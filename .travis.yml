language: python

sudo: false

env:
- TEST_PROFILE="test.proteus.yaml"

python:
- 2.7

addons:
  apt:
    packages:
    - gfortran
    - cmake
    - swig
    - libblas-dev
    - liblapack-dev

before_install:
- wget https://dl.dropboxusercontent.com/u/26353144/hashdist_travis.tgz
- tar xzf hashdist_travis.tgz 
- mv .hashdist $HOME

install:
- make hashdist
- make stack
- make stack/default.yaml
- CFLAGS='-w -fno-var-tracking-assignments' make install
- export PATH=$PWD/linux2/bin:$PATH
- export SSL_CERT_DIR=/etc/ssl/certs
- ls $SSL_CERT_DIR

script:
- py.test -vv proteus/tests proteus/tests/ci  proteus/tests/poisson_2d  proteus/tests/mesh_tests --ignore proteus/tests/POD


notifications:
  email:
    on_success: change
    on_failure: always
