<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>proteus: RANS2P.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX-AMS-MML_HTMLorMML.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">proteus
   &#160;<span id="projectnumber">1.7.2</span>
   </div>
   <div id="projectbrief">C/C++/Fortran libraries</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_43e0a1f539e00dcfa1a6bc4d4fee4fc2.html">home</a></li><li class="navelem"><a class="el" href="dir_08a8391b992a14344a0999056aee6393.html">tridelat</a></li><li class="navelem"><a class="el" href="dir_ea00e9b50a0f6d637a9dd4ed40825cbc.html">PROTEUS</a></li><li class="navelem"><a class="el" href="dir_d23a82edd4ac0940d9425868b4e8e61c.html">proteus2</a></li><li class="navelem"><a class="el" href="dir_fe87453fcfc0d512029001dc42c43d5c.html">proteus</a></li><li class="navelem"><a class="el" href="dir_7345f39f9a430cfefb4e585cf0572b86.html">mprans</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">RANS2P.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_r_a_n_s2_p_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#ifndef RANS2P_H</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#define RANS2P_H</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &lt;cmath&gt;</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &lt;valarray&gt;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_comp_kernel_8h.html">CompKernel.h</a>&quot;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_mixed_model_factory_8h.html">MixedModelFactory.h</a>&quot;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_py_embedded_functions_8h.html">PyEmbeddedFunctions.h</a>&quot;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="equivalent__polynomials_8h.html">equivalent_polynomials.h</a>&quot;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno"><a class="line" href="_r_a_n_s2_p_8h.html#aaef02b6e1d46c51958a20651954c60b0">   10</a></span>&#160;<span class="keyword">const</span>  <span class="keywordtype">double</span> <a class="code" href="_r_a_n_s2_p_8h.html#aaef02b6e1d46c51958a20651954c60b0">DM</a>=0.0;<span class="comment">//1-mesh conservation and divergence, 0 - weak div(v) only</span></div>
<div class="line"><a name="l00011"></a><span class="lineno"><a class="line" href="_r_a_n_s2_p_8h.html#af4c90b58f2b5c70d46004521b792f727">   11</a></span>&#160;<span class="keyword">const</span>  <span class="keywordtype">double</span> <a class="code" href="_r_a_n_s2_p_8h.html#af4c90b58f2b5c70d46004521b792f727">DM2</a>=0.0;<span class="comment">//1-point-wise mesh volume strong-residual, 0 - div(v) only</span></div>
<div class="line"><a name="l00012"></a><span class="lineno"><a class="line" href="_r_a_n_s2_p_8h.html#a5c858c7944d8ca1cbd20d6eeb52a1ae3">   12</a></span>&#160;<span class="keyword">const</span>  <span class="keywordtype">double</span> <a class="code" href="_r_a_n_s2_p_8h.html#a5c858c7944d8ca1cbd20d6eeb52a1ae3">DM3</a>=1.0;<span class="comment">//1-point-wise divergence, 0-point-wise rate of volume change</span></div>
<div class="line"><a name="l00013"></a><span class="lineno"><a class="line" href="_r_a_n_s2_p_8h.html#a3716a8d2d50d63c6f70019ad4c23c4ac">   13</a></span>&#160;<span class="preprocessor">#define USE_CYLINDER_AS_PARTICLE//just for debug</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceproteus.html">proteus</a></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;{</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;  <span class="keyword">template</span>&lt;<span class="keywordtype">int</span> nSpace, <span class="keywordtype">int</span> nP, <span class="keywordtype">int</span> nQ&gt;</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;  <span class="keyword">using</span> <a class="code" href="namespaceproteus.html#acdff9c5188c64d27db5cdf2669c2a849">GeneralizedFunctions</a> = <a class="code" href="classequivalent__polynomials_1_1_generalized_functions__mix.html">equivalent_polynomials::GeneralizedFunctions_mix&lt;nSpace, nP, nQ&gt;</a>;</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160; </div>
<div class="line"><a name="l00019"></a><span class="lineno"><a class="line" href="classproteus_1_1_r_a_n_s2_p__base.html">   19</a></span>&#160;  <span class="keyword">class </span><a class="code" href="classproteus_1_1_r_a_n_s2_p__base.html">RANS2P_base</a></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;  {</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;  <span class="keyword">public</span>:</div>
<div class="line"><a name="l00022"></a><span class="lineno"><a class="line" href="classproteus_1_1_r_a_n_s2_p__base.html#ac98b9770a5a62b4c353b5487b6094593">   22</a></span>&#160;    <span class="keyword">virtual</span> <a class="code" href="classproteus_1_1_r_a_n_s2_p__base.html#ac98b9770a5a62b4c353b5487b6094593">~RANS2P_base</a>(){}</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classproteus_1_1_r_a_n_s2_p__base.html#af9e615ad723539c7c8dade1a9480506f">calculateResidual</a>(<span class="keywordtype">double</span> NONCONSERVATIVE_FORM,</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;                                   <span class="keywordtype">double</span> MOMENTUM_SGE,</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;                                   <span class="keywordtype">double</span> PRESSURE_SGE,</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;                                   <span class="keywordtype">double</span> VELOCITY_SGE,</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;                                   <span class="keywordtype">double</span> PRESSURE_PROJECTION_STABLIZATION,</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;                                   <span class="keywordtype">double</span> *numerical_viscosity,</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;                                   <span class="comment">//element</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;                                   <span class="keywordtype">double</span> *mesh_trial_ref,</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;                                   <span class="keywordtype">double</span> *mesh_grad_trial_ref,</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;                                   <span class="keywordtype">double</span> *mesh_dof,</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;                                   <span class="keywordtype">double</span> *mesh_velocity_dof,</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;                                   <span class="keywordtype">double</span> MOVING_DOMAIN, <span class="comment">//0 or 1</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;                                   <span class="keywordtype">int</span> *mesh_l2g,</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;                                   <span class="keywordtype">double</span> *x_ref,</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;                                   <span class="keywordtype">double</span> *dV_ref,</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;                                   <span class="keywordtype">double</span> *p_trial_ref,</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;                                   <span class="keywordtype">double</span> *p_grad_trial_ref,</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;                                   <span class="keywordtype">double</span> *p_test_ref,</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;                                   <span class="keywordtype">double</span> *p_grad_test_ref,</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;                                   <span class="keywordtype">double</span> *vel_trial_ref,</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;                                   <span class="keywordtype">double</span> *vel_grad_trial_ref,</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;                                   <span class="keywordtype">double</span> *vel_test_ref,</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;                                   <span class="keywordtype">double</span> *vel_grad_test_ref,</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;                                   <span class="comment">//element boundary</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;                                   <span class="keywordtype">double</span> *mesh_trial_trace_ref,</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;                                   <span class="keywordtype">double</span> *mesh_grad_trial_trace_ref,</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;                                   <span class="keywordtype">double</span> *dS_ref,</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;                                   <span class="keywordtype">double</span> *p_trial_trace_ref,</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;                                   <span class="keywordtype">double</span> *p_grad_trial_trace_ref,</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;                                   <span class="keywordtype">double</span> *p_test_trace_ref,</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;                                   <span class="keywordtype">double</span> *p_grad_test_trace_ref,</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;                                   <span class="keywordtype">double</span> *vel_trial_trace_ref,</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                                   <span class="keywordtype">double</span> *vel_grad_trial_trace_ref,</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;                                   <span class="keywordtype">double</span> *vel_test_trace_ref,</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;                                   <span class="keywordtype">double</span> *vel_grad_test_trace_ref,</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;                                   <span class="keywordtype">double</span> *normal_ref,</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;                                   <span class="keywordtype">double</span> *boundaryJac_ref,</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                                   <span class="comment">//physics</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;                                   <span class="keywordtype">double</span> eb_adjoint_sigma,</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;                                   <span class="keywordtype">double</span> *elementDiameter,</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;                                   <span class="keywordtype">double</span> *nodeDiametersArray,</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;                                   <span class="keywordtype">double</span> hFactor,</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                                   <span class="keywordtype">int</span> nElements_global,</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;                                   <span class="keywordtype">int</span> nElementBoundaries_owned,</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;                                   <span class="keywordtype">double</span> useRBLES,</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;                                   <span class="keywordtype">double</span> useMetrics,</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;                                   <span class="keywordtype">double</span> alphaBDF,</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;                                   <span class="keywordtype">double</span> epsFact_rho,</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;                                   <span class="keywordtype">double</span> epsFact_mu,</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                                   <span class="keywordtype">double</span> sigma,</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                                   <span class="keywordtype">double</span> <a class="code" href="_error_residual_method_8cpp.html#ae5f5d9edb66645eab31a7c8389493ce7">rho_0</a>,</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                                   <span class="keywordtype">double</span> <a class="code" href="_error_residual_method_8cpp.html#a383b07af68441ce2b4adaaf8d8cc9d90">nu_0</a>,</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                                   <span class="keywordtype">double</span> <a class="code" href="_error_residual_method_8cpp.html#a751e53c9d8dfaf696b11b86e0c1b42e9">rho_1</a>,</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                                   <span class="keywordtype">double</span> <a class="code" href="_error_residual_method_8cpp.html#ae5896ebfee35f22242123e4ae82c81d9">nu_1</a>,</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                                   <span class="keywordtype">double</span> smagorinskyConstant,</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                                   <span class="keywordtype">int</span> turbulenceClosureModel,</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                                   <span class="keywordtype">double</span> Ct_sge,</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                                   <span class="keywordtype">double</span> Cd_sge,</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                                   <span class="keywordtype">double</span> C_dc,</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                                   <span class="keywordtype">double</span> C_b,</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                                   <span class="comment">//VRANS</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                                   <span class="keyword">const</span> <span class="keywordtype">double</span> *eps_solid,</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                                         <span class="keywordtype">double</span> *phi_solid,</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;                                   <span class="keyword">const</span> <span class="keywordtype">double</span> *q_velocity_solid,</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                                   <span class="keyword">const</span> <span class="keywordtype">double</span> *q_porosity,</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                                   <span class="keyword">const</span> <span class="keywordtype">double</span> *q_dragAlpha,</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;                                   <span class="keyword">const</span> <span class="keywordtype">double</span> *q_dragBeta,</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                                   <span class="keyword">const</span> <span class="keywordtype">double</span> *q_mass_source,</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                                   <span class="keyword">const</span> <span class="keywordtype">double</span> *q_turb_var_0,</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                                   <span class="keyword">const</span> <span class="keywordtype">double</span> *q_turb_var_1,</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;                                   <span class="keyword">const</span> <span class="keywordtype">double</span> *q_turb_var_grad_0,</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                                   <span class="keyword">const</span> <span class="keywordtype">double</span> LAG_LES,</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                                   <span class="keywordtype">double</span> *q_eddy_viscosity,</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                                   <span class="keywordtype">double</span> *q_eddy_viscosity_last,</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                                   <span class="keywordtype">double</span> *ebqe_eddy_viscosity,</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                                   <span class="keywordtype">double</span> *ebqe_eddy_viscosity_last,</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                                   <span class="keywordtype">int</span> *p_l2g,</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                                   <span class="keywordtype">int</span> *vel_l2g,</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                                   <span class="keywordtype">int</span>* rp_l2g,</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                                   <span class="keywordtype">int</span>* rvel_l2g,</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                                   <span class="keywordtype">double</span>* p_dof,</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                                   <span class="keywordtype">double</span>* u_dof,</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                                   <span class="keywordtype">double</span>* v_dof,</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                                   <span class="keywordtype">double</span>* w_dof,</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                                   <span class="keywordtype">double</span> *p_old_dof,</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                                   <span class="keywordtype">double</span> *u_old_dof,</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                                   <span class="keywordtype">double</span> *v_old_dof,</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                                   <span class="keywordtype">double</span> *w_old_dof,</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                                   <span class="keywordtype">double</span> *g,</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                                   <span class="keyword">const</span> <span class="keywordtype">double</span> useVF,</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                                   <span class="keywordtype">double</span> *q_rho,</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                                   <span class="keywordtype">double</span> *vf,</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                                   <span class="keywordtype">double</span> *<a class="code" href="namespaceproteus.html#a17bf106c5df3b1331ed2a18392384813">phi</a>,</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                                   <span class="keywordtype">double</span> *phi_nodes,</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                                   <span class="keywordtype">double</span> *normal_phi,</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                                   <span class="keywordtype">double</span> *kappa_phi,</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                                   <span class="keywordtype">double</span> *q_mom_u_acc,</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                                   <span class="keywordtype">double</span> *q_mom_v_acc,</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                                   <span class="keywordtype">double</span> *q_mom_w_acc,</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                                   <span class="keywordtype">double</span> *q_mass_adv,</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                                   <span class="keywordtype">double</span> *q_mom_u_acc_beta_bdf, <span class="keywordtype">double</span> *q_mom_v_acc_beta_bdf, <span class="keywordtype">double</span> *q_mom_w_acc_beta_bdf,</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                                   <span class="keywordtype">double</span> *q_dV,</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                                   <span class="keywordtype">double</span> *q_dV_last,</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                                   <span class="keywordtype">double</span> *q_velocity_sge,</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                                   <span class="keywordtype">double</span> *q_cfl,</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                                   <span class="keywordtype">double</span> *q_numDiff_u, <span class="keywordtype">double</span> *q_numDiff_v, <span class="keywordtype">double</span> *q_numDiff_w,</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                                   <span class="keywordtype">double</span> *q_numDiff_u_last, <span class="keywordtype">double</span> *q_numDiff_v_last, <span class="keywordtype">double</span> *q_numDiff_w_last,</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                                   <span class="keywordtype">int</span> *sdInfo_u_u_rowptr, <span class="keywordtype">int</span> *sdInfo_u_u_colind,</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                                   <span class="keywordtype">int</span> *sdInfo_u_v_rowptr, <span class="keywordtype">int</span> *sdInfo_u_v_colind,</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                                   <span class="keywordtype">int</span> *sdInfo_u_w_rowptr, <span class="keywordtype">int</span> *sdInfo_u_w_colind,</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                                   <span class="keywordtype">int</span> *sdInfo_v_v_rowptr, <span class="keywordtype">int</span> *sdInfo_v_v_colind,</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                                   <span class="keywordtype">int</span> *sdInfo_v_u_rowptr, <span class="keywordtype">int</span> *sdInfo_v_u_colind,</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                                   <span class="keywordtype">int</span> *sdInfo_v_w_rowptr, <span class="keywordtype">int</span> *sdInfo_v_w_colind,</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                                   <span class="keywordtype">int</span> *sdInfo_w_w_rowptr, <span class="keywordtype">int</span> *sdInfo_w_w_colind,</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                                   <span class="keywordtype">int</span> *sdInfo_w_u_rowptr, <span class="keywordtype">int</span> *sdInfo_w_u_colind,</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                                   <span class="keywordtype">int</span> *sdInfo_w_v_rowptr, <span class="keywordtype">int</span> *sdInfo_w_v_colind,</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                                   <span class="keywordtype">int</span> offset_p, <span class="keywordtype">int</span> offset_u, <span class="keywordtype">int</span> offset_v, <span class="keywordtype">int</span> offset_w,</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                                   <span class="keywordtype">int</span> stride_p, <span class="keywordtype">int</span> stride_u, <span class="keywordtype">int</span> stride_v, <span class="keywordtype">int</span> stride_w,</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                                   <span class="keywordtype">double</span> *globalResidual,</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                                   <span class="keywordtype">int</span> nExteriorElementBoundaries_global,</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                                   <span class="keywordtype">int</span> *exteriorElementBoundariesArray,</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                                   <span class="keywordtype">int</span> *elementBoundaryElementsArray,</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                                   <span class="keywordtype">int</span> *elementBoundaryLocalElementBoundariesArray,</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                                   <span class="keywordtype">double</span> *ebqe_vf_ext,</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                                   <span class="keywordtype">double</span> *bc_ebqe_vf_ext,</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                                   <span class="keywordtype">double</span> *ebqe_phi_ext,</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                                   <span class="keywordtype">double</span> *bc_ebqe_phi_ext,</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                                   <span class="keywordtype">double</span> *ebqe_normal_phi_ext,</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                                   <span class="keywordtype">double</span> *ebqe_kappa_phi_ext,</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                                   <span class="comment">//VRANS</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                                   <span class="keyword">const</span> <span class="keywordtype">double</span> *ebqe_porosity_ext,</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                                   <span class="keyword">const</span> <span class="keywordtype">double</span> *ebqe_turb_var_0,</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                                   <span class="keyword">const</span> <span class="keywordtype">double</span> *ebqe_turb_var_1,</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                                   <span class="comment">//VRANS end</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                                   <span class="keywordtype">int</span> *isDOFBoundary_p,</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                                   <span class="keywordtype">int</span> *isDOFBoundary_u,</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                                   <span class="keywordtype">int</span> *isDOFBoundary_v,</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                                   <span class="keywordtype">int</span> *isDOFBoundary_w,</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                                   <span class="keywordtype">int</span> *isAdvectiveFluxBoundary_p,</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                                   <span class="keywordtype">int</span> *isAdvectiveFluxBoundary_u,</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                                   <span class="keywordtype">int</span> *isAdvectiveFluxBoundary_v,</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                                   <span class="keywordtype">int</span> *isAdvectiveFluxBoundary_w,</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                                   <span class="keywordtype">int</span> *isDiffusiveFluxBoundary_u,</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                                   <span class="keywordtype">int</span> *isDiffusiveFluxBoundary_v,</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                                   <span class="keywordtype">int</span> *isDiffusiveFluxBoundary_w,</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                                   <span class="keywordtype">double</span> *ebqe_bc_p_ext,</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                                   <span class="keywordtype">double</span> *ebqe_bc_flux_mass_ext,</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                                   <span class="keywordtype">double</span> *ebqe_bc_flux_mom_u_adv_ext,</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                                   <span class="keywordtype">double</span> *ebqe_bc_flux_mom_v_adv_ext,</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                                   <span class="keywordtype">double</span> *ebqe_bc_flux_mom_w_adv_ext,</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                                   <span class="keywordtype">double</span> *ebqe_bc_u_ext,</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                                   <span class="keywordtype">double</span> *ebqe_bc_flux_u_diff_ext,</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                                   <span class="keywordtype">double</span> *ebqe_penalty_ext,</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                                   <span class="keywordtype">double</span> *ebqe_bc_v_ext,</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                                   <span class="keywordtype">double</span> *ebqe_bc_flux_v_diff_ext,</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                                   <span class="keywordtype">double</span> *ebqe_bc_w_ext,</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                                   <span class="keywordtype">double</span> *ebqe_bc_flux_w_diff_ext,</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                                   <span class="keywordtype">double</span> *q_x,</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                                   <span class="keywordtype">double</span> *q_velocity,</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                                   <span class="keywordtype">double</span> *ebqe_velocity,</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                                   <span class="keywordtype">double</span> *flux,</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                                   <span class="keywordtype">double</span> *elementResidual_p,</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                                   <span class="keywordtype">int</span> *elementFlags,</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                                   <span class="keywordtype">int</span> *boundaryFlags,</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                                   <span class="keywordtype">double</span> *barycenters,</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                                   <span class="keywordtype">double</span> *wettedAreas,</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                                   <span class="keywordtype">double</span> *netForces_p,</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                                   <span class="keywordtype">double</span> *netForces_v,</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                                   <span class="keywordtype">double</span> *netMoments,</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                                   <span class="keywordtype">double</span> *velocityError,</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                                   <span class="keywordtype">double</span> *velocityErrorNodal,</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                                   <span class="keywordtype">double</span> *forcex,</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                                   <span class="keywordtype">double</span> *forcey,</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                                   <span class="keywordtype">double</span> *forcez,</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                                   <span class="keywordtype">int</span> use_ball_as_particle,</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                                   <span class="keywordtype">double</span> *ball_center,</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                                   <span class="keywordtype">double</span> *ball_radius,</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                                   <span class="keywordtype">double</span> *ball_velocity,</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                                   <span class="keywordtype">double</span> *ball_angular_velocity,</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                                   <span class="keywordtype">double</span>* ball_center_acceleration,</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                                   <span class="keywordtype">double</span>* ball_angular_acceleration,</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                                   <span class="keywordtype">double</span>* ball_density,</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                                   <span class="keywordtype">double</span>* particle_signed_distances,</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                                   <span class="keywordtype">double</span>* particle_signed_distance_normals,</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                                   <span class="keywordtype">double</span>* particle_velocities,</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                                   <span class="keywordtype">double</span>* particle_centroids,</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                                   <span class="keywordtype">double</span>* ebq_global_phi_s,</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                                   <span class="keywordtype">double</span>* ebq_global_grad_phi_s,</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                                   <span class="keywordtype">double</span>* ebq_particle_velocity_s,</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                                   <span class="keywordtype">int</span>     nParticles,</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                                   <span class="keywordtype">double</span> *particle_netForces,</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                                   <span class="keywordtype">double</span> *particle_netMoments,</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                                   <span class="keywordtype">double</span> *particle_surfaceArea,</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                                   <span class="keywordtype">int</span>    nElements_owned,</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                                   <span class="keywordtype">double</span> particle_nitsche,</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                                   <span class="keywordtype">double</span> particle_epsFact,</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                                   <span class="keywordtype">double</span> particle_alpha,</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                                   <span class="keywordtype">double</span> particle_beta,</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                                   <span class="keywordtype">double</span> particle_penalty_constant,</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                                   <span class="keywordtype">double</span>* phi_solid_nodes,</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                                   <span class="keywordtype">double</span>* distance_to_solids,</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                                   <span class="keyword">const</span> <span class="keywordtype">int</span> use_pseudo_penalty,</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                                   <span class="keywordtype">bool</span> useExact) = 0;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classproteus_1_1_r_a_n_s2_p__base.html#aa57937b9b5702e2d0cf3f5ca4a33aeb7">calculateJacobian</a>(<span class="keywordtype">double</span> NONCONSERVATIVE_FORM,</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                                   <span class="keywordtype">double</span> MOMENTUM_SGE,</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                                   <span class="keywordtype">double</span> PRESSURE_SGE,</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                                   <span class="keywordtype">double</span> VELOCITY_SGE,</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                                   <span class="keywordtype">double</span> PRESSURE_PROJECTION_STABILIZATION,</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                                   <span class="comment">//element</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                                   <span class="keywordtype">double</span> *mesh_trial_ref,</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                                   <span class="keywordtype">double</span> *mesh_grad_trial_ref,</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                                   <span class="keywordtype">double</span> *mesh_dof,</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                                   <span class="keywordtype">double</span> *mesh_velocity_dof,</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                                   <span class="keywordtype">double</span> MOVING_DOMAIN,</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                                   <span class="keywordtype">int</span> *mesh_l2g,</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                                   <span class="keywordtype">double</span> *x_ref,</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                                   <span class="keywordtype">double</span> *dV_ref,</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                                   <span class="keywordtype">double</span> *p_trial_ref,</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                                   <span class="keywordtype">double</span> *p_grad_trial_ref,</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                                   <span class="keywordtype">double</span> *p_test_ref,</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                                   <span class="keywordtype">double</span> *p_grad_test_ref,</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                                   <span class="keywordtype">double</span> *vel_trial_ref,</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                                   <span class="keywordtype">double</span> *vel_grad_trial_ref,</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                                   <span class="keywordtype">double</span> *vel_test_ref,</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                                   <span class="keywordtype">double</span> *vel_grad_test_ref,</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                                   <span class="comment">//element boundary</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                                   <span class="keywordtype">double</span> *mesh_trial_trace_ref,</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                                   <span class="keywordtype">double</span> *mesh_grad_trial_trace_ref,</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                                   <span class="keywordtype">double</span> *dS_ref,</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                                   <span class="keywordtype">double</span> *p_trial_trace_ref,</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                                   <span class="keywordtype">double</span> *p_grad_trial_trace_ref,</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                                   <span class="keywordtype">double</span> *p_test_trace_ref,</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                                   <span class="keywordtype">double</span> *p_grad_test_trace_ref,</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                                   <span class="keywordtype">double</span> *vel_trial_trace_ref,</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                                   <span class="keywordtype">double</span> *vel_grad_trial_trace_ref,</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                                   <span class="keywordtype">double</span> *vel_test_trace_ref,</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                                   <span class="keywordtype">double</span> *vel_grad_test_trace_ref,</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                                   <span class="keywordtype">double</span> *normal_ref,</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                                   <span class="keywordtype">double</span> *boundaryJac_ref,</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                                   <span class="comment">//physics</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                                   <span class="keywordtype">double</span> eb_adjoint_sigma,</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                                   <span class="keywordtype">double</span> *elementDiameter,</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                                   <span class="keywordtype">double</span> *nodeDiametersArray,</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                                   <span class="keywordtype">double</span> hFactor,</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                                   <span class="keywordtype">int</span> nElements_global,</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                                   <span class="keywordtype">double</span> useRBLES,</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                                   <span class="keywordtype">double</span> useMetrics,</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                                   <span class="keywordtype">double</span> alphaBDF,</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                                   <span class="keywordtype">double</span> epsFact_rho,</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                                   <span class="keywordtype">double</span> epsFact_mu,</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                                   <span class="keywordtype">double</span> sigma,</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                                   <span class="keywordtype">double</span> <a class="code" href="_error_residual_method_8cpp.html#ae5f5d9edb66645eab31a7c8389493ce7">rho_0</a>,</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                                   <span class="keywordtype">double</span> <a class="code" href="_error_residual_method_8cpp.html#a383b07af68441ce2b4adaaf8d8cc9d90">nu_0</a>,</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                                   <span class="keywordtype">double</span> <a class="code" href="_error_residual_method_8cpp.html#a751e53c9d8dfaf696b11b86e0c1b42e9">rho_1</a>,</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                                   <span class="keywordtype">double</span> <a class="code" href="_error_residual_method_8cpp.html#ae5896ebfee35f22242123e4ae82c81d9">nu_1</a>,</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                                   <span class="keywordtype">double</span> smagorinskyConstant,</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                                   <span class="keywordtype">int</span> turbulenceClosureModel,</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                                   <span class="keywordtype">double</span> Ct_sge,</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                                   <span class="keywordtype">double</span> Cd_sge,</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                                   <span class="keywordtype">double</span> C_dg,</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                                   <span class="keywordtype">double</span> C_b,</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                                   <span class="comment">//VRANS</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                                   <span class="keyword">const</span> <span class="keywordtype">double</span> *eps_solid,</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                                   <span class="keyword">const</span> <span class="keywordtype">double</span> *phi_solid,</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                                   <span class="keyword">const</span> <span class="keywordtype">double</span> *q_velocity_solid,</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                                   <span class="keyword">const</span> <span class="keywordtype">double</span> *q_porosity,</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                                   <span class="keyword">const</span> <span class="keywordtype">double</span> *q_dragAlpha,</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                                   <span class="keyword">const</span> <span class="keywordtype">double</span> *q_dragBeta,</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                                   <span class="keyword">const</span> <span class="keywordtype">double</span> *q_mass_source,</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                                   <span class="keyword">const</span> <span class="keywordtype">double</span> *q_turb_var_0,</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                                   <span class="keyword">const</span> <span class="keywordtype">double</span> *q_turb_var_1,</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                                   <span class="keyword">const</span> <span class="keywordtype">double</span> *q_turb_var_grad_0,</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                                   <span class="keyword">const</span> <span class="keywordtype">double</span> LAG_LES,</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                                   <span class="keywordtype">double</span> *q_eddy_viscosity_last,</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                                   <span class="keywordtype">double</span> *ebqe_eddy_viscosity_last,</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                                   <span class="keywordtype">int</span> *p_l2g,</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                                   <span class="keywordtype">int</span> *vel_l2g,</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                                   <span class="keywordtype">double</span> *p_dof, <span class="keywordtype">double</span> *u_dof, <span class="keywordtype">double</span> *v_dof, <span class="keywordtype">double</span> *w_dof,</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                                   <span class="keywordtype">double</span> *p_old_dof,</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                                   <span class="keywordtype">double</span> *u_old_dof,</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                                   <span class="keywordtype">double</span> *v_old_dof,</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                                   <span class="keywordtype">double</span> *w_old_dof,</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                                   <span class="keywordtype">double</span> *g,</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                                   <span class="keyword">const</span> <span class="keywordtype">double</span> useVF,</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                                   <span class="keywordtype">double</span> *vf,</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                                   <span class="keywordtype">double</span> *<a class="code" href="namespaceproteus.html#a17bf106c5df3b1331ed2a18392384813">phi</a>,</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                                   <span class="keywordtype">double</span> *phi_nodes,</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                                   <span class="keywordtype">double</span> *normal_phi,</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                                   <span class="keywordtype">double</span> *kappa_phi,</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                                   <span class="keywordtype">double</span> *q_mom_u_acc_beta_bdf, <span class="keywordtype">double</span> *q_mom_v_acc_beta_bdf, <span class="keywordtype">double</span> *q_mom_w_acc_beta_bdf,</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                                   <span class="keywordtype">double</span> *q_dV,</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                                   <span class="keywordtype">double</span> *q_dV_last,</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                                   <span class="keywordtype">double</span> *q_velocity_sge,</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                                   <span class="keywordtype">double</span> *q_cfl,</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                                   <span class="keywordtype">double</span> *q_numDiff_u_last, <span class="keywordtype">double</span> *q_numDiff_v_last, <span class="keywordtype">double</span> *q_numDiff_w_last,</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                                   <span class="keywordtype">int</span> *sdInfo_u_u_rowptr, <span class="keywordtype">int</span> *sdInfo_u_u_colind,</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                                   <span class="keywordtype">int</span> *sdInfo_u_v_rowptr, <span class="keywordtype">int</span> *sdInfo_u_v_colind,</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                                   <span class="keywordtype">int</span> *sdInfo_u_w_rowptr, <span class="keywordtype">int</span> *sdInfo_u_w_colind,</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                                   <span class="keywordtype">int</span> *sdInfo_v_v_rowptr, <span class="keywordtype">int</span> *sdInfo_v_v_colind,</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                                   <span class="keywordtype">int</span> *sdInfo_v_u_rowptr, <span class="keywordtype">int</span> *sdInfo_v_u_colind,</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                                   <span class="keywordtype">int</span> *sdInfo_v_w_rowptr, <span class="keywordtype">int</span> *sdInfo_v_w_colind,</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                                   <span class="keywordtype">int</span> *sdInfo_w_w_rowptr, <span class="keywordtype">int</span> *sdInfo_w_w_colind,</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                                   <span class="keywordtype">int</span> *sdInfo_w_u_rowptr, <span class="keywordtype">int</span> *sdInfo_w_u_colind,</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                                   <span class="keywordtype">int</span> *sdInfo_w_v_rowptr, <span class="keywordtype">int</span> *sdInfo_w_v_colind,</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                                   <span class="keywordtype">int</span> *csrRowIndeces_p_p, <span class="keywordtype">int</span> *csrColumnOffsets_p_p,</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                                   <span class="keywordtype">int</span> *csrRowIndeces_p_u, <span class="keywordtype">int</span> *csrColumnOffsets_p_u,</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                                   <span class="keywordtype">int</span> *csrRowIndeces_p_v, <span class="keywordtype">int</span> *csrColumnOffsets_p_v,</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                                   <span class="keywordtype">int</span> *csrRowIndeces_p_w, <span class="keywordtype">int</span> *csrColumnOffsets_p_w,</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                                   <span class="keywordtype">int</span> *csrRowIndeces_u_p, <span class="keywordtype">int</span> *csrColumnOffsets_u_p,</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                                   <span class="keywordtype">int</span> *csrRowIndeces_u_u, <span class="keywordtype">int</span> *csrColumnOffsets_u_u,</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                                   <span class="keywordtype">int</span> *csrRowIndeces_u_v, <span class="keywordtype">int</span> *csrColumnOffsets_u_v,</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                                   <span class="keywordtype">int</span> *csrRowIndeces_u_w, <span class="keywordtype">int</span> *csrColumnOffsets_u_w,</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                                   <span class="keywordtype">int</span> *csrRowIndeces_v_p, <span class="keywordtype">int</span> *csrColumnOffsets_v_p,</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                                   <span class="keywordtype">int</span> *csrRowIndeces_v_u, <span class="keywordtype">int</span> *csrColumnOffsets_v_u,</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                                   <span class="keywordtype">int</span> *csrRowIndeces_v_v, <span class="keywordtype">int</span> *csrColumnOffsets_v_v,</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                                   <span class="keywordtype">int</span> *csrRowIndeces_v_w, <span class="keywordtype">int</span> *csrColumnOffsets_v_w,</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                                   <span class="keywordtype">int</span> *csrRowIndeces_w_p, <span class="keywordtype">int</span> *csrColumnOffsets_w_p,</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                                   <span class="keywordtype">int</span> *csrRowIndeces_w_u, <span class="keywordtype">int</span> *csrColumnOffsets_w_u,</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                                   <span class="keywordtype">int</span> *csrRowIndeces_w_v, <span class="keywordtype">int</span> *csrColumnOffsets_w_v,</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                                   <span class="keywordtype">int</span> *csrRowIndeces_w_w, <span class="keywordtype">int</span> *csrColumnOffsets_w_w,</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                                   <span class="keywordtype">double</span> *globalJacobian,</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                                   <span class="keywordtype">int</span> nExteriorElementBoundaries_global,</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                                   <span class="keywordtype">int</span> *exteriorElementBoundariesArray,</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                                   <span class="keywordtype">int</span> *elementBoundaryElementsArray,</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                                   <span class="keywordtype">int</span> *elementBoundaryLocalElementBoundariesArray,</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                                   <span class="keywordtype">double</span> *ebqe_vf_ext,</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                                   <span class="keywordtype">double</span> *bc_ebqe_vf_ext,</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                                   <span class="keywordtype">double</span> *ebqe_phi_ext,</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                                   <span class="keywordtype">double</span> *bc_ebqe_phi_ext,</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                                   <span class="keywordtype">double</span> *ebqe_normal_phi_ext,</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                                   <span class="keywordtype">double</span> *ebqe_kappa_phi_ext,</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                                   <span class="comment">//VRANS</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                                   <span class="keyword">const</span> <span class="keywordtype">double</span> *ebqe_porosity_ext,</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                                   <span class="keyword">const</span> <span class="keywordtype">double</span> *ebqe_turb_var_0,</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                                   <span class="keyword">const</span> <span class="keywordtype">double</span> *ebqe_turb_var_1,</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                                   <span class="comment">//VRANS end</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                                   <span class="keywordtype">int</span> *isDOFBoundary_p,</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                                   <span class="keywordtype">int</span> *isDOFBoundary_u,</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                                   <span class="keywordtype">int</span> *isDOFBoundary_v,</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                                   <span class="keywordtype">int</span> *isDOFBoundary_w,</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                                   <span class="keywordtype">int</span> *isAdvectiveFluxBoundary_p,</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                                   <span class="keywordtype">int</span> *isAdvectiveFluxBoundary_u,</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                                   <span class="keywordtype">int</span> *isAdvectiveFluxBoundary_v,</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                                   <span class="keywordtype">int</span> *isAdvectiveFluxBoundary_w,</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                                   <span class="keywordtype">int</span> *isDiffusiveFluxBoundary_u,</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                                   <span class="keywordtype">int</span> *isDiffusiveFluxBoundary_v,</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                                   <span class="keywordtype">int</span> *isDiffusiveFluxBoundary_w,</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                                   <span class="keywordtype">double</span> *ebqe_bc_p_ext,</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                                   <span class="keywordtype">double</span> *ebqe_bc_flux_mass_ext,</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                                   <span class="keywordtype">double</span> *ebqe_bc_flux_mom_u_adv_ext,</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                                   <span class="keywordtype">double</span> *ebqe_bc_flux_mom_v_adv_ext,</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                                   <span class="keywordtype">double</span> *ebqe_bc_flux_mom_w_adv_ext,</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                                   <span class="keywordtype">double</span> *ebqe_bc_u_ext,</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                                   <span class="keywordtype">double</span> *ebqe_bc_flux_u_diff_ext,</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                                   <span class="keywordtype">double</span> *ebqe_penalty_ext,</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                                   <span class="keywordtype">double</span> *ebqe_bc_v_ext,</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                                   <span class="keywordtype">double</span> *ebqe_bc_flux_v_diff_ext,</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                                   <span class="keywordtype">double</span> *ebqe_bc_w_ext,</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                                   <span class="keywordtype">double</span> *ebqe_bc_flux_w_diff_ext,</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                                   <span class="keywordtype">int</span> *csrColumnOffsets_eb_p_p,</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                                   <span class="keywordtype">int</span> *csrColumnOffsets_eb_p_u,</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                                   <span class="keywordtype">int</span> *csrColumnOffsets_eb_p_v,</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                                   <span class="keywordtype">int</span> *csrColumnOffsets_eb_p_w,</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                                   <span class="keywordtype">int</span> *csrColumnOffsets_eb_u_p,</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                                   <span class="keywordtype">int</span> *csrColumnOffsets_eb_u_u,</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                                   <span class="keywordtype">int</span> *csrColumnOffsets_eb_u_v,</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                                   <span class="keywordtype">int</span> *csrColumnOffsets_eb_u_w,</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                                   <span class="keywordtype">int</span> *csrColumnOffsets_eb_v_p,</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                                   <span class="keywordtype">int</span> *csrColumnOffsets_eb_v_u,</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                                   <span class="keywordtype">int</span> *csrColumnOffsets_eb_v_v,</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                                   <span class="keywordtype">int</span> *csrColumnOffsets_eb_v_w,</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                                   <span class="keywordtype">int</span> *csrColumnOffsets_eb_w_p,</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                                   <span class="keywordtype">int</span> *csrColumnOffsets_eb_w_u,</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                                   <span class="keywordtype">int</span> *csrColumnOffsets_eb_w_v,</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                                   <span class="keywordtype">int</span> *csrColumnOffsets_eb_w_w,</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                                   <span class="keywordtype">int</span> *elementFlags,</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                                   <span class="keywordtype">int</span> *boundaryFlags,</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                                   <span class="keywordtype">int</span> use_ball_as_particle,</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                                   <span class="keywordtype">double</span> *ball_center,</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                                   <span class="keywordtype">double</span> *ball_radius,</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                                   <span class="keywordtype">double</span> *ball_velocity,</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                                   <span class="keywordtype">double</span> *ball_angular_velocity,</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                                   <span class="keywordtype">double</span>* ball_center_acceleration,</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                                   <span class="keywordtype">double</span>* ball_angular_acceleration,</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                                   <span class="keywordtype">double</span>* ball_density,</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                                   <span class="keywordtype">double</span>* particle_signed_distances,</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                                   <span class="keywordtype">double</span>* particle_signed_distance_normals,</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                                   <span class="keywordtype">double</span>* particle_velocities,</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                                   <span class="keywordtype">double</span>* particle_centroids,</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                                   <span class="keywordtype">double</span>* ebq_global_phi_s,</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                                   <span class="keywordtype">double</span>* ebq_global_grad_phi_s,</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                                   <span class="keywordtype">double</span>* ebq_particle_velocity_s,</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                                   <span class="keywordtype">double</span>* phi_solid_nodes,</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                                   <span class="keywordtype">double</span>* distance_to_solids,</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                                   <span class="keywordtype">int</span> nParticles,</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                                   <span class="keywordtype">int</span> nElements_owned,</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                                   <span class="keywordtype">double</span> particle_nitsche,</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                                   <span class="keywordtype">double</span> particle_epsFact,</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                                   <span class="keywordtype">double</span> particle_alpha,</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                                   <span class="keywordtype">double</span> particle_beta,</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                                   <span class="keywordtype">double</span> particle_penalty_constant,</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                                   <span class="keyword">const</span> <span class="keywordtype">int</span> use_pseudo_penalty,</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                                   <span class="keywordtype">bool</span> useExact) = 0;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classproteus_1_1_r_a_n_s2_p__base.html#a19ed30cfae419903868c7593804dca97">calculateVelocityAverage</a>(<span class="keywordtype">int</span> nExteriorElementBoundaries_global,</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                                          <span class="keywordtype">int</span>* exteriorElementBoundariesArray,</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                                          <span class="keywordtype">int</span> nInteriorElementBoundaries_global,</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                                          <span class="keywordtype">int</span>* interiorElementBoundariesArray,</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                                          <span class="keywordtype">int</span>* elementBoundaryElementsArray,</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                                          <span class="keywordtype">int</span>* elementBoundaryLocalElementBoundariesArray,</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                                          <span class="keywordtype">double</span>* mesh_dof,</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                                          <span class="keywordtype">double</span>* mesh_velocity_dof,</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                                          <span class="keywordtype">double</span> MOVING_DOMAIN,<span class="comment">//0 or 1</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                                          <span class="keywordtype">int</span>* mesh_l2g,</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                                          <span class="keywordtype">double</span>* mesh_trial_trace_ref,</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                                          <span class="keywordtype">double</span>* mesh_grad_trial_trace_ref,</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                                          <span class="keywordtype">double</span>* normal_ref,</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                                          <span class="keywordtype">double</span>* boundaryJac_ref,</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                                          <span class="keywordtype">int</span>* vel_l2g,</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                                          <span class="keywordtype">double</span>* u_dof,</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                                          <span class="keywordtype">double</span>* v_dof,</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                                          <span class="keywordtype">double</span>* w_dof,</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                                          <span class="keywordtype">double</span>* vel_trial_trace_ref,</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                                          <span class="keywordtype">double</span>* ebqe_velocity,</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                                          <span class="keywordtype">double</span>* velocityAverage)=0;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classproteus_1_1_r_a_n_s2_p__base.html#ac792268b36a32af7e06114b451e97fe5">getTwoPhaseAdvectionOperator</a>(<span class="keywordtype">double</span>* mesh_trial_ref,</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                                              <span class="keywordtype">double</span>* mesh_grad_trial_ref,</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                                              <span class="keywordtype">double</span>* mesh_dof,</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                                              <span class="keywordtype">int</span>* mesh_l2g,</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                                              <span class="keywordtype">double</span>* dV_ref,</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                                              <span class="keywordtype">double</span>* p_trial_ref,</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                                              <span class="keywordtype">double</span>* p_grad_trial_ref,</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                                              <span class="keywordtype">double</span>* vel_trail_ref,</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                                              <span class="keywordtype">double</span>* vel_grad_trial_ref,</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                                              <span class="keywordtype">double</span>* elementDiameter,</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                                              <span class="keywordtype">double</span>* nodeDiametersArray,</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                                              <span class="keywordtype">int</span> nElements_global,</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                                              <span class="keywordtype">double</span> useMetrics,</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                                              <span class="keywordtype">double</span> epsFact_rho,</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                                              <span class="keywordtype">double</span> epsFact_mu,</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                                              <span class="keywordtype">double</span> <a class="code" href="_error_residual_method_8cpp.html#ae5f5d9edb66645eab31a7c8389493ce7">rho_0</a>,</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                                              <span class="keywordtype">double</span> <a class="code" href="_error_residual_method_8cpp.html#a383b07af68441ce2b4adaaf8d8cc9d90">nu_0</a>,</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                                              <span class="keywordtype">double</span> <a class="code" href="_error_residual_method_8cpp.html#a751e53c9d8dfaf696b11b86e0c1b42e9">rho_1</a>,</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                                              <span class="keywordtype">double</span> <a class="code" href="_error_residual_method_8cpp.html#ae5896ebfee35f22242123e4ae82c81d9">nu_1</a>,</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                                              <span class="keywordtype">int</span>* vel_l2g,</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                                              <span class="keywordtype">double</span>* u_dof, <span class="keywordtype">double</span>* v_dof, <span class="keywordtype">double</span>* w_dof,</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                                              <span class="keyword">const</span> <span class="keywordtype">double</span> useVF,</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                                              <span class="keywordtype">double</span> *vf,</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                                              <span class="keywordtype">double</span> *<a class="code" href="namespaceproteus.html#a17bf106c5df3b1331ed2a18392384813">phi</a>,</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                                              <span class="keywordtype">int</span>* csrRowIndeces_p_p, <span class="keywordtype">int</span>* csrColumnOffsets_p_p,</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                                              <span class="keywordtype">int</span>* csrRowIndeces_u_u, <span class="keywordtype">int</span>* csrColumnOffsets_u_u,</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                                              <span class="keywordtype">int</span>* csrRowIndeces_v_v, <span class="keywordtype">int</span>* csrColumnOffsets_v_v,</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                                              <span class="keywordtype">int</span>* csrRowIndeces_w_w, <span class="keywordtype">int</span>* csrColumnOffsets_w_w,</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                                              <span class="keywordtype">double</span>* advection_matrix) = 0;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classproteus_1_1_r_a_n_s2_p__base.html#acf1aa973f8b828074f917566f649d172">getTwoPhaseInvScaledLaplaceOperator</a>(<span class="keywordtype">double</span>* mesh_trial_ref,</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;                                                     <span class="keywordtype">double</span>* mesh_grad_trial_ref,</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                                                     <span class="keywordtype">double</span>* mesh_dof,</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                                                     <span class="keywordtype">int</span>* mesh_l2g,</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                                                     <span class="keywordtype">double</span>* dV_ref,</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                                                     <span class="keywordtype">double</span>* p_grad_trial_ref,</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                                                     <span class="keywordtype">double</span>* vel_grad_trial_ref,</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                                                     <span class="keywordtype">double</span>* elementDiameter,</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                                                     <span class="keywordtype">double</span>* nodeDiametersArray,</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                                                     <span class="keywordtype">int</span> nElements_global,</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                                                     <span class="keywordtype">double</span> useMetrics,</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                                                     <span class="keywordtype">double</span> epsFact_rho,</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                                                     <span class="keywordtype">double</span> epsFact_mu,</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                                                     <span class="keywordtype">double</span> <a class="code" href="_error_residual_method_8cpp.html#ae5f5d9edb66645eab31a7c8389493ce7">rho_0</a>,</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                                                     <span class="keywordtype">double</span> <a class="code" href="_error_residual_method_8cpp.html#a383b07af68441ce2b4adaaf8d8cc9d90">nu_0</a>,</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                                                     <span class="keywordtype">double</span> <a class="code" href="_error_residual_method_8cpp.html#a751e53c9d8dfaf696b11b86e0c1b42e9">rho_1</a>,</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                                                     <span class="keywordtype">double</span> <a class="code" href="_error_residual_method_8cpp.html#ae5896ebfee35f22242123e4ae82c81d9">nu_1</a>,</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                                                     <span class="keywordtype">int</span>* p_l2g,</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                                                     <span class="keywordtype">int</span>* vel_l2g,</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                                                     <span class="keywordtype">double</span>* p_dof, <span class="keywordtype">double</span>* u_dof, <span class="keywordtype">double</span>* v_dof, <span class="keywordtype">double</span>* w_dof,</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;                                                     <span class="keyword">const</span> <span class="keywordtype">double</span> useVF,</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                                                     <span class="keywordtype">double</span>* vf,</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;                                                     <span class="keywordtype">double</span>* <a class="code" href="namespaceproteus.html#a17bf106c5df3b1331ed2a18392384813">phi</a>,</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                                                     <span class="keywordtype">int</span>* sdInfo_p_p_rowptr, <span class="keywordtype">int</span>* sdInfo_p_p_colind,</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;                                                     <span class="keywordtype">int</span>* sdInfo_u_u_rowptr, <span class="keywordtype">int</span>* sdInfo_u_u_colind,</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                                                     <span class="keywordtype">int</span>* sdInfo_v_v_rowptr, <span class="keywordtype">int</span>* sdInfo_v_v_colind,</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                                                     <span class="keywordtype">int</span>* sdInfo_w_w_rowptr, <span class="keywordtype">int</span>* sdInfo_w_w_colind,                                                 </div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                                                     <span class="keywordtype">int</span>* csrRowIndeces_p_p, <span class="keywordtype">int</span>* csrColumnOffsets_p_p,</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                                                     <span class="keywordtype">int</span>* csrRowIndeces_u_u, <span class="keywordtype">int</span>* csrColumnOffsets_u_u,</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                                                     <span class="keywordtype">int</span>* csrRowIndeces_v_v, <span class="keywordtype">int</span>* csrColumnOffsets_v_v,</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;                                                     <span class="keywordtype">int</span>* csrRowIndeces_w_w, <span class="keywordtype">int</span>* csrColumnOffsets_w_w,                                              </div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                                                     <span class="keywordtype">double</span>* laplace_matrix)=0;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classproteus_1_1_r_a_n_s2_p__base.html#ac76453a3d1a99cd4ba3702092696bc2d">getTwoPhaseScaledMassOperator</a>(<span class="keywordtype">int</span> scale_type,</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                                               <span class="keywordtype">int</span> use_numerical_viscosity,</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                                               <span class="keywordtype">int</span> lumped,</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                                               <span class="keywordtype">double</span> *mesh_trial_ref,</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                                               <span class="keywordtype">double</span> *mesh_grad_trial_ref,</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;                                               <span class="keywordtype">double</span> *mesh_dof,</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;                                               <span class="keywordtype">int</span>* mesh_l2g,</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;                                               <span class="keywordtype">double</span>* dV_ref,</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                                               <span class="keywordtype">double</span>* p_trial_ref,</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;                                               <span class="keywordtype">double</span>* p_test_ref,</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                                               <span class="keywordtype">double</span>* vel_trial_ref,</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                                               <span class="keywordtype">double</span>* vel_test_ref,</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;                                               <span class="keywordtype">double</span>* elementDiameter,</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                                               <span class="keywordtype">double</span>* nodeDiametersArray,</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                                               <span class="keywordtype">double</span>* numerical_viscosity,</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                                               <span class="keywordtype">int</span> nElements_global,</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                                               <span class="keywordtype">double</span> useMetrics,</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                                               <span class="keywordtype">double</span> epsFact_rho,</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;                                               <span class="keywordtype">double</span> epsFact_mu,</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                                               <span class="keywordtype">double</span> <a class="code" href="_error_residual_method_8cpp.html#ae5f5d9edb66645eab31a7c8389493ce7">rho_0</a>,</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                                               <span class="keywordtype">double</span> <a class="code" href="_error_residual_method_8cpp.html#a383b07af68441ce2b4adaaf8d8cc9d90">nu_0</a>,</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                                               <span class="keywordtype">double</span> <a class="code" href="_error_residual_method_8cpp.html#a751e53c9d8dfaf696b11b86e0c1b42e9">rho_1</a>,</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                                               <span class="keywordtype">double</span> <a class="code" href="_error_residual_method_8cpp.html#ae5896ebfee35f22242123e4ae82c81d9">nu_1</a>,</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;                                               <span class="keywordtype">int</span>* p_l2g,</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                                               <span class="keywordtype">int</span>* vel_l2g,</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                                               <span class="keywordtype">double</span>* p_dof, <span class="keywordtype">double</span>* u_dof, <span class="keywordtype">double</span>* v_dof, <span class="keywordtype">double</span>* w_dof,</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                                               <span class="keyword">const</span> <span class="keywordtype">double</span> useVF,</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                                               <span class="keywordtype">double</span>* vf,</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                                               <span class="keywordtype">double</span>* <a class="code" href="namespaceproteus.html#a17bf106c5df3b1331ed2a18392384813">phi</a>,</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                                               <span class="keywordtype">int</span>* csrRowIndeces_p_p,</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                                               <span class="keywordtype">int</span>* csrColumnOffsets_p_p,</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                                               <span class="keywordtype">int</span>* csrRowIndeces_u_u,</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                                               <span class="keywordtype">int</span>* csrColumnOffsets_u_u,</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                                               <span class="keywordtype">int</span>* csrRowIndeces_v_v,</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                                               <span class="keywordtype">int</span>* csrColumnOffsets_v_v,</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                                               <span class="keywordtype">int</span>* csrRowIndeces_w_w,</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                                               <span class="keywordtype">int</span>* csrColumnOffsets_w_w,                                              </div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;                                               <span class="keywordtype">double</span>* mass_matrix)=0;</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;  };</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160; </div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;  <span class="keyword">template</span>&lt;<span class="keyword">class </span>CompKernelType,</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    <span class="keyword">class </span>CompKernelType_v,</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    <span class="keywordtype">int</span> nSpace,</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    <span class="keywordtype">int</span> nQuadraturePoints_element,</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <span class="keywordtype">int</span> nDOF_mesh_trial_element,</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    <span class="keywordtype">int</span> nDOF_trial_element,</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    <span class="keywordtype">int</span> nDOF_test_element,</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <span class="keywordtype">int</span> nDOF_v_trial_element,</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    <span class="keywordtype">int</span> nDOF_v_test_element,</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <span class="keywordtype">int</span> nQuadraturePoints_elementBoundary&gt;</div>
<div class="line"><a name="l00558"></a><span class="lineno"><a class="line" href="classproteus_1_1_r_a_n_s2_p.html">  558</a></span>&#160;    <span class="keyword">class </span><a class="code" href="classproteus_1_1_r_a_n_s2_p.html">RANS2P</a> : <span class="keyword">public</span> <a class="code" href="classproteus_1_1_r_a_n_s2_p__base.html">RANS2P_base</a></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    {</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    <span class="keyword">public</span>:</div>
<div class="line"><a name="l00561"></a><span class="lineno"><a class="line" href="classproteus_1_1_r_a_n_s2_p.html#a7b007a2b0d9961faa8f679a3db540ca3">  561</a></span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a7b007a2b0d9961faa8f679a3db540ca3">nDOF_test_X_trial_element</a>;</div>
<div class="line"><a name="l00562"></a><span class="lineno"><a class="line" href="classproteus_1_1_r_a_n_s2_p.html#a657d5d64a05158d6d19614555ce257e7">  562</a></span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a657d5d64a05158d6d19614555ce257e7">nDOF_test_X_v_trial_element</a>;</div>
<div class="line"><a name="l00563"></a><span class="lineno"><a class="line" href="classproteus_1_1_r_a_n_s2_p.html#a6f565d2a300310b20f932576bd743238">  563</a></span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a6f565d2a300310b20f932576bd743238">nDOF_v_test_X_trial_element</a>;</div>
<div class="line"><a name="l00564"></a><span class="lineno"><a class="line" href="classproteus_1_1_r_a_n_s2_p.html#a6352965aa4dc8cd7ae8cd6cb1c028c96">  564</a></span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a6352965aa4dc8cd7ae8cd6cb1c028c96">nDOF_v_test_X_v_trial_element</a>;</div>
<div class="line"><a name="l00565"></a><span class="lineno"><a class="line" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">  565</a></span>&#160;      CompKernelType <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>;</div>
<div class="line"><a name="l00566"></a><span class="lineno"><a class="line" href="classproteus_1_1_r_a_n_s2_p.html#a7a7848813d299e5d43a0c4872556a476">  566</a></span>&#160;      CompKernelType_v <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a7a7848813d299e5d43a0c4872556a476">ck_v</a>;</div>
<div class="line"><a name="l00567"></a><span class="lineno"><a class="line" href="classproteus_1_1_r_a_n_s2_p.html#a25259ea48a9bc3708796a96164a3b8de">  567</a></span>&#160;      <a class="code" href="classequivalent__polynomials_1_1_generalized_functions__mix.html">GeneralizedFunctions&lt;nSpace,1,nQuadraturePoints_element&gt;</a> <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a25259ea48a9bc3708796a96164a3b8de">gf</a>;</div>
<div class="line"><a name="l00568"></a><span class="lineno"><a class="line" href="classproteus_1_1_r_a_n_s2_p.html#aa6183d3c81313639cd5ec6c4697ccdde">  568</a></span>&#160;      <a class="code" href="classequivalent__polynomials_1_1_generalized_functions__mix.html">GeneralizedFunctions&lt;nSpace,1,nQuadraturePoints_element&gt;</a> <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#aa6183d3c81313639cd5ec6c4697ccdde">gf_s</a>;</div>
<div class="line"><a name="l00569"></a><span class="lineno"><a class="line" href="classproteus_1_1_r_a_n_s2_p.html#a855a5f37352edded7f10b9a548f906f9">  569</a></span>&#160;    <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a855a5f37352edded7f10b9a548f906f9">RANS2P</a>():</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;      <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a7b007a2b0d9961faa8f679a3db540ca3">nDOF_test_X_trial_element</a>(nDOF_test_element*nDOF_trial_element),</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;        <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a657d5d64a05158d6d19614555ce257e7">nDOF_test_X_v_trial_element</a>(nDOF_test_element*nDOF_v_trial_element),</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a6f565d2a300310b20f932576bd743238">nDOF_v_test_X_trial_element</a>(nDOF_v_test_element*nDOF_trial_element),</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;        <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a6352965aa4dc8cd7ae8cd6cb1c028c96">nDOF_v_test_X_v_trial_element</a>(nDOF_v_test_element*nDOF_v_trial_element),</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;        <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>(),</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a7a7848813d299e5d43a0c4872556a476">ck_v</a>()</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;          {<span class="comment">/*        std::cout&lt;&lt;&quot;Constructing RANS2P&lt;CompKernelTemplate&lt;&quot;</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="comment">                     &lt;&lt;0&lt;&lt;&quot;,&quot;</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;<span class="comment">                     &lt;&lt;0&lt;&lt;&quot;,&quot;</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="comment">                     &lt;&lt;0&lt;&lt;&quot;,&quot;</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="comment">                     &lt;&lt;0&lt;&lt;&quot;&gt;,&quot;*/</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;            <span class="comment">/*  &lt;&lt;nSpaceIn&lt;&lt;&quot;,&quot;</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="comment">                &lt;&lt;nQuadraturePoints_elementIn&lt;&lt;&quot;,&quot;</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="comment">                &lt;&lt;nDOF_mesh_trial_elementIn&lt;&lt;&quot;,&quot;</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="comment">                &lt;&lt;nDOF_trial_elementIn&lt;&lt;&quot;,&quot;</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="comment">                &lt;&lt;nDOF_test_elementIn&lt;&lt;&quot;,&quot;</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="comment">                &lt;&lt;nQuadraturePoints_elementBoundaryIn&lt;&lt;&quot;&gt;());&quot;*/</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;            <span class="comment">/*  &lt;&lt;std::endl&lt;&lt;std::flush; */</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;          }</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160; </div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;      <span class="keyword">inline</span></div>
<div class="line"><a name="l00591"></a><span class="lineno"><a class="line" href="classproteus_1_1_r_a_n_s2_p.html#adff72a3cebc8b98398097095827e7aa6">  591</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#adff72a3cebc8b98398097095827e7aa6">evaluateCoefficients</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> NONCONSERVATIVE_FORM,</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;                                  <span class="keyword">const</span> <span class="keywordtype">double</span> eps_rho,</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;                                  <span class="keyword">const</span> <span class="keywordtype">double</span> eps_mu,</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;                                  <span class="keyword">const</span> <span class="keywordtype">double</span> sigma,</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;                                  <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="_error_residual_method_8cpp.html#ae5f5d9edb66645eab31a7c8389493ce7">rho_0</a>,</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;                                  <span class="keywordtype">double</span> <a class="code" href="_error_residual_method_8cpp.html#a383b07af68441ce2b4adaaf8d8cc9d90">nu_0</a>,</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;                                  <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="_error_residual_method_8cpp.html#a751e53c9d8dfaf696b11b86e0c1b42e9">rho_1</a>,</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                                  <span class="keywordtype">double</span> <a class="code" href="_error_residual_method_8cpp.html#ae5896ebfee35f22242123e4ae82c81d9">nu_1</a>,</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                                  <span class="keyword">const</span> <span class="keywordtype">double</span> h_e,</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                                  <span class="keyword">const</span> <span class="keywordtype">double</span> smagorinskyConstant,</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;                                  <span class="keyword">const</span> <span class="keywordtype">int</span> turbulenceClosureModel,</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;                                  <span class="keyword">const</span> <span class="keywordtype">double</span> g[nSpace],</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;                                  <span class="keyword">const</span> <span class="keywordtype">double</span> useVF,</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;                                  <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; vf,</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;                                  <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; <a class="code" href="namespaceproteus.html#a17bf106c5df3b1331ed2a18392384813">phi</a>,</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;                                  <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[nSpace],</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;                                  <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; kappa,</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                                  <span class="keyword">const</span> <span class="keywordtype">double</span> porosity,<span class="comment">//VRANS specific</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;                                  <span class="keyword">const</span> <span class="keywordtype">double</span> phi_solid,</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;                                  <span class="keyword">const</span> <span class="keywordtype">double</span> p_old,</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;                                  <span class="keyword">const</span> <span class="keywordtype">double</span> u_old,</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;                                  <span class="keyword">const</span> <span class="keywordtype">double</span> v_old,</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;                                  <span class="keyword">const</span> <span class="keywordtype">double</span> w_old,</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                                  <span class="keyword">const</span> <span class="keywordtype">double</span> grad_p_old[nSpace],</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                                  <span class="keyword">const</span> <span class="keywordtype">double</span> grad_u_old[nSpace],</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;                                  <span class="keyword">const</span> <span class="keywordtype">double</span> grad_v_old[nSpace],</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;                                  <span class="keyword">const</span> <span class="keywordtype">double</span> grad_w_old[nSpace],</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;                                  <span class="keyword">const</span> <span class="keywordtype">int</span> use_pseudo_penalty,</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;                                  <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; p,</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                                  <span class="keyword">const</span> <span class="keywordtype">double</span> grad_p[nSpace],</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;                                  <span class="keyword">const</span> <span class="keywordtype">double</span> grad_u[nSpace],</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;                                  <span class="keyword">const</span> <span class="keywordtype">double</span> grad_v[nSpace],</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;                                  <span class="keyword">const</span> <span class="keywordtype">double</span> grad_w[nSpace],</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;                                  <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; <a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>,</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                                  <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; <a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>,</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                                  <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; <a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a>,</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;                                  <span class="keyword">const</span> <span class="keywordtype">double</span> LAG_LES,</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                                  <span class="keywordtype">double</span>&amp; eddy_viscosity,</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;                                  <span class="keywordtype">double</span>&amp; eddy_viscosity_last,</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                                  <span class="keywordtype">double</span>&amp; mom_u_acc,</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                                  <span class="keywordtype">double</span>&amp; dmom_u_acc_u,</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                                  <span class="keywordtype">double</span>&amp; mom_v_acc,</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                                  <span class="keywordtype">double</span>&amp; dmom_v_acc_v,</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                                  <span class="keywordtype">double</span>&amp; mom_w_acc,</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                                  <span class="keywordtype">double</span>&amp; dmom_w_acc_w,</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                                  <span class="keywordtype">double</span> mass_adv[nSpace],</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                                  <span class="keywordtype">double</span> dmass_adv_u[nSpace],</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                                  <span class="keywordtype">double</span> dmass_adv_v[nSpace],</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                                  <span class="keywordtype">double</span> dmass_adv_w[nSpace],</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                                  <span class="keywordtype">double</span> mom_u_adv[nSpace],</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;                                  <span class="keywordtype">double</span> dmom_u_adv_u[nSpace],</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;                                  <span class="keywordtype">double</span> dmom_u_adv_v[nSpace],</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                                  <span class="keywordtype">double</span> dmom_u_adv_w[nSpace],</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                                  <span class="keywordtype">double</span> mom_v_adv[nSpace],</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                                  <span class="keywordtype">double</span> dmom_v_adv_u[nSpace],</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                                  <span class="keywordtype">double</span> dmom_v_adv_v[nSpace],</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                                  <span class="keywordtype">double</span> dmom_v_adv_w[nSpace],</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                                  <span class="keywordtype">double</span> mom_w_adv[nSpace],</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                                  <span class="keywordtype">double</span> dmom_w_adv_u[nSpace],</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                                  <span class="keywordtype">double</span> dmom_w_adv_v[nSpace],</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                                  <span class="keywordtype">double</span> dmom_w_adv_w[nSpace],</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                                  <span class="keywordtype">double</span> mom_uu_diff_ten[nSpace],</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                                  <span class="keywordtype">double</span> mom_vv_diff_ten[nSpace],</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                                  <span class="keywordtype">double</span> mom_ww_diff_ten[nSpace],</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                                  <span class="keywordtype">double</span> mom_uv_diff_ten[1],</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;                                  <span class="keywordtype">double</span> mom_uw_diff_ten[1],</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;                                  <span class="keywordtype">double</span> mom_vu_diff_ten[1],</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;                                  <span class="keywordtype">double</span> mom_vw_diff_ten[1],</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;                                  <span class="keywordtype">double</span> mom_wu_diff_ten[1],</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;                                  <span class="keywordtype">double</span> mom_wv_diff_ten[1],</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;                                  <span class="keywordtype">double</span>&amp; mom_u_source,</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;                                  <span class="keywordtype">double</span>&amp; mom_v_source,</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;                                  <span class="keywordtype">double</span>&amp; mom_w_source,</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;                                  <span class="keywordtype">double</span>&amp; mom_u_ham,</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                                  <span class="keywordtype">double</span> dmom_u_ham_grad_p[nSpace],</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;                                  <span class="keywordtype">double</span> dmom_u_ham_grad_u[nSpace],</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;                                  <span class="keywordtype">double</span>&amp; dmom_u_ham_u,</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;                                  <span class="keywordtype">double</span>&amp; dmom_u_ham_v,</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                                  <span class="keywordtype">double</span>&amp; dmom_u_ham_w,</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;                                  <span class="keywordtype">double</span>&amp; mom_v_ham,</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;                                  <span class="keywordtype">double</span> dmom_v_ham_grad_p[nSpace],</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;                                  <span class="keywordtype">double</span> dmom_v_ham_grad_v[nSpace],</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                                  <span class="keywordtype">double</span>&amp; dmom_v_ham_u,</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;                                  <span class="keywordtype">double</span>&amp; dmom_v_ham_v,</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;                                  <span class="keywordtype">double</span>&amp; dmom_v_ham_w,</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                                  <span class="keywordtype">double</span>&amp; mom_w_ham,</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;                                  <span class="keywordtype">double</span> dmom_w_ham_grad_p[nSpace],</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;                                  <span class="keywordtype">double</span> dmom_w_ham_grad_w[nSpace],</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;                                  <span class="keywordtype">double</span>&amp; dmom_w_ham_u,</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;                                  <span class="keywordtype">double</span>&amp; dmom_w_ham_v,</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;                                  <span class="keywordtype">double</span>&amp; dmom_w_ham_w,</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;                                  <span class="keywordtype">double</span>&amp; rho,</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                                  <span class="keywordtype">double</span> forcex,</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                                  <span class="keywordtype">double</span> forcey,</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                                  <span class="keywordtype">double</span> forcez)</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;      {</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;        <span class="keywordtype">double</span> nu,mu,H_rho,ImH_rho,d_rho,H_mu,ImH_mu,d_mu,norm_n,nu_t0=0.0,nu_t1=0.0,nu_t;</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;        H_rho = (1.0-useVF)*<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a25259ea48a9bc3708796a96164a3b8de">gf</a>.H(eps_rho,<a class="code" href="namespaceproteus.html#a17bf106c5df3b1331ed2a18392384813">phi</a>) + useVF*fmin(1.0,fmax(0.0,vf));</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;        ImH_rho = (1.0-useVF)*<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a25259ea48a9bc3708796a96164a3b8de">gf</a>.ImH(eps_rho,<a class="code" href="namespaceproteus.html#a17bf106c5df3b1331ed2a18392384813">phi</a>) + useVF*(1.0-fmin(1.0,fmax(0.0,vf)));</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;        d_rho = (1.0-useVF)*<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a25259ea48a9bc3708796a96164a3b8de">gf</a>.D(eps_rho,<a class="code" href="namespaceproteus.html#a17bf106c5df3b1331ed2a18392384813">phi</a>);</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;        H_mu = (1.0-useVF)*<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a25259ea48a9bc3708796a96164a3b8de">gf</a>.H(eps_mu,<a class="code" href="namespaceproteus.html#a17bf106c5df3b1331ed2a18392384813">phi</a>) + useVF*fmin(1.0,fmax(0.0,vf));</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;        ImH_mu = (1.0-useVF)*<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a25259ea48a9bc3708796a96164a3b8de">gf</a>.ImH(eps_mu,<a class="code" href="namespaceproteus.html#a17bf106c5df3b1331ed2a18392384813">phi</a>) + useVF*(1.0-fmin(1.0,fmax(0.0,vf)));</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;        d_mu = (1.0-useVF)*<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a25259ea48a9bc3708796a96164a3b8de">gf</a>.D(eps_mu,<a class="code" href="namespaceproteus.html#a17bf106c5df3b1331ed2a18392384813">phi</a>);</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> in_fluid = (phi_solid&gt;0.0)?1:0;</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;        <span class="comment">//calculate eddy viscosity</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;        <span class="keywordflow">switch</span> (turbulenceClosureModel)</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;          {</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;            <span class="keywordtype">double</span> norm_S;</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;          <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;            {</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;              norm_S = sqrt(2.0*(grad_u[0]*grad_u[0] + grad_v[1]*grad_v[1] + grad_w[2]*grad_w[2] +</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;                                 0.5*(grad_u[1]+grad_v[0])*(grad_u[1]+grad_v[0]) +</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;                                 0.5*(grad_u[2]+grad_w[0])*(grad_u[2]+grad_w[0]) +</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;                                 0.5*(grad_v[2]+grad_w[1])*(grad_v[2]+grad_w[1])));</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;              nu_t0 = smagorinskyConstant*smagorinskyConstant*h_e*h_e*norm_S;</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;              nu_t1 = smagorinskyConstant*smagorinskyConstant*h_e*h_e*norm_S;</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;            }</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;          <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;            {</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;              <span class="keywordtype">double</span> re_0,cs_0=0.0,re_1,cs_1=0.0;</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;              norm_S = sqrt(2.0*(grad_u[0]*grad_u[0] + grad_v[1]*grad_v[1] + grad_w[2]*grad_w[2] +</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;                                 0.5*(grad_u[1]+grad_v[0])*(grad_u[1]+grad_v[0]) +</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;                                 0.5*(grad_u[2]+grad_w[0])*(grad_u[2]+grad_w[0]) +</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;                                 0.5*(grad_v[2]+grad_w[1])*(grad_v[2]+grad_w[1])));</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;              re_0 = h_e*h_e*norm_S/<a class="code" href="_error_residual_method_8cpp.html#a383b07af68441ce2b4adaaf8d8cc9d90">nu_0</a>;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;              <span class="keywordflow">if</span> (re_0 &gt; 1.0)</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;                cs_0=0.027*pow(10.0,-3.23*pow(re_0,-0.92));</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;              nu_t0 = cs_0*h_e*h_e*norm_S;</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;              re_1 = h_e*h_e*norm_S/<a class="code" href="_error_residual_method_8cpp.html#ae5896ebfee35f22242123e4ae82c81d9">nu_1</a>;</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;              <span class="keywordflow">if</span> (re_1 &gt; 1.0)</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;                cs_1=0.027*pow(10.0,-3.23*pow(re_1,-0.92));</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;              nu_t1 = cs_1*h_e*h_e*norm_S;</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;            }</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;          }</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160; </div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;        rho = <a class="code" href="_error_residual_method_8cpp.html#ae5f5d9edb66645eab31a7c8389493ce7">rho_0</a>*ImH_rho+<a class="code" href="_error_residual_method_8cpp.html#a751e53c9d8dfaf696b11b86e0c1b42e9">rho_1</a>*H_rho;</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;        nu_t= nu_t0*ImH_mu+nu_t1*H_mu;</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;        eddy_viscosity = nu_t;</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;        nu  = <a class="code" href="_error_residual_method_8cpp.html#a383b07af68441ce2b4adaaf8d8cc9d90">nu_0</a>*ImH_mu+<a class="code" href="_error_residual_method_8cpp.html#ae5896ebfee35f22242123e4ae82c81d9">nu_1</a>*H_mu;</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;        nu += (1.0-LAG_LES)*nu_t + LAG_LES*eddy_viscosity_last;</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;        mu  = <a class="code" href="_error_residual_method_8cpp.html#ae5f5d9edb66645eab31a7c8389493ce7">rho_0</a>*<a class="code" href="_error_residual_method_8cpp.html#a383b07af68441ce2b4adaaf8d8cc9d90">nu_0</a>*ImH_mu+<a class="code" href="_error_residual_method_8cpp.html#a751e53c9d8dfaf696b11b86e0c1b42e9">rho_1</a>*<a class="code" href="_error_residual_method_8cpp.html#ae5896ebfee35f22242123e4ae82c81d9">nu_1</a>*H_mu;</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;        mu += ((1.0-LAG_LES)*nu_t + LAG_LES*eddy_viscosity_last)*rho;</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;        <span class="keywordflow">if</span> (NONCONSERVATIVE_FORM &gt; 0.0)</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;          {</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;            <span class="comment">//u momentum accumulation</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;            mom_u_acc=<a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>;<span class="comment">//trick for non-conservative form</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;            dmom_u_acc_u=rho*porosity;</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160; </div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;            <span class="comment">//v momentum accumulation</span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;            mom_v_acc=<a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>;</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;            dmom_v_acc_v=rho*porosity;</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160; </div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;            <span class="comment">//w momentum accumulation</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;            mom_w_acc=<a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a>;</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;            dmom_w_acc_w=rho*porosity;</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160; </div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;            <span class="comment">//mass advective flux</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;            mass_adv[0]=porosity*<a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>;</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;            mass_adv[1]=porosity*<a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>;</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;            mass_adv[2]=porosity*<a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a>;</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160; </div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;            dmass_adv_u[0]=porosity;</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;            dmass_adv_u[1]=0.0;</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;            dmass_adv_u[2]=0.0;</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160; </div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;            dmass_adv_v[0]=0.0;</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;            dmass_adv_v[1]=porosity;</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;            dmass_adv_v[2]=0.0;</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160; </div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;            dmass_adv_w[0]=0.0;</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;            dmass_adv_w[1]=0.0;</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;            dmass_adv_w[2]=porosity;</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160; </div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;            <span class="comment">//u momentum advective flux</span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;            mom_u_adv[0]=0.0;</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;            mom_u_adv[1]=0.0;</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;            mom_u_adv[2]=0.0;</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160; </div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;            dmom_u_adv_u[0]=0.0;</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;            dmom_u_adv_u[1]=0.0;</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;            dmom_u_adv_u[2]=0.0;</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160; </div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;            dmom_u_adv_v[0]=0.0;</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;            dmom_u_adv_v[1]=0.0;</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;            dmom_u_adv_v[2]=0.0;</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160; </div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;            dmom_u_adv_w[0]=0.0;</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;            dmom_u_adv_w[1]=0.0;</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;            dmom_u_adv_w[2]=0.0;</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160; </div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;            <span class="comment">//v momentum advective_flux</span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;            mom_v_adv[0]=0.0;</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;            mom_v_adv[1]=0.0;</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;            mom_v_adv[2]=0.0;</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160; </div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;            dmom_v_adv_u[0]=0.0;</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;            dmom_v_adv_u[1]=0.0;</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;            dmom_v_adv_u[2]=0.0;</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160; </div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;            dmom_v_adv_w[0]=0.0;</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;            dmom_v_adv_w[1]=0.0;</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;            dmom_v_adv_w[2]=0.0;</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160; </div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;            dmom_v_adv_v[0]=0.0;</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;            dmom_v_adv_v[1]=0.0;</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;            dmom_v_adv_v[2]=0.0;</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160; </div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;            <span class="comment">//w momentum advective_flux</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;            mom_w_adv[0]=0.0;</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;            mom_w_adv[1]=0.0;</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;            mom_w_adv[2]=0.0;</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160; </div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;            dmom_w_adv_u[0]=0.0;</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;            dmom_w_adv_u[1]=0.0;</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;            dmom_w_adv_u[2]=0.0;</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160; </div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;            dmom_w_adv_v[0]=0.0;</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;            dmom_w_adv_v[1]=0.0;</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;            dmom_w_adv_v[2]=0.0;</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160; </div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;            dmom_w_adv_w[0]=0.0;</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;            dmom_w_adv_w[1]=0.0;</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;            dmom_w_adv_w[2]=0.0;</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160; </div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;            <span class="comment">//u momentum diffusion tensor</span></div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;            mom_uu_diff_ten[0] = 2.0*porosity*mu;</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;            mom_uu_diff_ten[1] = porosity*mu;</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;            mom_uu_diff_ten[2] = porosity*mu;</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160; </div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;            mom_uv_diff_ten[0]=porosity*mu;</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160; </div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;            mom_uw_diff_ten[0]=porosity*mu;</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160; </div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;            <span class="comment">//v momentum diffusion tensor</span></div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;            mom_vv_diff_ten[0] = porosity*mu;</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;            mom_vv_diff_ten[1] = 2.0*porosity*mu;</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;            mom_vv_diff_ten[2] = porosity*mu;</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160; </div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;            mom_vu_diff_ten[0]=porosity*mu;</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160; </div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;            mom_vw_diff_ten[0]=porosity*mu;</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160; </div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;            <span class="comment">//w momentum diffusion tensor</span></div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;            mom_ww_diff_ten[0] = porosity*mu;</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;            mom_ww_diff_ten[1] = porosity*mu;</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;            mom_ww_diff_ten[2] = 2.0*porosity*mu;</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160; </div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;            mom_wu_diff_ten[0]=porosity*mu;</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160; </div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;            mom_wv_diff_ten[0]=porosity*mu;</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160; </div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;            <span class="comment">//momentum sources</span></div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;            norm_n = sqrt(<a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[0]*<a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[0]+<a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[1]*<a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[1]+<a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[2]*<a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[2]);</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;            mom_u_source = -porosity*rho*g[0];<span class="comment">// - porosity*d_mu*sigma*kappa*n[0];</span></div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;            mom_v_source = -porosity*rho*g[1];<span class="comment">// - porosity*d_mu*sigma*kappa*n[1];</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;            mom_w_source = -porosity*rho*g[2];<span class="comment">// - porosity*d_mu*sigma*kappa*n[2];</span></div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160; </div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;            <span class="comment">//u momentum Hamiltonian (pressure)</span></div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;            mom_u_ham = porosity*grad_p[0];</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;            dmom_u_ham_grad_p[0]=porosity;</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;            dmom_u_ham_grad_p[1]=0.0;</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;            dmom_u_ham_grad_p[2]=0.0;</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160; </div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;            <span class="comment">//v momentum Hamiltonian (pressure)</span></div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;            mom_v_ham = porosity*grad_p[1];</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;            dmom_v_ham_grad_p[0]=0.0;</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;            dmom_v_ham_grad_p[1]=porosity;</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;            dmom_v_ham_grad_p[2]=0.0;</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160; </div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;            <span class="comment">//w momentum Hamiltonian (pressure)</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;            mom_w_ham = porosity*grad_p[2];</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;            dmom_w_ham_grad_p[0]=0.0;</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;            dmom_w_ham_grad_p[1]=0.0;</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;            dmom_w_ham_grad_p[2]=porosity;</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160; </div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;            <span class="comment">//u momentum Hamiltonian (advection)</span></div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;            mom_u_ham += rho*porosity*(<a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>*grad_u[0]+<a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>*grad_u[1]+<a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a>*grad_u[2]);</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;            dmom_u_ham_grad_u[0]=rho*porosity*<a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>;</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;            dmom_u_ham_grad_u[1]=rho*porosity*<a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>;</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;            dmom_u_ham_grad_u[2]=rho*porosity*<a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a>;</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;            dmom_u_ham_u =rho*porosity*grad_u[0];</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;            dmom_u_ham_v =rho*porosity*grad_u[1];</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;            dmom_u_ham_w =rho*porosity*grad_u[2];</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160; </div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;            <span class="comment">//v momentum Hamiltonian (advection)</span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;            mom_v_ham += rho*porosity*(<a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>*grad_v[0]+<a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>*grad_v[1]+<a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a>*grad_v[2]);</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;            dmom_v_ham_grad_v[0]=rho*porosity*<a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>;</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;            dmom_v_ham_grad_v[1]=rho*porosity*<a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>;</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;            dmom_v_ham_grad_v[2]=rho*porosity*<a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a>;</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;            dmom_v_ham_u =rho*porosity*grad_v[0];</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;            dmom_v_ham_v =rho*porosity*grad_v[1];</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;            dmom_v_ham_w =rho*porosity*grad_v[2];</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160; </div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;            <span class="comment">/* //w momentum Hamiltonian (advection) */</span></div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;            mom_w_ham += rho*porosity*(<a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>*grad_w[0]+<a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>*grad_w[1]+<a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a>*grad_w[2]);</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;            dmom_w_ham_grad_w[0]=rho*porosity*<a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>;</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;            dmom_w_ham_grad_w[1]=rho*porosity*<a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>;</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;            dmom_w_ham_grad_w[2]=rho*porosity*<a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a>;</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;            dmom_w_ham_u =rho*porosity*grad_w[0];</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;            dmom_w_ham_v =rho*porosity*grad_w[1];</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;            dmom_w_ham_w =rho*porosity*grad_w[2];</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160; </div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;          }</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;          {</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;            <span class="comment">//u momentum accumulation</span></div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;            mom_u_acc=porosity*<a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>;</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;            dmom_u_acc_u=porosity;</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160; </div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;            <span class="comment">//v momentum accumulation</span></div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;            mom_v_acc=porosity*<a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>;</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;            dmom_v_acc_v=porosity;</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160; </div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;            <span class="comment">//w momentum accumulation</span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;            mom_w_acc=porosity*<a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a>;</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;            dmom_w_acc_w=porosity;</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160; </div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160; </div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;            <span class="comment">//mass advective flux</span></div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;            mass_adv[0]=porosity*<a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>;</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;            mass_adv[1]=porosity*<a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>;</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;            mass_adv[2]=porosity*<a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a>;</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160; </div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;            dmass_adv_u[0]=porosity;</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;            dmass_adv_u[1]=0.0;</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;            dmass_adv_u[2]=0.0;</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160; </div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;            dmass_adv_v[0]=0.0;</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;            dmass_adv_v[1]=porosity;</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;            dmass_adv_v[2]=0.0;</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160; </div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;            dmass_adv_w[0]=0.0;</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;            dmass_adv_w[1]=0.0;</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;            dmass_adv_w[2]=porosity;</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160; </div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;            <span class="comment">//u momentum advective flux</span></div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;            mom_u_adv[0]=porosity*<a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>*<a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>;</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;            mom_u_adv[1]=porosity*<a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>*<a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>;</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;            mom_u_adv[2]=porosity*<a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>*<a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a>;</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160; </div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;            dmom_u_adv_u[0]=2.0*porosity*<a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>;</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;            dmom_u_adv_u[1]=porosity*<a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>;</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;            dmom_u_adv_u[2]=porosity*<a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a>;</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160; </div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;            dmom_u_adv_v[0]=0.0;</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;            dmom_u_adv_v[1]=porosity*<a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>;</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;            dmom_u_adv_v[2]=0.0;</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160; </div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;            dmom_u_adv_w[0]=0.0;</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;            dmom_u_adv_w[1]=0.0;</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;            dmom_u_adv_w[2]=porosity*<a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>;</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160; </div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;            <span class="comment">//v momentum advective_flux</span></div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;            mom_v_adv[0]=porosity*<a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>*<a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>;</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;            mom_v_adv[1]=porosity*<a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>*<a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>;</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;            mom_v_adv[2]=porosity*<a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>*<a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a>;</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160; </div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;            dmom_v_adv_u[0]=porosity*<a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>;</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;            dmom_v_adv_u[1]=0.0;</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;            dmom_v_adv_u[2]=0.0;</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160; </div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;            dmom_v_adv_w[0]=0.0;</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;            dmom_v_adv_w[1]=0.0;</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;            dmom_v_adv_w[2]=porosity*<a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>;</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160; </div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;            dmom_v_adv_v[0]=porosity*<a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>;</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;            dmom_v_adv_v[1]=2.0*porosity*<a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>;</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;            dmom_v_adv_v[2]=porosity*<a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a>;</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160; </div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;            <span class="comment">//w momentum advective_flux</span></div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;            mom_w_adv[0]=porosity*<a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a>*<a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>;</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;            mom_w_adv[1]=porosity*<a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a>*<a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>;</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;            mom_w_adv[2]=porosity*<a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a>*<a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a>;</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160; </div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;            dmom_w_adv_u[0]=porosity*<a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a>;</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;            dmom_w_adv_u[1]=0.0;</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;            dmom_w_adv_u[2]=0.0;</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160; </div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;            dmom_w_adv_v[0]=0.0;</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;            dmom_w_adv_v[1]=porosity*<a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a>;</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;            dmom_w_adv_v[2]=0.0;</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160; </div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;            dmom_w_adv_w[0]=porosity*<a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>;</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;            dmom_w_adv_w[1]=porosity*<a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>;</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;            dmom_w_adv_w[2]=2.0*porosity*<a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a>;</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160; </div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;            <span class="comment">//u momentum diffusion tensor</span></div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;            mom_uu_diff_ten[0] = 2.0*porosity*nu;</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;            mom_uu_diff_ten[1] = porosity*nu;</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;            mom_uu_diff_ten[2] = porosity*nu;</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160; </div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;            mom_uv_diff_ten[0]=porosity*nu;</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160; </div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;            mom_uw_diff_ten[0]=porosity*nu;</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160; </div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;            <span class="comment">//v momentum diffusion tensor</span></div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;            mom_vv_diff_ten[0] = porosity*nu;</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;            mom_vv_diff_ten[1] = 2.0*porosity*nu;</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;            mom_vv_diff_ten[2] = porosity*nu;</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160; </div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;            mom_vu_diff_ten[0]=porosity*nu;</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160; </div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;            mom_vw_diff_ten[0]=porosity*nu;</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160; </div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;            <span class="comment">//w momentum diffusion tensor</span></div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;            mom_ww_diff_ten[0] = porosity*nu;</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;            mom_ww_diff_ten[1] = porosity*nu;</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;            mom_ww_diff_ten[2] = 2.0*porosity*nu;</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160; </div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;            mom_wu_diff_ten[0]=porosity*nu;</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160; </div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;            mom_wv_diff_ten[0]=porosity*nu;</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160; </div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;            <span class="comment">//momentum sources</span></div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;            norm_n = sqrt(<a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[0]*<a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[0]+<a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[1]*<a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[1]+<a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[2]*<a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[2]);</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;            mom_u_source = -porosity*g[0];<span class="comment">// - porosity*d_mu*sigma*kappa*n[0]/(rho*(norm_n+1.0e-8));</span></div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;            mom_v_source = -porosity*g[1];<span class="comment">// - porosity*d_mu*sigma*kappa*n[1]/(rho*(norm_n+1.0e-8));</span></div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;            mom_w_source = -porosity*g[2];<span class="comment">// - porosity*d_mu*sigma*kappa*n[2]/(rho*(norm_n+1.0e-8));</span></div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160; </div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;            <span class="comment">//u momentum Hamiltonian (pressure)</span></div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;            mom_u_ham = porosity*grad_p[0]/rho;</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;            dmom_u_ham_grad_p[0]=porosity/rho;</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;            dmom_u_ham_grad_p[1]=0.0;</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;            dmom_u_ham_grad_p[2]=0.0;</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160; </div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;            <span class="comment">//v momentum Hamiltonian (pressure)</span></div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;            mom_v_ham = porosity*grad_p[1]/rho;</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;            dmom_v_ham_grad_p[0]=0.0;</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;            dmom_v_ham_grad_p[1]=porosity/rho;</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;            dmom_v_ham_grad_p[2]=0.0;</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160; </div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;            <span class="comment">//w momentum Hamiltonian (pressure)</span></div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;            mom_w_ham = porosity*grad_p[2]/rho;</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;            dmom_w_ham_grad_p[0]=0.0;</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;            dmom_w_ham_grad_p[1]=0.0;</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;            dmom_w_ham_grad_p[2]=porosity/rho;</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160; </div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;            <span class="comment">//u momentum Hamiltonian (advection</span></div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;            dmom_u_ham_grad_u[0]=0.0;</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;            dmom_u_ham_grad_u[1]=0.0;</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;            dmom_u_ham_grad_u[2]=0.0;</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;            dmom_u_ham_u =0.0;</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;            dmom_u_ham_v =0.0;</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;            dmom_u_ham_w =0.0;</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160; </div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;            <span class="comment">//v momentum Hamiltonian (advection)</span></div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;            dmom_v_ham_grad_v[0]=0.0;</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;            dmom_v_ham_grad_v[1]=0.0;</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;            dmom_v_ham_grad_v[2]=0.0;</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;            dmom_v_ham_u =0.0;</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;            dmom_v_ham_v =0.0;</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;            dmom_v_ham_w =0.0;</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160; </div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;            <span class="comment">//w momentum Hamiltonian (advection)</span></div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;            dmom_w_ham_grad_w[0]=0.0;</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;            dmom_w_ham_grad_w[1]=0.0;</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;            dmom_w_ham_grad_w[2]=0.0;</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;            dmom_w_ham_u =0.0;</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;            dmom_w_ham_v =0.0;</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;            dmom_w_ham_w =0.0;</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;          }</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;        mom_u_source -= forcex;</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;        mom_v_source -= forcey;</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;        mom_w_source -= forcez;</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;      }</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160; </div>
<div class="line"><a name="l01057"></a><span class="lineno"><a class="line" href="classproteus_1_1_r_a_n_s2_p.html#a3e0cb3084e0e32cc2355384f2e511801"> 1057</a></span>&#160;      <span class="keywordtype">int</span> <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a3e0cb3084e0e32cc2355384f2e511801">get_distance_to_ball</a>(<span class="keywordtype">int</span> n_balls,<span class="keyword">const</span> <span class="keywordtype">double</span>* ball_center, <span class="keyword">const</span> <span class="keywordtype">double</span>* ball_radius, <span class="keyword">const</span> <span class="keywordtype">double</span> x, <span class="keyword">const</span> <span class="keywordtype">double</span> y, <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="_headers_8h.html#a9d199fcfc162b9ad09d4c9426e713a74">z</a>, <span class="keywordtype">double</span>&amp; distance)</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;      {</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;          distance = 1e10;</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;          <span class="keywordtype">int</span> index = -1;</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;          <span class="keywordtype">double</span> d_ball_i;</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;n_balls; ++i)</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;          {</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;              d_ball_i = std::sqrt((ball_center[i*3+0]-x)*(ball_center[i*3+0]-x)</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;                                  +(ball_center[i*3+1]-y)*(ball_center[i*3+1]-y)</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;#ifndef <a class="code" href="_r_a_n_s2_p_8h.html#a3716a8d2d50d63c6f70019ad4c23c4ac">USE_CYLINDER_AS_PARTICLE</a></div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;                                  +(ball_center[i*3+2]-<a class="code" href="_headers_8h.html#a9d199fcfc162b9ad09d4c9426e713a74">z</a>)*(ball_center[i*3+2]-<a class="code" href="_headers_8h.html#a9d199fcfc162b9ad09d4c9426e713a74">z</a>)</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;#endif</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;                                  ) - ball_radius[i];</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;              <span class="keywordflow">if</span>(d_ball_i&lt;distance)</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;              {</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;                  distance = d_ball_i;</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;                  index = i;</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;              }</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;          }</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;          <span class="keywordflow">return</span> index;</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;      }</div>
<div class="line"><a name="l01078"></a><span class="lineno"><a class="line" href="classproteus_1_1_r_a_n_s2_p.html#a5aa363a0b10908c6c2ed472e343cf65b"> 1078</a></span>&#160;      <span class="keywordtype">void</span> <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a5aa363a0b10908c6c2ed472e343cf65b">get_distance_to_ith_ball</a>(<span class="keywordtype">int</span> n_balls,<span class="keyword">const</span> <span class="keywordtype">double</span>* ball_center, <span class="keyword">const</span> <span class="keywordtype">double</span>* ball_radius,</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;                                  <span class="keywordtype">int</span> I,</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;                                  <span class="keyword">const</span> <span class="keywordtype">double</span> x, <span class="keyword">const</span> <span class="keywordtype">double</span> y, <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="_headers_8h.html#a9d199fcfc162b9ad09d4c9426e713a74">z</a>,</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;                                  <span class="keywordtype">double</span>&amp; distance)</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;      {</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;          distance = std::sqrt((ball_center[I*3+0]-x)*(ball_center[I*3+0]-x)</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;                               + (ball_center[I*3+1]-y)*(ball_center[I*3+1]-y)</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;#ifndef <a class="code" href="_r_a_n_s2_p_8h.html#a3716a8d2d50d63c6f70019ad4c23c4ac">USE_CYLINDER_AS_PARTICLE</a></div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;                               + (ball_center[I*3+2]-<a class="code" href="_headers_8h.html#a9d199fcfc162b9ad09d4c9426e713a74">z</a>)*(ball_center[I*3+2]-<a class="code" href="_headers_8h.html#a9d199fcfc162b9ad09d4c9426e713a74">z</a>)</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;#endif</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;                            ) - ball_radius[I];</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;      }</div>
<div class="line"><a name="l01090"></a><span class="lineno"><a class="line" href="classproteus_1_1_r_a_n_s2_p.html#a90291d937f750ccb2105046f007a355b"> 1090</a></span>&#160;      <span class="keywordtype">void</span> <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a90291d937f750ccb2105046f007a355b">get_normal_to_ith_ball</a>(<span class="keywordtype">int</span> n_balls,<span class="keyword">const</span> <span class="keywordtype">double</span>* ball_center, <span class="keyword">const</span> <span class="keywordtype">double</span>* ball_radius,</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;                                  <span class="keywordtype">int</span> I,</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;                                  <span class="keyword">const</span> <span class="keywordtype">double</span> x, <span class="keyword">const</span> <span class="keywordtype">double</span> y, <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="_headers_8h.html#a9d199fcfc162b9ad09d4c9426e713a74">z</a>,</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;                                  <span class="keywordtype">double</span>&amp; nx, <span class="keywordtype">double</span>&amp; ny, <span class="keywordtype">double</span>&amp; nz)</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;      {</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;          <span class="keywordtype">double</span> distance = std::sqrt((ball_center[I*3+0]-x)*(ball_center[I*3+0]-x)</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;                                    + (ball_center[I*3+1]-y)*(ball_center[I*3+1]-y)</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;#ifndef <a class="code" href="_r_a_n_s2_p_8h.html#a3716a8d2d50d63c6f70019ad4c23c4ac">USE_CYLINDER_AS_PARTICLE</a></div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;                                    + (ball_center[I*3+2]-<a class="code" href="_headers_8h.html#a9d199fcfc162b9ad09d4c9426e713a74">z</a>)*(ball_center[I*3+2]-<a class="code" href="_headers_8h.html#a9d199fcfc162b9ad09d4c9426e713a74">z</a>)</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;#endif</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;                            );</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;          nx = (x - ball_center[I*3+0])/(distance+1e-10);</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;          ny = (y - ball_center[I*3+1])/(distance+1e-10);</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;<span class="preprocessor">#ifdef USE_CYLINDER_AS_PARTICLE</span></div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;          nz = 0.0;</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;          nz = (<a class="code" href="_headers_8h.html#a9d199fcfc162b9ad09d4c9426e713a74">z</a> - ball_center[I*3+2])/(distance+1e-10);</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;      }</div>
<div class="line"><a name="l01109"></a><span class="lineno"><a class="line" href="classproteus_1_1_r_a_n_s2_p.html#a9a5e8fe094de9df2b69c2c635a7f0d8e"> 1109</a></span>&#160;      <span class="keywordtype">void</span> <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a9a5e8fe094de9df2b69c2c635a7f0d8e">get_cross_product</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> *<a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>, <span class="keyword">const</span> <span class="keywordtype">double</span> *<a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>,<span class="keywordtype">double</span> res[3])</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;      {</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;          res[0] = <a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>[1]*<a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>[2]-<a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>[2]*<a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>[1];</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;          res[1] = <a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>[2]*<a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>[0]-<a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>[0]*<a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>[2];</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;          res[2] = <a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>[0]*<a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>[1]-<a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>[1]*<a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>[0];</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;      }</div>
<div class="line"><a name="l01115"></a><span class="lineno"><a class="line" href="classproteus_1_1_r_a_n_s2_p.html#a93a1c0a9daf704bd52b3d1416ffbe58a"> 1115</a></span>&#160;      <span class="keywordtype">void</span> <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a93a1c0a9daf704bd52b3d1416ffbe58a">get_velocity_to_ith_ball</a>(<span class="keywordtype">int</span> n_balls,<span class="keyword">const</span> <span class="keywordtype">double</span>* ball_center, <span class="keyword">const</span> <span class="keywordtype">double</span>* ball_radius,</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;                                    <span class="keyword">const</span> <span class="keywordtype">double</span>* ball_velocity, <span class="keyword">const</span> <span class="keywordtype">double</span>* ball_angular_velocity,</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;                                    <span class="keywordtype">int</span> I,</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;                                    <span class="keyword">const</span> <span class="keywordtype">double</span> x, <span class="keyword">const</span> <span class="keywordtype">double</span> y, <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="_headers_8h.html#a9d199fcfc162b9ad09d4c9426e713a74">z</a>,</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;                                    <span class="keywordtype">double</span>&amp; <a class="code" href="_headers_8h.html#ae920d60831fd60b11f1b758a12e87eff">vx</a>, <span class="keywordtype">double</span>&amp; <a class="code" href="_headers_8h.html#a9891a031d6c4d31d28333ae6e6f6b746">vy</a>, <span class="keywordtype">double</span>&amp; vz)</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;      {</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;<span class="preprocessor">#ifdef USE_CYLINDER_AS_PARTICLE</span></div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;          <span class="keywordtype">double</span> position[3]={x-ball_center[3*I + 0],y-ball_center[3*I + 1],0.0};</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;          <span class="keywordtype">double</span> position[3]={x-ball_center[3*I + 0],y-ball_center[3*I + 1],<a class="code" href="_headers_8h.html#a9d199fcfc162b9ad09d4c9426e713a74">z</a>-ball_center[3*I + 2]};</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;          <span class="keywordtype">double</span> angular_cross_position[3];</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a9a5e8fe094de9df2b69c2c635a7f0d8e">get_cross_product</a>(&amp;ball_angular_velocity[3*I + 0],position,angular_cross_position);</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;          <a class="code" href="_headers_8h.html#ae920d60831fd60b11f1b758a12e87eff">vx</a> = ball_velocity[3*I + 0] + angular_cross_position[0];</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;          <a class="code" href="_headers_8h.html#a9891a031d6c4d31d28333ae6e6f6b746">vy</a> = ball_velocity[3*I + 1] + angular_cross_position[1];</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;          vz = ball_velocity[3*I + 2] + angular_cross_position[2];</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160; </div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;      }</div>
<div class="line"><a name="l01133"></a><span class="lineno"><a class="line" href="classproteus_1_1_r_a_n_s2_p.html#a8d4e605e4a83de181253b63041a8feb6"> 1133</a></span>&#160;      <span class="keywordtype">void</span> <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a8d4e605e4a83de181253b63041a8feb6">get_acceleration_to_ith_ball</a>(<span class="keywordtype">int</span> n_balls,<span class="keyword">const</span> <span class="keywordtype">double</span>* ball_center, <span class="keyword">const</span> <span class="keywordtype">double</span>* ball_radius,</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;                                    <span class="keyword">const</span> <span class="keywordtype">double</span>* ball_velocity, <span class="keyword">const</span> <span class="keywordtype">double</span>* ball_angular_velocity,</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;                                    <span class="keyword">const</span> <span class="keywordtype">double</span>* ball_center_acceleration, <span class="keyword">const</span> <span class="keywordtype">double</span>* ball_angular_acceleration,</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;                                    <span class="keywordtype">int</span> I,</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;                                    <span class="keyword">const</span> <span class="keywordtype">double</span> x, <span class="keyword">const</span> <span class="keywordtype">double</span> y, <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="_headers_8h.html#a9d199fcfc162b9ad09d4c9426e713a74">z</a>,</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;                                    <span class="keywordtype">double</span>&amp; ax, <span class="keywordtype">double</span>&amp; ay, <span class="keywordtype">double</span>&amp; az)</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;      {</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;<span class="preprocessor">#ifdef USE_CYLINDER_AS_PARTICLE</span></div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;          <span class="keywordtype">double</span> position[3]={x-ball_center[3*I + 0],y-ball_center[3*I + 1],0.0};</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;          <span class="keywordtype">double</span> position[3]={x-ball_center[3*I + 0],y-ball_center[3*I + 1],<a class="code" href="_headers_8h.html#a9d199fcfc162b9ad09d4c9426e713a74">z</a>-ball_center[3*I + 2]};</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;          <span class="keywordtype">double</span> angular_cross_position[3];</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a9a5e8fe094de9df2b69c2c635a7f0d8e">get_cross_product</a>(&amp;ball_angular_velocity[3*I + 0],position,angular_cross_position);</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;          <span class="comment">//YY-incomplete</span></div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;      }</div>
<div class="line"><a name="l01149"></a><span class="lineno"><a class="line" href="classproteus_1_1_r_a_n_s2_p.html#ae66ab530966d1d5fbc2e170ef698a4f3"> 1149</a></span>&#160;      <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#ae66ab530966d1d5fbc2e170ef698a4f3">updateSolidParticleTerms</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> NONCONSERVATIVE_FORM,</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;                                           <span class="keywordtype">bool</span> element_owned,</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;                                           <span class="keyword">const</span> <span class="keywordtype">double</span> particle_nitsche,</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;                                           <span class="keyword">const</span> <span class="keywordtype">double</span> dV,</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;                                           <span class="keyword">const</span> <span class="keywordtype">int</span> nParticles,</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;                                           <span class="keyword">const</span> <span class="keywordtype">int</span> sd_offset,</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;                                           <span class="keywordtype">double</span>* particle_signed_distances,</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;                                           <span class="keywordtype">double</span>* particle_signed_distance_normals,</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;                                           <span class="keywordtype">double</span>* particle_velocities,</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;                                           <span class="keywordtype">double</span>* particle_centroids,</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;                                           <span class="keyword">const</span> <span class="keywordtype">int</span> use_ball_as_particle,</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;                                           <span class="keyword">const</span> <span class="keywordtype">double</span>* ball_center,</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;                                           <span class="keyword">const</span> <span class="keywordtype">double</span>* ball_radius,</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;                                           <span class="keyword">const</span> <span class="keywordtype">double</span>* ball_velocity,</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;                                           <span class="keyword">const</span> <span class="keywordtype">double</span>* ball_angular_velocity,</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;                                           <span class="keyword">const</span> <span class="keywordtype">double</span>* ball_center_acceleration,</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;                                           <span class="keyword">const</span> <span class="keywordtype">double</span>* ball_angular_acceleration,</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;                                           <span class="keyword">const</span> <span class="keywordtype">double</span>* ball_density,</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;                                           <span class="keyword">const</span> <span class="keywordtype">double</span> porosity, <span class="comment">//VRANS specific</span></div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;                                           <span class="keyword">const</span> <span class="keywordtype">double</span> penalty,</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;                                           <span class="keyword">const</span> <span class="keywordtype">double</span> alpha,</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;                                           <span class="keyword">const</span> <span class="keywordtype">double</span> beta,</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;                                           <span class="keyword">const</span> <span class="keywordtype">double</span> eps_rho,</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;                                           <span class="keyword">const</span> <span class="keywordtype">double</span> eps_mu,</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;                                           <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="_error_residual_method_8cpp.html#ae5f5d9edb66645eab31a7c8389493ce7">rho_0</a>,</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;                                           <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="_error_residual_method_8cpp.html#a383b07af68441ce2b4adaaf8d8cc9d90">nu_0</a>,</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;                                           <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="_error_residual_method_8cpp.html#a751e53c9d8dfaf696b11b86e0c1b42e9">rho_1</a>,</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;                                           <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="_error_residual_method_8cpp.html#ae5896ebfee35f22242123e4ae82c81d9">nu_1</a>,</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;                                           <span class="keyword">const</span> <span class="keywordtype">double</span> useVF,</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;                                           <span class="keyword">const</span> <span class="keywordtype">double</span> vf,</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;                                           <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="namespaceproteus.html#a17bf106c5df3b1331ed2a18392384813">phi</a>,</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;                                           <span class="keyword">const</span> <span class="keywordtype">double</span> x,</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;                                           <span class="keyword">const</span> <span class="keywordtype">double</span> y,</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;                                           <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="_headers_8h.html#a9d199fcfc162b9ad09d4c9426e713a74">z</a>,</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;                                           <span class="keyword">const</span> <span class="keywordtype">double</span> p,</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;                                           <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>,</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;                                           <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>,</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;                                           <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a>,</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;                                           <span class="keyword">const</span> <span class="keywordtype">double</span> uStar,</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;                                           <span class="keyword">const</span> <span class="keywordtype">double</span> vStar,</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;                                           <span class="keyword">const</span> <span class="keywordtype">double</span> wStar,</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;                                           <span class="keyword">const</span> <span class="keywordtype">double</span> eps_s,</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;                                           <span class="keyword">const</span> <span class="keywordtype">double</span> grad_u[nSpace],</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;                                           <span class="keyword">const</span> <span class="keywordtype">double</span> grad_v[nSpace],</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;                                           <span class="keyword">const</span> <span class="keywordtype">double</span> grad_w[nSpace],</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;                                           <span class="keywordtype">double</span> &amp;mom_u_source,</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;                                           <span class="keywordtype">double</span> &amp;mom_v_source,</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;                                           <span class="keywordtype">double</span> &amp;mom_w_source,</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;                                           <span class="keywordtype">double</span> dmom_u_source[nSpace],</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;                                           <span class="keywordtype">double</span> dmom_v_source[nSpace],</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;                                           <span class="keywordtype">double</span> dmom_w_source[nSpace],</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;                                           <span class="keywordtype">double</span> mom_u_adv[nSpace],</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;                                           <span class="keywordtype">double</span> mom_v_adv[nSpace],</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;                                           <span class="keywordtype">double</span> mom_w_adv[nSpace],</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;                                           <span class="keywordtype">double</span> dmom_u_adv_u[nSpace],</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;                                           <span class="keywordtype">double</span> dmom_v_adv_v[nSpace],</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;                                           <span class="keywordtype">double</span> dmom_w_adv_w[nSpace],</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;                                           <span class="keywordtype">double</span> &amp;mom_u_ham,</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;                                           <span class="keywordtype">double</span> dmom_u_ham_grad_u[nSpace],</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;                                           <span class="keywordtype">double</span> &amp;dmom_u_ham_u,</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;                                           <span class="keywordtype">double</span> &amp;dmom_u_ham_v,</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;                                           <span class="keywordtype">double</span> &amp;dmom_u_ham_w,</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;                                           <span class="keywordtype">double</span> &amp;mom_v_ham,</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;                                           <span class="keywordtype">double</span> dmom_v_ham_grad_v[nSpace],</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;                                           <span class="keywordtype">double</span> &amp;dmom_v_ham_u,</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;                                           <span class="keywordtype">double</span> &amp;dmom_v_ham_v,</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;                                           <span class="keywordtype">double</span> &amp;dmom_v_ham_w,</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;                                           <span class="keywordtype">double</span> &amp;mom_w_ham,</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;                                           <span class="keywordtype">double</span> dmom_w_ham_grad_w[nSpace],</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;                                           <span class="keywordtype">double</span> &amp;dmom_w_ham_u,</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;                                           <span class="keywordtype">double</span> &amp;dmom_w_ham_v,</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;                                           <span class="keywordtype">double</span> &amp;dmom_w_ham_w,</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;                                           <span class="keywordtype">double</span> &amp;mass_ham,</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;                                           <span class="keywordtype">double</span> &amp;dmass_ham_u,</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;                                           <span class="keywordtype">double</span> &amp;dmass_ham_v,</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;                                           <span class="keywordtype">double</span> &amp;dmass_ham_w,</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;                                           <span class="keywordtype">double</span> *particle_netForces,</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;                                           <span class="keywordtype">double</span> *particle_netMoments,</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;                                           <span class="keywordtype">double</span> *particle_surfaceArea,</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;                                           <span class="keyword">const</span> <span class="keywordtype">int</span> use_pseudo_penalty)</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;    {</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;      <span class="keywordtype">double</span> C, rho, mu, nu, H_mu, ImH_mu, uc, duc_du, duc_dv, duc_dw, H_s, ImH_s, D_s, phi_s, u_s, v_s, w_s;</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;        <span class="keywordtype">double</span> force_x, force_y, force_z, r_x, r_y, r_z, force_p_x, force_p_y, force_p_z, force_stress_x, force_stress_y, force_stress_z;</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;        <span class="keywordtype">double</span> phi_s_normal[3]={0.0};</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;        <span class="keywordtype">double</span> fluid_outward_normal[3];</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="group__analytical_solutions.html#gac0d5ac1b71bf68c8383846ab25b5b2fa">vel</a>[3];</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;        <span class="keywordtype">double</span> center[3];</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;        H_mu = (1.0 - useVF) * <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a25259ea48a9bc3708796a96164a3b8de">gf</a>.H(eps_mu, <a class="code" href="namespaceproteus.html#a17bf106c5df3b1331ed2a18392384813">phi</a>) + useVF * fmin(1.0, fmax(0.0, vf));</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;        ImH_mu = (1.0 - useVF) * <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a25259ea48a9bc3708796a96164a3b8de">gf</a>.ImH(eps_mu, <a class="code" href="namespaceproteus.html#a17bf106c5df3b1331ed2a18392384813">phi</a>) + useVF * (1.0-fmin(1.0, fmax(0.0, vf)));</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;        nu = <a class="code" href="_error_residual_method_8cpp.html#a383b07af68441ce2b4adaaf8d8cc9d90">nu_0</a> * ImH_mu + <a class="code" href="_error_residual_method_8cpp.html#ae5896ebfee35f22242123e4ae82c81d9">nu_1</a> * H_mu;</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;        rho = <a class="code" href="_error_residual_method_8cpp.html#ae5f5d9edb66645eab31a7c8389493ce7">rho_0</a> * ImH_mu + <a class="code" href="_error_residual_method_8cpp.html#a751e53c9d8dfaf696b11b86e0c1b42e9">rho_1</a> * H_mu;</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;        mu = <a class="code" href="_error_residual_method_8cpp.html#ae5f5d9edb66645eab31a7c8389493ce7">rho_0</a> * <a class="code" href="_error_residual_method_8cpp.html#a383b07af68441ce2b4adaaf8d8cc9d90">nu_0</a> * ImH_mu + <a class="code" href="_error_residual_method_8cpp.html#a751e53c9d8dfaf696b11b86e0c1b42e9">rho_1</a> * <a class="code" href="_error_residual_method_8cpp.html#ae5896ebfee35f22242123e4ae82c81d9">nu_1</a> * H_mu;</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;        C = 0.0;</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nParticles; i++)</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;          {</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;            <span class="keywordflow">if</span>(use_ball_as_particle==1)</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;              {</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a5aa363a0b10908c6c2ed472e343cf65b">get_distance_to_ith_ball</a>(nParticles,ball_center,ball_radius,i,x,y,<a class="code" href="_headers_8h.html#a9d199fcfc162b9ad09d4c9426e713a74">z</a>,phi_s);</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a90291d937f750ccb2105046f007a355b">get_normal_to_ith_ball</a>(nParticles,ball_center,ball_radius,i,x,y,<a class="code" href="_headers_8h.html#a9d199fcfc162b9ad09d4c9426e713a74">z</a>,phi_s_normal[0],phi_s_normal[1],phi_s_normal[2]);</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a93a1c0a9daf704bd52b3d1416ffbe58a">get_velocity_to_ith_ball</a>(nParticles,ball_center,ball_radius,</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;                                         ball_velocity,ball_angular_velocity,</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;                                         i,x,y,<a class="code" href="_headers_8h.html#a9d199fcfc162b9ad09d4c9426e713a74">z</a>,</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;                                         <a class="code" href="group__analytical_solutions.html#gac0d5ac1b71bf68c8383846ab25b5b2fa">vel</a>[0],<a class="code" href="group__analytical_solutions.html#gac0d5ac1b71bf68c8383846ab25b5b2fa">vel</a>[1],<a class="code" href="group__analytical_solutions.html#gac0d5ac1b71bf68c8383846ab25b5b2fa">vel</a>[2]);</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;                center[0] = ball_center[3*i+0];</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;                center[1] = ball_center[3*i+1];</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;                center[2] = ball_center[3*i+2];</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;            }</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;              {</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;                phi_s = particle_signed_distances[i * sd_offset];</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;                phi_s_normal[0] = particle_signed_distance_normals[i * sd_offset * 3 + 0];</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;                phi_s_normal[1] = particle_signed_distance_normals[i * sd_offset * 3 + 1];</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;                phi_s_normal[2] = particle_signed_distance_normals[i * sd_offset * 3 + 2];</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;                <a class="code" href="group__analytical_solutions.html#gac0d5ac1b71bf68c8383846ab25b5b2fa">vel</a>[0] = particle_velocities[i * sd_offset * 3 + 0];</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;                <a class="code" href="group__analytical_solutions.html#gac0d5ac1b71bf68c8383846ab25b5b2fa">vel</a>[1] = particle_velocities[i * sd_offset * 3 + 1];</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;                <a class="code" href="group__analytical_solutions.html#gac0d5ac1b71bf68c8383846ab25b5b2fa">vel</a>[2] = particle_velocities[i * sd_offset * 3 + 2];</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;                center[0] = particle_centroids[3*i+0];</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;                center[1] = particle_centroids[3*i+1];</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;                center[2] = particle_centroids[3*i+2];</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;            }</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;            fluid_outward_normal[0] = -phi_s_normal[0];</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;            fluid_outward_normal[1] = -phi_s_normal[1];</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;            fluid_outward_normal[2] = -phi_s_normal[2];</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;            u_s = <a class="code" href="group__analytical_solutions.html#gac0d5ac1b71bf68c8383846ab25b5b2fa">vel</a>[0];</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;            v_s = <a class="code" href="group__analytical_solutions.html#gac0d5ac1b71bf68c8383846ab25b5b2fa">vel</a>[1];</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;            w_s = <a class="code" href="group__analytical_solutions.html#gac0d5ac1b71bf68c8383846ab25b5b2fa">vel</a>[2];</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;            H_s = <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#aa6183d3c81313639cd5ec6c4697ccdde">gf_s</a>.H(eps_s, phi_s);</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;            ImH_s = <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#aa6183d3c81313639cd5ec6c4697ccdde">gf_s</a>.ImH(eps_s, phi_s);</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;            D_s = <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#aa6183d3c81313639cd5ec6c4697ccdde">gf_s</a>.D(eps_s, phi_s);</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;            <span class="keywordtype">double</span> rel_vel_norm = sqrt((uStar - u_s) * (uStar - u_s) +</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;                                       (vStar - v_s) * (vStar - v_s) +</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;                                       (wStar - w_s) * (wStar - w_s));</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160; </div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;            <span class="keywordtype">double</span> C_surf = (phi_s &gt; 0.0) ? 0.0 : nu * penalty;</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;            <span class="keywordtype">double</span> C_vol = (phi_s &gt; 0.0) ? 0.0 : (alpha + beta * rel_vel_norm);</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160; </div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;            C = (D_s * C_surf + ImH_s * C_vol);</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;            <span class="comment">//            force_x = dV * D_s * (p * phi_s_normal[0] - porosity * mu * (phi_s_normal[0] * grad_u[0] + phi_s_normal[1] * grad_u[1]) + C_surf * (u - u_s) * rho) +</span></div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;            <span class="comment">//              dV * ImH_s * C_vol * (u - u_s) * rho;</span></div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;            <span class="comment">//            force_y = dV * D_s * (p * phi_s_normal[1] - porosity * mu * (phi_s_normal[0] * grad_v[0] + phi_s_normal[1] * grad_v[1]) + C_surf * (v - v_s) * rho) +</span></div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;            <span class="comment">//              dV * ImH_s * C_vol * (v - v_s) * rho;</span></div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;<span class="comment">//            force_x = dV*D_s*(p*fluid_outward_normal[0] - porosity*mu*(fluid_outward_normal[0]*grad_u[0] + fluid_outward_normal[1]*grad_u[1]) + C_surf*rel_vel_norm*(u-u_s)*rho) + dV*ImH_s*C_vol*(u-u_s)*rho;</span></div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;<span class="comment">//            force_y = dV*D_s*(p*fluid_outward_normal[1] - porosity*mu*(fluid_outward_normal[0]*grad_v[0] + fluid_outward_normal[1]*grad_v[1]) + C_surf*rel_vel_norm*(v-v_s)*rho) + dV*ImH_s*C_vol*(v-v_s)*rho;</span></div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;<span class="comment">//            force_x = dV * D_s * (p * fluid_outward_normal[0]</span></div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;<span class="comment">//                                  -mu * (fluid_outward_normal[0] * 2* grad_u[0] + fluid_outward_normal[1] * (grad_u[1]+grad_v[0]))</span></div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;<span class="comment">//                                  );</span></div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;<span class="comment">//            force_y = dV * D_s * (p * fluid_outward_normal[1]</span></div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;<span class="comment">//                                  -mu * (fluid_outward_normal[0] * (grad_u[1]+grad_v[0]) + fluid_outward_normal[1] * 2* grad_v[1])</span></div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;<span class="comment">//                                  );</span></div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;            force_p_x = dV * D_s * p * fluid_outward_normal[0];</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;            force_stress_x = dV * D_s * (-mu) * (fluid_outward_normal[0] * 2* grad_u[0] </div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;                                                +fluid_outward_normal[1] * (grad_v[0]+grad_u[1])</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;                                                +fluid_outward_normal[2] * (grad_w[0]+grad_u[2]));</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;            force_p_y = dV * D_s * p * fluid_outward_normal[1];</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;            force_stress_y = dV * D_s * (-mu) * (fluid_outward_normal[0] * (grad_u[1]+grad_v[0]) </div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;                                                +fluid_outward_normal[1] * 2* grad_v[1]</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;                                                +fluid_outward_normal[2] * (grad_w[1]+grad_v[2]));</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;            force_p_z = dV * D_s * p * fluid_outward_normal[2];</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;            force_stress_z = dV * D_s * (-mu) * (fluid_outward_normal[0] * (grad_u[2]+grad_w[0]) </div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;                                                +fluid_outward_normal[1] * (grad_v[2]+grad_w[1])</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;                                                +fluid_outward_normal[1] * 2* grad_w[2]);</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160; </div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;            force_x = force_p_x + force_stress_x;</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;            force_y = force_p_y + force_stress_y;</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;            force_z = force_p_z + force_stress_z;</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;            <span class="comment">//always 3D for particle centroids</span></div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;            r_x = x - center[0];</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;            r_y = y - center[1];</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;            r_z = <a class="code" href="_headers_8h.html#a9d199fcfc162b9ad09d4c9426e713a74">z</a> - center[2];</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160; </div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;            <span class="keywordflow">if</span> (element_owned)</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;            {</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;                particle_surfaceArea[i] += dV * D_s;</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;                particle_netForces[i * 3 + 0] += force_x;</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;                particle_netForces[i * 3 + 1] += force_y;</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;                particle_netForces[i * 3 + 2] += force_z;</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;                particle_netForces[(i+  nParticles)*3+0]+= force_stress_x;</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;                particle_netForces[(i+2*nParticles)*3+0]+= force_p_x;</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;                particle_netForces[(i+  nParticles)*3+1]+= force_stress_y;</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;                particle_netForces[(i+2*nParticles)*3+1]+= force_p_y;</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;                particle_netForces[(i+  nParticles)*3+2]+= force_stress_z;</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;                particle_netForces[(i+2*nParticles)*3+2]+= force_p_z;</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;                particle_netMoments[i*3+0] += (r_y*force_z - r_z*force_y);</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;                particle_netMoments[i*3+1] += (r_z*force_x - r_x*force_z);</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;                particle_netMoments[i*3+2] += (r_x*force_y - r_y*force_x);</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;              }</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160; </div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;            <span class="comment">// These should be done inside to make sure the correct velocity of different particles are used</span></div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;            <span class="comment">//(1)</span></div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;            mom_u_source += C * (<a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a> - u_s);</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;            mom_v_source += C * (<a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a> - v_s);</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;            mom_w_source += C * (<a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a> - w_s);</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160; </div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;            dmom_u_source[0] += C;</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;            dmom_v_source[1] += C;</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;            dmom_w_source[2] += C;</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160; </div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;            <span class="keywordflow">if</span> (NONCONSERVATIVE_FORM &gt; 0.0)</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;            {</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;                <span class="comment">//(2)</span></div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;                mom_u_ham -= D_s * porosity * nu * (fluid_outward_normal[0] * grad_u[0] + fluid_outward_normal[1] * grad_u[1] + fluid_outward_normal[2]*grad_u[2]);</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;                dmom_u_ham_grad_u[0] -= D_s * porosity * nu * fluid_outward_normal[0];</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;                dmom_u_ham_grad_u[1] -= D_s * porosity * nu * fluid_outward_normal[1];</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;                dmom_u_ham_grad_u[2] -= D_s * porosity * nu * fluid_outward_normal[2];</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160; </div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;                mom_v_ham -= D_s * porosity * nu * (fluid_outward_normal[0] * grad_v[0] + fluid_outward_normal[1] * grad_v[1] + fluid_outward_normal[2]*grad_v[2]);</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;                dmom_v_ham_grad_v[0] -= D_s * porosity * nu * fluid_outward_normal[0];</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;                dmom_v_ham_grad_v[1] -= D_s * porosity * nu * fluid_outward_normal[1];</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;                dmom_v_ham_grad_v[2] -= D_s * porosity * nu * fluid_outward_normal[2];</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160; </div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;                mom_w_ham -= D_s * porosity * nu * (fluid_outward_normal[0] * grad_w[0] + fluid_outward_normal[1] * grad_w[1] + fluid_outward_normal[2]*grad_w[2]);</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;                dmom_w_ham_grad_w[0] -= D_s * porosity * nu * fluid_outward_normal[0];</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;                dmom_w_ham_grad_w[1] -= D_s * porosity * nu * fluid_outward_normal[1];</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;                dmom_w_ham_grad_w[2] -= D_s * porosity * nu * fluid_outward_normal[2];</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160; </div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;                <span class="comment">//(3)</span></div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;                mom_u_adv[0] += D_s * porosity * nu * fluid_outward_normal[0] * (<a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a> - u_s);</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;                mom_u_adv[1] += D_s * porosity * nu * fluid_outward_normal[1] * (<a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a> - u_s);</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;                mom_u_adv[2] += D_s * porosity * nu * fluid_outward_normal[2] * (<a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a> - u_s);</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;                dmom_u_adv_u[0] += D_s * porosity * nu * fluid_outward_normal[0];</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;                dmom_u_adv_u[1] += D_s * porosity * nu * fluid_outward_normal[1];</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;                dmom_u_adv_u[2] += D_s * porosity * nu * fluid_outward_normal[2];</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160; </div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;                mom_v_adv[0] += D_s * porosity * nu * fluid_outward_normal[0] * (<a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a> - v_s);</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;                mom_v_adv[1] += D_s * porosity * nu * fluid_outward_normal[1] * (<a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a> - v_s);</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;                mom_v_adv[2] += D_s * porosity * nu * fluid_outward_normal[2] * (<a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a> - v_s);</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;                dmom_v_adv_v[0] += D_s * porosity * nu * fluid_outward_normal[0];</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;                dmom_v_adv_v[1] += D_s * porosity * nu * fluid_outward_normal[1];</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;                dmom_v_adv_v[2] += D_s * porosity * nu * fluid_outward_normal[2];</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160; </div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;                mom_w_adv[0] += D_s * porosity * nu * fluid_outward_normal[0] * (<a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a> - w_s);</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;                mom_w_adv[1] += D_s * porosity * nu * fluid_outward_normal[1] * (<a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a> - w_s);</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;                mom_w_adv[2] += D_s * porosity * nu * fluid_outward_normal[2] * (<a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a> - w_s);</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;                dmom_w_adv_w[0] += D_s * porosity * nu * fluid_outward_normal[0];</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;                dmom_w_adv_w[1] += D_s * porosity * nu * fluid_outward_normal[1];</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;                dmom_w_adv_w[2] += D_s * porosity * nu * fluid_outward_normal[2];</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;            }</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;            {</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;                <span class="comment">//(2)</span></div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;                mom_u_ham -= D_s * porosity * nu/rho * (fluid_outward_normal[0] * grad_u[0] + fluid_outward_normal[1] * grad_u[1] + fluid_outward_normal[2]*grad_u[2]);</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;                dmom_u_ham_grad_u[0] -= D_s * porosity * nu/rho * fluid_outward_normal[0];</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;                dmom_u_ham_grad_u[1] -= D_s * porosity * nu/rho * fluid_outward_normal[1];</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;                dmom_u_ham_grad_u[2] -= D_s * porosity * nu/rho * fluid_outward_normal[2];</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160; </div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;                mom_v_ham -= D_s * porosity * nu/rho * (fluid_outward_normal[0] * grad_v[0] + fluid_outward_normal[1] * grad_v[1] + fluid_outward_normal[2]*grad_v[2]);</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;                dmom_v_ham_grad_v[0] -= D_s * porosity * nu/rho * fluid_outward_normal[0];</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;                dmom_v_ham_grad_v[1] -= D_s * porosity * nu/rho * fluid_outward_normal[1];</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;                dmom_v_ham_grad_v[2] -= D_s * porosity * nu/rho * fluid_outward_normal[2];</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160; </div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160; </div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;                mom_w_ham -= D_s * porosity * nu/rho * (fluid_outward_normal[0] * grad_w[0] + fluid_outward_normal[1] * grad_w[1] + fluid_outward_normal[2]*grad_w[2]);</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;                dmom_w_ham_grad_w[0] -= D_s * porosity * nu/rho * fluid_outward_normal[0];</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;                dmom_w_ham_grad_w[1] -= D_s * porosity * nu/rho * fluid_outward_normal[1];</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;                dmom_w_ham_grad_w[2] -= D_s * porosity * nu/rho * fluid_outward_normal[2];</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;                <span class="comment">//(3)</span></div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;                mom_u_adv[0] += D_s * porosity * nu/rho * fluid_outward_normal[0] * (<a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a> - u_s);</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;                mom_u_adv[1] += D_s * porosity * nu/rho * fluid_outward_normal[1] * (<a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a> - u_s);</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;                mom_u_adv[2] += D_s * porosity * nu/rho * fluid_outward_normal[2] * (<a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a> - u_s);</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;                dmom_u_adv_u[0] += D_s * porosity * nu/rho * fluid_outward_normal[0];</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;                dmom_u_adv_u[1] += D_s * porosity * nu/rho * fluid_outward_normal[1];</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;                dmom_u_adv_u[2] += D_s * porosity * nu/rho * fluid_outward_normal[2];</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160; </div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;                mom_v_adv[0] += D_s * porosity * nu/rho * fluid_outward_normal[0] * (<a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a> - v_s);</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;                mom_v_adv[1] += D_s * porosity * nu/rho * fluid_outward_normal[1] * (<a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a> - v_s);</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;                mom_v_adv[2] += D_s * porosity * nu/rho * fluid_outward_normal[2] * (<a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a> - v_s);</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;                dmom_v_adv_v[0] += D_s * porosity * nu/rho * fluid_outward_normal[0];</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;                dmom_v_adv_v[1] += D_s * porosity * nu/rho * fluid_outward_normal[1];</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;                dmom_v_adv_v[2] += D_s * porosity * nu/rho * fluid_outward_normal[2];</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160; </div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;                mom_w_adv[0] += D_s * porosity * nu/rho * fluid_outward_normal[0] * (<a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a> - w_s);</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;                mom_w_adv[1] += D_s * porosity * nu/rho * fluid_outward_normal[1] * (<a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a> - w_s);</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;                mom_w_adv[2] += D_s * porosity * nu/rho * fluid_outward_normal[2] * (<a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a> - w_s);</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;                dmom_w_adv_w[0] += D_s * porosity * nu/rho * fluid_outward_normal[0];</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;                dmom_w_adv_w[1] += D_s * porosity * nu/rho * fluid_outward_normal[1];</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;                dmom_w_adv_w[2] += D_s * porosity * nu/rho * fluid_outward_normal[2];</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;                <span class="comment">//(4)</span></div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;<span class="comment">//                mom_u_ham +=  D_s * porosity * (fluid_outward_normal[0] * u + fluid_outward_normal[1] * v)*u;</span></div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;<span class="comment">//                mom_v_ham +=  D_s * porosity * (fluid_outward_normal[0] * u + fluid_outward_normal[1] * v)*v;</span></div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;<span class="comment">//                dmom_u_ham_u += D_s * porosity * fluid_outward_normal[0] * u * 2.0;</span></div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;<span class="comment">//                dmom_u_ham_v += D_s * porosity * fluid_outward_normal[1] * u;</span></div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;<span class="comment">//                dmom_v_ham_u += D_s * porosity * fluid_outward_normal[0] * v;</span></div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;<span class="comment">//                dmom_v_ham_v += D_s * porosity * fluid_outward_normal[1] * v * 2.0;</span></div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160; </div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;            }</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;            <span class="comment">//(6)</span></div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;<span class="comment">//            mass_ham += D_s * porosity * (fluid_outward_normal[0] * u + fluid_outward_normal[1] * v);</span></div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;<span class="comment">//            dmass_ham_u += D_s * porosity * fluid_outward_normal[0];</span></div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;<span class="comment">//            dmass_ham_v += D_s * porosity * fluid_outward_normal[1];</span></div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;            <span class="comment">//(7)</span></div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;<span class="comment">//            mass_ham += C_surf * D_s * porosity * (fluid_outward_normal[0] * (u - u_s) + fluid_outward_normal[1] * (v - v_s));</span></div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;<span class="comment">//            dmass_ham_u += C_surf * D_s * porosity * fluid_outward_normal[0];</span></div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;<span class="comment">//            dmass_ham_v += C_surf * D_s * porosity * fluid_outward_normal[1];</span></div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;        }</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;    }</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;      <span class="comment">//VRANS specific</span></div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;      <span class="keyword">inline</span></div>
<div class="line"><a name="l01446"></a><span class="lineno"><a class="line" href="classproteus_1_1_r_a_n_s2_p.html#ad2e43c8a8d5e8cbaf4434992e9bf9a7d"> 1446</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#ad2e43c8a8d5e8cbaf4434992e9bf9a7d">updateDarcyForchheimerTerms_Ergun</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> NONCONSERVATIVE_FORM,</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;                                               <span class="comment">/* const double linearDragFactor, */</span></div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;                                               <span class="comment">/* const double nonlinearDragFactor, */</span></div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;                                               <span class="comment">/* const double porosity, */</span></div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;                                               <span class="comment">/* const double meanGrainSize, */</span></div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;                                               <span class="keyword">const</span> <span class="keywordtype">double</span> alpha,</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;                                               <span class="keyword">const</span> <span class="keywordtype">double</span> beta,</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;                                               <span class="keyword">const</span> <span class="keywordtype">double</span> eps_rho,</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;                                               <span class="keyword">const</span> <span class="keywordtype">double</span> eps_mu,</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;                                               <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="_error_residual_method_8cpp.html#ae5f5d9edb66645eab31a7c8389493ce7">rho_0</a>,</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;                                               <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="_error_residual_method_8cpp.html#a383b07af68441ce2b4adaaf8d8cc9d90">nu_0</a>,</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;                                               <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="_error_residual_method_8cpp.html#a751e53c9d8dfaf696b11b86e0c1b42e9">rho_1</a>,</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;                                               <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="_error_residual_method_8cpp.html#ae5896ebfee35f22242123e4ae82c81d9">nu_1</a>,</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;                                               <span class="keyword">const</span> <span class="keywordtype">double</span> useVF,</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;                                               <span class="keyword">const</span> <span class="keywordtype">double</span> vf,</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;                                               <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="namespaceproteus.html#a17bf106c5df3b1331ed2a18392384813">phi</a>,</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;                                               <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>,</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;                                               <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>,</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;                                               <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a>,</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;                                               <span class="keyword">const</span> <span class="keywordtype">double</span> uStar,</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;                                               <span class="keyword">const</span> <span class="keywordtype">double</span> vStar,</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;                                               <span class="keyword">const</span> <span class="keywordtype">double</span> wStar,</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;                                               <span class="keyword">const</span> <span class="keywordtype">double</span> eps_s,</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;                                               <span class="keyword">const</span> <span class="keywordtype">double</span> phi_s,</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;                                               <span class="keyword">const</span> <span class="keywordtype">double</span> u_s,</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;                                               <span class="keyword">const</span> <span class="keywordtype">double</span> v_s,</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;                                               <span class="keyword">const</span> <span class="keywordtype">double</span> w_s,</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;                                               <span class="keywordtype">double</span>&amp; mom_u_source,</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;                                               <span class="keywordtype">double</span>&amp; mom_v_source,</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;                                               <span class="keywordtype">double</span>&amp; mom_w_source,</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;                                               <span class="keywordtype">double</span> dmom_u_source[nSpace],</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;                                               <span class="keywordtype">double</span> dmom_v_source[nSpace],</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;                                               <span class="keywordtype">double</span> dmom_w_source[nSpace])</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;      {</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;        <span class="keywordtype">double</span> rho,mu,nu,H_mu,ImH_mu, uc,duc_du,duc_dv,duc_dw,viscosity,H_s;</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;        H_mu = (1.0-useVF)*<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a25259ea48a9bc3708796a96164a3b8de">gf</a>.H(eps_mu,<a class="code" href="namespaceproteus.html#a17bf106c5df3b1331ed2a18392384813">phi</a>)+useVF*fmin(1.0,fmax(0.0,vf));</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;        ImH_mu = (1.0-useVF)*<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a25259ea48a9bc3708796a96164a3b8de">gf</a>.ImH(eps_mu,<a class="code" href="namespaceproteus.html#a17bf106c5df3b1331ed2a18392384813">phi</a>)+useVF*(1.0-fmin(1.0,fmax(0.0,vf)));</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;        nu  = <a class="code" href="_error_residual_method_8cpp.html#a383b07af68441ce2b4adaaf8d8cc9d90">nu_0</a>*ImH_mu+<a class="code" href="_error_residual_method_8cpp.html#ae5896ebfee35f22242123e4ae82c81d9">nu_1</a>*H_mu;</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;        rho  = <a class="code" href="_error_residual_method_8cpp.html#ae5f5d9edb66645eab31a7c8389493ce7">rho_0</a>*ImH_mu+<a class="code" href="_error_residual_method_8cpp.html#a751e53c9d8dfaf696b11b86e0c1b42e9">rho_1</a>*H_mu;</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;        mu  = <a class="code" href="_error_residual_method_8cpp.html#ae5f5d9edb66645eab31a7c8389493ce7">rho_0</a>*<a class="code" href="_error_residual_method_8cpp.html#a383b07af68441ce2b4adaaf8d8cc9d90">nu_0</a>*ImH_mu+<a class="code" href="_error_residual_method_8cpp.html#a751e53c9d8dfaf696b11b86e0c1b42e9">rho_1</a>*<a class="code" href="_error_residual_method_8cpp.html#ae5896ebfee35f22242123e4ae82c81d9">nu_1</a>*H_mu;</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;        <span class="keywordflow">if</span> (NONCONSERVATIVE_FORM &gt; 0.0)</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;          {</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;            viscosity = mu;</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;          }</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;          {</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;            viscosity = nu;</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;          }</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;        <span class="keywordtype">double</span> x = fmax(0.0, fmin( 1.0, 0.5+phi_s/(2.0*eps_s)));<span class="comment">//0 at phi_s = -eps, 1 at phi_s=eps</span></div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160; </div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;        <span class="comment">// Relaxation function, Jacobsen et al. 2011, Mayer et al 1998</span></div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;        H_s = (exp(pow(x,3.5)) - 1.)/ (exp(1.) - 1.);</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160; </div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;        <span class="comment">//implicit</span></div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;        <span class="comment">/* uc = sqrt(u*u+v*v*+w*w);  */</span></div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;        <span class="comment">/* duc_du = u/(uc+1.0e-12); */</span></div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;        <span class="comment">/* duc_dv = v/(uc+1.0e-12); */</span></div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;        <span class="comment">/* duc_dw = w/(uc+1.0e-12); */</span></div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;        <span class="comment">//semi-implicit quadratic term</span></div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;        uc = sqrt(uStar*uStar+vStar*vStar*+wStar*wStar);</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;        duc_du = 0.0;</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;        duc_dv = 0.0;</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;        duc_dw = 0.0;</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160; </div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;        mom_u_source += H_s*viscosity*(alpha + beta*uc)*(<a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>-u_s);</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;        mom_v_source += H_s*viscosity*(alpha + beta*uc)*(<a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>-v_s);</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;        mom_w_source += H_s*viscosity*(alpha + beta*uc)*(<a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a>-w_s);</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160; </div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;        dmom_u_source[0] = H_s*viscosity*(alpha + beta*uc + beta*duc_du*(<a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>-u_s));</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;        dmom_u_source[1] = H_s*viscosity*beta*duc_dv*(<a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>-u_s);</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;        dmom_u_source[2] = H_s*viscosity*beta*duc_dw*(<a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>-u_s);</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160; </div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;        dmom_v_source[0] = H_s*viscosity*beta*duc_du*(<a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>-v_s);</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;        dmom_v_source[1] = H_s*viscosity*(alpha + beta*uc + beta*duc_dv*(<a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>-v_s));</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;        dmom_v_source[2] = H_s*viscosity*beta*duc_dw*(<a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>-v_s);</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160; </div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;        dmom_w_source[0] = H_s*viscosity*beta*duc_du*(<a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a>-w_s);</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;        dmom_w_source[1] = H_s*viscosity*beta*duc_dv*(<a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a>-w_s);</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;        dmom_w_source[2] = H_s*viscosity*(alpha + beta*uc + beta*duc_dw*(<a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a>-w_s));</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;      }</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160; </div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;      <span class="keyword">inline</span></div>
<div class="line"><a name="l01528"></a><span class="lineno"><a class="line" href="classproteus_1_1_r_a_n_s2_p.html#aab46065ecbde76bd2d9ef320ad287b76"> 1528</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#aab46065ecbde76bd2d9ef320ad287b76">updateTurbulenceClosure</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> NONCONSERVATIVE_FORM,</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;                                     <span class="keyword">const</span> <span class="keywordtype">int</span> turbulenceClosureModel,</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;                                     <span class="keyword">const</span> <span class="keywordtype">double</span> eps_rho,</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;                                     <span class="keyword">const</span> <span class="keywordtype">double</span> eps_mu,</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;                                     <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="_error_residual_method_8cpp.html#ae5f5d9edb66645eab31a7c8389493ce7">rho_0</a>,</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;                                     <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="_error_residual_method_8cpp.html#a383b07af68441ce2b4adaaf8d8cc9d90">nu_0</a>,</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;                                     <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="_error_residual_method_8cpp.html#a751e53c9d8dfaf696b11b86e0c1b42e9">rho_1</a>,</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;                                     <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="_error_residual_method_8cpp.html#ae5896ebfee35f22242123e4ae82c81d9">nu_1</a>,</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;                                     <span class="keyword">const</span> <span class="keywordtype">double</span> useVF,</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;                                     <span class="keyword">const</span> <span class="keywordtype">double</span> vf,</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;                                     <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="namespaceproteus.html#a17bf106c5df3b1331ed2a18392384813">phi</a>,</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;                                     <span class="keyword">const</span> <span class="keywordtype">double</span> porosity,</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;                                     <span class="keyword">const</span> <span class="keywordtype">double</span> eddy_visc_coef_0,</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;                                     <span class="keyword">const</span> <span class="keywordtype">double</span> turb_var_0, <span class="comment">//k for k-eps or k-omega</span></div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;                                     <span class="keyword">const</span> <span class="keywordtype">double</span> turb_var_1, <span class="comment">//epsilon for k-epsilon, omega for k-omega</span></div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;                                     <span class="keyword">const</span> <span class="keywordtype">double</span> turb_grad_0[nSpace],<span class="comment">//grad k for k-eps,k-omega</span></div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;                                     <span class="keywordtype">double</span>&amp; eddy_viscosity,</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;                                     <span class="keywordtype">double</span> mom_uu_diff_ten[nSpace],</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;                                     <span class="keywordtype">double</span> mom_vv_diff_ten[nSpace],</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;                                     <span class="keywordtype">double</span> mom_ww_diff_ten[nSpace],</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;                                     <span class="keywordtype">double</span> mom_uv_diff_ten[1],</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;                                     <span class="keywordtype">double</span> mom_uw_diff_ten[1],</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;                                     <span class="keywordtype">double</span> mom_vu_diff_ten[1],</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;                                     <span class="keywordtype">double</span> mom_vw_diff_ten[1],</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;                                     <span class="keywordtype">double</span> mom_wu_diff_ten[1],</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;                                     <span class="keywordtype">double</span> mom_wv_diff_ten[1],</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;                                     <span class="keywordtype">double</span>&amp; mom_u_source,</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;                                     <span class="keywordtype">double</span>&amp; mom_v_source,</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;                                     <span class="keywordtype">double</span>&amp; mom_w_source)</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;      {</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;<span class="comment">        /****</span></div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;<span class="comment">             eddy_visc_coef</span></div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;<span class="comment">             &lt;= 2  LES (do nothing)</span></div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;<span class="comment">             == 3  k-epsilon</span></div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;<span class="comment">        */</span></div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;        assert (turbulenceClosureModel &gt;=3);</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;        <span class="keywordtype">double</span> rho,nu,H_mu,ImH_mu, nu_t=0.0,nu_t_keps =0.0, nu_t_komega=0.0;</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;        <span class="keywordtype">double</span> isKEpsilon = 1.0, dynamic_eddy_viscosity = 0.0;</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160; </div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;        <span class="keywordflow">if</span> (turbulenceClosureModel == 4)</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;          isKEpsilon = 0.0;</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;        H_mu = (1.0-useVF)*<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a25259ea48a9bc3708796a96164a3b8de">gf</a>.H(eps_mu,<a class="code" href="namespaceproteus.html#a17bf106c5df3b1331ed2a18392384813">phi</a>)+useVF*fmin(1.0,fmax(0.0,vf));</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;        ImH_mu = (1.0-useVF)*<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a25259ea48a9bc3708796a96164a3b8de">gf</a>.ImH(eps_mu,<a class="code" href="namespaceproteus.html#a17bf106c5df3b1331ed2a18392384813">phi</a>)+useVF*(1.0-fmin(1.0,fmax(0.0,vf)));</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;        nu  = <a class="code" href="_error_residual_method_8cpp.html#a383b07af68441ce2b4adaaf8d8cc9d90">nu_0</a>*ImH_mu+<a class="code" href="_error_residual_method_8cpp.html#ae5896ebfee35f22242123e4ae82c81d9">nu_1</a>*H_mu;</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;        rho  = <a class="code" href="_error_residual_method_8cpp.html#ae5f5d9edb66645eab31a7c8389493ce7">rho_0</a>*ImH_mu+<a class="code" href="_error_residual_method_8cpp.html#a751e53c9d8dfaf696b11b86e0c1b42e9">rho_1</a>*H_mu;</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160; </div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> twoThirds = 2.0/3.0; <span class="keyword">const</span> <span class="keywordtype">double</span> div_zero = 1.0e-2*fmin(<a class="code" href="_error_residual_method_8cpp.html#a383b07af68441ce2b4adaaf8d8cc9d90">nu_0</a>,<a class="code" href="_error_residual_method_8cpp.html#ae5896ebfee35f22242123e4ae82c81d9">nu_1</a>);</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;        mom_u_source += twoThirds*turb_grad_0[0];</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;        mom_v_source += twoThirds*turb_grad_0[1];</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;        mom_w_source += twoThirds*turb_grad_0[2];</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160; </div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;        <span class="comment">//--- closure model specific ---</span></div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;        <span class="comment">//k-epsilon</span></div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;        nu_t_keps = eddy_visc_coef_0*turb_var_0*turb_var_0/(fabs(turb_var_1) + div_zero);</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;        <span class="comment">//k-omega</span></div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;        nu_t_komega = turb_var_0/(fabs(turb_var_1) + div_zero);</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;        nu_t = isKEpsilon*nu_t_keps + (1.0-isKEpsilon)*nu_t_komega;</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160; </div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;        nu_t = fmax(nu_t,1.0e-4*nu); <span class="comment">//limit according to Lew, Buscaglia etal 01</span></div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;        <span class="comment">//mwf hack</span></div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;        nu_t     = fmin(nu_t,1.0e6*nu);</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;        eddy_viscosity = nu_t;</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;        <span class="keywordflow">if</span> (NONCONSERVATIVE_FORM &gt; 0.0)</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;          {</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;            dynamic_eddy_viscosity = nu_t*rho;</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;            <span class="comment">//u momentum diffusion tensor</span></div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;            mom_uu_diff_ten[0] += 2.0*porosity*dynamic_eddy_viscosity;</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;            mom_uu_diff_ten[1] += porosity*dynamic_eddy_viscosity;</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;            mom_uu_diff_ten[2] += porosity*dynamic_eddy_viscosity;</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160; </div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;            mom_uv_diff_ten[0] +=porosity*dynamic_eddy_viscosity;</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160; </div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;            mom_uw_diff_ten[0] +=porosity*dynamic_eddy_viscosity;</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160; </div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;            <span class="comment">//v momentum diffusion tensor</span></div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;            mom_vv_diff_ten[0] += porosity*dynamic_eddy_viscosity;</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;            mom_vv_diff_ten[1] += 2.0*porosity*dynamic_eddy_viscosity;</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;            mom_vv_diff_ten[2] += porosity*dynamic_eddy_viscosity;</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160; </div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;            mom_vu_diff_ten[0] += porosity*dynamic_eddy_viscosity;</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160; </div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;            mom_vw_diff_ten[0] += porosity*dynamic_eddy_viscosity;</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160; </div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;            <span class="comment">//w momentum diffusion tensor</span></div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;            mom_ww_diff_ten[0] += porosity*dynamic_eddy_viscosity;</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;            mom_ww_diff_ten[1] += porosity*dynamic_eddy_viscosity;</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;            mom_ww_diff_ten[2] += 2.0*porosity*dynamic_eddy_viscosity;</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160; </div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;            mom_wu_diff_ten[0] += porosity*dynamic_eddy_viscosity;</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160; </div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;            mom_wv_diff_ten[0] += porosity*dynamic_eddy_viscosity;</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;          }</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;          {</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;            <span class="comment">//u momentum diffusion tensor</span></div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;            mom_uu_diff_ten[0] += 2.0*porosity*eddy_viscosity;</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;            mom_uu_diff_ten[1] += porosity*eddy_viscosity;</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;            mom_uu_diff_ten[2] += porosity*eddy_viscosity;</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160; </div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;            mom_uv_diff_ten[0]+=porosity*eddy_viscosity;</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160; </div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;            mom_uw_diff_ten[0]+=porosity*eddy_viscosity;</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160; </div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;            <span class="comment">//v momentum diffusion tensor</span></div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;            mom_vv_diff_ten[0] += porosity*eddy_viscosity;</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;            mom_vv_diff_ten[1] += 2.0*porosity*eddy_viscosity;</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;            mom_vv_diff_ten[2] += porosity*eddy_viscosity;</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160; </div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;            mom_vu_diff_ten[0]+=porosity*eddy_viscosity;</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160; </div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;            mom_vw_diff_ten[0]+=porosity*eddy_viscosity;</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160; </div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;            <span class="comment">//w momentum diffusion tensor</span></div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;            mom_ww_diff_ten[0] += porosity*eddy_viscosity;</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;            mom_ww_diff_ten[1] += porosity*eddy_viscosity;</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;            mom_ww_diff_ten[2] += 2.0*porosity*eddy_viscosity;</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160; </div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;            mom_wu_diff_ten[0]+=porosity*eddy_viscosity;</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160; </div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;            mom_wv_diff_ten[0]+=porosity*eddy_viscosity;</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;          }</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;      }</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160; </div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;      <span class="keyword">inline</span></div>
<div class="line"><a name="l01654"></a><span class="lineno"><a class="line" href="classproteus_1_1_r_a_n_s2_p.html#addf5cd3a254683dcee98d02fc43cd5f7"> 1654</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#addf5cd3a254683dcee98d02fc43cd5f7">calculateSubgridError_tau</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp;  hFactor,</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;                                       <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; elementDiameter,</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;                                       <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; dmt,</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;                                       <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; dm,</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;                                       <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="group__analytical_solutions.html#ga31fe0a5e02da8c2ed2761f3aabf86e0d">df</a>[nSpace],</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;                                       <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; a,</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;                                       <span class="keyword">const</span> <span class="keywordtype">double</span>&amp;  pfac,</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;                                       <span class="keywordtype">double</span>&amp; tau_v,</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;                                       <span class="keywordtype">double</span>&amp; tau_p,</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;                                       <span class="keywordtype">double</span>&amp; cfl)</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;      {</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;        <span class="keywordtype">double</span> h,oneByAbsdt,density,viscosity,nrm_df;</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;        h = hFactor*elementDiameter;</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;        density = dm;</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;        viscosity =  a;</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;        nrm_df=0.0;</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> I=0;I&lt;nSpace;I++)</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;          nrm_df+=<a class="code" href="group__analytical_solutions.html#ga31fe0a5e02da8c2ed2761f3aabf86e0d">df</a>[I]*<a class="code" href="group__analytical_solutions.html#ga31fe0a5e02da8c2ed2761f3aabf86e0d">df</a>[I];</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;        nrm_df = sqrt(nrm_df);</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;        cfl = nrm_df/(h*density);<span class="comment">//this is really cfl/dt, but that&#39;s what we want to know, the step controller expect this</span></div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;        oneByAbsdt =  fabs(dmt);</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;        tau_v = 1.0/(4.0*viscosity/(h*h) + 2.0*nrm_df/h + oneByAbsdt);</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;        tau_p = (4.0*viscosity + 2.0*nrm_df*h + oneByAbsdt*h*h)/pfac;</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;        <span class="comment">/* std::cout&lt;&lt;&quot;tau_v &quot;&lt;&lt;tau_v&lt;&lt;&quot; tau_p &quot;&lt;&lt;tau_p&lt;&lt;std::endl; */</span></div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;      }</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160; </div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;      <span class="keyword">inline</span></div>
<div class="line"><a name="l01681"></a><span class="lineno"><a class="line" href="classproteus_1_1_r_a_n_s2_p.html#ae3ee3b038921e561ba98a35bfe00dc0e"> 1681</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#ae3ee3b038921e561ba98a35bfe00dc0e">calculateSubgridError_tau</a>(     <span class="keyword">const</span> <span class="keywordtype">double</span>&amp;  Ct_sge,</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">double</span>&amp;  Cd_sge,</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">double</span>   G[nSpace*nSpace],</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">double</span>&amp;  G_dd_G,</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">double</span>&amp;  tr_G,</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">double</span>&amp;  A0,</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">double</span>   Ai[nSpace],</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">double</span>&amp;  Kij,</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">double</span>&amp;  pfac,</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;                                            <span class="keywordtype">double</span>&amp; tau_v,</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;                                            <span class="keywordtype">double</span>&amp; tau_p,</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;                                            <span class="keywordtype">double</span>&amp; q_cfl)</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;      {</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;        <span class="keywordtype">double</span> v_d_Gv=0.0;</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> I=0;I&lt;nSpace;I++)</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> J=0;J&lt;nSpace;J++)</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;            v_d_Gv += Ai[I]*G[I*nSpace+J]*Ai[J];</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;        tau_v = 1.0/sqrt(Ct_sge*A0*A0 + v_d_Gv + Cd_sge*Kij*Kij*G_dd_G + 1.0e-12);</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;        tau_p = 1.0/(pfac*tr_G*tau_v);</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;      }</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160; </div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;      <span class="keyword">inline</span></div>
<div class="line"><a name="l01703"></a><span class="lineno"><a class="line" href="classproteus_1_1_r_a_n_s2_p.html#acf8d86d92ac9b99a31df36acfc6fece3"> 1703</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#acf8d86d92ac9b99a31df36acfc6fece3">calculateSubgridError_tauRes</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; tau_p,</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;                                          <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; tau_v,</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;                                          <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; pdeResidualP,</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;                                          <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; pdeResidualU,</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;                                          <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; pdeResidualV,</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;                                          <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; pdeResidualW,</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;                                          <span class="keywordtype">double</span>&amp; subgridErrorP,</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;                                          <span class="keywordtype">double</span>&amp; subgridErrorU,</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;                                          <span class="keywordtype">double</span>&amp; subgridErrorV,</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;                                          <span class="keywordtype">double</span>&amp; subgridErrorW)</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;      {</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;        <span class="comment">/* GLS pressure */</span></div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;        subgridErrorP = -tau_p*pdeResidualP;</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;        <span class="comment">/* GLS momentum */</span></div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;        subgridErrorU = -tau_v*pdeResidualU;</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;        subgridErrorV = -tau_v*pdeResidualV;</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;        subgridErrorW = -tau_v*pdeResidualW;</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;      }</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160; </div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;      <span class="keyword">inline</span></div>
<div class="line"><a name="l01723"></a><span class="lineno"><a class="line" href="classproteus_1_1_r_a_n_s2_p.html#a4d4318b9ef2e89282a12e519eb6ced49"> 1723</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a4d4318b9ef2e89282a12e519eb6ced49">calculateSubgridErrorDerivatives_tauRes</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; tau_p,</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;                                                     <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; tau_v,</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;                                                     <span class="keyword">const</span> <span class="keywordtype">double</span> dpdeResidualP_du[nDOF_v_trial_element],</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;                                                     <span class="keyword">const</span> <span class="keywordtype">double</span> dpdeResidualP_dv[nDOF_v_trial_element],</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;                                                     <span class="keyword">const</span> <span class="keywordtype">double</span> dpdeResidualP_dw[nDOF_v_trial_element],</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;                                                     <span class="keyword">const</span> <span class="keywordtype">double</span> dpdeResidualU_dp[nDOF_trial_element],</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;                                                     <span class="keyword">const</span> <span class="keywordtype">double</span> dpdeResidualU_du[nDOF_v_trial_element],</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;                                                     <span class="keyword">const</span> <span class="keywordtype">double</span> dpdeResidualV_dp[nDOF_trial_element],</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;                                                     <span class="keyword">const</span> <span class="keywordtype">double</span> dpdeResidualV_dv[nDOF_v_trial_element],</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;                                                     <span class="keyword">const</span> <span class="keywordtype">double</span> dpdeResidualW_dp[nDOF_trial_element],</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;                                                     <span class="keyword">const</span> <span class="keywordtype">double</span> dpdeResidualW_dw[nDOF_v_trial_element],</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;                                                     <span class="keywordtype">double</span> dsubgridErrorP_du[nDOF_v_trial_element],</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;                                                     <span class="keywordtype">double</span> dsubgridErrorP_dv[nDOF_v_trial_element],</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;                                                     <span class="keywordtype">double</span> dsubgridErrorP_dw[nDOF_v_trial_element],</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;                                                     <span class="keywordtype">double</span> dsubgridErrorU_dp[nDOF_trial_element],</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;                                                     <span class="keywordtype">double</span> dsubgridErrorU_du[nDOF_v_trial_element],</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;                                                     <span class="keywordtype">double</span> dsubgridErrorV_dp[nDOF_trial_element],</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;                                                     <span class="keywordtype">double</span> dsubgridErrorV_dv[nDOF_v_trial_element],</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;                                                     <span class="keywordtype">double</span> dsubgridErrorW_dp[nDOF_trial_element],</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;                                                     <span class="keywordtype">double</span> dsubgridErrorW_dw[nDOF_v_trial_element])</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;      {</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0;j&lt;nDOF_v_trial_element;j++)</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;          {</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;            <span class="comment">/* GLS pressure */</span></div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;            dsubgridErrorP_du[j] = -tau_p*dpdeResidualP_du[j];</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;            dsubgridErrorP_dv[j] = -tau_p*dpdeResidualP_dv[j];</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;            dsubgridErrorP_dw[j] = -tau_p*dpdeResidualP_dw[j];</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;            <span class="comment">/* GLS  momentum*/</span></div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;            <span class="comment">/* u */</span></div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;            dsubgridErrorU_du[j] = -tau_v*dpdeResidualU_du[j];</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;            <span class="comment">/* v */</span></div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;            dsubgridErrorV_dv[j] = -tau_v*dpdeResidualV_dv[j];</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;            <span class="comment">/* w */</span></div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;            dsubgridErrorW_dw[j] = -tau_v*dpdeResidualW_dw[j];</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;          }</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0;j&lt;nDOF_trial_element;j++)</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;          {</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;            <span class="comment">/* GLS  momentum*/</span></div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;            <span class="comment">/* u */</span></div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;            dsubgridErrorU_dp[j] = -tau_v*dpdeResidualU_dp[j];</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;            <span class="comment">/* v */</span></div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;            dsubgridErrorV_dp[j] = -tau_v*dpdeResidualV_dp[j];</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;            <span class="comment">/* w */</span></div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;            dsubgridErrorW_dp[j] = -tau_v*dpdeResidualW_dp[j];</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;          }</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;      }</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160; </div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;      <span class="keyword">inline</span></div>
<div class="line"><a name="l01771"></a><span class="lineno"><a class="line" href="classproteus_1_1_r_a_n_s2_p.html#ab987f978eddb3b321b25be02d34f517d"> 1771</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#ab987f978eddb3b321b25be02d34f517d">exteriorNumericalAdvectiveFlux</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> NONCONSERVATIVE_FORM,</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; isDOFBoundary_p,</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; isDOFBoundary_u,</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; isDOFBoundary_v,</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; isDOFBoundary_w,</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; isFluxBoundary_p,</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; isFluxBoundary_u,</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; isFluxBoundary_v,</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; isFluxBoundary_w,</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; oneByRho,</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; bc_oneByRho,</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[nSpace],</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; bc_p,</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; bc_u,</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; bc_v,</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; bc_w,</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">double</span> bc_f_mass[nSpace],</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">double</span> bc_f_umom[nSpace],</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">double</span> bc_f_vmom[nSpace],</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">double</span> bc_f_wmom[nSpace],</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; bc_flux_mass,</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; bc_flux_umom,</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; bc_flux_vmom,</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; bc_flux_wmom,</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; p,</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; <a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>,</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; <a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>,</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; <a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a>,</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">double</span> f_mass[nSpace],</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">double</span> f_umom[nSpace],</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">double</span> f_vmom[nSpace],</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">double</span> f_wmom[nSpace],</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">double</span> df_mass_du[nSpace],</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">double</span> df_mass_dv[nSpace],</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">double</span> df_mass_dw[nSpace],</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">double</span> df_umom_dp[nSpace],</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">double</span> dham_grad[nSpace],</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">double</span> df_umom_du[nSpace],</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">double</span> df_umom_dv[nSpace],</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">double</span> df_umom_dw[nSpace],</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">double</span> df_vmom_dp[nSpace],</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">double</span> df_vmom_du[nSpace],</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">double</span> df_vmom_dv[nSpace],</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">double</span> df_vmom_dw[nSpace],</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">double</span> df_wmom_dp[nSpace],</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">double</span> df_wmom_du[nSpace],</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">double</span> df_wmom_dv[nSpace],</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">double</span> df_wmom_dw[nSpace],</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;                                            <span class="keywordtype">double</span>&amp; flux_mass,</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;                                            <span class="keywordtype">double</span>&amp; flux_umom,</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;                                            <span class="keywordtype">double</span>&amp; flux_vmom,</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;                                            <span class="keywordtype">double</span>&amp; flux_wmom,</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;                                            <span class="keywordtype">double</span>* velocity)</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;      {</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;        <span class="keywordtype">double</span> flowSpeedNormal;</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;        flux_mass = 0.0;</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;        flux_umom = 0.0;</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;        flux_vmom = 0.0;</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;        flux_wmom = 0.0;</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;        <span class="keywordflow">if</span> (NONCONSERVATIVE_FORM &gt; 0.0)</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;          {</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;            flowSpeedNormal=<a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[0]*df_vmom_dv[0]+<a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[1]*df_umom_du[1]+<a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[2]*df_umom_du[2];<span class="comment">//tricky, works for  moving and fixed domains</span></div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;            flowSpeedNormal+=<a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[0]*dham_grad[0]+<a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[1]*dham_grad[1]+<a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[2]*dham_grad[2];</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;          }</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;          flowSpeedNormal=<a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[0]*df_vmom_dv[0]+<a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[1]*df_umom_du[1]+<a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[2]*df_umom_du[2];<span class="comment">//tricky, works for  moving and fixed domains</span></div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;        <span class="keywordflow">if</span> (isDOFBoundary_u != 1)</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;          {</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;            flux_mass += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[0]*f_mass[0];</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;            velocity[0] = f_mass[0];</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;            <span class="keywordflow">if</span> (flowSpeedNormal &gt;= 0.0)</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;              {</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;                flux_umom += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[0]*f_umom[0];</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;                flux_vmom += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[0]*f_vmom[0];</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;                flux_wmom += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[0]*f_wmom[0];</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;              }</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;              {</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;                <span class="keywordflow">if</span> (NONCONSERVATIVE_FORM &gt; 0.0)</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;                  {</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;                    flux_umom+=(0.0-<a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>)*flowSpeedNormal;</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;                  }</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;              }</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;          }</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;          {</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;            flux_mass += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[0]*f_mass[0];</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;            velocity[0] = f_mass[0];</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;            <span class="keywordflow">if</span> (flowSpeedNormal &gt;= 0.0)</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;              {</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;                flux_umom += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[0]*f_umom[0];</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;                flux_vmom += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[0]*f_vmom[0];</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;                flux_wmom += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[0]*f_wmom[0];</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;              }</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;              {</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;              <span class="keywordflow">if</span> (NONCONSERVATIVE_FORM &gt; 0.0)</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;                {</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;                  flux_umom+=(bc_u-<a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>)*flowSpeedNormal;</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;                }</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;              <span class="keywordflow">else</span></div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;                {</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;                  flux_umom+=<a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[0]*bc_f_umom[0];</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;                  flux_vmom+=<a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[0]*bc_f_vmom[0];</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;                  flux_wmom+=<a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[0]*bc_f_wmom[0];</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;                }</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;              }</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;          }</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;        <span class="keywordflow">if</span> (isDOFBoundary_v != 1)</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;          {</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;            flux_mass+=<a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[1]*f_mass[1];</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;            velocity[1] = f_mass[1];</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;            <span class="keywordflow">if</span> (flowSpeedNormal &gt;= 0.0)</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;              {</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;                flux_umom+=<a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[1]*f_umom[1];</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;                flux_vmom+=<a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[1]*f_vmom[1];</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;                flux_wmom+=<a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[1]*f_wmom[1];</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;              }</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;              {</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;                <span class="keywordflow">if</span> (NONCONSERVATIVE_FORM &gt; 0.0)</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;                  {</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;                    flux_vmom+=(0.0-<a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>)*flowSpeedNormal;</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;                  }</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;              }</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;          }</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;          {</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;            flux_mass+=<a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[1]*f_mass[1];</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;            velocity[1] = f_mass[1];</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;            <span class="keywordflow">if</span> (flowSpeedNormal &gt;= 0.0)</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;              {</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;                flux_umom+=<a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[1]*f_umom[1];</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;                flux_vmom+=<a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[1]*f_vmom[1];</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;                flux_wmom+=<a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[1]*f_wmom[1];</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;              }</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;              {</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;                <span class="keywordflow">if</span> (NONCONSERVATIVE_FORM &gt; 0.0)</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;                  {</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;                    flux_vmom+=(bc_v-<a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>)*flowSpeedNormal;</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;                  }</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;                  {</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;                    flux_umom+=<a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[1]*bc_f_umom[1];</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;                    flux_vmom+=<a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[1]*bc_f_vmom[1];</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;                    flux_wmom+=<a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[1]*bc_f_wmom[1];</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;                  }</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;              }</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;          }</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;        <span class="keywordflow">if</span> (isDOFBoundary_w != 1)</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;          {</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;            flux_mass+=<a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[2]*f_mass[2];</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;            velocity[2] = f_mass[2];</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;            <span class="keywordflow">if</span> (flowSpeedNormal &gt;= 0.0)</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;              {</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;                flux_umom+=<a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[2]*f_umom[2];</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;                flux_vmom+=<a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[2]*f_vmom[2];</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;                flux_wmom+=<a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[2]*f_wmom[2];</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;              }</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;              {</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;                <span class="keywordflow">if</span> (NONCONSERVATIVE_FORM &gt; 0.0)</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;                  {</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;                    flux_wmom+=(0.0-<a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a>)*flowSpeedNormal;</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;                  }</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;              }</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;          }</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;          {</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;            flux_mass +=<a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[2]*f_mass[2];</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;            velocity[2] = f_mass[2];</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;            <span class="keywordflow">if</span> (flowSpeedNormal &gt;= 0.0)</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;              {</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;                flux_umom+=<a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[2]*f_umom[2];</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;                flux_vmom+=<a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[2]*f_vmom[2];</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;                flux_wmom+=<a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[2]*f_wmom[2];</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;              }</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;              {</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;                <span class="keywordflow">if</span> (NONCONSERVATIVE_FORM &gt; 0.0)</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;                  {</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;                    flux_wmom+=(bc_w-<a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a>)*flowSpeedNormal;</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;                  }</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;                  {</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;                    flux_umom+=<a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[2]*bc_f_umom[2];</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;                    flux_vmom+=<a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[2]*bc_f_vmom[2];</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;                    flux_wmom+=<a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[2]*bc_f_wmom[2];</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;                  }</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;              }</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;          }</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;        <span class="keywordflow">if</span> (isDOFBoundary_p == 1)</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;          {</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;            <span class="keywordflow">if</span> (NONCONSERVATIVE_FORM &gt; 0.0)</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;              {</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;                flux_umom+= <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[0]*(bc_p - p);</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;                flux_vmom+= <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[1]*(bc_p - p);</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;                flux_wmom+= <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[2]*(bc_p - p);</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;              }</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;              {</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;                flux_umom+= <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[0]*(bc_p*bc_oneByRho-p*oneByRho);</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;                flux_vmom+= <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[1]*(bc_p*bc_oneByRho-p*oneByRho);</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;                flux_wmom+= <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[2]*(bc_p*bc_oneByRho-p*oneByRho);</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;              }</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;          }</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;        <span class="keywordflow">if</span> (isFluxBoundary_p == 1)</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;          {</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;            velocity[0] += (bc_flux_mass - flux_mass)*<a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[0];</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;            velocity[1] += (bc_flux_mass - flux_mass)*<a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[1];</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;            velocity[2] += (bc_flux_mass - flux_mass)*<a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[2];</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;            flux_mass = bc_flux_mass;</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;          }</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;        <span class="keywordflow">if</span> (isFluxBoundary_u == 1)</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;          {</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;            flux_umom = bc_flux_umom;</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;          }</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;        <span class="keywordflow">if</span> (isFluxBoundary_v == 1)</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;          {</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;            flux_vmom = bc_flux_vmom;</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;          }</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;        <span class="keywordflow">if</span> (isFluxBoundary_w == 1)</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;          {</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;            flux_wmom = bc_flux_wmom;</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;          }</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;      }</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160; </div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;      <span class="keyword">inline</span></div>
<div class="line"><a name="l02000"></a><span class="lineno"><a class="line" href="classproteus_1_1_r_a_n_s2_p.html#a25f4dd4b428fe7b1487c82d93fa3a0c7"> 2000</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a25f4dd4b428fe7b1487c82d93fa3a0c7">exteriorNumericalAdvectiveFluxDerivatives</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> NONCONSERVATIVE_FORM,</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;                                                       <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; isDOFBoundary_p,</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;                                                       <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; isDOFBoundary_u,</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;                                                       <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; isDOFBoundary_v,</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;                                                       <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; isDOFBoundary_w,</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;                                                       <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; isFluxBoundary_p,</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;                                                       <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; isFluxBoundary_u,</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;                                                       <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; isFluxBoundary_v,</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;                                                       <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; isFluxBoundary_w,</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;                                                       <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; oneByRho,</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;                                                       <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[nSpace],</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;                                                       <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; bc_p,</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;                                                       <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; bc_u,</div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;                                                       <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; bc_v,</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;                                                       <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; bc_w,</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;                                                       <span class="keyword">const</span> <span class="keywordtype">double</span> bc_f_mass[nSpace],</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;                                                       <span class="keyword">const</span> <span class="keywordtype">double</span> bc_f_umom[nSpace],</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;                                                       <span class="keyword">const</span> <span class="keywordtype">double</span> bc_f_vmom[nSpace],</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;                                                       <span class="keyword">const</span> <span class="keywordtype">double</span> bc_f_wmom[nSpace],</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;                                                       <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; bc_flux_mass,</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;                                                       <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; bc_flux_umom,</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;                                                       <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; bc_flux_vmom,</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;                                                       <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; bc_flux_wmom,</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;                                                       <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; p,</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;                                                       <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; <a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>,</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;                                                       <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; <a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>,</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;                                                       <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; <a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a>,</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;                                                       <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; dmom_u_acc_u,</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;                                                       <span class="keyword">const</span> <span class="keywordtype">double</span> f_mass[nSpace],</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;                                                       <span class="keyword">const</span> <span class="keywordtype">double</span> f_umom[nSpace],</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;                                                       <span class="keyword">const</span> <span class="keywordtype">double</span> f_vmom[nSpace],</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;                                                       <span class="keyword">const</span> <span class="keywordtype">double</span> f_wmom[nSpace],</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;                                                       <span class="keyword">const</span> <span class="keywordtype">double</span> df_mass_du[nSpace],</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;                                                       <span class="keyword">const</span> <span class="keywordtype">double</span> df_mass_dv[nSpace],</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;                                                       <span class="keyword">const</span> <span class="keywordtype">double</span> df_mass_dw[nSpace],</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;                                                       <span class="keyword">const</span> <span class="keywordtype">double</span> df_umom_dp[nSpace],</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;                                                       <span class="keyword">const</span> <span class="keywordtype">double</span> dham_grad[nSpace],</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;                                                       <span class="keyword">const</span> <span class="keywordtype">double</span> df_umom_du[nSpace],</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;                                                       <span class="keyword">const</span> <span class="keywordtype">double</span> df_umom_dv[nSpace],</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;                                                       <span class="keyword">const</span> <span class="keywordtype">double</span> df_umom_dw[nSpace],</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;                                                       <span class="keyword">const</span> <span class="keywordtype">double</span> df_vmom_dp[nSpace],</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;                                                       <span class="keyword">const</span> <span class="keywordtype">double</span> df_vmom_du[nSpace],</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;                                                       <span class="keyword">const</span> <span class="keywordtype">double</span> df_vmom_dv[nSpace],</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;                                                       <span class="keyword">const</span> <span class="keywordtype">double</span> df_vmom_dw[nSpace],</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;                                                       <span class="keyword">const</span> <span class="keywordtype">double</span> df_wmom_dp[nSpace],</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;                                                       <span class="keyword">const</span> <span class="keywordtype">double</span> df_wmom_du[nSpace],</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;                                                       <span class="keyword">const</span> <span class="keywordtype">double</span> df_wmom_dv[nSpace],</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;                                                       <span class="keyword">const</span> <span class="keywordtype">double</span> df_wmom_dw[nSpace],</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;                                                       <span class="keywordtype">double</span>&amp; dflux_mass_du,</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;                                                       <span class="keywordtype">double</span>&amp; dflux_mass_dv,</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;                                                       <span class="keywordtype">double</span>&amp; dflux_mass_dw,</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;                                                       <span class="keywordtype">double</span>&amp; dflux_umom_dp,</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;                                                       <span class="keywordtype">double</span>&amp; dflux_umom_du,</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;                                                       <span class="keywordtype">double</span>&amp; dflux_umom_dv,</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;                                                       <span class="keywordtype">double</span>&amp; dflux_umom_dw,</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;                                                       <span class="keywordtype">double</span>&amp; dflux_vmom_dp,</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;                                                       <span class="keywordtype">double</span>&amp; dflux_vmom_du,</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;                                                       <span class="keywordtype">double</span>&amp; dflux_vmom_dv,</div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;                                                       <span class="keywordtype">double</span>&amp; dflux_vmom_dw,</div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;                                                       <span class="keywordtype">double</span>&amp; dflux_wmom_dp,</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;                                                       <span class="keywordtype">double</span>&amp; dflux_wmom_du,</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;                                                       <span class="keywordtype">double</span>&amp; dflux_wmom_dv,</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;                                                       <span class="keywordtype">double</span>&amp; dflux_wmom_dw)</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;      {</div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;        <span class="keywordtype">double</span> flowSpeedNormal;</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;        dflux_mass_du = 0.0;</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;        dflux_mass_dv = 0.0;</div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;        dflux_mass_dw = 0.0;</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160; </div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;        dflux_umom_dp = 0.0;</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;        dflux_umom_du = 0.0;</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;        dflux_umom_dv = 0.0;</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;        dflux_umom_dw = 0.0;</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160; </div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;        dflux_vmom_dp = 0.0;</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;        dflux_vmom_du = 0.0;</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;        dflux_vmom_dv = 0.0;</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;        dflux_vmom_dw = 0.0;</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160; </div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;        dflux_wmom_dp = 0.0;</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;        dflux_wmom_du = 0.0;</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;        dflux_wmom_dv = 0.0;</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;        dflux_wmom_dw = 0.0;</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;        flowSpeedNormal=<a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[0]*df_vmom_dv[0]+<a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[1]*df_umom_du[1]+<a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[2]*df_umom_du[2];<span class="comment">//tricky, works for moving and fixed  domains</span></div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;        flowSpeedNormal+=NONCONSERVATIVE_FORM*(<a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[0]*dham_grad[0]+<a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[1]*dham_grad[1]+<a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[2]*dham_grad[2]);</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;        <span class="keywordflow">if</span> (isDOFBoundary_u != 1)</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;          {</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;            dflux_mass_du += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[0]*df_mass_du[0];</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;            <span class="keywordflow">if</span> (flowSpeedNormal &gt;= 0.0)</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;              {</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;                dflux_umom_du += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[0]*df_umom_du[0];</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;                dflux_umom_dv += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[0]*df_umom_dv[0];</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;                dflux_umom_dw += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[0]*df_umom_dw[0];</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160; </div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;                dflux_vmom_du += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[0]*df_vmom_du[0];</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;                dflux_vmom_dv += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[0]*df_vmom_dv[0];</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;                dflux_vmom_dw += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[0]*df_vmom_dw[0];</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;                </div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;                dflux_wmom_du += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[0]*df_wmom_du[0];</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;                dflux_wmom_dv += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[0]*df_wmom_dv[0];</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;                dflux_wmom_dw += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[0]*df_wmom_dw[0];</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;              }</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;              {</div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;                <span class="keywordflow">if</span> (NONCONSERVATIVE_FORM &gt; 0.0)</div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;                  {</div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;                    dflux_umom_du+=(  dmom_u_acc_u*<a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[0]*(0.0 - <a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>) - flowSpeedNormal ) ;</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;                    dflux_umom_dv+= dmom_u_acc_u * (0.0 - <a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>) * <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[1];</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;                    dflux_umom_dw+= dmom_u_acc_u * (0.0 - <a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>) * <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[2];</div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;                  }</div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;              }</div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;          }</div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;          {</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;            <span class="comment">//cek still upwind the advection for Dirichlet?</span></div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;            dflux_mass_du += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[0]*df_mass_du[0];</div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;            <span class="keywordflow">if</span> (flowSpeedNormal &gt;= 0.0)</div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;              {</div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;                dflux_umom_du += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[0]*df_umom_du[0];</div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;                dflux_umom_dv += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[0]*df_umom_dv[0];</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;                dflux_umom_dw += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[0]*df_umom_dw[0];</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;                </div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;                dflux_vmom_du += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[0]*df_vmom_du[0];</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;                dflux_vmom_dv += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[0]*df_vmom_dv[0];</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;                dflux_vmom_dw += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[0]*df_vmom_dw[0];</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;                </div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;                dflux_wmom_du += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[0]*df_wmom_du[0];</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;                dflux_wmom_dv += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[0]*df_wmom_dv[0];</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;                dflux_wmom_dw += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[0]*df_wmom_dw[0];</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;              }</div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;              {</div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;                <span class="keywordflow">if</span> (NONCONSERVATIVE_FORM &gt; 0.0)</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;                  {</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;                    dflux_umom_du+=(  dmom_u_acc_u*<a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[0]*(bc_u-<a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>) - flowSpeedNormal ) ;</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;                    dflux_umom_dv+= dmom_u_acc_u * (bc_u - <a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>) * <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[1];</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;                    dflux_umom_dw+= dmom_u_acc_u * (bc_u - <a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>) * <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[2];</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;                  }</div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;                  {</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;                    <span class="keywordflow">if</span> (isDOFBoundary_v != 1)</div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;                      dflux_vmom_dv += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[0]*df_vmom_dv[0];</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;                    <span class="keywordflow">if</span> (isDOFBoundary_w != 1)</div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;                      dflux_wmom_dw += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[0]*df_wmom_dw[0];</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;                  }</div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;              }</div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;          }</div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;        <span class="keywordflow">if</span> (isDOFBoundary_v != 1)</div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;          {</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;            dflux_mass_dv += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[1]*df_mass_dv[1];</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;            <span class="keywordflow">if</span> (flowSpeedNormal &gt;= 0.0)</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;              {</div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;                dflux_umom_du += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[1]*df_umom_du[1];</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;                dflux_umom_dv += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[1]*df_umom_dv[1];</div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;                dflux_umom_dw += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[1]*df_umom_dw[1];</div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;                </div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;                dflux_vmom_du += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[1]*df_vmom_du[1];</div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;                dflux_vmom_dv += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[1]*df_vmom_dv[1];</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;                dflux_vmom_dw += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[1]*df_vmom_dw[1];</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;                </div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;                dflux_wmom_du += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[1]*df_wmom_du[1];</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;                dflux_wmom_dv += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[1]*df_wmom_dv[1];</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;                dflux_wmom_dw += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[1]*df_wmom_dw[1];</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;              }</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;              {</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;                <span class="keywordflow">if</span> (NONCONSERVATIVE_FORM &gt; 0.0)</div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;                  {</div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;                    dflux_vmom_du += dmom_u_acc_u * <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[0] * (0.0 - <a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>);</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;                    dflux_vmom_dv += ( dmom_u_acc_u * <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[1] * (0.0 - <a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>) - flowSpeedNormal) ;</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;                    dflux_vmom_dw += dmom_u_acc_u * <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[2] * (0.0 - <a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>);</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;                  }</div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;              }</div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;          }</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;          {</div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;            <span class="comment">//cek still upwind the advection for Dirichlet?</span></div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;            dflux_mass_dv += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[1]*df_mass_dv[1];</div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;            <span class="keywordflow">if</span> (flowSpeedNormal &gt;= 0.0)</div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;              {</div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;                dflux_umom_du += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[1]*df_umom_du[1];</div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;                dflux_umom_dv += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[1]*df_umom_dv[1];</div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;                dflux_umom_dw += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[1]*df_umom_dw[1];</div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160; </div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;                dflux_vmom_du += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[1]*df_vmom_du[1];</div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;                dflux_vmom_dv += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[1]*df_vmom_dv[1];</div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;                dflux_vmom_dw += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[1]*df_vmom_dw[1];</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;                </div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;                dflux_wmom_du += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[1]*df_wmom_du[1];</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;                dflux_wmom_dv += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[1]*df_wmom_dv[1];</div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;                dflux_wmom_dw += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[1]*df_wmom_dw[1];</div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;              }</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;              {</div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;                <span class="keywordflow">if</span> (NONCONSERVATIVE_FORM &gt; 0.0)</div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;                  {</div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;                    dflux_vmom_du += dmom_u_acc_u * <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[0] * (bc_v - <a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>);</div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;                    dflux_vmom_dv += ( dmom_u_acc_u * <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[1] * (bc_v - <a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>) - flowSpeedNormal) ;</div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;                    dflux_vmom_dw += dmom_u_acc_u * <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[2] * (bc_v - <a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>);</div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;                  }</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;                  {</div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;                    <span class="keywordflow">if</span> (isDOFBoundary_u != 1)</div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;                      dflux_umom_du += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[1]*df_umom_du[1];</div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;                    <span class="keywordflow">if</span> (isDOFBoundary_w != 1)</div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;                      dflux_wmom_dw += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[1]*df_wmom_dw[1];</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;                  }</div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;              }</div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;          }</div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;        <span class="keywordflow">if</span> (isDOFBoundary_w != 1)</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;          {</div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;            dflux_mass_dw+=<a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[2]*df_mass_dw[2];</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;            <span class="keywordflow">if</span> (flowSpeedNormal &gt;= 0.0)</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;              {</div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;                dflux_umom_du += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[2]*df_umom_du[2];</div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;                dflux_umom_dv += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[2]*df_umom_dv[2];</div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;                dflux_umom_dw += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[2]*df_umom_dw[2];</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160; </div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;                dflux_vmom_du += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[2]*df_vmom_du[2];</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;                dflux_vmom_dv += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[2]*df_vmom_dv[2];</div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;                dflux_vmom_dw += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[2]*df_vmom_dw[2];</div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;                </div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;                dflux_wmom_du += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[2]*df_wmom_du[2];</div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;                dflux_wmom_dv += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[2]*df_wmom_dv[2];</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;                dflux_wmom_dw += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[2]*df_wmom_dw[2];</div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;              }</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;              {</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;                <span class="keywordflow">if</span> (NONCONSERVATIVE_FORM &gt; 0.0)</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;                  {</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;                    dflux_wmom_du += dmom_u_acc_u * <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[0] * (0.0 - <a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a>);</div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;                    dflux_wmom_dv += dmom_u_acc_u * <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[1] * (0.0 - <a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a>);</div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;                    dflux_wmom_dw += ( dmom_u_acc_u * <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[2] * (0.0 - <a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a>) - flowSpeedNormal) ;</div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;                  }</div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;              }</div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;          }</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;          {</div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;            <span class="comment">//cek still upwind the advection for Dirichlet?</span></div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;            dflux_mass_dw += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[2]*df_mass_dw[2];</div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;            <span class="keywordflow">if</span> (flowSpeedNormal &gt;= 0.0)</div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;              {</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;                dflux_umom_du += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[2]*df_umom_du[2];</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;                dflux_umom_dv += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[2]*df_umom_dv[2];</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;                dflux_umom_dw += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[2]*df_umom_dw[2];</div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160; </div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;                dflux_vmom_du += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[2]*df_vmom_du[2];</div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;                dflux_vmom_dv += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[2]*df_vmom_dv[2];</div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;                dflux_vmom_dw += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[2]*df_vmom_dw[2];</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160; </div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;                dflux_wmom_du += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[2]*df_wmom_du[2];</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;                dflux_wmom_dv += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[2]*df_wmom_dv[2];</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;                dflux_wmom_dw += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[2]*df_wmom_dw[2];</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;              }</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;              {</div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;                <span class="keywordflow">if</span> (NONCONSERVATIVE_FORM &gt; 0.0)</div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;                  {</div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;                    dflux_wmom_du += dmom_u_acc_u * <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[0] * (0.0 - <a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a>);</div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;                    dflux_wmom_dv += dmom_u_acc_u * <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[1] * (0.0 - <a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a>);</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;                    dflux_wmom_dw += ( dmom_u_acc_u * <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[2] * (0.0 - <a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a>) - flowSpeedNormal) ;</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;                  }</div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;                  {</div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;                    <span class="keywordflow">if</span> (isDOFBoundary_u != 1)</div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;                      dflux_umom_du += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[2]*df_umom_du[2];</div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;                    <span class="keywordflow">if</span> (isDOFBoundary_v != 1)</div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;                      dflux_vmom_dv += <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[2]*df_vmom_dv[2];</div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;                  }</div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;              }</div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;          }</div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;        <span class="keywordflow">if</span> (isDOFBoundary_p == 1)</div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;          {</div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;            <span class="keywordflow">if</span> (NONCONSERVATIVE_FORM &gt; 0.0)</div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;              {</div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;                dflux_umom_dp= -<a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[0];</div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;                dflux_vmom_dp= -<a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[1];</div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;                dflux_wmom_dp= -<a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[2];</div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;              }</div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;              {</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;                dflux_umom_dp= -<a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[0]*oneByRho;</div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;                dflux_vmom_dp= -<a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[1]*oneByRho;</div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;                dflux_wmom_dp= -<a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[2]*oneByRho;</div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;              }</div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;          }</div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;        <span class="keywordflow">if</span> (isFluxBoundary_p == 1)</div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;          {</div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;            dflux_mass_du = 0.0;</div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;            dflux_mass_dv = 0.0;</div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;            dflux_mass_dw = 0.0;</div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;          }</div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;        <span class="keywordflow">if</span> (isFluxBoundary_u == 1)</div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;          {</div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;            dflux_umom_dp = 0.0;</div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;            dflux_umom_du = 0.0;</div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;            dflux_umom_dv = 0.0;</div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;            dflux_umom_dw = 0.0;</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;          }</div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;        <span class="keywordflow">if</span> (isFluxBoundary_v == 1)</div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;          {</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;            dflux_vmom_dp = 0.0;</div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;            dflux_vmom_du = 0.0;</div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;            dflux_vmom_dv = 0.0;</div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;            dflux_vmom_dw = 0.0;</div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;          }</div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;        <span class="keywordflow">if</span> (isFluxBoundary_w == 1)</div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;          {</div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;            dflux_wmom_dp = 0.0;</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;            dflux_wmom_du = 0.0;</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;            dflux_wmom_dv = 0.0;</div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;            dflux_wmom_dw = 0.0;</div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;          }</div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;      }</div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160; </div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;      <span class="keyword">inline</span></div>
<div class="line"><a name="l02316"></a><span class="lineno"><a class="line" href="classproteus_1_1_r_a_n_s2_p.html#aba606100197bd1648a169d46dcf84ad0"> 2316</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#aba606100197bd1648a169d46dcf84ad0">exteriorNumericalDiffusiveFlux</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; eps,</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; <a class="code" href="namespaceproteus.html#a17bf106c5df3b1331ed2a18392384813">phi</a>,</div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;                                            <span class="keywordtype">int</span>* rowptr,</div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;                                            <span class="keywordtype">int</span>* colind,</div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; isDOFBoundary,</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; isFluxBoundary,</div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[nSpace],</div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;                                            <span class="keywordtype">double</span>* bc_a,</div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; bc_u,</div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; bc_flux,</div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;                                            <span class="keywordtype">double</span>* a,</div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">double</span> grad_potential[nSpace],</div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; <a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>,</div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; penalty,</div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;                                            <span class="keywordtype">double</span>&amp; flux)</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;      {</div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;        <span class="keywordtype">double</span> diffusiveVelocityComponent_I,penaltyFlux,max_a;</div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;        <span class="keywordflow">if</span>(isFluxBoundary == 1)</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;          {</div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;            flux = bc_flux;</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;          }</div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(isDOFBoundary == 1)</div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;          {</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;            flux = 0.0;</div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;            max_a=0.0;</div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> I=0;I&lt;nSpace;I++)</div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;              {</div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;                diffusiveVelocityComponent_I=0.0;</div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">int</span> m=rowptr[I];m&lt;rowptr[I+1];m++)</div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;                  {</div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;                    diffusiveVelocityComponent_I -= a[m]*grad_potential[colind[m]];</div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;                    max_a = fmax(max_a,a[m]);</div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;                  }</div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;                flux+= diffusiveVelocityComponent_I*<a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[I];</div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;              }</div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;            penaltyFlux = max_a*penalty*(<a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>-bc_u);</div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;            flux += penaltyFlux;</div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;            <span class="comment">//cek: need to investigate this issue more</span></div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;            <span class="comment">//contact line slip</span></div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;            <span class="comment">//flux*=(gf.D(eps,0) - gf.D(eps,phi))/gf.D(eps,0);</span></div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;          }</div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;          {</div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;            std::cerr&lt;&lt;<span class="stringliteral">&quot;RANS2P: warning, diffusion term with no boundary condition set, setting diffusive flux to 0.0&quot;</span>&lt;&lt;std::endl;</div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;            flux = 0.0;</div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;          }</div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;      }</div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160; </div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160; </div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;      <span class="keyword">inline</span></div>
<div class="line"><a name="l02366"></a><span class="lineno"><a class="line" href="classproteus_1_1_r_a_n_s2_p.html#ad7f7189cfca7297be05b3782551714b0"> 2366</a></span>&#160;        <span class="keywordtype">double</span> <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#ad7f7189cfca7297be05b3782551714b0">ExteriorNumericalDiffusiveFluxJacobian</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; eps,</div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;                                                      <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; <a class="code" href="namespaceproteus.html#a17bf106c5df3b1331ed2a18392384813">phi</a>,</div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;                                                      <span class="keywordtype">int</span>* rowptr,</div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;                                                      <span class="keywordtype">int</span>* colind,</div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;                                                      <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; isDOFBoundary,</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;                                                      <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; isFluxBoundary,</div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;                                                      <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[nSpace],</div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;                                                      <span class="keywordtype">double</span>* a,</div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;                                                      <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; <a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>,</div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;                                                      <span class="keyword">const</span> <span class="keywordtype">double</span> grad_v[nSpace],</div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;                                                      <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; penalty)</div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;      {</div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;        <span class="keywordtype">double</span> dvel_I,tmp=0.0,max_a=0.0;</div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;        <span class="keywordflow">if</span>(isFluxBoundary==0 &amp;&amp; isDOFBoundary==1)</div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;          {</div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> I=0;I&lt;nSpace;I++)</div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;              {</div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;                dvel_I=0.0;</div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">int</span> m=rowptr[I];m&lt;rowptr[I+1];m++)</div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;                  {</div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;                    dvel_I -= a[m]*grad_v[colind[m]];</div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;                    max_a = fmax(max_a,a[m]);</div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;                  }</div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;                tmp += dvel_I*<a class="code" href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a>[I];</div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;              }</div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;            tmp +=max_a*penalty*<a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>;</div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;            <span class="comment">//cek: need to investigate this issue more</span></div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;            <span class="comment">//contact line slip</span></div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;            <span class="comment">//tmp*=(gf.D(eps,0) - gf.D(eps,phi))/gf.D(eps,0);</span></div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;          }</div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;        <span class="keywordflow">return</span> tmp;</div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;      }</div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160; </div>
<div class="line"><a name="l02399"></a><span class="lineno"><a class="line" href="classproteus_1_1_r_a_n_s2_p.html#a63146e5310c6c2c58f6d91398944a69a"> 2399</a></span>&#160;      <span class="keywordtype">void</span> <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a63146e5310c6c2c58f6d91398944a69a">calculateResidual</a>(<span class="keywordtype">double</span> NONCONSERVATIVE_FORM,</div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;                             <span class="keywordtype">double</span> MOMENTUM_SGE,</div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;                             <span class="keywordtype">double</span> PRESSURE_SGE,</div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;                             <span class="keywordtype">double</span> VELOCITY_SGE,</div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;                             <span class="keywordtype">double</span> PRESSURE_PROJECTION_STABILIZATION,</div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;                             <span class="keywordtype">double</span>* numerical_viscosity,</div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;                             <span class="comment">//element</span></div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;                             <span class="keywordtype">double</span>* mesh_trial_ref,</div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;                             <span class="keywordtype">double</span>* mesh_grad_trial_ref,</div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;                             <span class="keywordtype">double</span>* mesh_dof,</div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;                             <span class="keywordtype">double</span>* mesh_velocity_dof,</div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;                             <span class="keywordtype">double</span> MOVING_DOMAIN,</div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;                             <span class="keywordtype">int</span>* mesh_l2g,</div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;                             <span class="keywordtype">double</span>* x_ref,</div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;                             <span class="keywordtype">double</span>* dV_ref,</div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;                             <span class="keywordtype">double</span>* p_trial_ref,</div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;                             <span class="keywordtype">double</span>* p_grad_trial_ref,</div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;                             <span class="keywordtype">double</span>* p_test_ref,</div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;                             <span class="keywordtype">double</span>* p_grad_test_ref,</div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;                             <span class="keywordtype">double</span>* vel_trial_ref,</div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;                             <span class="keywordtype">double</span>* vel_grad_trial_ref,</div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;                             <span class="keywordtype">double</span>* vel_test_ref,</div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;                             <span class="keywordtype">double</span>* vel_grad_test_ref,</div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;                             <span class="comment">//element boundary</span></div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;                             <span class="keywordtype">double</span>* mesh_trial_trace_ref,</div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;                             <span class="keywordtype">double</span>* mesh_grad_trial_trace_ref,</div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;                             <span class="keywordtype">double</span>* dS_ref,</div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;                             <span class="keywordtype">double</span>* p_trial_trace_ref,</div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;                             <span class="keywordtype">double</span>* p_grad_trial_trace_ref,</div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;                             <span class="keywordtype">double</span>* p_test_trace_ref,</div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;                             <span class="keywordtype">double</span>* p_grad_test_trace_ref,</div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;                             <span class="keywordtype">double</span>* vel_trial_trace_ref,</div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;                             <span class="keywordtype">double</span>* vel_grad_trial_trace_ref,</div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;                             <span class="keywordtype">double</span>* vel_test_trace_ref,</div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;                             <span class="keywordtype">double</span>* vel_grad_test_trace_ref,</div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;                             <span class="keywordtype">double</span>* normal_ref,</div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;                             <span class="keywordtype">double</span>* boundaryJac_ref,</div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;                             <span class="comment">//physics</span></div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;                             <span class="keywordtype">double</span> eb_adjoint_sigma,</div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;                             <span class="keywordtype">double</span>* elementDiameter,</div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;                             <span class="keywordtype">double</span>* nodeDiametersArray,</div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;                             <span class="keywordtype">double</span> hFactor,</div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;                             <span class="keywordtype">int</span> nElements_global,</div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;                             <span class="keywordtype">int</span> nElementBoundaries_owned,</div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;                             <span class="keywordtype">double</span> useRBLES,</div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;                             <span class="keywordtype">double</span> useMetrics,</div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;                             <span class="keywordtype">double</span> alphaBDF,</div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;                             <span class="keywordtype">double</span> epsFact_rho,</div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;                             <span class="keywordtype">double</span> epsFact_mu,</div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;                             <span class="keywordtype">double</span> sigma,</div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;                             <span class="keywordtype">double</span> <a class="code" href="_error_residual_method_8cpp.html#ae5f5d9edb66645eab31a7c8389493ce7">rho_0</a>,</div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;                             <span class="keywordtype">double</span> <a class="code" href="_error_residual_method_8cpp.html#a383b07af68441ce2b4adaaf8d8cc9d90">nu_0</a>,</div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;                             <span class="keywordtype">double</span> <a class="code" href="_error_residual_method_8cpp.html#a751e53c9d8dfaf696b11b86e0c1b42e9">rho_1</a>,</div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;                             <span class="keywordtype">double</span> <a class="code" href="_error_residual_method_8cpp.html#ae5896ebfee35f22242123e4ae82c81d9">nu_1</a>,</div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;                             <span class="keywordtype">double</span> smagorinskyConstant,</div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;                             <span class="keywordtype">int</span> turbulenceClosureModel,</div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;                             <span class="keywordtype">double</span> Ct_sge,</div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;                             <span class="keywordtype">double</span> Cd_sge,</div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;                             <span class="keywordtype">double</span> C_dc,</div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;                             <span class="keywordtype">double</span> C_b,</div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;                             <span class="comment">//VRANS</span></div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">double</span>* eps_solid,</div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;                                   <span class="keywordtype">double</span>* phi_solid,</div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">double</span>* q_velocity_solid,</div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">double</span>* q_porosity,</div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">double</span>* q_dragAlpha,</div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">double</span>* q_dragBeta,</div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">double</span>* q_mass_source,</div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">double</span>* q_turb_var_0,</div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">double</span>* q_turb_var_1,</div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">double</span>* q_turb_var_grad_0,</div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">double</span> LAG_LES,</div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;                             <span class="keywordtype">double</span> * q_eddy_viscosity,</div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;                             <span class="keywordtype">double</span> * q_eddy_viscosity_last,</div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;                             <span class="keywordtype">double</span> * ebqe_eddy_viscosity,</div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;                             <span class="keywordtype">double</span> * ebqe_eddy_viscosity_last,</div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;                             <span class="comment">//</span></div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;                             <span class="keywordtype">int</span>* p_l2g,</div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;                             <span class="keywordtype">int</span>* vel_l2g,</div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;                             <span class="keywordtype">int</span>* rp_l2g,</div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;                             <span class="keywordtype">int</span>* rvel_l2g,</div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;                             <span class="keywordtype">double</span>* p_dof,</div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;                             <span class="keywordtype">double</span>* u_dof,</div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;                             <span class="keywordtype">double</span>* v_dof,</div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;                             <span class="keywordtype">double</span>* w_dof,</div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;                             <span class="keywordtype">double</span>* p_old_dof,</div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;                             <span class="keywordtype">double</span>* u_old_dof,</div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;                             <span class="keywordtype">double</span>* v_old_dof,</div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;                             <span class="keywordtype">double</span>* w_old_dof,</div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;                             <span class="keywordtype">double</span>* g,</div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">double</span> useVF,</div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;                             <span class="keywordtype">double</span>* q_rho,</div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;                             <span class="keywordtype">double</span>* vf,</div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;                             <span class="keywordtype">double</span>* <a class="code" href="namespaceproteus.html#a17bf106c5df3b1331ed2a18392384813">phi</a>,</div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;                             <span class="keywordtype">double</span>* phi_nodes,</div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;                             <span class="keywordtype">double</span>* normal_phi,</div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;                             <span class="keywordtype">double</span>* kappa_phi,</div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;                             <span class="keywordtype">double</span>* q_mom_u_acc,</div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;                             <span class="keywordtype">double</span>* q_mom_v_acc,</div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;                             <span class="keywordtype">double</span>* q_mom_w_acc,</div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;                             <span class="keywordtype">double</span>* q_mass_adv,</div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;                             <span class="keywordtype">double</span>* q_mom_u_acc_beta_bdf, <span class="keywordtype">double</span>* q_mom_v_acc_beta_bdf, <span class="keywordtype">double</span>* q_mom_w_acc_beta_bdf,</div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;                             <span class="keywordtype">double</span>* q_dV,</div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;                             <span class="keywordtype">double</span>* q_dV_last,</div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;                             <span class="keywordtype">double</span>* q_velocity_sge,</div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;                             <span class="keywordtype">double</span>* q_cfl,</div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;                             <span class="keywordtype">double</span>* q_numDiff_u, <span class="keywordtype">double</span>* q_numDiff_v, <span class="keywordtype">double</span>* q_numDiff_w,</div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;                             <span class="keywordtype">double</span>* q_numDiff_u_last, <span class="keywordtype">double</span>* q_numDiff_v_last, <span class="keywordtype">double</span>* q_numDiff_w_last,</div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;                             <span class="keywordtype">int</span>* sdInfo_u_u_rowptr,<span class="keywordtype">int</span>* sdInfo_u_u_colind,</div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;                             <span class="keywordtype">int</span>* sdInfo_u_v_rowptr,<span class="keywordtype">int</span>* sdInfo_u_v_colind,</div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;                             <span class="keywordtype">int</span>* sdInfo_u_w_rowptr,<span class="keywordtype">int</span>* sdInfo_u_w_colind,</div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;                             <span class="keywordtype">int</span>* sdInfo_v_v_rowptr,<span class="keywordtype">int</span>* sdInfo_v_v_colind,</div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;                             <span class="keywordtype">int</span>* sdInfo_v_u_rowptr,<span class="keywordtype">int</span>* sdInfo_v_u_colind,</div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;                             <span class="keywordtype">int</span>* sdInfo_v_w_rowptr,<span class="keywordtype">int</span>* sdInfo_v_w_colind,</div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;                             <span class="keywordtype">int</span>* sdInfo_w_w_rowptr,<span class="keywordtype">int</span>* sdInfo_w_w_colind,</div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;                             <span class="keywordtype">int</span>* sdInfo_w_u_rowptr,<span class="keywordtype">int</span>* sdInfo_w_u_colind,</div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;                             <span class="keywordtype">int</span>* sdInfo_w_v_rowptr,<span class="keywordtype">int</span>* sdInfo_w_v_colind,</div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;                             <span class="keywordtype">int</span> offset_p, <span class="keywordtype">int</span> offset_u, <span class="keywordtype">int</span> offset_v, <span class="keywordtype">int</span> offset_w,</div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;                             <span class="keywordtype">int</span> stride_p, <span class="keywordtype">int</span> stride_u, <span class="keywordtype">int</span> stride_v, <span class="keywordtype">int</span> stride_w,</div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;                             <span class="keywordtype">double</span>* globalResidual,</div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;                             <span class="keywordtype">int</span> nExteriorElementBoundaries_global,</div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;                             <span class="keywordtype">int</span>* exteriorElementBoundariesArray,</div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;                             <span class="keywordtype">int</span>* elementBoundaryElementsArray,</div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;                             <span class="keywordtype">int</span>* elementBoundaryLocalElementBoundariesArray,</div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;                             <span class="keywordtype">double</span>* ebqe_vf_ext,</div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;                             <span class="keywordtype">double</span>* bc_ebqe_vf_ext,</div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;                             <span class="keywordtype">double</span>* ebqe_phi_ext,</div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;                             <span class="keywordtype">double</span>* bc_ebqe_phi_ext,</div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;                             <span class="keywordtype">double</span>* ebqe_normal_phi_ext,</div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;                             <span class="keywordtype">double</span>* ebqe_kappa_phi_ext,</div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;                             <span class="comment">//VRANS</span></div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">double</span>* ebqe_porosity_ext,</div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">double</span>* ebqe_turb_var_0,</div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">double</span>* ebqe_turb_var_1,</div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;                             <span class="comment">//VRANS end</span></div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;                             <span class="keywordtype">int</span>* isDOFBoundary_p,</div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;                             <span class="keywordtype">int</span>* isDOFBoundary_u,</div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;                             <span class="keywordtype">int</span>* isDOFBoundary_v,</div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;                             <span class="keywordtype">int</span>* isDOFBoundary_w,</div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;                             <span class="keywordtype">int</span>* isAdvectiveFluxBoundary_p,</div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;                             <span class="keywordtype">int</span>* isAdvectiveFluxBoundary_u,</div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;                             <span class="keywordtype">int</span>* isAdvectiveFluxBoundary_v,</div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;                             <span class="keywordtype">int</span>* isAdvectiveFluxBoundary_w,</div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;                             <span class="keywordtype">int</span>* isDiffusiveFluxBoundary_u,</div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;                             <span class="keywordtype">int</span>* isDiffusiveFluxBoundary_v,</div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;                             <span class="keywordtype">int</span>* isDiffusiveFluxBoundary_w,</div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;                             <span class="keywordtype">double</span>* ebqe_bc_p_ext,</div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;                             <span class="keywordtype">double</span>* ebqe_bc_flux_mass_ext,</div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;                             <span class="keywordtype">double</span>* ebqe_bc_flux_mom_u_adv_ext,</div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;                             <span class="keywordtype">double</span>* ebqe_bc_flux_mom_v_adv_ext,</div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;                             <span class="keywordtype">double</span>* ebqe_bc_flux_mom_w_adv_ext,</div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;                             <span class="keywordtype">double</span>* ebqe_bc_u_ext,</div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;                             <span class="keywordtype">double</span>* ebqe_bc_flux_u_diff_ext,</div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;                             <span class="keywordtype">double</span>* ebqe_penalty_ext,</div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;                             <span class="keywordtype">double</span>* ebqe_bc_v_ext,</div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;                             <span class="keywordtype">double</span>* ebqe_bc_flux_v_diff_ext,</div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;                             <span class="keywordtype">double</span>* ebqe_bc_w_ext,</div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;                             <span class="keywordtype">double</span>* ebqe_bc_flux_w_diff_ext,</div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;                             <span class="keywordtype">double</span>* q_x,</div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;                             <span class="keywordtype">double</span>* q_velocity,</div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;                             <span class="keywordtype">double</span>* ebqe_velocity,</div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;                             <span class="keywordtype">double</span>* flux,</div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;                             <span class="keywordtype">double</span>* elementResidual_p_save,</div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;                             <span class="keywordtype">int</span>* elementFlags,</div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;                             <span class="keywordtype">int</span>* boundaryFlags,</div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;                             <span class="keywordtype">double</span>* barycenters,</div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;                             <span class="keywordtype">double</span>* wettedAreas,</div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;                             <span class="keywordtype">double</span>* netForces_p,</div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;                             <span class="keywordtype">double</span>* netForces_v,</div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;                             <span class="keywordtype">double</span>* netMoments,</div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;                             <span class="keywordtype">double</span>* velocityError,</div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;                             <span class="keywordtype">double</span>* velocityErrorNodal,</div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;                             <span class="keywordtype">double</span>* forcex,</div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;                             <span class="keywordtype">double</span>* forcey,</div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;                             <span class="keywordtype">double</span>* forcez,</div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;                             <span class="keywordtype">int</span>     use_ball_as_particle,</div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;                             <span class="keywordtype">double</span>* ball_center,</div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;                             <span class="keywordtype">double</span>* ball_radius,</div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;                             <span class="keywordtype">double</span>* ball_velocity,</div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;                             <span class="keywordtype">double</span>* ball_angular_velocity,</div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;                             <span class="keywordtype">double</span>* ball_center_acceleration,</div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;                             <span class="keywordtype">double</span>* ball_angular_acceleration,</div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;                             <span class="keywordtype">double</span>* ball_density,</div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;                             <span class="keywordtype">double</span>* particle_signed_distances,</div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;                             <span class="keywordtype">double</span>* particle_signed_distance_normals,</div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;                             <span class="keywordtype">double</span>* particle_velocities,</div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;                             <span class="keywordtype">double</span>* particle_centroids,</div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;                             <span class="keywordtype">double</span>* ebq_global_phi_s,</div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;                             <span class="keywordtype">double</span>* ebq_global_grad_phi_s,</div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;                             <span class="keywordtype">double</span>* ebq_particle_velocity_s,</div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;                             <span class="keywordtype">int</span> nParticles,</div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;                             <span class="keywordtype">double</span> *particle_netForces,</div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;                             <span class="keywordtype">double</span> *particle_netMoments,</div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;                             <span class="keywordtype">double</span> *particle_surfaceArea,</div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;                             <span class="keywordtype">int</span> nElements_owned,</div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;                             <span class="keywordtype">double</span> particle_nitsche,</div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;                             <span class="keywordtype">double</span> particle_epsFact,</div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;                             <span class="keywordtype">double</span> particle_alpha,</div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;                             <span class="keywordtype">double</span> particle_beta,</div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;                             <span class="keywordtype">double</span> particle_penalty_constant,</div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;                             <span class="keywordtype">double</span>* phi_solid_nodes,</div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;                             <span class="keywordtype">double</span>* distance_to_solids,</div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">int</span> use_pseudo_penalty,</div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;                             <span class="keywordtype">bool</span> useExact)</div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;      {</div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;        <a class="code" href="_py_embedded_functions_8h.html#a3ddeb1b85023f01e48ff330ed82632b4">logEvent</a>(<span class="stringliteral">&quot;Entered mprans calculateResidual&quot;</span>,6);</div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;        <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a25259ea48a9bc3708796a96164a3b8de">gf</a>.useExact = useExact;</div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;        <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#aa6183d3c81313639cd5ec6c4697ccdde">gf_s</a>.useExact = useExact;</div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> nQuadraturePoints_global(nElements_global*nQuadraturePoints_element);</div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;        </div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;        <span class="comment">//loop over elements to compute volume integrals and load them into element and global residual</span></div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;        <span class="keywordtype">double</span> mesh_volume_conservation=0.0,</div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;          mesh_volume_conservation_weak=0.0,</div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;          mesh_volume_conservation_err_max=0.0,</div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;          mesh_volume_conservation_err_max_weak=0.0;</div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;        <span class="keywordtype">double</span> globalConservationError=0.0;</div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> eN=0;eN&lt;nElements_global;eN++)</div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;          {</div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;            <span class="comment">//declare local storage for element residual and initialize</span></div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;            <span class="keyword">register</span> <span class="keywordtype">double</span> elementResidual_p[nDOF_test_element],elementResidual_mesh[nDOF_test_element],</div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;              elementResidual_u[nDOF_v_test_element],</div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;              elementResidual_v[nDOF_v_test_element],</div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;              elementResidual_w[nDOF_v_test_element],</div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;              eps_rho,eps_mu;</div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;            <span class="keywordtype">double</span> mesh_volume_conservation_element=0.0,</div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;              mesh_volume_conservation_element_weak=0.0;</div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;nDOF_test_element;i++)</div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;              {</div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;                <span class="keywordtype">int</span> eN_i = eN*nDOF_test_element+i;</div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;                elementResidual_p_save[eN_i]=0.0;</div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;                elementResidual_mesh[i]=0.0;</div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;                elementResidual_p[i]=0.0;</div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;              }</div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;nDOF_v_test_element;i++)</div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;              {</div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;                elementResidual_u[i]=0.0;</div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;                elementResidual_v[i]=0.0;</div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;                elementResidual_w[i]=0.0;</div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;              }<span class="comment">//i</span></div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;            <span class="comment">//Use for plotting result</span></div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;            <span class="keywordflow">if</span>(use_ball_as_particle==1)</div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;              {</div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> I=0;I&lt;nDOF_mesh_trial_element;I++)</div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;                  <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a3e0cb3084e0e32cc2355384f2e511801">get_distance_to_ball</a>(nParticles, ball_center, ball_radius,</div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;                                       mesh_dof[3*mesh_l2g[eN*nDOF_mesh_trial_element+I]+0],</div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;                                       mesh_dof[3*mesh_l2g[eN*nDOF_mesh_trial_element+I]+1],</div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;                                       mesh_dof[3*mesh_l2g[eN*nDOF_mesh_trial_element+I]+2],</div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;                                       phi_solid_nodes[mesh_l2g[eN*nDOF_mesh_trial_element+I]]);</div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;              }</div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;            <span class="keywordtype">double</span> element_phi[nDOF_mesh_trial_element], element_phi_s[nDOF_mesh_trial_element];</div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0;j&lt;nDOF_mesh_trial_element;j++)</div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;              {</div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;                <span class="keyword">register</span> <span class="keywordtype">int</span> eN_j = eN*nDOF_mesh_trial_element+j;</div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;                element_phi[j] = phi_nodes[mesh_l2g[eN_j]];</div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;                element_phi_s[j] = phi_solid_nodes[mesh_l2g[eN_j]];</div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;              }</div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;            <span class="keywordtype">double</span> element_nodes[nDOF_mesh_trial_element*3];</div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;nDOF_mesh_trial_element;i++)</div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;              {</div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;                <span class="keyword">register</span> <span class="keywordtype">int</span> eN_i=eN*nDOF_mesh_trial_element+i;</div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">int</span> I=0;I&lt;3;I++)</div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;                  element_nodes[i*3 + I] = mesh_dof[mesh_l2g[eN_i]*3 + I];</div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;              }<span class="comment">//i</span></div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;            <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#aa6183d3c81313639cd5ec6c4697ccdde">gf_s</a>.calculate(element_phi_s, element_nodes, x_ref);</div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;            <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a25259ea48a9bc3708796a96164a3b8de">gf</a>.calculate(element_phi, element_nodes, x_ref);</div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;            <span class="comment">//loop over quadrature points and compute integrands</span></div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0;k&lt;nQuadraturePoints_element;k++)</div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;              {</div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;                <span class="comment">//compute indices and declare local storage</span></div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;                <span class="keyword">register</span> <span class="keywordtype">int</span> eN_k = eN*nQuadraturePoints_element+k,</div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;                  eN_k_nSpace = eN_k*nSpace,</div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;                  eN_k_3d = eN_k*3,</div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;                  eN_nDOF_trial_element = eN*nDOF_trial_element,</div>
<div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;                  eN_nDOF_v_trial_element = eN*nDOF_v_trial_element;</div>
<div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;                <span class="keyword">register</span> <span class="keywordtype">double</span> p=0.0,<a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>=0.0,<a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>=0.0,<a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a>=0.0,</div>
<div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;                  grad_p[nSpace],grad_u[nSpace],grad_v[nSpace],grad_w[nSpace],</div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;                  p_old=0.0,u_old=0.0,v_old=0.0,w_old=0.0,</div>
<div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;                  grad_p_old[nSpace],grad_u_old[nSpace],grad_v_old[nSpace],grad_w_old[nSpace],</div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;                  mom_u_acc=0.0,</div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;                  dmom_u_acc_u=0.0,</div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;                  mom_v_acc=0.0,</div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;                  dmom_v_acc_v=0.0,</div>
<div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;                  mom_w_acc=0.0,</div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;                  dmom_w_acc_w=0.0,</div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;                  mass_adv[nSpace],</div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;                  dmass_adv_u[nSpace],</div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;                  dmass_adv_v[nSpace],</div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;                  dmass_adv_w[nSpace],</div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;                  mass_ham=0.0,</div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;                  dmass_ham_u=0.0,</div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;                  dmass_ham_v=0.0,</div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;                  dmass_ham_w=0.0,</div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;                  mom_u_adv[nSpace],</div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;                  dmom_u_adv_u[nSpace],</div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;                  dmom_u_adv_v[nSpace],</div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;                  dmom_u_adv_w[nSpace],</div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;                  mom_v_adv[nSpace],</div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;                  dmom_v_adv_u[nSpace],</div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;                  dmom_v_adv_v[nSpace],</div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;                  dmom_v_adv_w[nSpace],</div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;                  mom_w_adv[nSpace],</div>
<div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;                  dmom_w_adv_u[nSpace],</div>
<div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;                  dmom_w_adv_v[nSpace],</div>
<div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;                  dmom_w_adv_w[nSpace],</div>
<div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;                  mom_uu_diff_ten[nSpace],</div>
<div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;                  mom_vv_diff_ten[nSpace],</div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;                  mom_ww_diff_ten[nSpace],</div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;                  mom_uv_diff_ten[1],</div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;                  mom_uw_diff_ten[1],</div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;                  mom_vu_diff_ten[1],</div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;                  mom_vw_diff_ten[1],</div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;                  mom_wu_diff_ten[1],</div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;                  mom_wv_diff_ten[1],</div>
<div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;                  mom_u_source=0.0,</div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;                  mom_v_source=0.0,</div>
<div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;                  mom_w_source=0.0,</div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;                  mom_u_ham=0.0,</div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;                  dmom_u_ham_grad_p[nSpace],</div>
<div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;                  dmom_u_ham_grad_u[nSpace],</div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;                  dmom_u_ham_u=0.0,</div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;                  dmom_u_ham_v=0.0,</div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;                  dmom_u_ham_w=0.0,</div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;                  mom_v_ham=0.0,</div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;                  dmom_v_ham_grad_p[nSpace],</div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;                  dmom_v_ham_grad_v[nSpace],</div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;                  dmom_v_ham_u=0.0,</div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;                  dmom_v_ham_v=0.0,</div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;                  dmom_v_ham_w=0.0,</div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;                  mom_w_ham=0.0,</div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;                  dmom_w_ham_grad_p[nSpace],</div>
<div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;                  dmom_w_ham_grad_w[nSpace],</div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;                  dmom_w_ham_u=0.0,</div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;                  dmom_w_ham_v=0.0,</div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;                  dmom_w_ham_w=0.0,</div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;                  mom_u_acc_t=0.0,</div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;                  dmom_u_acc_u_t=0.0,</div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;                  mom_v_acc_t=0.0,</div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;                  dmom_v_acc_v_t=0.0,</div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;                  mom_w_acc_t=0.0,</div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;                  dmom_w_acc_w_t=0.0,</div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;                  pdeResidual_p=0.0,</div>
<div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;                  pdeResidual_u=0.0,</div>
<div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;                  pdeResidual_v=0.0,</div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;                  pdeResidual_w=0.0,</div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;                  Lstar_u_p[nDOF_test_element],</div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;                  Lstar_v_p[nDOF_test_element],</div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;                  Lstar_w_p[nDOF_test_element],</div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;                  Lstar_u_u[nDOF_v_test_element],</div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;                  Lstar_v_v[nDOF_v_test_element],</div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;                  Lstar_w_w[nDOF_v_test_element],</div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;                  Lstar_p_u[nDOF_v_test_element],</div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;                  Lstar_p_v[nDOF_v_test_element],</div>
<div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;                  Lstar_p_w[nDOF_v_test_element],</div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;                  subgridError_p=0.0,</div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;                  subgridError_u=0.0,</div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;                  subgridError_v=0.0,</div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;                  subgridError_w=0.0,</div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;                  tau_p=0.0,tau_p0=0.0,tau_p1=0.0,</div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;                  tau_v=0.0,tau_v0=0.0,tau_v1=0.0,</div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;                  jac[nSpace*nSpace],</div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;                  jacDet,</div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;                  jacInv[nSpace*nSpace],</div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;                  p_grad_trial[nDOF_trial_element*nSpace],vel_grad_trial[nDOF_v_trial_element*nSpace],</div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;                  p_test_dV[nDOF_trial_element],vel_test_dV[nDOF_v_test_element],</div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;                  p_grad_test_dV[nDOF_test_element*nSpace],vel_grad_test_dV[nDOF_v_test_element*nSpace],</div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;                  dV,x,y,<a class="code" href="_headers_8h.html#a9d199fcfc162b9ad09d4c9426e713a74">z</a>,xt,yt,zt,</div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;                  <span class="comment">//</span></div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;                  porosity,</div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;                  <span class="comment">//meanGrainSize,</span></div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;                  mass_source,</div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;                  dmom_u_source[nSpace],</div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;                  dmom_v_source[nSpace],</div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;                  dmom_w_source[nSpace],</div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;                  <span class="comment">//</span></div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;                  G[nSpace*nSpace],G_dd_G,tr_G,norm_Rv,h_phi, dmom_adv_star[nSpace],dmom_adv_sge[nSpace],dmom_ham_grad_sge[nSpace];</div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;                <span class="comment">//get jacobian, etc for mapping reference element</span></div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#aa6183d3c81313639cd5ec6c4697ccdde">gf_s</a>.set_quad(k);</div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a25259ea48a9bc3708796a96164a3b8de">gf</a>.set_quad(k);</div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.calculateMapping_element(eN,</div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;                                            k,</div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;                                            mesh_dof,</div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;                                            mesh_l2g,</div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;                                            mesh_trial_ref,</div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;                                            mesh_grad_trial_ref,</div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;                                            jac,</div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;                                            jacDet,</div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;                                            jacInv,</div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;                                            x,y,<a class="code" href="_headers_8h.html#a9d199fcfc162b9ad09d4c9426e713a74">z</a>);</div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.calculateH_element(eN,</div>
<div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;                                      k,</div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;                                      nodeDiametersArray,</div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;                                      mesh_l2g,</div>
<div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;                                      mesh_trial_ref,</div>
<div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;                                      h_phi);</div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160; </div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.calculateMappingVelocity_element(eN,</div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;                                                    k,</div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;                                                    mesh_velocity_dof,</div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;                                                    mesh_l2g,</div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;                                                    mesh_trial_ref,</div>
<div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;                                                    xt,yt,zt);</div>
<div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;                <span class="comment">//xt=0.0;yt=0.0;zt=0.0;</span></div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;                <span class="comment">//std::cout&lt;&lt;&quot;xt &quot;&lt;&lt;xt&lt;&lt;&#39;\t&#39;&lt;&lt;yt&lt;&lt;&#39;\t&#39;&lt;&lt;zt&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;                <span class="comment">//get the physical integration weight</span></div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;                dV = fabs(jacDet)*dV_ref[k];</div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.calculateG(jacInv,G,G_dd_G,tr_G);</div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;                <span class="comment">//ck.calculateGScale(G,&amp;normal_phi[eN_k_nSpace],h_phi);</span></div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160; </div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;                eps_rho = epsFact_rho*(useMetrics*h_phi+(1.0-useMetrics)*elementDiameter[eN]);</div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;                eps_mu  = epsFact_mu *(useMetrics*h_phi+(1.0-useMetrics)*elementDiameter[eN]);</div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160; </div>
<div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;                <span class="comment">//get the trial function gradients</span></div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.gradTrialFromRef(&amp;p_grad_trial_ref[k*nDOF_trial_element*nSpace],jacInv,p_grad_trial);</div>
<div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a7a7848813d299e5d43a0c4872556a476">ck_v</a>.gradTrialFromRef(&amp;vel_grad_trial_ref[k*nDOF_v_trial_element*nSpace],jacInv,vel_grad_trial);</div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;                <span class="comment">//get the solution</span></div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.valFromDOF(p_dof,&amp;p_l2g[eN_nDOF_trial_element],&amp;p_trial_ref[k*nDOF_trial_element],p);</div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a7a7848813d299e5d43a0c4872556a476">ck_v</a>.valFromDOF(u_dof,&amp;vel_l2g[eN_nDOF_v_trial_element],&amp;vel_trial_ref[k*nDOF_v_trial_element],<a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>);</div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a7a7848813d299e5d43a0c4872556a476">ck_v</a>.valFromDOF(v_dof,&amp;vel_l2g[eN_nDOF_v_trial_element],&amp;vel_trial_ref[k*nDOF_v_trial_element],<a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>);</div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a7a7848813d299e5d43a0c4872556a476">ck_v</a>.valFromDOF(w_dof,&amp;vel_l2g[eN_nDOF_v_trial_element],&amp;vel_trial_ref[k*nDOF_v_trial_element],<a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a>);</div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.valFromDOF(p_old_dof,&amp;p_l2g[eN_nDOF_trial_element],&amp;p_trial_ref[k*nDOF_trial_element],p_old);</div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a7a7848813d299e5d43a0c4872556a476">ck_v</a>.valFromDOF(u_old_dof,&amp;vel_l2g[eN_nDOF_v_trial_element],&amp;vel_trial_ref[k*nDOF_v_trial_element],u_old);</div>
<div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a7a7848813d299e5d43a0c4872556a476">ck_v</a>.valFromDOF(v_old_dof,&amp;vel_l2g[eN_nDOF_v_trial_element],&amp;vel_trial_ref[k*nDOF_v_trial_element],v_old);</div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a7a7848813d299e5d43a0c4872556a476">ck_v</a>.valFromDOF(w_old_dof,&amp;vel_l2g[eN_nDOF_v_trial_element],&amp;vel_trial_ref[k*nDOF_v_trial_element],w_old);</div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;                <span class="comment">//get the solution gradients</span></div>
<div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.gradFromDOF(p_dof,&amp;p_l2g[eN_nDOF_trial_element],p_grad_trial,grad_p);</div>
<div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a7a7848813d299e5d43a0c4872556a476">ck_v</a>.gradFromDOF(u_dof,&amp;vel_l2g[eN_nDOF_v_trial_element],vel_grad_trial,grad_u);</div>
<div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a7a7848813d299e5d43a0c4872556a476">ck_v</a>.gradFromDOF(v_dof,&amp;vel_l2g[eN_nDOF_v_trial_element],vel_grad_trial,grad_v);</div>
<div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a7a7848813d299e5d43a0c4872556a476">ck_v</a>.gradFromDOF(w_dof,&amp;vel_l2g[eN_nDOF_v_trial_element],vel_grad_trial,grad_w);</div>
<div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.gradFromDOF(p_dof,&amp;p_l2g[eN_nDOF_trial_element],p_grad_trial,grad_p_old);</div>
<div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a7a7848813d299e5d43a0c4872556a476">ck_v</a>.gradFromDOF(u_dof,&amp;vel_l2g[eN_nDOF_v_trial_element],vel_grad_trial,grad_u_old);</div>
<div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a7a7848813d299e5d43a0c4872556a476">ck_v</a>.gradFromDOF(v_dof,&amp;vel_l2g[eN_nDOF_v_trial_element],vel_grad_trial,grad_v_old);</div>
<div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a7a7848813d299e5d43a0c4872556a476">ck_v</a>.gradFromDOF(w_dof,&amp;vel_l2g[eN_nDOF_v_trial_element],vel_grad_trial,grad_w_old);</div>
<div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;                <span class="comment">//precalculate test function products with integration weights</span></div>
<div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0;j&lt;nDOF_test_element;j++)</div>
<div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;                  {</div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;                    p_test_dV[j] = p_test_ref[k*nDOF_trial_element+j]*dV;</div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> I=0;I&lt;nSpace;I++)</div>
<div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;                      {</div>
<div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;                        p_grad_test_dV[j*nSpace+I]   = p_grad_trial[j*nSpace+I]*dV;<span class="comment">//assume test_i = trial_i</span></div>
<div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;                      }</div>
<div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;                  }</div>
<div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;                <span class="comment">//precalculate test function products with integration weights</span></div>
<div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0;j&lt;nDOF_v_test_element;j++)</div>
<div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;                  {</div>
<div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;                    vel_test_dV[j] = vel_test_ref[k*nDOF_v_trial_element+j]*dV;</div>
<div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> I=0;I&lt;nSpace;I++)</div>
<div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;                      {</div>
<div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;                        vel_grad_test_dV[j*nSpace+I] = vel_grad_trial[j*nSpace+I]*dV;<span class="comment">//assume test_i = trial_i</span></div>
<div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;                      }</div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;                  }</div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;                <span class="comment">//todo: extend this to higher-order meshes, for now assume mesh trial and p trial are same </span></div>
<div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;                <span class="keywordtype">double</span> div_mesh_velocity=0.0;</div>
<div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0;j&lt;nDOF_trial_element;j++)</div>
<div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;                  {</div>
<div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;                    <span class="keywordtype">int</span> eN_j=eN*nDOF_trial_element+j;</div>
<div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;                    div_mesh_velocity +=</div>
<div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;                      mesh_velocity_dof[mesh_l2g[eN_j]*3+0]*p_grad_trial[j*nSpace+0] +</div>
<div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;                      mesh_velocity_dof[mesh_l2g[eN_j]*3+1]*p_grad_trial[j*nSpace+1] +</div>
<div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;                      mesh_velocity_dof[mesh_l2g[eN_j]*3+2]*p_grad_trial[j*nSpace+2];</div>
<div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;                  }</div>
<div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;                mesh_volume_conservation_element += (alphaBDF*(dV-q_dV_last[eN_k])/dV - div_mesh_velocity)*dV;</div>
<div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;                div_mesh_velocity = <a class="code" href="_r_a_n_s2_p_8h.html#a5c858c7944d8ca1cbd20d6eeb52a1ae3">DM3</a>*div_mesh_velocity + (1.0-<a class="code" href="_r_a_n_s2_p_8h.html#a5c858c7944d8ca1cbd20d6eeb52a1ae3">DM3</a>)*alphaBDF*(dV-q_dV_last[eN_k])/dV;</div>
<div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;                <span class="comment">//VRANS</span></div>
<div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;                porosity      = q_porosity[eN_k];</div>
<div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;                <span class="comment">//meanGrainSize = q_meanGrain[eN_k];</span></div>
<div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;                <span class="comment">//save velocity at quadrature points for other models to use</span></div>
<div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;                q_velocity[eN_k_nSpace+0]=<a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>;</div>
<div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;                q_velocity[eN_k_nSpace+1]=<a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>;</div>
<div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;                q_velocity[eN_k_nSpace+2]=<a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a>;</div>
<div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;                q_x[eN_k_3d+0]=x;</div>
<div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;                q_x[eN_k_3d+1]=y;</div>
<div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;                q_x[eN_k_3d+2]=<a class="code" href="_headers_8h.html#a9d199fcfc162b9ad09d4c9426e713a74">z</a>;</div>
<div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;                <span class="keywordflow">if</span> (use_ball_as_particle == 1)</div>
<div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;                {</div>
<div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;                    <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a3e0cb3084e0e32cc2355384f2e511801">get_distance_to_ball</a>(nParticles, ball_center, ball_radius,x,y,<a class="code" href="_headers_8h.html#a9d199fcfc162b9ad09d4c9426e713a74">z</a>,distance_to_solids[eN_k]);</div>
<div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;                }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;                  <span class="comment">//distance_to_solids is given in Prestep</span></div>
<div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;                }</div>
<div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;                <span class="keywordflow">if</span> (nParticles &gt; 0)</div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;                    phi_solid[eN_k] = distance_to_solids[eN_k];</div>
<div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;                <span class="comment">//calculate pde coefficients at quadrature points</span></div>
<div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#adff72a3cebc8b98398097095827e7aa6">evaluateCoefficients</a>(NONCONSERVATIVE_FORM,</div>
<div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;                                     eps_rho,</div>
<div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;                                     eps_mu,</div>
<div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;                                     sigma,</div>
<div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;                                     <a class="code" href="_error_residual_method_8cpp.html#ae5f5d9edb66645eab31a7c8389493ce7">rho_0</a>,</div>
<div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;                                     <a class="code" href="_error_residual_method_8cpp.html#a383b07af68441ce2b4adaaf8d8cc9d90">nu_0</a>,</div>
<div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;                                     <a class="code" href="_error_residual_method_8cpp.html#a751e53c9d8dfaf696b11b86e0c1b42e9">rho_1</a>,</div>
<div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;                                     <a class="code" href="_error_residual_method_8cpp.html#ae5896ebfee35f22242123e4ae82c81d9">nu_1</a>,</div>
<div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;                                     elementDiameter[eN],</div>
<div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;                                     smagorinskyConstant,</div>
<div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;                                     turbulenceClosureModel,</div>
<div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;                                     g,</div>
<div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;                                     useVF,</div>
<div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;                                     vf[eN_k],</div>
<div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;                                     <a class="code" href="namespaceproteus.html#a17bf106c5df3b1331ed2a18392384813">phi</a>[eN_k],</div>
<div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;                                     &amp;normal_phi[eN_k_nSpace],</div>
<div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;                                     kappa_phi[eN_k],</div>
<div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;                                     <span class="comment">//VRANS</span></div>
<div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;                                     porosity,</div>
<div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;                                     phi_solid[eN_k],<span class="comment">//distance to solid</span></div>
<div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;                                     p_old,</div>
<div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;                                     u_old,</div>
<div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;                                     v_old,</div>
<div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;                                     w_old,</div>
<div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;                                     grad_p_old,</div>
<div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;                                     grad_u_old,</div>
<div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;                                     grad_v_old,</div>
<div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;                                     grad_w_old,</div>
<div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;                                     use_pseudo_penalty,</div>
<div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;                                     <span class="comment">//</span></div>
<div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;                                     p,</div>
<div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;                                     grad_p,</div>
<div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;                                     grad_u,</div>
<div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;                                     grad_v,</div>
<div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;                                     grad_w,</div>
<div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;                                     <a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>,</div>
<div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;                                     <a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>,</div>
<div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;                                     <a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a>,</div>
<div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;                                     LAG_LES,</div>
<div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;                                     q_eddy_viscosity[eN_k],</div>
<div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;                                     q_eddy_viscosity_last[eN_k],</div>
<div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;                                     mom_u_acc,</div>
<div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;                                     dmom_u_acc_u,</div>
<div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;                                     mom_v_acc,</div>
<div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;                                     dmom_v_acc_v,</div>
<div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;                                     mom_w_acc,</div>
<div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;                                     dmom_w_acc_w,</div>
<div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;                                     mass_adv,</div>
<div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;                                     dmass_adv_u,</div>
<div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;                                     dmass_adv_v,</div>
<div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;                                     dmass_adv_w,</div>
<div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;                                     mom_u_adv,</div>
<div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;                                     dmom_u_adv_u,</div>
<div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;                                     dmom_u_adv_v,</div>
<div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;                                     dmom_u_adv_w,</div>
<div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;                                     mom_v_adv,</div>
<div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;                                     dmom_v_adv_u,</div>
<div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;                                     dmom_v_adv_v,</div>
<div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;                                     dmom_v_adv_w,</div>
<div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;                                     mom_w_adv,</div>
<div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;                                     dmom_w_adv_u,</div>
<div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;                                     dmom_w_adv_v,</div>
<div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;                                     dmom_w_adv_w,</div>
<div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;                                     mom_uu_diff_ten,</div>
<div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;                                     mom_vv_diff_ten,</div>
<div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;                                     mom_ww_diff_ten,</div>
<div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;                                     mom_uv_diff_ten,</div>
<div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;                                     mom_uw_diff_ten,</div>
<div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;                                     mom_vu_diff_ten,</div>
<div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;                                     mom_vw_diff_ten,</div>
<div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;                                     mom_wu_diff_ten,</div>
<div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;                                     mom_wv_diff_ten,</div>
<div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;                                     mom_u_source,</div>
<div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;                                     mom_v_source,</div>
<div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;                                     mom_w_source,</div>
<div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;                                     mom_u_ham,</div>
<div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;                                     dmom_u_ham_grad_p,</div>
<div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;                                     dmom_u_ham_grad_u,</div>
<div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;                                     dmom_u_ham_u,</div>
<div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;                                     dmom_u_ham_v,</div>
<div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;                                     dmom_u_ham_w,</div>
<div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;                                     mom_v_ham,</div>
<div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;                                     dmom_v_ham_grad_p,</div>
<div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;                                     dmom_v_ham_grad_v,</div>
<div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;                                     dmom_v_ham_u,</div>
<div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;                                     dmom_v_ham_v,</div>
<div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;                                     dmom_v_ham_w,</div>
<div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;                                     mom_w_ham,</div>
<div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;                                     dmom_w_ham_grad_p,</div>
<div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;                                     dmom_w_ham_grad_w,</div>
<div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;                                     dmom_w_ham_u,</div>
<div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;                                     dmom_w_ham_v,</div>
<div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;                                     dmom_w_ham_w,</div>
<div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;                                     q_rho[eN_k],</div>
<div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;                                     forcex[eN_k],</div>
<div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;                                     forcey[eN_k],</div>
<div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;                                     forcez[eN_k]);</div>
<div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;                <span class="comment">//VRANS</span></div>
<div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;                mass_source = q_mass_source[eN_k];</div>
<div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;                <span class="comment">//todo: decide if these should be lagged or not?</span></div>
<div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#ad2e43c8a8d5e8cbaf4434992e9bf9a7d">updateDarcyForchheimerTerms_Ergun</a>(NONCONSERVATIVE_FORM,</div>
<div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;                                                  <span class="comment">/* linearDragFactor, */</span></div>
<div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;                                                  <span class="comment">/* nonlinearDragFactor, */</span></div>
<div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;                                                  <span class="comment">/* porosity, */</span></div>
<div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;                                                  <span class="comment">/* meanGrainSize, */</span></div>
<div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;                                                  q_dragAlpha[eN_k],</div>
<div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;                                                  q_dragBeta[eN_k],</div>
<div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;                                                  eps_rho,</div>
<div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;                                                  eps_mu,</div>
<div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;                                                  <a class="code" href="_error_residual_method_8cpp.html#ae5f5d9edb66645eab31a7c8389493ce7">rho_0</a>,</div>
<div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;                                                  <a class="code" href="_error_residual_method_8cpp.html#a383b07af68441ce2b4adaaf8d8cc9d90">nu_0</a>,</div>
<div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;                                                  <a class="code" href="_error_residual_method_8cpp.html#a751e53c9d8dfaf696b11b86e0c1b42e9">rho_1</a>,</div>
<div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;                                                  <a class="code" href="_error_residual_method_8cpp.html#ae5896ebfee35f22242123e4ae82c81d9">nu_1</a>,</div>
<div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;                                                  useVF,</div>
<div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;                                                  vf[eN_k],</div>
<div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;                                                  <a class="code" href="namespaceproteus.html#a17bf106c5df3b1331ed2a18392384813">phi</a>[eN_k],</div>
<div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;                                                  <a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>,</div>
<div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;                                                  <a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>,</div>
<div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;                                                  <a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a>,</div>
<div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;                                                  q_velocity_sge[eN_k_nSpace+0],</div>
<div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;                                                  q_velocity_sge[eN_k_nSpace+1],</div>
<div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;                                                  q_velocity_sge[eN_k_nSpace+2],</div>
<div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;                                                  eps_solid[elementFlags[eN]],</div>
<div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;                                                  phi_solid[eN_k],</div>
<div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;                                                  q_velocity_solid[eN_k_nSpace+0],</div>
<div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;                                                  q_velocity_solid[eN_k_nSpace+1],</div>
<div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;                                                  q_velocity_solid[eN_k_nSpace+2],</div>
<div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;                                                  mom_u_source,</div>
<div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;                                                  mom_v_source,</div>
<div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;                                                  mom_w_source,</div>
<div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;                                                  dmom_u_source,</div>
<div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;                                                  dmom_v_source,</div>
<div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;                                                  dmom_w_source);</div>
<div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160; </div>
<div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">double</span> particle_eps  = particle_epsFact*(useMetrics*h_phi+(1.0-useMetrics)*elementDiameter[eN]);</div>
<div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;                <span class="keywordflow">if</span>(nParticles &gt; 0)</div>
<div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;                  <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#ae66ab530966d1d5fbc2e170ef698a4f3">updateSolidParticleTerms</a>(NONCONSERVATIVE_FORM,</div>
<div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;                                           eN &lt; nElements_owned,</div>
<div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;                                           particle_nitsche,</div>
<div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;                                           dV,</div>
<div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;                                           nParticles,</div>
<div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;                                           nQuadraturePoints_global,</div>
<div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;                                           &amp;particle_signed_distances[eN_k],</div>
<div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;                                           &amp;particle_signed_distance_normals[eN_k_3d],</div>
<div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;                                           &amp;particle_velocities[eN_k_3d],</div>
<div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;                                           particle_centroids,</div>
<div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;                                           use_ball_as_particle,</div>
<div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;                                           ball_center,</div>
<div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;                                           ball_radius,</div>
<div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;                                           ball_velocity,</div>
<div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;                                           ball_angular_velocity,</div>
<div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;                                           ball_center_acceleration,</div>
<div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;                                           ball_angular_acceleration,</div>
<div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;                                           ball_density,</div>
<div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;                                           porosity,</div>
<div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;                                           particle_penalty_constant/h_phi,<span class="comment">//penalty,</span></div>
<div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;                                           particle_alpha,</div>
<div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;                                           particle_beta,</div>
<div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;                                           eps_rho,</div>
<div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;                                           eps_mu,</div>
<div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;                                           <a class="code" href="_error_residual_method_8cpp.html#ae5f5d9edb66645eab31a7c8389493ce7">rho_0</a>,</div>
<div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;                                           <a class="code" href="_error_residual_method_8cpp.html#a383b07af68441ce2b4adaaf8d8cc9d90">nu_0</a>,</div>
<div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;                                           <a class="code" href="_error_residual_method_8cpp.html#a751e53c9d8dfaf696b11b86e0c1b42e9">rho_1</a>,</div>
<div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;                                           <a class="code" href="_error_residual_method_8cpp.html#ae5896ebfee35f22242123e4ae82c81d9">nu_1</a>,</div>
<div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;                                           useVF,</div>
<div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;                                           vf[eN_k],</div>
<div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;                                           <a class="code" href="namespaceproteus.html#a17bf106c5df3b1331ed2a18392384813">phi</a>[eN_k],</div>
<div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;                                           x,</div>
<div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;                                           y,</div>
<div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;                                           <a class="code" href="_headers_8h.html#a9d199fcfc162b9ad09d4c9426e713a74">z</a>,</div>
<div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;                                           p,</div>
<div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;                                           <a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>,</div>
<div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;                                           <a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>,</div>
<div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;                                           <a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a>,</div>
<div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;                                           q_velocity_sge[eN_k_nSpace+0],</div>
<div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;                                           q_velocity_sge[eN_k_nSpace+1],</div>
<div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;                                           q_velocity_sge[eN_k_nSpace+1],</div>
<div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;                                           particle_eps,</div>
<div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;                                           grad_u,</div>
<div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;                                           grad_v,</div>
<div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;                                           grad_w,</div>
<div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;                                           mom_u_source,</div>
<div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;                                           mom_v_source,</div>
<div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;                                           mom_w_source,</div>
<div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;                                           dmom_u_source,</div>
<div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;                                           dmom_v_source,</div>
<div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;                                           dmom_w_source,</div>
<div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;                                           mom_u_adv,</div>
<div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;                                           mom_v_adv,</div>
<div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;                                           mom_w_adv,</div>
<div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;                                           dmom_u_adv_u,</div>
<div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;                                           dmom_v_adv_v,</div>
<div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;                                           dmom_w_adv_w,</div>
<div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;                                           mom_u_ham,</div>
<div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;                                           dmom_u_ham_grad_u,</div>
<div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;                                           dmom_u_ham_u,</div>
<div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;                                           dmom_u_ham_v,</div>
<div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;                                           dmom_u_ham_w,</div>
<div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;                                           mom_v_ham,</div>
<div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;                                           dmom_v_ham_grad_v,</div>
<div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;                                           dmom_v_ham_u,</div>
<div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;                                           dmom_v_ham_v,</div>
<div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;                                           dmom_v_ham_w,</div>
<div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;                                           mom_w_ham,</div>
<div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;                                           dmom_w_ham_grad_w,</div>
<div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;                                           dmom_w_ham_u,</div>
<div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;                                           dmom_w_ham_v,</div>
<div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;                                           dmom_w_ham_w,</div>
<div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;                                           mass_ham,</div>
<div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;                                           dmass_ham_u,</div>
<div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;                                           dmass_ham_v,</div>
<div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;                                           dmass_ham_w,</div>
<div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;                                           &amp;particle_netForces[0],</div>
<div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;                                           &amp;particle_netMoments[0],</div>
<div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;                                           &amp;particle_surfaceArea[0],</div>
<div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;                                           use_pseudo_penalty);</div>
<div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;                <span class="comment">//Turbulence closure model</span></div>
<div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;                <span class="keywordflow">if</span> (turbulenceClosureModel &gt;= 3)</div>
<div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;                  {</div>
<div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;                    <span class="keyword">const</span> <span class="keywordtype">double</span> c_mu = 0.09;<span class="comment">//mwf hack</span></div>
<div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;                    <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#aab46065ecbde76bd2d9ef320ad287b76">updateTurbulenceClosure</a>(NONCONSERVATIVE_FORM,</div>
<div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;                                            turbulenceClosureModel,</div>
<div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;                                            eps_rho,</div>
<div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;                                            eps_mu,</div>
<div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;                                            <a class="code" href="_error_residual_method_8cpp.html#ae5f5d9edb66645eab31a7c8389493ce7">rho_0</a>,</div>
<div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;                                            <a class="code" href="_error_residual_method_8cpp.html#a383b07af68441ce2b4adaaf8d8cc9d90">nu_0</a>,</div>
<div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;                                            <a class="code" href="_error_residual_method_8cpp.html#a751e53c9d8dfaf696b11b86e0c1b42e9">rho_1</a>,</div>
<div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;                                            <a class="code" href="_error_residual_method_8cpp.html#ae5896ebfee35f22242123e4ae82c81d9">nu_1</a>,</div>
<div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;                                            useVF,</div>
<div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;                                            vf[eN_k],</div>
<div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;                                            <a class="code" href="namespaceproteus.html#a17bf106c5df3b1331ed2a18392384813">phi</a>[eN_k],</div>
<div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;                                            porosity,</div>
<div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;                                            c_mu, <span class="comment">//mwf hack</span></div>
<div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;                                            q_turb_var_0[eN_k],</div>
<div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;                                            q_turb_var_1[eN_k],</div>
<div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;                                            &amp;q_turb_var_grad_0[eN_k_nSpace],</div>
<div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;                                            q_eddy_viscosity[eN_k],</div>
<div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;                                            mom_uu_diff_ten,</div>
<div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;                                            mom_vv_diff_ten,</div>
<div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;                                            mom_ww_diff_ten,</div>
<div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;                                            mom_uv_diff_ten,</div>
<div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;                                            mom_uw_diff_ten,</div>
<div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;                                            mom_vu_diff_ten,</div>
<div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;                                            mom_vw_diff_ten,</div>
<div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160;                                            mom_wu_diff_ten,</div>
<div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;                                            mom_wv_diff_ten,</div>
<div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;                                            mom_u_source,</div>
<div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;                                            mom_v_source,</div>
<div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;                                            mom_w_source);</div>
<div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160; </div>
<div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;                  }</div>
<div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;                <span class="comment">//save momentum for time history and velocity for subgrid error</span></div>
<div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;                q_mom_u_acc[eN_k] = mom_u_acc;</div>
<div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;                q_mom_v_acc[eN_k] = mom_v_acc;</div>
<div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;                q_mom_w_acc[eN_k] = mom_w_acc;</div>
<div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;                <span class="comment">//subgrid error uses grid scale velocity</span></div>
<div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;                q_mass_adv[eN_k_nSpace+0] = <a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>;</div>
<div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;                q_mass_adv[eN_k_nSpace+1] = <a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>;</div>
<div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;                q_mass_adv[eN_k_nSpace+2] = <a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a>;</div>
<div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;                <span class="comment">//moving mesh</span></div>
<div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;                <span class="keywordflow">if</span> (NONCONSERVATIVE_FORM &gt; 0.0)</div>
<div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;                  {</div>
<div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;                    mom_u_ham -= MOVING_DOMAIN*dmom_u_acc_u*(grad_u[0]*xt + grad_u[1]*yt + grad_u[2]*zt);</div>
<div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;                    dmom_u_ham_grad_u[0] -= MOVING_DOMAIN*dmom_u_acc_u*xt;</div>
<div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;                    dmom_u_ham_grad_u[1] -= MOVING_DOMAIN*dmom_u_acc_u*yt;</div>
<div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;                    dmom_u_ham_grad_u[2] -= MOVING_DOMAIN*dmom_u_acc_u*zt;</div>
<div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;                  }</div>
<div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;                  {</div>
<div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;                    mom_u_adv[0] -= MOVING_DOMAIN*mom_u_acc*xt;</div>
<div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;                    mom_u_adv[1] -= MOVING_DOMAIN*mom_u_acc*yt;</div>
<div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;                    mom_u_adv[2] -= MOVING_DOMAIN*mom_u_acc*zt;</div>
<div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;                    dmom_u_adv_u[0] -= MOVING_DOMAIN*dmom_u_acc_u*xt;</div>
<div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;                    dmom_u_adv_u[1] -= MOVING_DOMAIN*dmom_u_acc_u*yt;</div>
<div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;                    dmom_u_adv_u[2] -= MOVING_DOMAIN*dmom_u_acc_u*zt;</div>
<div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;                  }</div>
<div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160; </div>
<div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;                <span class="keywordflow">if</span> (NONCONSERVATIVE_FORM &gt; 0.0)</div>
<div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;                  {</div>
<div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;                    mom_v_ham -= MOVING_DOMAIN*dmom_v_acc_v*(grad_v[0]*xt + grad_v[1]*yt + grad_v[2]*zt);</div>
<div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;                    dmom_v_ham_grad_v[0] -= MOVING_DOMAIN*dmom_v_acc_v*xt;</div>
<div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;                    dmom_v_ham_grad_v[1] -= MOVING_DOMAIN*dmom_v_acc_v*yt;</div>
<div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;                    dmom_v_ham_grad_v[2] -= MOVING_DOMAIN*dmom_v_acc_v*zt;</div>
<div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;                  }</div>
<div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;                  {</div>
<div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;                    mom_v_adv[0] -= MOVING_DOMAIN*mom_v_acc*xt;</div>
<div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;                    mom_v_adv[1] -= MOVING_DOMAIN*mom_v_acc*yt;</div>
<div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;                    mom_v_adv[2] -= MOVING_DOMAIN*mom_v_acc*zt;</div>
<div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;                    dmom_v_adv_v[0] -= MOVING_DOMAIN*dmom_v_acc_v*xt;</div>
<div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;                    dmom_v_adv_v[1] -= MOVING_DOMAIN*dmom_v_acc_v*yt;</div>
<div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;                    dmom_v_adv_v[2] -= MOVING_DOMAIN*dmom_v_acc_v*zt;</div>
<div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;                  }</div>
<div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160; </div>
<div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;                <span class="keywordflow">if</span> (NONCONSERVATIVE_FORM &gt; 0.0)</div>
<div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;                  {</div>
<div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;                    mom_w_ham -= MOVING_DOMAIN*dmom_w_acc_w*(grad_w[0]*xt + grad_w[1]*yt + grad_w[2]*zt);</div>
<div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;                    dmom_w_ham_grad_w[0] -= MOVING_DOMAIN*dmom_w_acc_w*xt;</div>
<div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;                    dmom_w_ham_grad_w[1] -= MOVING_DOMAIN*dmom_w_acc_w*yt;</div>
<div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;                    dmom_w_ham_grad_w[2] -= MOVING_DOMAIN*dmom_w_acc_w*zt;</div>
<div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;                  }</div>
<div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;                  {</div>
<div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;                    mom_w_adv[0] -= MOVING_DOMAIN*mom_w_acc*xt;</div>
<div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;                    mom_w_adv[1] -= MOVING_DOMAIN*mom_w_acc*yt;</div>
<div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;                    mom_w_adv[2] -= MOVING_DOMAIN*mom_w_acc*zt;</div>
<div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;                    dmom_w_adv_w[0] -= MOVING_DOMAIN*dmom_w_acc_w*xt;</div>
<div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160;                    dmom_w_adv_w[1] -= MOVING_DOMAIN*dmom_w_acc_w*yt;</div>
<div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160;                    dmom_w_adv_w[2] -= MOVING_DOMAIN*dmom_w_acc_w*zt;</div>
<div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160;                  }</div>
<div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;                <span class="comment">//calculate time derivative at quadrature points</span></div>
<div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;                <span class="keywordflow">if</span> (q_dV_last[eN_k] &lt;= -100)</div>
<div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;                  q_dV_last[eN_k] = dV;</div>
<div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;                q_dV[eN_k] = dV;</div>
<div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.bdf(alphaBDF,</div>
<div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;                       q_mom_u_acc_beta_bdf[eN_k]*q_dV_last[eN_k]/dV,</div>
<div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;                       mom_u_acc,</div>
<div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;                       dmom_u_acc_u,</div>
<div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;                       mom_u_acc_t,</div>
<div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;                       dmom_u_acc_u_t);</div>
<div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.bdf(alphaBDF,</div>
<div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;                       q_mom_v_acc_beta_bdf[eN_k]*q_dV_last[eN_k]/dV,</div>
<div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;                       mom_v_acc,</div>
<div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;                       dmom_v_acc_v,</div>
<div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;                       mom_v_acc_t,</div>
<div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;                       dmom_v_acc_v_t);</div>
<div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.bdf(alphaBDF,</div>
<div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;                       q_mom_w_acc_beta_bdf[eN_k]*q_dV_last[eN_k]/dV,</div>
<div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;                       mom_w_acc,</div>
<div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;                       dmom_w_acc_w,</div>
<div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;                       mom_w_acc_t,</div>
<div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;                       dmom_w_acc_w_t);</div>
<div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;                <span class="keywordflow">if</span>(use_pseudo_penalty &gt; 0 &amp;&amp; phi_solid[eN_k]&lt;0.0)<span class="comment">//Do not have to change Jacobian</span></div>
<div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;                {</div>
<div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;                  <span class="keywordtype">double</span> distance,<a class="code" href="_headers_8h.html#ae920d60831fd60b11f1b758a12e87eff">vx</a>,<a class="code" href="_headers_8h.html#a9891a031d6c4d31d28333ae6e6f6b746">vy</a>,vz;</div>
<div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;                  <span class="keywordtype">int</span> index_ball = <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a3e0cb3084e0e32cc2355384f2e511801">get_distance_to_ball</a>(nParticles, ball_center, ball_radius,x,y,<a class="code" href="_headers_8h.html#a9d199fcfc162b9ad09d4c9426e713a74">z</a>,distance);</div>
<div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160;                  <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a93a1c0a9daf704bd52b3d1416ffbe58a">get_velocity_to_ith_ball</a>(nParticles,ball_center,ball_radius,ball_velocity,ball_angular_velocity,index_ball,x,y,<a class="code" href="_headers_8h.html#a9d199fcfc162b9ad09d4c9426e713a74">z</a>,<a class="code" href="_headers_8h.html#ae920d60831fd60b11f1b758a12e87eff">vx</a>,<a class="code" href="_headers_8h.html#a9891a031d6c4d31d28333ae6e6f6b746">vy</a>,vz);</div>
<div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;                  mom_u_acc_t = alphaBDF*(mom_u_acc - <a class="code" href="_headers_8h.html#ae920d60831fd60b11f1b758a12e87eff">vx</a>);</div>
<div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;                  mom_v_acc_t = alphaBDF*(mom_v_acc - <a class="code" href="_headers_8h.html#a9891a031d6c4d31d28333ae6e6f6b746">vy</a>);</div>
<div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;                  mom_w_acc_t = alphaBDF*(mom_w_acc - vz);</div>
<div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;                }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(use_pseudo_penalty == -1 &amp;&amp; phi_solid[eN_k]&lt;0.0)<span class="comment">//no derivative term inside the solid; Has to change Jacobian</span></div>
<div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160;                {</div>
<div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;                  mom_u_acc_t = 0.0;</div>
<div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;                  mom_v_acc_t = 0.0;</div>
<div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160;                  mom_w_acc_t = 0.0;</div>
<div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160;                  dmom_u_acc_u= 0.0;</div>
<div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;                  dmom_v_acc_v= 0.0;</div>
<div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160;                  dmom_w_acc_w= 0.0;</div>
<div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160;                }</div>
<div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;                <span class="keywordflow">if</span> (NONCONSERVATIVE_FORM &gt; 0.0)</div>
<div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;                  {</div>
<div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160;                    mom_u_acc_t *= dmom_u_acc_u;</div>
<div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160;                    mom_v_acc_t *= dmom_v_acc_v;</div>
<div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;                    mom_w_acc_t *= dmom_w_acc_w;</div>
<div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;                  }</div>
<div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160;                <span class="comment">//calculate subgrid error (strong residual and adjoint)</span></div>
<div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160;                <span class="comment">//calculate strong residual</span></div>
<div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160;                pdeResidual_p = <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Advection_strong(dmass_adv_u,grad_u) +</div>
<div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160;                  <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Advection_strong(dmass_adv_v,grad_v) +</div>
<div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160;                  <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Advection_strong(dmass_adv_w,grad_w) +</div>
<div class="line"><a name="l03255"></a><span class="lineno"> 3255</span>&#160;                  <a class="code" href="_r_a_n_s2_p_8h.html#af4c90b58f2b5c70d46004521b792f727">DM2</a>*MOVING_DOMAIN*<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Reaction_strong(alphaBDF*(dV-q_dV_last[eN_k])/dV - div_mesh_velocity) +</div>
<div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160;                  <span class="comment">//VRANS</span></div>
<div class="line"><a name="l03257"></a><span class="lineno"> 3257</span>&#160;                  <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Reaction_strong(mass_source);</div>
<div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;                <span class="keywordflow">if</span> (NONCONSERVATIVE_FORM &gt; 0.0)</div>
<div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160;                  {</div>
<div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;                    dmom_adv_sge[0] = 0.0;</div>
<div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;                    dmom_adv_sge[1] = 0.0;</div>
<div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;                    dmom_adv_sge[2] = 0.0;</div>
<div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;                    dmom_ham_grad_sge[0] = dmom_u_acc_u*(q_velocity_sge[eN_k_nSpace+0] - MOVING_DOMAIN*xt);</div>
<div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;                    dmom_ham_grad_sge[1] = dmom_u_acc_u*(q_velocity_sge[eN_k_nSpace+1] - MOVING_DOMAIN*yt);</div>
<div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;                    dmom_ham_grad_sge[2] = dmom_u_acc_u*(q_velocity_sge[eN_k_nSpace+2] - MOVING_DOMAIN*zt);</div>
<div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;                  }</div>
<div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160;                  {</div>
<div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;                    dmom_adv_sge[0] = dmom_u_acc_u*(q_velocity_sge[eN_k_nSpace+0] - MOVING_DOMAIN*xt);</div>
<div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;                    dmom_adv_sge[1] = dmom_u_acc_u*(q_velocity_sge[eN_k_nSpace+1] - MOVING_DOMAIN*yt);</div>
<div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;                    dmom_adv_sge[2] = dmom_u_acc_u*(q_velocity_sge[eN_k_nSpace+2] - MOVING_DOMAIN*zt);</div>
<div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;                    dmom_ham_grad_sge[0] = 0.0;</div>
<div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;                    dmom_ham_grad_sge[1] = 0.0;</div>
<div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160;                    dmom_ham_grad_sge[2] = 0.0;</div>
<div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;                  }</div>
<div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160;                <span class="keywordtype">double</span> mv_tau[nSpace];</div>
<div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160;                mv_tau[0] = dmom_adv_sge[0] + dmom_ham_grad_sge[0];</div>
<div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;                mv_tau[1] = dmom_adv_sge[1] + dmom_ham_grad_sge[1];</div>
<div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;                mv_tau[2] = dmom_adv_sge[2] + dmom_ham_grad_sge[2];</div>
<div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160; </div>
<div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;                pdeResidual_u = <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Mass_strong(mom_u_acc_t) +</div>
<div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;                  <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Advection_strong(dmom_adv_sge,grad_u) +</div>
<div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160;                  <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Hamiltonian_strong(dmom_ham_grad_sge,grad_u) +</div>
<div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160;                  <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Hamiltonian_strong(dmom_u_ham_grad_p,grad_p) +</div>
<div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;                  <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Reaction_strong(mom_u_source) -</div>
<div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;                  <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Reaction_strong(dmom_u_acc_u*<a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>*div_mesh_velocity);</div>
<div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160; </div>
<div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160;                pdeResidual_v = <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Mass_strong(mom_v_acc_t) +</div>
<div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;                  <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Advection_strong(dmom_adv_sge,grad_v) +</div>
<div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;                  <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Hamiltonian_strong(dmom_ham_grad_sge,grad_v) +</div>
<div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160;                  <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Hamiltonian_strong(dmom_v_ham_grad_p,grad_p) +</div>
<div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;                  <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Reaction_strong(mom_v_source) -</div>
<div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160;                  <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Reaction_strong(dmom_v_acc_v*<a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>*div_mesh_velocity);</div>
<div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160; </div>
<div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160;                pdeResidual_w = <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Mass_strong(mom_w_acc_t) +</div>
<div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;                  <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Advection_strong(dmom_adv_sge,grad_w) +</div>
<div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160;                  <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Hamiltonian_strong(dmom_ham_grad_sge,grad_w) +</div>
<div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160;                  <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Hamiltonian_strong(dmom_w_ham_grad_p,grad_p) +</div>
<div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160;                  <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Reaction_strong(mom_w_source) -</div>
<div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;                  <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Reaction_strong(dmom_w_acc_w*<a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a>*div_mesh_velocity);</div>
<div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160; </div>
<div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;                <span class="comment">//calculate tau and tau*Res</span></div>
<div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160;                <span class="comment">//add contributions from mass and source terms</span></div>
<div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160;                <span class="keywordtype">double</span> tmpR=dmom_u_acc_u_t + dmom_u_source[0];</div>
<div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#addf5cd3a254683dcee98d02fc43cd5f7">calculateSubgridError_tau</a>(hFactor,</div>
<div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;                                          elementDiameter[eN],</div>
<div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160;                                          tmpR,<span class="comment">//dmom_u_acc_u_t,</span></div>
<div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;                                          dmom_u_acc_u,</div>
<div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;                                          mv_tau,<span class="comment">//dmom_adv_sge,</span></div>
<div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160;                                          mom_uu_diff_ten[1],</div>
<div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160;                                          dmom_u_ham_grad_p[0],</div>
<div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160;                                          tau_v0,</div>
<div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160;                                          tau_p0,</div>
<div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;                                          q_cfl[eN_k]);</div>
<div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160; </div>
<div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#addf5cd3a254683dcee98d02fc43cd5f7">calculateSubgridError_tau</a>(Ct_sge,Cd_sge,</div>
<div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160;                                          G,G_dd_G,tr_G,</div>
<div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160;                                          tmpR,<span class="comment">//dmom_u_acc_u_t,</span></div>
<div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;                                          mv_tau,<span class="comment">//dmom_adv_sge,</span></div>
<div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;                                          mom_uu_diff_ten[1],</div>
<div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;                                          dmom_u_ham_grad_p[0],</div>
<div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;                                          tau_v1,</div>
<div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;                                          tau_p1,</div>
<div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;                                          q_cfl[eN_k]);</div>
<div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160; </div>
<div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;                tau_v = useMetrics*tau_v1+(1.0-useMetrics)*tau_v0;</div>
<div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;                tau_p = useMetrics*tau_p1+(1.0-useMetrics)*tau_p0;</div>
<div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160; </div>
<div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#acf8d86d92ac9b99a31df36acfc6fece3">calculateSubgridError_tauRes</a>(tau_p,</div>
<div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;                                             tau_v,</div>
<div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160;                                             pdeResidual_p,</div>
<div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;                                             pdeResidual_u,</div>
<div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;                                             pdeResidual_v,</div>
<div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160;                                             pdeResidual_w,</div>
<div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;                                             subgridError_p,</div>
<div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;                                             subgridError_u,</div>
<div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;                                             subgridError_v,</div>
<div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160;                                             subgridError_w);</div>
<div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160;                <span class="comment">// velocity used in adjoint (VMS or RBLES, with or without lagging the grid scale velocity)</span></div>
<div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;                dmom_adv_star[0] = dmom_u_acc_u*(q_velocity_sge[eN_k_nSpace+0] - MOVING_DOMAIN*xt + useRBLES*subgridError_u);</div>
<div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160;                dmom_adv_star[1] = dmom_u_acc_u*(q_velocity_sge[eN_k_nSpace+1] - MOVING_DOMAIN*yt + useRBLES*subgridError_v);</div>
<div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;                dmom_adv_star[2] = dmom_u_acc_u*(q_velocity_sge[eN_k_nSpace+2] - MOVING_DOMAIN*zt + useRBLES*subgridError_w);</div>
<div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160; </div>
<div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160;                mom_u_adv[0] += dmom_u_acc_u*(useRBLES*subgridError_u*q_velocity_sge[eN_k_nSpace+0]);</div>
<div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;                mom_u_adv[1] += dmom_u_acc_u*(useRBLES*subgridError_v*q_velocity_sge[eN_k_nSpace+0]);</div>
<div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160;                mom_u_adv[2] += dmom_u_acc_u*(useRBLES*subgridError_w*q_velocity_sge[eN_k_nSpace+0]);</div>
<div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160; </div>
<div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160;                mom_v_adv[0] += dmom_u_acc_u*(useRBLES*subgridError_u*q_velocity_sge[eN_k_nSpace+1]);</div>
<div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;                mom_v_adv[1] += dmom_u_acc_u*(useRBLES*subgridError_v*q_velocity_sge[eN_k_nSpace+1]);</div>
<div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;                mom_v_adv[2] += dmom_u_acc_u*(useRBLES*subgridError_w*q_velocity_sge[eN_k_nSpace+1]);</div>
<div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160; </div>
<div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;                mom_w_adv[0] += dmom_u_acc_u*(useRBLES*subgridError_u*q_velocity_sge[eN_k_nSpace+2]);</div>
<div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;                mom_w_adv[1] += dmom_u_acc_u*(useRBLES*subgridError_v*q_velocity_sge[eN_k_nSpace+2]);</div>
<div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;                mom_w_adv[2] += dmom_u_acc_u*(useRBLES*subgridError_w*q_velocity_sge[eN_k_nSpace+2]);</div>
<div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160; </div>
<div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;                <span class="comment">// adjoint times the test functions</span></div>
<div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;nDOF_test_element;i++)</div>
<div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160;                  {</div>
<div class="line"><a name="l03360"></a><span class="lineno"> 3360</span>&#160;                    <span class="keyword">register</span> <span class="keywordtype">int</span> i_nSpace = i*nSpace;</div>
<div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;                    Lstar_u_p[i]=<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Advection_adjoint(dmass_adv_u,&amp;p_grad_test_dV[i_nSpace]);</div>
<div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;                    Lstar_v_p[i]=<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Advection_adjoint(dmass_adv_v,&amp;p_grad_test_dV[i_nSpace]);</div>
<div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160;                    Lstar_w_p[i]=<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Advection_adjoint(dmass_adv_w,&amp;p_grad_test_dV[i_nSpace]);</div>
<div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;                  }</div>
<div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;nDOF_v_test_element;i++)</div>
<div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160;                  {</div>
<div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160;                    <span class="keyword">register</span> <span class="keywordtype">int</span> i_nSpace = i*nSpace;</div>
<div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160;                    <span class="comment">//use the same advection adjoint for all three since we&#39;re approximating the linearized adjoint</span></div>
<div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160;                    Lstar_u_u[i]=<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Advection_adjoint(dmom_adv_star,&amp;vel_grad_test_dV[i_nSpace]);<span class="comment">//cek COMP/INCOMP form have same adjoint</span></div>
<div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160;                    Lstar_v_v[i]=<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Advection_adjoint(dmom_adv_star,&amp;vel_grad_test_dV[i_nSpace]);<span class="comment">//ditto</span></div>
<div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160;                    Lstar_w_w[i]=<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Advection_adjoint(dmom_adv_star,&amp;vel_grad_test_dV[i_nSpace]);<span class="comment">//ditto</span></div>
<div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160;                    Lstar_p_u[i]=<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Hamiltonian_adjoint(dmom_u_ham_grad_p,&amp;vel_grad_test_dV[i_nSpace]);</div>
<div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160;                    Lstar_p_v[i]=<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Hamiltonian_adjoint(dmom_v_ham_grad_p,&amp;vel_grad_test_dV[i_nSpace]);</div>
<div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;                    Lstar_p_w[i]=<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Hamiltonian_adjoint(dmom_w_ham_grad_p,&amp;vel_grad_test_dV[i_nSpace]);</div>
<div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160; </div>
<div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;                    <span class="comment">//VRANS account for drag terms, diagonal only here ... decide if need off diagonal terms too</span></div>
<div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160;                    Lstar_u_u[i]+=<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Reaction_adjoint(dmom_u_source[0],vel_test_dV[i]);</div>
<div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160;                    Lstar_v_v[i]+=<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Reaction_adjoint(dmom_v_source[1],vel_test_dV[i]);</div>
<div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160;                    Lstar_w_w[i]+=<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Reaction_adjoint(dmom_w_source[2],vel_test_dV[i]);</div>
<div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;                  }</div>
<div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160; </div>
<div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;                norm_Rv = sqrt(pdeResidual_u*pdeResidual_u + pdeResidual_v*pdeResidual_v + pdeResidual_w*pdeResidual_w);</div>
<div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;                q_numDiff_u[eN_k] = C_dc*norm_Rv*(useMetrics/sqrt(G_dd_G+1.0e-12)  +</div>
<div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160;                                                  (1.0-useMetrics)*hFactor*hFactor*elementDiameter[eN]*elementDiameter[eN]);</div>
<div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;                q_numDiff_v[eN_k] = q_numDiff_u[eN_k];</div>
<div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160;                q_numDiff_w[eN_k] = q_numDiff_u[eN_k];</div>
<div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;                <span class="comment">//update element residual</span></div>
<div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;                <span class="keywordtype">double</span> mesh_vel[3];</div>
<div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160;                mesh_vel[0] = xt;</div>
<div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;                mesh_vel[1] = yt;</div>
<div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160;                mesh_vel[2] = zt;</div>
<div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;nDOF_test_element;i++)</div>
<div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160;                  {</div>
<div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160;                    <span class="keyword">register</span> <span class="keywordtype">int</span> i_nSpace=i*nSpace;</div>
<div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160;                    <span class="comment">/* std::cout&lt;&lt;&quot;elemRes_mesh &quot;&lt;&lt;mesh_vel[0]&lt;&lt;&#39;\t&#39;&lt;&lt;mesh_vel[2]&lt;&lt;&#39;\t&#39;&lt;&lt;p_test_dV[i]&lt;&lt;&#39;\t&#39;&lt;&lt;(q_dV_last[eN_k]/dV)&lt;&lt;&#39;\t&#39;&lt;&lt;dV&lt;&lt;std::endl; */</span></div>
<div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160;                    elementResidual_mesh[i] += <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Reaction_weak(1.0,p_test_dV[i]) -</div>
<div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;                      <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Reaction_weak(1.0,p_test_dV[i]*q_dV_last[eN_k]/dV) -</div>
<div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160;                      <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Advection_weak(mesh_vel,&amp;p_grad_test_dV[i_nSpace]);</div>
<div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160; </div>
<div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160;                    elementResidual_p[i] += <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Advection_weak(mass_adv,&amp;p_grad_test_dV[i_nSpace])</div>
<div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160;                      + <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Hamiltonian_weak(mass_ham, p_test_dV[i])</div>
<div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;                      + <a class="code" href="_r_a_n_s2_p_8h.html#aaef02b6e1d46c51958a20651954c60b0">DM</a>*MOVING_DOMAIN*(<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Reaction_weak(alphaBDF*1.0,p_test_dV[i]) -</div>
<div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160;                                        <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Reaction_weak(alphaBDF*1.0,p_test_dV[i]*q_dV_last[eN_k]/dV) -</div>
<div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160;                                        <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Advection_weak(mesh_vel,&amp;p_grad_test_dV[i_nSpace])) +</div>
<div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160;                      <span class="comment">//VRANS</span></div>
<div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160;                      <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Reaction_weak(mass_source,p_test_dV[i]); <span class="comment">//VRANS source term for wave maker</span></div>
<div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160;                      <span class="comment">//</span></div>
<div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160;                    <span class="keywordflow">if</span> (nDOF_test_element == nDOF_v_test_element)</div>
<div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160;                      {</div>
<div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;                        elementResidual_p[i] +=</div>
<div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.SubgridError(subgridError_u,Lstar_u_p[i]) +</div>
<div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.SubgridError(subgridError_v,Lstar_v_p[i]) +</div>
<div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.SubgridError(subgridError_w,Lstar_w_p[i]);</div>
<div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;                      }</div>
<div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160;                  }</div>
<div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;nDOF_v_test_element;i++)</div>
<div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160;                  {</div>
<div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160;                    <span class="keyword">register</span> <span class="keywordtype">int</span> i_nSpace=i*nSpace;</div>
<div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160;                    elementResidual_u[i] += <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Mass_weak(mom_u_acc_t,vel_test_dV[i]) +</div>
<div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;                      <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Advection_weak(mom_u_adv,&amp;vel_grad_test_dV[i_nSpace]) +</div>
<div class="line"><a name="l03424"></a><span class="lineno"> 3424</span>&#160;                      <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Diffusion_weak(sdInfo_u_u_rowptr,sdInfo_u_u_colind,mom_uu_diff_ten,grad_u,&amp;vel_grad_test_dV[i_nSpace]) +</div>
<div class="line"><a name="l03425"></a><span class="lineno"> 3425</span>&#160;                      <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Diffusion_weak(sdInfo_u_v_rowptr,sdInfo_u_v_colind,mom_uv_diff_ten,grad_v,&amp;vel_grad_test_dV[i_nSpace]) +</div>
<div class="line"><a name="l03426"></a><span class="lineno"> 3426</span>&#160;                      <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Diffusion_weak(sdInfo_u_w_rowptr,sdInfo_u_w_colind,mom_uw_diff_ten,grad_w,&amp;vel_grad_test_dV[i_nSpace]) +</div>
<div class="line"><a name="l03427"></a><span class="lineno"> 3427</span>&#160;                      <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Reaction_weak(mom_u_source+NONCONSERVATIVE_FORM*dmom_u_acc_u*<a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>*div_mesh_velocity,vel_test_dV[i]) +</div>
<div class="line"><a name="l03428"></a><span class="lineno"> 3428</span>&#160;                      <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Hamiltonian_weak(mom_u_ham,vel_test_dV[i]) +</div>
<div class="line"><a name="l03429"></a><span class="lineno"> 3429</span>&#160;                      MOMENTUM_SGE*VELOCITY_SGE*<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.SubgridError(subgridError_u,Lstar_u_u[i]) +</div>
<div class="line"><a name="l03430"></a><span class="lineno"> 3430</span>&#160;                      <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.NumericalDiffusion(q_numDiff_u_last[eN_k],grad_u,&amp;vel_grad_test_dV[i_nSpace]);</div>
<div class="line"><a name="l03431"></a><span class="lineno"> 3431</span>&#160;                    elementResidual_v[i] += <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Mass_weak(mom_v_acc_t,vel_test_dV[i]) +</div>
<div class="line"><a name="l03432"></a><span class="lineno"> 3432</span>&#160;                      <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Advection_weak(mom_v_adv,&amp;vel_grad_test_dV[i_nSpace]) +</div>
<div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160;                      <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Diffusion_weak(sdInfo_v_u_rowptr,sdInfo_v_u_colind,mom_vu_diff_ten,grad_u,&amp;vel_grad_test_dV[i_nSpace]) +</div>
<div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160;                      <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Diffusion_weak(sdInfo_v_v_rowptr,sdInfo_v_v_colind,mom_vv_diff_ten,grad_v,&amp;vel_grad_test_dV[i_nSpace]) +</div>
<div class="line"><a name="l03435"></a><span class="lineno"> 3435</span>&#160;                      <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Diffusion_weak(sdInfo_v_w_rowptr,sdInfo_v_w_colind,mom_vw_diff_ten,grad_w,&amp;vel_grad_test_dV[i_nSpace]) +</div>
<div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160;                      <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Reaction_weak(mom_v_source+NONCONSERVATIVE_FORM*dmom_v_acc_v*<a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>*div_mesh_velocity,vel_test_dV[i]) +</div>
<div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160;                      <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Hamiltonian_weak(mom_v_ham,vel_test_dV[i]) +</div>
<div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160;                      MOMENTUM_SGE*VELOCITY_SGE*<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.SubgridError(subgridError_v,Lstar_v_v[i]) +</div>
<div class="line"><a name="l03439"></a><span class="lineno"> 3439</span>&#160;                      <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.NumericalDiffusion(q_numDiff_v_last[eN_k],grad_v,&amp;vel_grad_test_dV[i_nSpace]);</div>
<div class="line"><a name="l03440"></a><span class="lineno"> 3440</span>&#160;                    elementResidual_w[i] +=  <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Mass_weak(mom_w_acc_t,vel_test_dV[i]) +</div>
<div class="line"><a name="l03441"></a><span class="lineno"> 3441</span>&#160;                      <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Advection_weak(mom_w_adv,&amp;vel_grad_test_dV[i_nSpace]) +</div>
<div class="line"><a name="l03442"></a><span class="lineno"> 3442</span>&#160;                      <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Diffusion_weak(sdInfo_w_u_rowptr,sdInfo_w_u_colind,mom_wu_diff_ten,grad_u,&amp;vel_grad_test_dV[i_nSpace]) +</div>
<div class="line"><a name="l03443"></a><span class="lineno"> 3443</span>&#160;                      <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Diffusion_weak(sdInfo_w_v_rowptr,sdInfo_w_v_colind,mom_wv_diff_ten,grad_v,&amp;vel_grad_test_dV[i_nSpace]) +</div>
<div class="line"><a name="l03444"></a><span class="lineno"> 3444</span>&#160;                      <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Diffusion_weak(sdInfo_w_w_rowptr,sdInfo_w_w_colind,mom_ww_diff_ten,grad_w,&amp;vel_grad_test_dV[i_nSpace]) +</div>
<div class="line"><a name="l03445"></a><span class="lineno"> 3445</span>&#160;                      <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Reaction_weak(mom_w_source+NONCONSERVATIVE_FORM*dmom_w_acc_w*<a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a>*div_mesh_velocity,vel_test_dV[i]) +</div>
<div class="line"><a name="l03446"></a><span class="lineno"> 3446</span>&#160;                      <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Hamiltonian_weak(mom_w_ham,vel_test_dV[i]) +</div>
<div class="line"><a name="l03447"></a><span class="lineno"> 3447</span>&#160;                      MOMENTUM_SGE*VELOCITY_SGE*<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.SubgridError(subgridError_w,Lstar_w_w[i]) +</div>
<div class="line"><a name="l03448"></a><span class="lineno"> 3448</span>&#160;                      <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.NumericalDiffusion(q_numDiff_w_last[eN_k],grad_w,&amp;vel_grad_test_dV[i_nSpace]);</div>
<div class="line"><a name="l03449"></a><span class="lineno"> 3449</span>&#160;                    <span class="keywordflow">if</span> (nDOF_test_element == nDOF_v_test_element)</div>
<div class="line"><a name="l03450"></a><span class="lineno"> 3450</span>&#160;                      {</div>
<div class="line"><a name="l03451"></a><span class="lineno"> 3451</span>&#160;                        elementResidual_u[i] += MOMENTUM_SGE*PRESSURE_SGE*<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.SubgridError(subgridError_p,Lstar_p_u[i]);</div>
<div class="line"><a name="l03452"></a><span class="lineno"> 3452</span>&#160;                        elementResidual_v[i] += MOMENTUM_SGE*PRESSURE_SGE*<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.SubgridError(subgridError_p,Lstar_p_v[i]);</div>
<div class="line"><a name="l03453"></a><span class="lineno"> 3453</span>&#160;                        elementResidual_w[i] += MOMENTUM_SGE*PRESSURE_SGE*<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.SubgridError(subgridError_p,Lstar_p_w[i]);</div>
<div class="line"><a name="l03454"></a><span class="lineno"> 3454</span>&#160;                      }</div>
<div class="line"><a name="l03455"></a><span class="lineno"> 3455</span>&#160;                  }<span class="comment">//i</span></div>
<div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160;                numerical_viscosity[eN_k] = q_numDiff_u_last[eN_k] + MOMENTUM_SGE*VELOCITY_SGE*tau_v*(dmom_adv_star[0]*dmom_adv_star[0]+</div>
<div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160;                                                                                                      dmom_adv_star[1]*dmom_adv_star[1]+</div>
<div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160;                                                                                                      dmom_adv_star[2]*dmom_adv_star[2]);</div>
<div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160;              }</div>
<div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160;            <span class="comment">//load element into global residual and save element residual</span></div>
<div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;nDOF_test_element;i++)</div>
<div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;              {</div>
<div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160;                <span class="keyword">register</span> <span class="keywordtype">int</span> eN_i=eN*nDOF_test_element+i;</div>
<div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160; </div>
<div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;                elementResidual_p_save[eN_i] +=  elementResidual_p[i];</div>
<div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;                mesh_volume_conservation_element_weak += elementResidual_mesh[i];</div>
<div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160;                globalResidual[offset_p+stride_p*rp_l2g[eN_i]]+=elementResidual_p[i];</div>
<div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160;              }</div>
<div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;nDOF_v_test_element;i++)</div>
<div class="line"><a name="l03472"></a><span class="lineno"> 3472</span>&#160;              {</div>
<div class="line"><a name="l03473"></a><span class="lineno"> 3473</span>&#160;                <span class="keyword">register</span> <span class="keywordtype">int</span> eN_i=eN*nDOF_v_test_element+i;</div>
<div class="line"><a name="l03474"></a><span class="lineno"> 3474</span>&#160; </div>
<div class="line"><a name="l03475"></a><span class="lineno"> 3475</span>&#160;                globalResidual[offset_u+stride_u*rvel_l2g[eN_i]]+=elementResidual_u[i];</div>
<div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160;                globalResidual[offset_v+stride_v*rvel_l2g[eN_i]]+=elementResidual_v[i];</div>
<div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160;                globalResidual[offset_w+stride_w*rvel_l2g[eN_i]]+=elementResidual_w[i];</div>
<div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160;              }<span class="comment">//i</span></div>
<div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160;            mesh_volume_conservation += mesh_volume_conservation_element;</div>
<div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;            mesh_volume_conservation_weak += mesh_volume_conservation_element_weak;</div>
<div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160;            mesh_volume_conservation_err_max=fmax(mesh_volume_conservation_err_max,fabs(mesh_volume_conservation_element));</div>
<div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160;            mesh_volume_conservation_err_max_weak=fmax(mesh_volume_conservation_err_max_weak,fabs(mesh_volume_conservation_element_weak));</div>
<div class="line"><a name="l03483"></a><span class="lineno"> 3483</span>&#160;          }<span class="comment">//elements</span></div>
<div class="line"><a name="l03484"></a><span class="lineno"> 3484</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l03485"></a><span class="lineno"> 3485</span>&#160;        <span class="comment">//loop over exterior element boundaries to calculate surface integrals and load into element and global residuals</span></div>
<div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160;        <span class="comment">//ebNE is the Exterior element boundary INdex</span></div>
<div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160;        <span class="comment">//ebN is the element boundary INdex</span></div>
<div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160;        <span class="comment">//eN is the element index</span></div>
<div class="line"><a name="l03490"></a><span class="lineno"> 3490</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ebNE = 0; ebNE &lt; nExteriorElementBoundaries_global; ebNE++)</div>
<div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160;          {</div>
<div class="line"><a name="l03492"></a><span class="lineno"> 3492</span>&#160;            <span class="keyword">register</span> <span class="keywordtype">int</span> ebN = exteriorElementBoundariesArray[ebNE],</div>
<div class="line"><a name="l03493"></a><span class="lineno"> 3493</span>&#160;              eN  = elementBoundaryElementsArray[ebN*2+0],</div>
<div class="line"><a name="l03494"></a><span class="lineno"> 3494</span>&#160;              ebN_local = elementBoundaryLocalElementBoundariesArray[ebN*2+0],</div>
<div class="line"><a name="l03495"></a><span class="lineno"> 3495</span>&#160;              eN_nDOF_trial_element = eN*nDOF_trial_element,</div>
<div class="line"><a name="l03496"></a><span class="lineno"> 3496</span>&#160;              eN_nDOF_v_trial_element = eN*nDOF_v_trial_element;</div>
<div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160;            <span class="keyword">register</span> <span class="keywordtype">double</span> elementResidual_mesh[nDOF_test_element],</div>
<div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160;              elementResidual_p[nDOF_test_element],</div>
<div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160;              elementResidual_u[nDOF_v_test_element],</div>
<div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160;              elementResidual_v[nDOF_v_test_element],</div>
<div class="line"><a name="l03501"></a><span class="lineno"> 3501</span>&#160;              elementResidual_w[nDOF_v_test_element],</div>
<div class="line"><a name="l03502"></a><span class="lineno"> 3502</span>&#160;              eps_rho,eps_mu;</div>
<div class="line"><a name="l03503"></a><span class="lineno"> 3503</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;nDOF_test_element;i++)</div>
<div class="line"><a name="l03504"></a><span class="lineno"> 3504</span>&#160;              {</div>
<div class="line"><a name="l03505"></a><span class="lineno"> 3505</span>&#160;                elementResidual_mesh[i]=0.0;</div>
<div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160;                elementResidual_p[i]=0.0;</div>
<div class="line"><a name="l03507"></a><span class="lineno"> 3507</span>&#160;              }</div>
<div class="line"><a name="l03508"></a><span class="lineno"> 3508</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;nDOF_v_test_element;i++)</div>
<div class="line"><a name="l03509"></a><span class="lineno"> 3509</span>&#160;              {</div>
<div class="line"><a name="l03510"></a><span class="lineno"> 3510</span>&#160;                elementResidual_u[i]=0.0;</div>
<div class="line"><a name="l03511"></a><span class="lineno"> 3511</span>&#160;                elementResidual_v[i]=0.0;</div>
<div class="line"><a name="l03512"></a><span class="lineno"> 3512</span>&#160;                elementResidual_w[i]=0.0;</div>
<div class="line"><a name="l03513"></a><span class="lineno"> 3513</span>&#160;              }</div>
<div class="line"><a name="l03514"></a><span class="lineno"> 3514</span>&#160;            <span class="keywordflow">for</span>  (<span class="keywordtype">int</span> kb=0;kb&lt;nQuadraturePoints_elementBoundary;kb++)</div>
<div class="line"><a name="l03515"></a><span class="lineno"> 3515</span>&#160;              {</div>
<div class="line"><a name="l03516"></a><span class="lineno"> 3516</span>&#160;                <span class="keyword">register</span> <span class="keywordtype">int</span> ebNE_kb = ebNE*nQuadraturePoints_elementBoundary+kb,</div>
<div class="line"><a name="l03517"></a><span class="lineno"> 3517</span>&#160;                  ebNE_kb_nSpace = ebNE_kb*nSpace,</div>
<div class="line"><a name="l03518"></a><span class="lineno"> 3518</span>&#160;                  ebN_local_kb = ebN_local*nQuadraturePoints_elementBoundary+kb,</div>
<div class="line"><a name="l03519"></a><span class="lineno"> 3519</span>&#160;                  ebN_local_kb_nSpace = ebN_local_kb*nSpace;</div>
<div class="line"><a name="l03520"></a><span class="lineno"> 3520</span>&#160;                <span class="keyword">register</span> <span class="keywordtype">double</span> p_ext=0.0,</div>
<div class="line"><a name="l03521"></a><span class="lineno"> 3521</span>&#160;                  u_ext=0.0,</div>
<div class="line"><a name="l03522"></a><span class="lineno"> 3522</span>&#160;                  v_ext=0.0,</div>
<div class="line"><a name="l03523"></a><span class="lineno"> 3523</span>&#160;                  w_ext=0.0,</div>
<div class="line"><a name="l03524"></a><span class="lineno"> 3524</span>&#160;                  grad_p_ext[nSpace],</div>
<div class="line"><a name="l03525"></a><span class="lineno"> 3525</span>&#160;                  grad_u_ext[nSpace],</div>
<div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160;                  grad_v_ext[nSpace],</div>
<div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160;                  grad_w_ext[nSpace],</div>
<div class="line"><a name="l03528"></a><span class="lineno"> 3528</span>&#160;                  p_old=0.0,u_old=0.0,v_old=0.0,w_old=0.0,</div>
<div class="line"><a name="l03529"></a><span class="lineno"> 3529</span>&#160;                  grad_p_old[nSpace],grad_u_old[nSpace],grad_v_old[nSpace],grad_w_old[nSpace],</div>
<div class="line"><a name="l03530"></a><span class="lineno"> 3530</span>&#160;                  mom_u_acc_ext=0.0,</div>
<div class="line"><a name="l03531"></a><span class="lineno"> 3531</span>&#160;                  dmom_u_acc_u_ext=0.0,</div>
<div class="line"><a name="l03532"></a><span class="lineno"> 3532</span>&#160;                  mom_v_acc_ext=0.0,</div>
<div class="line"><a name="l03533"></a><span class="lineno"> 3533</span>&#160;                  dmom_v_acc_v_ext=0.0,</div>
<div class="line"><a name="l03534"></a><span class="lineno"> 3534</span>&#160;                  mom_w_acc_ext=0.0,</div>
<div class="line"><a name="l03535"></a><span class="lineno"> 3535</span>&#160;                  dmom_w_acc_w_ext=0.0,</div>
<div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;                  mass_adv_ext[nSpace],</div>
<div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160;                  dmass_adv_u_ext[nSpace],</div>
<div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160;                  dmass_adv_v_ext[nSpace],</div>
<div class="line"><a name="l03539"></a><span class="lineno"> 3539</span>&#160;                  dmass_adv_w_ext[nSpace],</div>
<div class="line"><a name="l03540"></a><span class="lineno"> 3540</span>&#160;                  mom_u_adv_ext[nSpace],</div>
<div class="line"><a name="l03541"></a><span class="lineno"> 3541</span>&#160;                  dmom_u_adv_u_ext[nSpace],</div>
<div class="line"><a name="l03542"></a><span class="lineno"> 3542</span>&#160;                  dmom_u_adv_v_ext[nSpace],</div>
<div class="line"><a name="l03543"></a><span class="lineno"> 3543</span>&#160;                  dmom_u_adv_w_ext[nSpace],</div>
<div class="line"><a name="l03544"></a><span class="lineno"> 3544</span>&#160;                  mom_v_adv_ext[nSpace],</div>
<div class="line"><a name="l03545"></a><span class="lineno"> 3545</span>&#160;                  dmom_v_adv_u_ext[nSpace],</div>
<div class="line"><a name="l03546"></a><span class="lineno"> 3546</span>&#160;                  dmom_v_adv_v_ext[nSpace],</div>
<div class="line"><a name="l03547"></a><span class="lineno"> 3547</span>&#160;                  dmom_v_adv_w_ext[nSpace],</div>
<div class="line"><a name="l03548"></a><span class="lineno"> 3548</span>&#160;                  mom_w_adv_ext[nSpace],</div>
<div class="line"><a name="l03549"></a><span class="lineno"> 3549</span>&#160;                  dmom_w_adv_u_ext[nSpace],</div>
<div class="line"><a name="l03550"></a><span class="lineno"> 3550</span>&#160;                  dmom_w_adv_v_ext[nSpace],</div>
<div class="line"><a name="l03551"></a><span class="lineno"> 3551</span>&#160;                  dmom_w_adv_w_ext[nSpace],</div>
<div class="line"><a name="l03552"></a><span class="lineno"> 3552</span>&#160;                  mom_uu_diff_ten_ext[nSpace],</div>
<div class="line"><a name="l03553"></a><span class="lineno"> 3553</span>&#160;                  mom_vv_diff_ten_ext[nSpace],</div>
<div class="line"><a name="l03554"></a><span class="lineno"> 3554</span>&#160;                  mom_ww_diff_ten_ext[nSpace],</div>
<div class="line"><a name="l03555"></a><span class="lineno"> 3555</span>&#160;                  mom_uv_diff_ten_ext[1],</div>
<div class="line"><a name="l03556"></a><span class="lineno"> 3556</span>&#160;                  mom_uw_diff_ten_ext[1],</div>
<div class="line"><a name="l03557"></a><span class="lineno"> 3557</span>&#160;                  mom_vu_diff_ten_ext[1],</div>
<div class="line"><a name="l03558"></a><span class="lineno"> 3558</span>&#160;                  mom_vw_diff_ten_ext[1],</div>
<div class="line"><a name="l03559"></a><span class="lineno"> 3559</span>&#160;                  mom_wu_diff_ten_ext[1],</div>
<div class="line"><a name="l03560"></a><span class="lineno"> 3560</span>&#160;                  mom_wv_diff_ten_ext[1],</div>
<div class="line"><a name="l03561"></a><span class="lineno"> 3561</span>&#160;                  mom_u_source_ext=0.0,</div>
<div class="line"><a name="l03562"></a><span class="lineno"> 3562</span>&#160;                  mom_v_source_ext=0.0,</div>
<div class="line"><a name="l03563"></a><span class="lineno"> 3563</span>&#160;                  mom_w_source_ext=0.0,</div>
<div class="line"><a name="l03564"></a><span class="lineno"> 3564</span>&#160;                  mom_u_ham_ext=0.0,</div>
<div class="line"><a name="l03565"></a><span class="lineno"> 3565</span>&#160;                  dmom_u_ham_grad_p_ext[nSpace],</div>
<div class="line"><a name="l03566"></a><span class="lineno"> 3566</span>&#160;                  dmom_u_ham_grad_u_ext[nSpace],</div>
<div class="line"><a name="l03567"></a><span class="lineno"> 3567</span>&#160;                  dmom_u_ham_u_ext=0.0,</div>
<div class="line"><a name="l03568"></a><span class="lineno"> 3568</span>&#160;                  dmom_u_ham_v_ext=0.0,</div>
<div class="line"><a name="l03569"></a><span class="lineno"> 3569</span>&#160;                  dmom_u_ham_w_ext=0.0,</div>
<div class="line"><a name="l03570"></a><span class="lineno"> 3570</span>&#160;                  mom_v_ham_ext=0.0,</div>
<div class="line"><a name="l03571"></a><span class="lineno"> 3571</span>&#160;                  dmom_v_ham_grad_p_ext[nSpace],</div>
<div class="line"><a name="l03572"></a><span class="lineno"> 3572</span>&#160;                  dmom_v_ham_grad_v_ext[nSpace],</div>
<div class="line"><a name="l03573"></a><span class="lineno"> 3573</span>&#160;                  dmom_v_ham_u_ext=0.0,</div>
<div class="line"><a name="l03574"></a><span class="lineno"> 3574</span>&#160;                  dmom_v_ham_v_ext=0.0,</div>
<div class="line"><a name="l03575"></a><span class="lineno"> 3575</span>&#160;                  dmom_v_ham_w_ext=0.0,</div>
<div class="line"><a name="l03576"></a><span class="lineno"> 3576</span>&#160;                  mom_w_ham_ext=0.0,</div>
<div class="line"><a name="l03577"></a><span class="lineno"> 3577</span>&#160;                  dmom_w_ham_grad_p_ext[nSpace],</div>
<div class="line"><a name="l03578"></a><span class="lineno"> 3578</span>&#160;                  dmom_w_ham_grad_w_ext[nSpace],</div>
<div class="line"><a name="l03579"></a><span class="lineno"> 3579</span>&#160;                  dmom_w_ham_u_ext=0.0,</div>
<div class="line"><a name="l03580"></a><span class="lineno"> 3580</span>&#160;                  dmom_w_ham_v_ext=0.0,</div>
<div class="line"><a name="l03581"></a><span class="lineno"> 3581</span>&#160;                  dmom_w_ham_w_ext=0.0,</div>
<div class="line"><a name="l03582"></a><span class="lineno"> 3582</span>&#160;                  dmom_u_adv_p_ext[nSpace],</div>
<div class="line"><a name="l03583"></a><span class="lineno"> 3583</span>&#160;                  dmom_v_adv_p_ext[nSpace],</div>
<div class="line"><a name="l03584"></a><span class="lineno"> 3584</span>&#160;                  dmom_w_adv_p_ext[nSpace],</div>
<div class="line"><a name="l03585"></a><span class="lineno"> 3585</span>&#160;                  flux_mass_ext=0.0,</div>
<div class="line"><a name="l03586"></a><span class="lineno"> 3586</span>&#160;                  flux_mom_u_adv_ext=0.0,</div>
<div class="line"><a name="l03587"></a><span class="lineno"> 3587</span>&#160;                  flux_mom_v_adv_ext=0.0,</div>
<div class="line"><a name="l03588"></a><span class="lineno"> 3588</span>&#160;                  flux_mom_w_adv_ext=0.0,</div>
<div class="line"><a name="l03589"></a><span class="lineno"> 3589</span>&#160;                  flux_mom_uu_diff_ext=0.0,</div>
<div class="line"><a name="l03590"></a><span class="lineno"> 3590</span>&#160;                  flux_mom_uv_diff_ext=0.0,</div>
<div class="line"><a name="l03591"></a><span class="lineno"> 3591</span>&#160;                  flux_mom_uw_diff_ext=0.0,</div>
<div class="line"><a name="l03592"></a><span class="lineno"> 3592</span>&#160;                  flux_mom_vu_diff_ext=0.0,</div>
<div class="line"><a name="l03593"></a><span class="lineno"> 3593</span>&#160;                  flux_mom_vv_diff_ext=0.0,</div>
<div class="line"><a name="l03594"></a><span class="lineno"> 3594</span>&#160;                  flux_mom_vw_diff_ext=0.0,</div>
<div class="line"><a name="l03595"></a><span class="lineno"> 3595</span>&#160;                  flux_mom_wu_diff_ext=0.0,</div>
<div class="line"><a name="l03596"></a><span class="lineno"> 3596</span>&#160;                  flux_mom_wv_diff_ext=0.0,</div>
<div class="line"><a name="l03597"></a><span class="lineno"> 3597</span>&#160;                  flux_mom_ww_diff_ext=0.0,</div>
<div class="line"><a name="l03598"></a><span class="lineno"> 3598</span>&#160;                  bc_p_ext=0.0,</div>
<div class="line"><a name="l03599"></a><span class="lineno"> 3599</span>&#160;                  bc_u_ext=0.0,</div>
<div class="line"><a name="l03600"></a><span class="lineno"> 3600</span>&#160;                  bc_v_ext=0.0,</div>
<div class="line"><a name="l03601"></a><span class="lineno"> 3601</span>&#160;                  bc_w_ext=0.0,</div>
<div class="line"><a name="l03602"></a><span class="lineno"> 3602</span>&#160;                  bc_mom_u_acc_ext=0.0,</div>
<div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160;                  bc_dmom_u_acc_u_ext=0.0,</div>
<div class="line"><a name="l03604"></a><span class="lineno"> 3604</span>&#160;                  bc_mom_v_acc_ext=0.0,</div>
<div class="line"><a name="l03605"></a><span class="lineno"> 3605</span>&#160;                  bc_dmom_v_acc_v_ext=0.0,</div>
<div class="line"><a name="l03606"></a><span class="lineno"> 3606</span>&#160;                  bc_mom_w_acc_ext=0.0,</div>
<div class="line"><a name="l03607"></a><span class="lineno"> 3607</span>&#160;                  bc_dmom_w_acc_w_ext=0.0,</div>
<div class="line"><a name="l03608"></a><span class="lineno"> 3608</span>&#160;                  bc_mass_adv_ext[nSpace],</div>
<div class="line"><a name="l03609"></a><span class="lineno"> 3609</span>&#160;                  bc_dmass_adv_u_ext[nSpace],</div>
<div class="line"><a name="l03610"></a><span class="lineno"> 3610</span>&#160;                  bc_dmass_adv_v_ext[nSpace],</div>
<div class="line"><a name="l03611"></a><span class="lineno"> 3611</span>&#160;                  bc_dmass_adv_w_ext[nSpace],</div>
<div class="line"><a name="l03612"></a><span class="lineno"> 3612</span>&#160;                  bc_mom_u_adv_ext[nSpace],</div>
<div class="line"><a name="l03613"></a><span class="lineno"> 3613</span>&#160;                  bc_dmom_u_adv_u_ext[nSpace],</div>
<div class="line"><a name="l03614"></a><span class="lineno"> 3614</span>&#160;                  bc_dmom_u_adv_v_ext[nSpace],</div>
<div class="line"><a name="l03615"></a><span class="lineno"> 3615</span>&#160;                  bc_dmom_u_adv_w_ext[nSpace],</div>
<div class="line"><a name="l03616"></a><span class="lineno"> 3616</span>&#160;                  bc_mom_v_adv_ext[nSpace],</div>
<div class="line"><a name="l03617"></a><span class="lineno"> 3617</span>&#160;                  bc_dmom_v_adv_u_ext[nSpace],</div>
<div class="line"><a name="l03618"></a><span class="lineno"> 3618</span>&#160;                  bc_dmom_v_adv_v_ext[nSpace],</div>
<div class="line"><a name="l03619"></a><span class="lineno"> 3619</span>&#160;                  bc_dmom_v_adv_w_ext[nSpace],</div>
<div class="line"><a name="l03620"></a><span class="lineno"> 3620</span>&#160;                  bc_mom_w_adv_ext[nSpace],</div>
<div class="line"><a name="l03621"></a><span class="lineno"> 3621</span>&#160;                  bc_dmom_w_adv_u_ext[nSpace],</div>
<div class="line"><a name="l03622"></a><span class="lineno"> 3622</span>&#160;                  bc_dmom_w_adv_v_ext[nSpace],</div>
<div class="line"><a name="l03623"></a><span class="lineno"> 3623</span>&#160;                  bc_dmom_w_adv_w_ext[nSpace],</div>
<div class="line"><a name="l03624"></a><span class="lineno"> 3624</span>&#160;                  bc_mom_uu_diff_ten_ext[nSpace],</div>
<div class="line"><a name="l03625"></a><span class="lineno"> 3625</span>&#160;                  bc_mom_vv_diff_ten_ext[nSpace],</div>
<div class="line"><a name="l03626"></a><span class="lineno"> 3626</span>&#160;                  bc_mom_ww_diff_ten_ext[nSpace],</div>
<div class="line"><a name="l03627"></a><span class="lineno"> 3627</span>&#160;                  bc_mom_uv_diff_ten_ext[1],</div>
<div class="line"><a name="l03628"></a><span class="lineno"> 3628</span>&#160;                  bc_mom_uw_diff_ten_ext[1],</div>
<div class="line"><a name="l03629"></a><span class="lineno"> 3629</span>&#160;                  bc_mom_vu_diff_ten_ext[1],</div>
<div class="line"><a name="l03630"></a><span class="lineno"> 3630</span>&#160;                  bc_mom_vw_diff_ten_ext[1],</div>
<div class="line"><a name="l03631"></a><span class="lineno"> 3631</span>&#160;                  bc_mom_wu_diff_ten_ext[1],</div>
<div class="line"><a name="l03632"></a><span class="lineno"> 3632</span>&#160;                  bc_mom_wv_diff_ten_ext[1],</div>
<div class="line"><a name="l03633"></a><span class="lineno"> 3633</span>&#160;                  bc_mom_u_source_ext=0.0,</div>
<div class="line"><a name="l03634"></a><span class="lineno"> 3634</span>&#160;                  bc_mom_v_source_ext=0.0,</div>
<div class="line"><a name="l03635"></a><span class="lineno"> 3635</span>&#160;                  bc_mom_w_source_ext=0.0,</div>
<div class="line"><a name="l03636"></a><span class="lineno"> 3636</span>&#160;                  bc_mom_u_ham_ext=0.0,</div>
<div class="line"><a name="l03637"></a><span class="lineno"> 3637</span>&#160;                  bc_dmom_u_ham_grad_p_ext[nSpace],</div>
<div class="line"><a name="l03638"></a><span class="lineno"> 3638</span>&#160;                  bc_dmom_u_ham_grad_u_ext[nSpace],</div>
<div class="line"><a name="l03639"></a><span class="lineno"> 3639</span>&#160;                  bc_dmom_u_ham_u_ext=0.0,</div>
<div class="line"><a name="l03640"></a><span class="lineno"> 3640</span>&#160;                  bc_dmom_u_ham_v_ext=0.0,</div>
<div class="line"><a name="l03641"></a><span class="lineno"> 3641</span>&#160;                  bc_dmom_u_ham_w_ext=0.0,</div>
<div class="line"><a name="l03642"></a><span class="lineno"> 3642</span>&#160;                  bc_mom_v_ham_ext=0.0,</div>
<div class="line"><a name="l03643"></a><span class="lineno"> 3643</span>&#160;                  bc_dmom_v_ham_grad_p_ext[nSpace],</div>
<div class="line"><a name="l03644"></a><span class="lineno"> 3644</span>&#160;                  bc_dmom_v_ham_grad_v_ext[nSpace],</div>
<div class="line"><a name="l03645"></a><span class="lineno"> 3645</span>&#160;                  bc_dmom_v_ham_u_ext=0.0,</div>
<div class="line"><a name="l03646"></a><span class="lineno"> 3646</span>&#160;                  bc_dmom_v_ham_v_ext=0.0,</div>
<div class="line"><a name="l03647"></a><span class="lineno"> 3647</span>&#160;                  bc_dmom_v_ham_w_ext=0.0,</div>
<div class="line"><a name="l03648"></a><span class="lineno"> 3648</span>&#160;                  bc_mom_w_ham_ext=0.0,</div>
<div class="line"><a name="l03649"></a><span class="lineno"> 3649</span>&#160;                  bc_dmom_w_ham_grad_p_ext[nSpace],</div>
<div class="line"><a name="l03650"></a><span class="lineno"> 3650</span>&#160;                  bc_dmom_w_ham_grad_w_ext[nSpace],</div>
<div class="line"><a name="l03651"></a><span class="lineno"> 3651</span>&#160;                  bc_dmom_w_ham_u_ext=0.0,</div>
<div class="line"><a name="l03652"></a><span class="lineno"> 3652</span>&#160;                  bc_dmom_w_ham_v_ext=0.0,</div>
<div class="line"><a name="l03653"></a><span class="lineno"> 3653</span>&#160;                  bc_dmom_w_ham_w_ext=0.0,</div>
<div class="line"><a name="l03654"></a><span class="lineno"> 3654</span>&#160;                  jac_ext[nSpace*nSpace],</div>
<div class="line"><a name="l03655"></a><span class="lineno"> 3655</span>&#160;                  jacDet_ext,</div>
<div class="line"><a name="l03656"></a><span class="lineno"> 3656</span>&#160;                  jacInv_ext[nSpace*nSpace],</div>
<div class="line"><a name="l03657"></a><span class="lineno"> 3657</span>&#160;                  boundaryJac[nSpace*(nSpace-1)],</div>
<div class="line"><a name="l03658"></a><span class="lineno"> 3658</span>&#160;                  metricTensor[(nSpace-1)*(nSpace-1)],</div>
<div class="line"><a name="l03659"></a><span class="lineno"> 3659</span>&#160;                  metricTensorDetSqrt,</div>
<div class="line"><a name="l03660"></a><span class="lineno"> 3660</span>&#160;                  dS,p_test_dS[nDOF_test_element],vel_test_dS[nDOF_v_test_element],</div>
<div class="line"><a name="l03661"></a><span class="lineno"> 3661</span>&#160;                  p_grad_trial_trace[nDOF_trial_element*nSpace],vel_grad_trial_trace[nDOF_v_trial_element*nSpace],</div>
<div class="line"><a name="l03662"></a><span class="lineno"> 3662</span>&#160;                  vel_grad_test_dS[nDOF_v_trial_element*nSpace],</div>
<div class="line"><a name="l03663"></a><span class="lineno"> 3663</span>&#160;                  normal[3],x_ext,y_ext,z_ext,xt_ext,yt_ext,zt_ext,integralScaling,</div>
<div class="line"><a name="l03664"></a><span class="lineno"> 3664</span>&#160;                  <span class="comment">//VRANS</span></div>
<div class="line"><a name="l03665"></a><span class="lineno"> 3665</span>&#160;                  porosity_ext,</div>
<div class="line"><a name="l03666"></a><span class="lineno"> 3666</span>&#160;                  <span class="comment">//</span></div>
<div class="line"><a name="l03667"></a><span class="lineno"> 3667</span>&#160;                  G[nSpace*nSpace],G_dd_G,tr_G,h_phi,h_penalty,penalty,</div>
<div class="line"><a name="l03668"></a><span class="lineno"> 3668</span>&#160;                  force_x,force_y,force_z,force_p_x,force_p_y,force_p_z,force_v_x,force_v_y,force_v_z,r_x,r_y,r_z;</div>
<div class="line"><a name="l03669"></a><span class="lineno"> 3669</span>&#160;                <span class="comment">//compute information about mapping from reference element to physical element</span></div>
<div class="line"><a name="l03670"></a><span class="lineno"> 3670</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.calculateMapping_elementBoundary(eN,</div>
<div class="line"><a name="l03671"></a><span class="lineno"> 3671</span>&#160;                                                    ebN_local,</div>
<div class="line"><a name="l03672"></a><span class="lineno"> 3672</span>&#160;                                                    kb,</div>
<div class="line"><a name="l03673"></a><span class="lineno"> 3673</span>&#160;                                                    ebN_local_kb,</div>
<div class="line"><a name="l03674"></a><span class="lineno"> 3674</span>&#160;                                                    mesh_dof,</div>
<div class="line"><a name="l03675"></a><span class="lineno"> 3675</span>&#160;                                                    mesh_l2g,</div>
<div class="line"><a name="l03676"></a><span class="lineno"> 3676</span>&#160;                                                    mesh_trial_trace_ref,</div>
<div class="line"><a name="l03677"></a><span class="lineno"> 3677</span>&#160;                                                    mesh_grad_trial_trace_ref,</div>
<div class="line"><a name="l03678"></a><span class="lineno"> 3678</span>&#160;                                                    boundaryJac_ref,</div>
<div class="line"><a name="l03679"></a><span class="lineno"> 3679</span>&#160;                                                    jac_ext,</div>
<div class="line"><a name="l03680"></a><span class="lineno"> 3680</span>&#160;                                                    jacDet_ext,</div>
<div class="line"><a name="l03681"></a><span class="lineno"> 3681</span>&#160;                                                    jacInv_ext,</div>
<div class="line"><a name="l03682"></a><span class="lineno"> 3682</span>&#160;                                                    boundaryJac,</div>
<div class="line"><a name="l03683"></a><span class="lineno"> 3683</span>&#160;                                                    metricTensor,</div>
<div class="line"><a name="l03684"></a><span class="lineno"> 3684</span>&#160;                                                    metricTensorDetSqrt,</div>
<div class="line"><a name="l03685"></a><span class="lineno"> 3685</span>&#160;                                                    normal_ref,</div>
<div class="line"><a name="l03686"></a><span class="lineno"> 3686</span>&#160;                                                    normal,</div>
<div class="line"><a name="l03687"></a><span class="lineno"> 3687</span>&#160;                                                    x_ext,y_ext,z_ext);</div>
<div class="line"><a name="l03688"></a><span class="lineno"> 3688</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.calculateMappingVelocity_elementBoundary(eN,</div>
<div class="line"><a name="l03689"></a><span class="lineno"> 3689</span>&#160;                                                            ebN_local,</div>
<div class="line"><a name="l03690"></a><span class="lineno"> 3690</span>&#160;                                                            kb,</div>
<div class="line"><a name="l03691"></a><span class="lineno"> 3691</span>&#160;                                                            ebN_local_kb,</div>
<div class="line"><a name="l03692"></a><span class="lineno"> 3692</span>&#160;                                                            mesh_velocity_dof,</div>
<div class="line"><a name="l03693"></a><span class="lineno"> 3693</span>&#160;                                                            mesh_l2g,</div>
<div class="line"><a name="l03694"></a><span class="lineno"> 3694</span>&#160;                                                            mesh_trial_trace_ref,</div>
<div class="line"><a name="l03695"></a><span class="lineno"> 3695</span>&#160;                                                            xt_ext,yt_ext,zt_ext,</div>
<div class="line"><a name="l03696"></a><span class="lineno"> 3696</span>&#160;                                                            normal,</div>
<div class="line"><a name="l03697"></a><span class="lineno"> 3697</span>&#160;                                                            boundaryJac,</div>
<div class="line"><a name="l03698"></a><span class="lineno"> 3698</span>&#160;                                                            metricTensor,</div>
<div class="line"><a name="l03699"></a><span class="lineno"> 3699</span>&#160;                                                            integralScaling);</div>
<div class="line"><a name="l03700"></a><span class="lineno"> 3700</span>&#160;                <span class="comment">//xt_ext=0.0;yt_ext=0.0;zt_ext=0.0;</span></div>
<div class="line"><a name="l03701"></a><span class="lineno"> 3701</span>&#160;                <span class="comment">//std::cout&lt;&lt;&quot;xt_ext &quot;&lt;&lt;xt_ext&lt;&lt;&#39;\t&#39;&lt;&lt;yt_ext&lt;&lt;&#39;\t&#39;&lt;&lt;zt_ext&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l03702"></a><span class="lineno"> 3702</span>&#160;                <span class="comment">//std::cout&lt;&lt;&quot;x_ext &quot;&lt;&lt;x_ext&lt;&lt;&#39;\t&#39;&lt;&lt;y_ext&lt;&lt;&#39;\t&#39;&lt;&lt;z_ext&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l03703"></a><span class="lineno"> 3703</span>&#160;                <span class="comment">//std::cout&lt;&lt;&quot;integralScaling - metricTensorDetSrt ===============================&quot;&lt;&lt;integralScaling-metricTensorDetSqrt&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l03704"></a><span class="lineno"> 3704</span>&#160;                <span class="comment">/* std::cout&lt;&lt;&quot;metricTensorDetSqrt &quot;&lt;&lt;metricTensorDetSqrt */</span></div>
<div class="line"><a name="l03705"></a><span class="lineno"> 3705</span>&#160;                <span class="comment">/*             &lt;&lt;&quot;dS_ref[kb]&quot;&lt;&lt;dS_ref[kb]&lt;&lt;std::endl; */</span></div>
<div class="line"><a name="l03706"></a><span class="lineno"> 3706</span>&#160;                <span class="comment">//dS = ((1.0-MOVING_DOMAIN)*metricTensorDetSqrt + MOVING_DOMAIN*integralScaling)*dS_ref[kb];//cek need to test effect on accuracy</span></div>
<div class="line"><a name="l03707"></a><span class="lineno"> 3707</span>&#160;                dS = metricTensorDetSqrt*dS_ref[kb];</div>
<div class="line"><a name="l03708"></a><span class="lineno"> 3708</span>&#160;                <span class="comment">//get the metric tensor</span></div>
<div class="line"><a name="l03709"></a><span class="lineno"> 3709</span>&#160;                <span class="comment">//cek todo use symmetry</span></div>
<div class="line"><a name="l03710"></a><span class="lineno"> 3710</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.calculateG(jacInv_ext,G,G_dd_G,tr_G);</div>
<div class="line"><a name="l03711"></a><span class="lineno"> 3711</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.calculateGScale(G,&amp;ebqe_normal_phi_ext[ebNE_kb_nSpace],h_phi);</div>
<div class="line"><a name="l03712"></a><span class="lineno"> 3712</span>&#160; </div>
<div class="line"><a name="l03713"></a><span class="lineno"> 3713</span>&#160;                eps_rho = epsFact_rho*(useMetrics*h_phi+(1.0-useMetrics)*elementDiameter[eN]);</div>
<div class="line"><a name="l03714"></a><span class="lineno"> 3714</span>&#160;                eps_mu  = epsFact_mu *(useMetrics*h_phi+(1.0-useMetrics)*elementDiameter[eN]);</div>
<div class="line"><a name="l03715"></a><span class="lineno"> 3715</span>&#160; </div>
<div class="line"><a name="l03716"></a><span class="lineno"> 3716</span>&#160;                <span class="comment">//compute shape and solution information</span></div>
<div class="line"><a name="l03717"></a><span class="lineno"> 3717</span>&#160;                <span class="comment">//shape</span></div>
<div class="line"><a name="l03718"></a><span class="lineno"> 3718</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.gradTrialFromRef(&amp;p_grad_trial_trace_ref[ebN_local_kb_nSpace*nDOF_trial_element],jacInv_ext,p_grad_trial_trace);</div>
<div class="line"><a name="l03719"></a><span class="lineno"> 3719</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a7a7848813d299e5d43a0c4872556a476">ck_v</a>.gradTrialFromRef(&amp;vel_grad_trial_trace_ref[ebN_local_kb_nSpace*nDOF_v_trial_element],jacInv_ext,vel_grad_trial_trace);</div>
<div class="line"><a name="l03720"></a><span class="lineno"> 3720</span>&#160;                <span class="comment">//cek hack use trial ck.gradTrialFromRef(&amp;vel_grad_test_trace_ref[ebN_local_kb_nSpace*nDOF_trial_element],jacInv_ext,vel_grad_test_trace);</span></div>
<div class="line"><a name="l03721"></a><span class="lineno"> 3721</span>&#160;                <span class="comment">//solution and gradients</span></div>
<div class="line"><a name="l03722"></a><span class="lineno"> 3722</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.valFromDOF(p_dof,&amp;p_l2g[eN_nDOF_trial_element],&amp;p_trial_trace_ref[ebN_local_kb*nDOF_test_element],p_ext);</div>
<div class="line"><a name="l03723"></a><span class="lineno"> 3723</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a7a7848813d299e5d43a0c4872556a476">ck_v</a>.valFromDOF(u_dof,&amp;vel_l2g[eN_nDOF_v_trial_element],&amp;vel_trial_trace_ref[ebN_local_kb*nDOF_v_test_element],u_ext);</div>
<div class="line"><a name="l03724"></a><span class="lineno"> 3724</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a7a7848813d299e5d43a0c4872556a476">ck_v</a>.valFromDOF(v_dof,&amp;vel_l2g[eN_nDOF_v_trial_element],&amp;vel_trial_trace_ref[ebN_local_kb*nDOF_v_test_element],v_ext);</div>
<div class="line"><a name="l03725"></a><span class="lineno"> 3725</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a7a7848813d299e5d43a0c4872556a476">ck_v</a>.valFromDOF(w_dof,&amp;vel_l2g[eN_nDOF_v_trial_element],&amp;vel_trial_trace_ref[ebN_local_kb*nDOF_v_test_element],w_ext);</div>
<div class="line"><a name="l03726"></a><span class="lineno"> 3726</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.valFromDOF(p_old_dof,&amp;p_l2g[eN_nDOF_trial_element],&amp;p_trial_trace_ref[ebN_local_kb*nDOF_test_element],p_old);</div>
<div class="line"><a name="l03727"></a><span class="lineno"> 3727</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a7a7848813d299e5d43a0c4872556a476">ck_v</a>.valFromDOF(u_old_dof,&amp;vel_l2g[eN_nDOF_v_trial_element],&amp;vel_trial_trace_ref[ebN_local_kb*nDOF_v_test_element],u_old);</div>
<div class="line"><a name="l03728"></a><span class="lineno"> 3728</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a7a7848813d299e5d43a0c4872556a476">ck_v</a>.valFromDOF(v_old_dof,&amp;vel_l2g[eN_nDOF_v_trial_element],&amp;vel_trial_trace_ref[ebN_local_kb*nDOF_v_test_element],v_old);</div>
<div class="line"><a name="l03729"></a><span class="lineno"> 3729</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a7a7848813d299e5d43a0c4872556a476">ck_v</a>.valFromDOF(w_old_dof,&amp;vel_l2g[eN_nDOF_v_trial_element],&amp;vel_trial_trace_ref[ebN_local_kb*nDOF_v_test_element],w_old);</div>
<div class="line"><a name="l03730"></a><span class="lineno"> 3730</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.gradFromDOF(p_dof,&amp;p_l2g[eN_nDOF_trial_element],p_grad_trial_trace,grad_p_ext);</div>
<div class="line"><a name="l03731"></a><span class="lineno"> 3731</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a7a7848813d299e5d43a0c4872556a476">ck_v</a>.gradFromDOF(u_dof,&amp;vel_l2g[eN_nDOF_v_trial_element],vel_grad_trial_trace,grad_u_ext);</div>
<div class="line"><a name="l03732"></a><span class="lineno"> 3732</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a7a7848813d299e5d43a0c4872556a476">ck_v</a>.gradFromDOF(v_dof,&amp;vel_l2g[eN_nDOF_v_trial_element],vel_grad_trial_trace,grad_v_ext);</div>
<div class="line"><a name="l03733"></a><span class="lineno"> 3733</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a7a7848813d299e5d43a0c4872556a476">ck_v</a>.gradFromDOF(w_dof,&amp;vel_l2g[eN_nDOF_v_trial_element],vel_grad_trial_trace,grad_w_ext);</div>
<div class="line"><a name="l03734"></a><span class="lineno"> 3734</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.gradFromDOF(p_old_dof,&amp;p_l2g[eN_nDOF_trial_element],p_grad_trial_trace,grad_p_old);</div>
<div class="line"><a name="l03735"></a><span class="lineno"> 3735</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a7a7848813d299e5d43a0c4872556a476">ck_v</a>.gradFromDOF(u_old_dof,&amp;vel_l2g[eN_nDOF_v_trial_element],vel_grad_trial_trace,grad_u_old);</div>
<div class="line"><a name="l03736"></a><span class="lineno"> 3736</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a7a7848813d299e5d43a0c4872556a476">ck_v</a>.gradFromDOF(v_old_dof,&amp;vel_l2g[eN_nDOF_v_trial_element],vel_grad_trial_trace,grad_v_old);</div>
<div class="line"><a name="l03737"></a><span class="lineno"> 3737</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a7a7848813d299e5d43a0c4872556a476">ck_v</a>.gradFromDOF(w_old_dof,&amp;vel_l2g[eN_nDOF_v_trial_element],vel_grad_trial_trace,grad_w_old);</div>
<div class="line"><a name="l03738"></a><span class="lineno"> 3738</span>&#160;                <span class="comment">//precalculate test function products with integration weights</span></div>
<div class="line"><a name="l03739"></a><span class="lineno"> 3739</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0;j&lt;nDOF_test_element;j++)</div>
<div class="line"><a name="l03740"></a><span class="lineno"> 3740</span>&#160;                  {</div>
<div class="line"><a name="l03741"></a><span class="lineno"> 3741</span>&#160;                    p_test_dS[j] = p_test_trace_ref[ebN_local_kb*nDOF_test_element+j]*dS;</div>
<div class="line"><a name="l03742"></a><span class="lineno"> 3742</span>&#160;                  }</div>
<div class="line"><a name="l03743"></a><span class="lineno"> 3743</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0;j&lt;nDOF_v_test_element;j++)</div>
<div class="line"><a name="l03744"></a><span class="lineno"> 3744</span>&#160;                  {</div>
<div class="line"><a name="l03745"></a><span class="lineno"> 3745</span>&#160;                    vel_test_dS[j] = vel_test_trace_ref[ebN_local_kb*nDOF_v_test_element+j]*dS;</div>
<div class="line"><a name="l03746"></a><span class="lineno"> 3746</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> I=0;I&lt;nSpace;I++)</div>
<div class="line"><a name="l03747"></a><span class="lineno"> 3747</span>&#160;                      vel_grad_test_dS[j*nSpace+I] = vel_grad_trial_trace[j*nSpace+I]*dS;<span class="comment">//assume test_j = trial_j</span></div>
<div class="line"><a name="l03748"></a><span class="lineno"> 3748</span>&#160;                  }</div>
<div class="line"><a name="l03749"></a><span class="lineno"> 3749</span>&#160;                bc_p_ext = isDOFBoundary_p[ebNE_kb]*ebqe_bc_p_ext[ebNE_kb]+(1-isDOFBoundary_p[ebNE_kb])*p_ext;</div>
<div class="line"><a name="l03750"></a><span class="lineno"> 3750</span>&#160;                <span class="comment">//note, our convention is that bc values at moving boundaries are relative to boundary velocity so we add it here</span></div>
<div class="line"><a name="l03751"></a><span class="lineno"> 3751</span>&#160;                bc_u_ext = isDOFBoundary_u[ebNE_kb]*(ebqe_bc_u_ext[ebNE_kb] + MOVING_DOMAIN*xt_ext) + (1-isDOFBoundary_u[ebNE_kb])*u_ext;</div>
<div class="line"><a name="l03752"></a><span class="lineno"> 3752</span>&#160;                bc_v_ext = isDOFBoundary_v[ebNE_kb]*(ebqe_bc_v_ext[ebNE_kb] + MOVING_DOMAIN*yt_ext) + (1-isDOFBoundary_v[ebNE_kb])*v_ext;</div>
<div class="line"><a name="l03753"></a><span class="lineno"> 3753</span>&#160;                bc_w_ext = isDOFBoundary_w[ebNE_kb]*(ebqe_bc_w_ext[ebNE_kb] + MOVING_DOMAIN*zt_ext) + (1-isDOFBoundary_w[ebNE_kb])*w_ext;</div>
<div class="line"><a name="l03754"></a><span class="lineno"> 3754</span>&#160;                <span class="comment">//VRANS</span></div>
<div class="line"><a name="l03755"></a><span class="lineno"> 3755</span>&#160;                porosity_ext = ebqe_porosity_ext[ebNE_kb];</div>
<div class="line"><a name="l03756"></a><span class="lineno"> 3756</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l03757"></a><span class="lineno"> 3757</span>&#160;                <span class="comment">//calculate the pde coefficients using the solution and the boundary values for the solution</span></div>
<div class="line"><a name="l03758"></a><span class="lineno"> 3758</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l03759"></a><span class="lineno"> 3759</span>&#160;                <span class="keywordtype">double</span> bc_eddy_viscosity_ext(0.); <span class="comment">//not interested in saving boundary eddy viscosity for now</span></div>
<div class="line"><a name="l03760"></a><span class="lineno"> 3760</span>&#160;                <span class="keywordtype">double</span> rho;</div>
<div class="line"><a name="l03761"></a><span class="lineno"> 3761</span>&#160;                <span class="keywordflow">if</span> (use_ball_as_particle == 1)</div>
<div class="line"><a name="l03762"></a><span class="lineno"> 3762</span>&#160;                {</div>
<div class="line"><a name="l03763"></a><span class="lineno"> 3763</span>&#160;                    <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a3e0cb3084e0e32cc2355384f2e511801">get_distance_to_ball</a>(nParticles, ball_center, ball_radius,x_ext,y_ext,z_ext,ebq_global_phi_s[ebNE_kb]);</div>
<div class="line"><a name="l03764"></a><span class="lineno"> 3764</span>&#160;                }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l03765"></a><span class="lineno"> 3765</span>&#160;                    <span class="comment">//ebq_global_phi_s[ebNE_kb] is computed in Prestep</span></div>
<div class="line"><a name="l03766"></a><span class="lineno"> 3766</span>&#160;                }</div>
<div class="line"><a name="l03767"></a><span class="lineno"> 3767</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#adff72a3cebc8b98398097095827e7aa6">evaluateCoefficients</a>(NONCONSERVATIVE_FORM,</div>
<div class="line"><a name="l03768"></a><span class="lineno"> 3768</span>&#160;                                     eps_rho,</div>
<div class="line"><a name="l03769"></a><span class="lineno"> 3769</span>&#160;                                     eps_mu,</div>
<div class="line"><a name="l03770"></a><span class="lineno"> 3770</span>&#160;                                     sigma,</div>
<div class="line"><a name="l03771"></a><span class="lineno"> 3771</span>&#160;                                     <a class="code" href="_error_residual_method_8cpp.html#ae5f5d9edb66645eab31a7c8389493ce7">rho_0</a>,</div>
<div class="line"><a name="l03772"></a><span class="lineno"> 3772</span>&#160;                                     <a class="code" href="_error_residual_method_8cpp.html#a383b07af68441ce2b4adaaf8d8cc9d90">nu_0</a>,</div>
<div class="line"><a name="l03773"></a><span class="lineno"> 3773</span>&#160;                                     <a class="code" href="_error_residual_method_8cpp.html#a751e53c9d8dfaf696b11b86e0c1b42e9">rho_1</a>,</div>
<div class="line"><a name="l03774"></a><span class="lineno"> 3774</span>&#160;                                     <a class="code" href="_error_residual_method_8cpp.html#ae5896ebfee35f22242123e4ae82c81d9">nu_1</a>,</div>
<div class="line"><a name="l03775"></a><span class="lineno"> 3775</span>&#160;                                     elementDiameter[eN],</div>
<div class="line"><a name="l03776"></a><span class="lineno"> 3776</span>&#160;                                     smagorinskyConstant,</div>
<div class="line"><a name="l03777"></a><span class="lineno"> 3777</span>&#160;                                     turbulenceClosureModel,</div>
<div class="line"><a name="l03778"></a><span class="lineno"> 3778</span>&#160;                                     g,</div>
<div class="line"><a name="l03779"></a><span class="lineno"> 3779</span>&#160;                                     useVF,</div>
<div class="line"><a name="l03780"></a><span class="lineno"> 3780</span>&#160;                                     ebqe_vf_ext[ebNE_kb],</div>
<div class="line"><a name="l03781"></a><span class="lineno"> 3781</span>&#160;                                     ebqe_phi_ext[ebNE_kb],</div>
<div class="line"><a name="l03782"></a><span class="lineno"> 3782</span>&#160;                                     &amp;ebqe_normal_phi_ext[ebNE_kb_nSpace],</div>
<div class="line"><a name="l03783"></a><span class="lineno"> 3783</span>&#160;                                     ebqe_kappa_phi_ext[ebNE_kb],</div>
<div class="line"><a name="l03784"></a><span class="lineno"> 3784</span>&#160;                                     <span class="comment">//VRANS</span></div>
<div class="line"><a name="l03785"></a><span class="lineno"> 3785</span>&#160;                                     porosity_ext,</div>
<div class="line"><a name="l03786"></a><span class="lineno"> 3786</span>&#160;                                     <span class="comment">//</span></div>
<div class="line"><a name="l03787"></a><span class="lineno"> 3787</span>&#160;                                     ebq_global_phi_s[ebNE_kb],</div>
<div class="line"><a name="l03788"></a><span class="lineno"> 3788</span>&#160;                                     p_old,</div>
<div class="line"><a name="l03789"></a><span class="lineno"> 3789</span>&#160;                                     u_old,</div>
<div class="line"><a name="l03790"></a><span class="lineno"> 3790</span>&#160;                                     v_old,</div>
<div class="line"><a name="l03791"></a><span class="lineno"> 3791</span>&#160;                                     w_old,</div>
<div class="line"><a name="l03792"></a><span class="lineno"> 3792</span>&#160;                                     grad_p_old,</div>
<div class="line"><a name="l03793"></a><span class="lineno"> 3793</span>&#160;                                     grad_u_old,</div>
<div class="line"><a name="l03794"></a><span class="lineno"> 3794</span>&#160;                                     grad_v_old,</div>
<div class="line"><a name="l03795"></a><span class="lineno"> 3795</span>&#160;                                     grad_w_old,</div>
<div class="line"><a name="l03796"></a><span class="lineno"> 3796</span>&#160;                                     use_pseudo_penalty,</div>
<div class="line"><a name="l03797"></a><span class="lineno"> 3797</span>&#160;                                     p_ext,</div>
<div class="line"><a name="l03798"></a><span class="lineno"> 3798</span>&#160;                                     grad_p_ext,</div>
<div class="line"><a name="l03799"></a><span class="lineno"> 3799</span>&#160;                                     grad_u_ext,</div>
<div class="line"><a name="l03800"></a><span class="lineno"> 3800</span>&#160;                                     grad_v_ext,</div>
<div class="line"><a name="l03801"></a><span class="lineno"> 3801</span>&#160;                                     grad_w_ext,</div>
<div class="line"><a name="l03802"></a><span class="lineno"> 3802</span>&#160;                                     u_ext,</div>
<div class="line"><a name="l03803"></a><span class="lineno"> 3803</span>&#160;                                     v_ext,</div>
<div class="line"><a name="l03804"></a><span class="lineno"> 3804</span>&#160;                                     w_ext,</div>
<div class="line"><a name="l03805"></a><span class="lineno"> 3805</span>&#160;                                     LAG_LES,</div>
<div class="line"><a name="l03806"></a><span class="lineno"> 3806</span>&#160;                                     ebqe_eddy_viscosity[ebNE_kb],</div>
<div class="line"><a name="l03807"></a><span class="lineno"> 3807</span>&#160;                                     ebqe_eddy_viscosity_last[ebNE_kb],</div>
<div class="line"><a name="l03808"></a><span class="lineno"> 3808</span>&#160;                                     mom_u_acc_ext,</div>
<div class="line"><a name="l03809"></a><span class="lineno"> 3809</span>&#160;                                     dmom_u_acc_u_ext,</div>
<div class="line"><a name="l03810"></a><span class="lineno"> 3810</span>&#160;                                     mom_v_acc_ext,</div>
<div class="line"><a name="l03811"></a><span class="lineno"> 3811</span>&#160;                                     dmom_v_acc_v_ext,</div>
<div class="line"><a name="l03812"></a><span class="lineno"> 3812</span>&#160;                                     mom_w_acc_ext,</div>
<div class="line"><a name="l03813"></a><span class="lineno"> 3813</span>&#160;                                     dmom_w_acc_w_ext,</div>
<div class="line"><a name="l03814"></a><span class="lineno"> 3814</span>&#160;                                     mass_adv_ext,</div>
<div class="line"><a name="l03815"></a><span class="lineno"> 3815</span>&#160;                                     dmass_adv_u_ext,</div>
<div class="line"><a name="l03816"></a><span class="lineno"> 3816</span>&#160;                                     dmass_adv_v_ext,</div>
<div class="line"><a name="l03817"></a><span class="lineno"> 3817</span>&#160;                                     dmass_adv_w_ext,</div>
<div class="line"><a name="l03818"></a><span class="lineno"> 3818</span>&#160;                                     mom_u_adv_ext,</div>
<div class="line"><a name="l03819"></a><span class="lineno"> 3819</span>&#160;                                     dmom_u_adv_u_ext,</div>
<div class="line"><a name="l03820"></a><span class="lineno"> 3820</span>&#160;                                     dmom_u_adv_v_ext,</div>
<div class="line"><a name="l03821"></a><span class="lineno"> 3821</span>&#160;                                     dmom_u_adv_w_ext,</div>
<div class="line"><a name="l03822"></a><span class="lineno"> 3822</span>&#160;                                     mom_v_adv_ext,</div>
<div class="line"><a name="l03823"></a><span class="lineno"> 3823</span>&#160;                                     dmom_v_adv_u_ext,</div>
<div class="line"><a name="l03824"></a><span class="lineno"> 3824</span>&#160;                                     dmom_v_adv_v_ext,</div>
<div class="line"><a name="l03825"></a><span class="lineno"> 3825</span>&#160;                                     dmom_v_adv_w_ext,</div>
<div class="line"><a name="l03826"></a><span class="lineno"> 3826</span>&#160;                                     mom_w_adv_ext,</div>
<div class="line"><a name="l03827"></a><span class="lineno"> 3827</span>&#160;                                     dmom_w_adv_u_ext,</div>
<div class="line"><a name="l03828"></a><span class="lineno"> 3828</span>&#160;                                     dmom_w_adv_v_ext,</div>
<div class="line"><a name="l03829"></a><span class="lineno"> 3829</span>&#160;                                     dmom_w_adv_w_ext,</div>
<div class="line"><a name="l03830"></a><span class="lineno"> 3830</span>&#160;                                     mom_uu_diff_ten_ext,</div>
<div class="line"><a name="l03831"></a><span class="lineno"> 3831</span>&#160;                                     mom_vv_diff_ten_ext,</div>
<div class="line"><a name="l03832"></a><span class="lineno"> 3832</span>&#160;                                     mom_ww_diff_ten_ext,</div>
<div class="line"><a name="l03833"></a><span class="lineno"> 3833</span>&#160;                                     mom_uv_diff_ten_ext,</div>
<div class="line"><a name="l03834"></a><span class="lineno"> 3834</span>&#160;                                     mom_uw_diff_ten_ext,</div>
<div class="line"><a name="l03835"></a><span class="lineno"> 3835</span>&#160;                                     mom_vu_diff_ten_ext,</div>
<div class="line"><a name="l03836"></a><span class="lineno"> 3836</span>&#160;                                     mom_vw_diff_ten_ext,</div>
<div class="line"><a name="l03837"></a><span class="lineno"> 3837</span>&#160;                                     mom_wu_diff_ten_ext,</div>
<div class="line"><a name="l03838"></a><span class="lineno"> 3838</span>&#160;                                     mom_wv_diff_ten_ext,</div>
<div class="line"><a name="l03839"></a><span class="lineno"> 3839</span>&#160;                                     mom_u_source_ext,</div>
<div class="line"><a name="l03840"></a><span class="lineno"> 3840</span>&#160;                                     mom_v_source_ext,</div>
<div class="line"><a name="l03841"></a><span class="lineno"> 3841</span>&#160;                                     mom_w_source_ext,</div>
<div class="line"><a name="l03842"></a><span class="lineno"> 3842</span>&#160;                                     mom_u_ham_ext,</div>
<div class="line"><a name="l03843"></a><span class="lineno"> 3843</span>&#160;                                     dmom_u_ham_grad_p_ext,</div>
<div class="line"><a name="l03844"></a><span class="lineno"> 3844</span>&#160;                                     dmom_u_ham_grad_u_ext,</div>
<div class="line"><a name="l03845"></a><span class="lineno"> 3845</span>&#160;                                     dmom_u_ham_u_ext,</div>
<div class="line"><a name="l03846"></a><span class="lineno"> 3846</span>&#160;                                     dmom_u_ham_v_ext,</div>
<div class="line"><a name="l03847"></a><span class="lineno"> 3847</span>&#160;                                     dmom_u_ham_w_ext,</div>
<div class="line"><a name="l03848"></a><span class="lineno"> 3848</span>&#160;                                     mom_v_ham_ext,</div>
<div class="line"><a name="l03849"></a><span class="lineno"> 3849</span>&#160;                                     dmom_v_ham_grad_p_ext,</div>
<div class="line"><a name="l03850"></a><span class="lineno"> 3850</span>&#160;                                     dmom_v_ham_grad_v_ext,</div>
<div class="line"><a name="l03851"></a><span class="lineno"> 3851</span>&#160;                                     dmom_v_ham_u_ext,</div>
<div class="line"><a name="l03852"></a><span class="lineno"> 3852</span>&#160;                                     dmom_v_ham_v_ext,</div>
<div class="line"><a name="l03853"></a><span class="lineno"> 3853</span>&#160;                                     dmom_v_ham_w_ext,</div>
<div class="line"><a name="l03854"></a><span class="lineno"> 3854</span>&#160;                                     mom_w_ham_ext,</div>
<div class="line"><a name="l03855"></a><span class="lineno"> 3855</span>&#160;                                     dmom_w_ham_grad_p_ext,</div>
<div class="line"><a name="l03856"></a><span class="lineno"> 3856</span>&#160;                                     dmom_w_ham_grad_w_ext,</div>
<div class="line"><a name="l03857"></a><span class="lineno"> 3857</span>&#160;                                     dmom_w_ham_u_ext,</div>
<div class="line"><a name="l03858"></a><span class="lineno"> 3858</span>&#160;                                     dmom_w_ham_v_ext,</div>
<div class="line"><a name="l03859"></a><span class="lineno"> 3859</span>&#160;                                     dmom_w_ham_w_ext,</div>
<div class="line"><a name="l03860"></a><span class="lineno"> 3860</span>&#160;                                     rho,</div>
<div class="line"><a name="l03861"></a><span class="lineno"> 3861</span>&#160;                                     0.0,</div>
<div class="line"><a name="l03862"></a><span class="lineno"> 3862</span>&#160;                                     0.0,</div>
<div class="line"><a name="l03863"></a><span class="lineno"> 3863</span>&#160;                                     0.0);</div>
<div class="line"><a name="l03864"></a><span class="lineno"> 3864</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#adff72a3cebc8b98398097095827e7aa6">evaluateCoefficients</a>(NONCONSERVATIVE_FORM,</div>
<div class="line"><a name="l03865"></a><span class="lineno"> 3865</span>&#160;                                     eps_rho,</div>
<div class="line"><a name="l03866"></a><span class="lineno"> 3866</span>&#160;                                     eps_mu,</div>
<div class="line"><a name="l03867"></a><span class="lineno"> 3867</span>&#160;                                     sigma,</div>
<div class="line"><a name="l03868"></a><span class="lineno"> 3868</span>&#160;                                     <a class="code" href="_error_residual_method_8cpp.html#ae5f5d9edb66645eab31a7c8389493ce7">rho_0</a>,</div>
<div class="line"><a name="l03869"></a><span class="lineno"> 3869</span>&#160;                                     <a class="code" href="_error_residual_method_8cpp.html#a383b07af68441ce2b4adaaf8d8cc9d90">nu_0</a>,</div>
<div class="line"><a name="l03870"></a><span class="lineno"> 3870</span>&#160;                                     <a class="code" href="_error_residual_method_8cpp.html#a751e53c9d8dfaf696b11b86e0c1b42e9">rho_1</a>,</div>
<div class="line"><a name="l03871"></a><span class="lineno"> 3871</span>&#160;                                     <a class="code" href="_error_residual_method_8cpp.html#ae5896ebfee35f22242123e4ae82c81d9">nu_1</a>,</div>
<div class="line"><a name="l03872"></a><span class="lineno"> 3872</span>&#160;                                     elementDiameter[eN],</div>
<div class="line"><a name="l03873"></a><span class="lineno"> 3873</span>&#160;                                     smagorinskyConstant,</div>
<div class="line"><a name="l03874"></a><span class="lineno"> 3874</span>&#160;                                     turbulenceClosureModel,</div>
<div class="line"><a name="l03875"></a><span class="lineno"> 3875</span>&#160;                                     g,</div>
<div class="line"><a name="l03876"></a><span class="lineno"> 3876</span>&#160;                                     useVF,</div>
<div class="line"><a name="l03877"></a><span class="lineno"> 3877</span>&#160;                                     bc_ebqe_vf_ext[ebNE_kb],</div>
<div class="line"><a name="l03878"></a><span class="lineno"> 3878</span>&#160;                                     bc_ebqe_phi_ext[ebNE_kb],</div>
<div class="line"><a name="l03879"></a><span class="lineno"> 3879</span>&#160;                                     &amp;ebqe_normal_phi_ext[ebNE_kb_nSpace],</div>
<div class="line"><a name="l03880"></a><span class="lineno"> 3880</span>&#160;                                     ebqe_kappa_phi_ext[ebNE_kb],</div>
<div class="line"><a name="l03881"></a><span class="lineno"> 3881</span>&#160;                                     <span class="comment">//VRANS</span></div>
<div class="line"><a name="l03882"></a><span class="lineno"> 3882</span>&#160;                                     porosity_ext,</div>
<div class="line"><a name="l03883"></a><span class="lineno"> 3883</span>&#160;                                     <span class="comment">//</span></div>
<div class="line"><a name="l03884"></a><span class="lineno"> 3884</span>&#160;                                     ebq_global_phi_s[ebNE_kb],</div>
<div class="line"><a name="l03885"></a><span class="lineno"> 3885</span>&#160;                                     p_old,</div>
<div class="line"><a name="l03886"></a><span class="lineno"> 3886</span>&#160;                                     u_old,</div>
<div class="line"><a name="l03887"></a><span class="lineno"> 3887</span>&#160;                                     v_old,</div>
<div class="line"><a name="l03888"></a><span class="lineno"> 3888</span>&#160;                                     w_old,</div>
<div class="line"><a name="l03889"></a><span class="lineno"> 3889</span>&#160;                                     grad_p_old,</div>
<div class="line"><a name="l03890"></a><span class="lineno"> 3890</span>&#160;                                     grad_u_old,</div>
<div class="line"><a name="l03891"></a><span class="lineno"> 3891</span>&#160;                                     grad_v_old,</div>
<div class="line"><a name="l03892"></a><span class="lineno"> 3892</span>&#160;                                     grad_w_old,</div>
<div class="line"><a name="l03893"></a><span class="lineno"> 3893</span>&#160;                                     use_pseudo_penalty,</div>
<div class="line"><a name="l03894"></a><span class="lineno"> 3894</span>&#160;                                     bc_p_ext,</div>
<div class="line"><a name="l03895"></a><span class="lineno"> 3895</span>&#160;                                     grad_p_ext,</div>
<div class="line"><a name="l03896"></a><span class="lineno"> 3896</span>&#160;                                     grad_u_ext,</div>
<div class="line"><a name="l03897"></a><span class="lineno"> 3897</span>&#160;                                     grad_v_ext,</div>
<div class="line"><a name="l03898"></a><span class="lineno"> 3898</span>&#160;                                     grad_w_ext,</div>
<div class="line"><a name="l03899"></a><span class="lineno"> 3899</span>&#160;                                     bc_u_ext,</div>
<div class="line"><a name="l03900"></a><span class="lineno"> 3900</span>&#160;                                     bc_v_ext,</div>
<div class="line"><a name="l03901"></a><span class="lineno"> 3901</span>&#160;                                     bc_w_ext,</div>
<div class="line"><a name="l03902"></a><span class="lineno"> 3902</span>&#160;                                     LAG_LES,</div>
<div class="line"><a name="l03903"></a><span class="lineno"> 3903</span>&#160;                                     bc_eddy_viscosity_ext,</div>
<div class="line"><a name="l03904"></a><span class="lineno"> 3904</span>&#160;                                     ebqe_eddy_viscosity_last[ebNE_kb],</div>
<div class="line"><a name="l03905"></a><span class="lineno"> 3905</span>&#160;                                     bc_mom_u_acc_ext,</div>
<div class="line"><a name="l03906"></a><span class="lineno"> 3906</span>&#160;                                     bc_dmom_u_acc_u_ext,</div>
<div class="line"><a name="l03907"></a><span class="lineno"> 3907</span>&#160;                                     bc_mom_v_acc_ext,</div>
<div class="line"><a name="l03908"></a><span class="lineno"> 3908</span>&#160;                                     bc_dmom_v_acc_v_ext,</div>
<div class="line"><a name="l03909"></a><span class="lineno"> 3909</span>&#160;                                     bc_mom_w_acc_ext,</div>
<div class="line"><a name="l03910"></a><span class="lineno"> 3910</span>&#160;                                     bc_dmom_w_acc_w_ext,</div>
<div class="line"><a name="l03911"></a><span class="lineno"> 3911</span>&#160;                                     bc_mass_adv_ext,</div>
<div class="line"><a name="l03912"></a><span class="lineno"> 3912</span>&#160;                                     bc_dmass_adv_u_ext,</div>
<div class="line"><a name="l03913"></a><span class="lineno"> 3913</span>&#160;                                     bc_dmass_adv_v_ext,</div>
<div class="line"><a name="l03914"></a><span class="lineno"> 3914</span>&#160;                                     bc_dmass_adv_w_ext,</div>
<div class="line"><a name="l03915"></a><span class="lineno"> 3915</span>&#160;                                     bc_mom_u_adv_ext,</div>
<div class="line"><a name="l03916"></a><span class="lineno"> 3916</span>&#160;                                     bc_dmom_u_adv_u_ext,</div>
<div class="line"><a name="l03917"></a><span class="lineno"> 3917</span>&#160;                                     bc_dmom_u_adv_v_ext,</div>
<div class="line"><a name="l03918"></a><span class="lineno"> 3918</span>&#160;                                     bc_dmom_u_adv_w_ext,</div>
<div class="line"><a name="l03919"></a><span class="lineno"> 3919</span>&#160;                                     bc_mom_v_adv_ext,</div>
<div class="line"><a name="l03920"></a><span class="lineno"> 3920</span>&#160;                                     bc_dmom_v_adv_u_ext,</div>
<div class="line"><a name="l03921"></a><span class="lineno"> 3921</span>&#160;                                     bc_dmom_v_adv_v_ext,</div>
<div class="line"><a name="l03922"></a><span class="lineno"> 3922</span>&#160;                                     bc_dmom_v_adv_w_ext,</div>
<div class="line"><a name="l03923"></a><span class="lineno"> 3923</span>&#160;                                     bc_mom_w_adv_ext,</div>
<div class="line"><a name="l03924"></a><span class="lineno"> 3924</span>&#160;                                     bc_dmom_w_adv_u_ext,</div>
<div class="line"><a name="l03925"></a><span class="lineno"> 3925</span>&#160;                                     bc_dmom_w_adv_v_ext,</div>
<div class="line"><a name="l03926"></a><span class="lineno"> 3926</span>&#160;                                     bc_dmom_w_adv_w_ext,</div>
<div class="line"><a name="l03927"></a><span class="lineno"> 3927</span>&#160;                                     bc_mom_uu_diff_ten_ext,</div>
<div class="line"><a name="l03928"></a><span class="lineno"> 3928</span>&#160;                                     bc_mom_vv_diff_ten_ext,</div>
<div class="line"><a name="l03929"></a><span class="lineno"> 3929</span>&#160;                                     bc_mom_ww_diff_ten_ext,</div>
<div class="line"><a name="l03930"></a><span class="lineno"> 3930</span>&#160;                                     bc_mom_uv_diff_ten_ext,</div>
<div class="line"><a name="l03931"></a><span class="lineno"> 3931</span>&#160;                                     bc_mom_uw_diff_ten_ext,</div>
<div class="line"><a name="l03932"></a><span class="lineno"> 3932</span>&#160;                                     bc_mom_vu_diff_ten_ext,</div>
<div class="line"><a name="l03933"></a><span class="lineno"> 3933</span>&#160;                                     bc_mom_vw_diff_ten_ext,</div>
<div class="line"><a name="l03934"></a><span class="lineno"> 3934</span>&#160;                                     bc_mom_wu_diff_ten_ext,</div>
<div class="line"><a name="l03935"></a><span class="lineno"> 3935</span>&#160;                                     bc_mom_wv_diff_ten_ext,</div>
<div class="line"><a name="l03936"></a><span class="lineno"> 3936</span>&#160;                                     bc_mom_u_source_ext,</div>
<div class="line"><a name="l03937"></a><span class="lineno"> 3937</span>&#160;                                     bc_mom_v_source_ext,</div>
<div class="line"><a name="l03938"></a><span class="lineno"> 3938</span>&#160;                                     bc_mom_w_source_ext,</div>
<div class="line"><a name="l03939"></a><span class="lineno"> 3939</span>&#160;                                     bc_mom_u_ham_ext,</div>
<div class="line"><a name="l03940"></a><span class="lineno"> 3940</span>&#160;                                     bc_dmom_u_ham_grad_p_ext,</div>
<div class="line"><a name="l03941"></a><span class="lineno"> 3941</span>&#160;                                     bc_dmom_u_ham_grad_u_ext,</div>
<div class="line"><a name="l03942"></a><span class="lineno"> 3942</span>&#160;                                     bc_dmom_u_ham_u_ext,</div>
<div class="line"><a name="l03943"></a><span class="lineno"> 3943</span>&#160;                                     bc_dmom_u_ham_v_ext,</div>
<div class="line"><a name="l03944"></a><span class="lineno"> 3944</span>&#160;                                     bc_dmom_u_ham_w_ext,</div>
<div class="line"><a name="l03945"></a><span class="lineno"> 3945</span>&#160;                                     bc_mom_v_ham_ext,</div>
<div class="line"><a name="l03946"></a><span class="lineno"> 3946</span>&#160;                                     bc_dmom_v_ham_grad_p_ext,</div>
<div class="line"><a name="l03947"></a><span class="lineno"> 3947</span>&#160;                                     bc_dmom_v_ham_grad_v_ext,</div>
<div class="line"><a name="l03948"></a><span class="lineno"> 3948</span>&#160;                                     bc_dmom_v_ham_u_ext,</div>
<div class="line"><a name="l03949"></a><span class="lineno"> 3949</span>&#160;                                     bc_dmom_v_ham_v_ext,</div>
<div class="line"><a name="l03950"></a><span class="lineno"> 3950</span>&#160;                                     bc_dmom_v_ham_w_ext,</div>
<div class="line"><a name="l03951"></a><span class="lineno"> 3951</span>&#160;                                     bc_mom_w_ham_ext,</div>
<div class="line"><a name="l03952"></a><span class="lineno"> 3952</span>&#160;                                     bc_dmom_w_ham_grad_p_ext,</div>
<div class="line"><a name="l03953"></a><span class="lineno"> 3953</span>&#160;                                     bc_dmom_w_ham_grad_w_ext,</div>
<div class="line"><a name="l03954"></a><span class="lineno"> 3954</span>&#160;                                     bc_dmom_w_ham_u_ext,</div>
<div class="line"><a name="l03955"></a><span class="lineno"> 3955</span>&#160;                                     bc_dmom_w_ham_v_ext,</div>
<div class="line"><a name="l03956"></a><span class="lineno"> 3956</span>&#160;                                     bc_dmom_w_ham_w_ext,</div>
<div class="line"><a name="l03957"></a><span class="lineno"> 3957</span>&#160;                                     rho,</div>
<div class="line"><a name="l03958"></a><span class="lineno"> 3958</span>&#160;                                     0.0,</div>
<div class="line"><a name="l03959"></a><span class="lineno"> 3959</span>&#160;                                     0.0,</div>
<div class="line"><a name="l03960"></a><span class="lineno"> 3960</span>&#160;                                     0.0);</div>
<div class="line"><a name="l03961"></a><span class="lineno"> 3961</span>&#160; </div>
<div class="line"><a name="l03962"></a><span class="lineno"> 3962</span>&#160;                <span class="comment">//Turbulence closure model</span></div>
<div class="line"><a name="l03963"></a><span class="lineno"> 3963</span>&#160;                <span class="keywordflow">if</span> (turbulenceClosureModel &gt;= 3)</div>
<div class="line"><a name="l03964"></a><span class="lineno"> 3964</span>&#160;                  {</div>
<div class="line"><a name="l03965"></a><span class="lineno"> 3965</span>&#160;                    <span class="keyword">const</span> <span class="keywordtype">double</span> turb_var_grad_0_dummy[3] = {0.,0.,0.};</div>
<div class="line"><a name="l03966"></a><span class="lineno"> 3966</span>&#160;                    <span class="keyword">const</span> <span class="keywordtype">double</span> c_mu = 0.09;<span class="comment">//mwf hack</span></div>
<div class="line"><a name="l03967"></a><span class="lineno"> 3967</span>&#160;                    <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#aab46065ecbde76bd2d9ef320ad287b76">updateTurbulenceClosure</a>(NONCONSERVATIVE_FORM,</div>
<div class="line"><a name="l03968"></a><span class="lineno"> 3968</span>&#160;                                            turbulenceClosureModel,</div>
<div class="line"><a name="l03969"></a><span class="lineno"> 3969</span>&#160;                                            eps_rho,</div>
<div class="line"><a name="l03970"></a><span class="lineno"> 3970</span>&#160;                                            eps_mu,</div>
<div class="line"><a name="l03971"></a><span class="lineno"> 3971</span>&#160;                                            <a class="code" href="_error_residual_method_8cpp.html#ae5f5d9edb66645eab31a7c8389493ce7">rho_0</a>,</div>
<div class="line"><a name="l03972"></a><span class="lineno"> 3972</span>&#160;                                            <a class="code" href="_error_residual_method_8cpp.html#a383b07af68441ce2b4adaaf8d8cc9d90">nu_0</a>,</div>
<div class="line"><a name="l03973"></a><span class="lineno"> 3973</span>&#160;                                            <a class="code" href="_error_residual_method_8cpp.html#a751e53c9d8dfaf696b11b86e0c1b42e9">rho_1</a>,</div>
<div class="line"><a name="l03974"></a><span class="lineno"> 3974</span>&#160;                                            <a class="code" href="_error_residual_method_8cpp.html#ae5896ebfee35f22242123e4ae82c81d9">nu_1</a>,</div>
<div class="line"><a name="l03975"></a><span class="lineno"> 3975</span>&#160;                                            useVF,</div>
<div class="line"><a name="l03976"></a><span class="lineno"> 3976</span>&#160;                                            ebqe_vf_ext[ebNE_kb],</div>
<div class="line"><a name="l03977"></a><span class="lineno"> 3977</span>&#160;                                            ebqe_phi_ext[ebNE_kb],</div>
<div class="line"><a name="l03978"></a><span class="lineno"> 3978</span>&#160;                                            porosity_ext,</div>
<div class="line"><a name="l03979"></a><span class="lineno"> 3979</span>&#160;                                            c_mu, <span class="comment">//mwf hack</span></div>
<div class="line"><a name="l03980"></a><span class="lineno"> 3980</span>&#160;                                            ebqe_turb_var_0[ebNE_kb],</div>
<div class="line"><a name="l03981"></a><span class="lineno"> 3981</span>&#160;                                            ebqe_turb_var_1[ebNE_kb],</div>
<div class="line"><a name="l03982"></a><span class="lineno"> 3982</span>&#160;                                            turb_var_grad_0_dummy, <span class="comment">//not needed</span></div>
<div class="line"><a name="l03983"></a><span class="lineno"> 3983</span>&#160;                                            ebqe_eddy_viscosity[ebNE_kb],</div>
<div class="line"><a name="l03984"></a><span class="lineno"> 3984</span>&#160;                                            mom_uu_diff_ten_ext,</div>
<div class="line"><a name="l03985"></a><span class="lineno"> 3985</span>&#160;                                            mom_vv_diff_ten_ext,</div>
<div class="line"><a name="l03986"></a><span class="lineno"> 3986</span>&#160;                                            mom_ww_diff_ten_ext,</div>
<div class="line"><a name="l03987"></a><span class="lineno"> 3987</span>&#160;                                            mom_uv_diff_ten_ext,</div>
<div class="line"><a name="l03988"></a><span class="lineno"> 3988</span>&#160;                                            mom_uw_diff_ten_ext,</div>
<div class="line"><a name="l03989"></a><span class="lineno"> 3989</span>&#160;                                            mom_vu_diff_ten_ext,</div>
<div class="line"><a name="l03990"></a><span class="lineno"> 3990</span>&#160;                                            mom_vw_diff_ten_ext,</div>
<div class="line"><a name="l03991"></a><span class="lineno"> 3991</span>&#160;                                            mom_wu_diff_ten_ext,</div>
<div class="line"><a name="l03992"></a><span class="lineno"> 3992</span>&#160;                                            mom_wv_diff_ten_ext,</div>
<div class="line"><a name="l03993"></a><span class="lineno"> 3993</span>&#160;                                            mom_u_source_ext,</div>
<div class="line"><a name="l03994"></a><span class="lineno"> 3994</span>&#160;                                            mom_v_source_ext,</div>
<div class="line"><a name="l03995"></a><span class="lineno"> 3995</span>&#160;                                            mom_w_source_ext);</div>
<div class="line"><a name="l03996"></a><span class="lineno"> 3996</span>&#160; </div>
<div class="line"><a name="l03997"></a><span class="lineno"> 3997</span>&#160;                    <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#aab46065ecbde76bd2d9ef320ad287b76">updateTurbulenceClosure</a>(NONCONSERVATIVE_FORM,</div>
<div class="line"><a name="l03998"></a><span class="lineno"> 3998</span>&#160;                                            turbulenceClosureModel,</div>
<div class="line"><a name="l03999"></a><span class="lineno"> 3999</span>&#160;                                            eps_rho,</div>
<div class="line"><a name="l04000"></a><span class="lineno"> 4000</span>&#160;                                            eps_mu,</div>
<div class="line"><a name="l04001"></a><span class="lineno"> 4001</span>&#160;                                            <a class="code" href="_error_residual_method_8cpp.html#ae5f5d9edb66645eab31a7c8389493ce7">rho_0</a>,</div>
<div class="line"><a name="l04002"></a><span class="lineno"> 4002</span>&#160;                                            <a class="code" href="_error_residual_method_8cpp.html#a383b07af68441ce2b4adaaf8d8cc9d90">nu_0</a>,</div>
<div class="line"><a name="l04003"></a><span class="lineno"> 4003</span>&#160;                                            <a class="code" href="_error_residual_method_8cpp.html#a751e53c9d8dfaf696b11b86e0c1b42e9">rho_1</a>,</div>
<div class="line"><a name="l04004"></a><span class="lineno"> 4004</span>&#160;                                            <a class="code" href="_error_residual_method_8cpp.html#ae5896ebfee35f22242123e4ae82c81d9">nu_1</a>,</div>
<div class="line"><a name="l04005"></a><span class="lineno"> 4005</span>&#160;                                            useVF,</div>
<div class="line"><a name="l04006"></a><span class="lineno"> 4006</span>&#160;                                            bc_ebqe_vf_ext[ebNE_kb],</div>
<div class="line"><a name="l04007"></a><span class="lineno"> 4007</span>&#160;                                            bc_ebqe_phi_ext[ebNE_kb],</div>
<div class="line"><a name="l04008"></a><span class="lineno"> 4008</span>&#160;                                            porosity_ext,</div>
<div class="line"><a name="l04009"></a><span class="lineno"> 4009</span>&#160;                                            c_mu, <span class="comment">//mwf hack</span></div>
<div class="line"><a name="l04010"></a><span class="lineno"> 4010</span>&#160;                                            ebqe_turb_var_0[ebNE_kb],</div>
<div class="line"><a name="l04011"></a><span class="lineno"> 4011</span>&#160;                                            ebqe_turb_var_1[ebNE_kb],</div>
<div class="line"><a name="l04012"></a><span class="lineno"> 4012</span>&#160;                                            turb_var_grad_0_dummy, <span class="comment">//not needed</span></div>
<div class="line"><a name="l04013"></a><span class="lineno"> 4013</span>&#160;                                            bc_eddy_viscosity_ext,</div>
<div class="line"><a name="l04014"></a><span class="lineno"> 4014</span>&#160;                                            bc_mom_uu_diff_ten_ext,</div>
<div class="line"><a name="l04015"></a><span class="lineno"> 4015</span>&#160;                                            bc_mom_vv_diff_ten_ext,</div>
<div class="line"><a name="l04016"></a><span class="lineno"> 4016</span>&#160;                                            bc_mom_ww_diff_ten_ext,</div>
<div class="line"><a name="l04017"></a><span class="lineno"> 4017</span>&#160;                                            bc_mom_uv_diff_ten_ext,</div>
<div class="line"><a name="l04018"></a><span class="lineno"> 4018</span>&#160;                                            bc_mom_uw_diff_ten_ext,</div>
<div class="line"><a name="l04019"></a><span class="lineno"> 4019</span>&#160;                                            bc_mom_vu_diff_ten_ext,</div>
<div class="line"><a name="l04020"></a><span class="lineno"> 4020</span>&#160;                                            bc_mom_vw_diff_ten_ext,</div>
<div class="line"><a name="l04021"></a><span class="lineno"> 4021</span>&#160;                                            bc_mom_wu_diff_ten_ext,</div>
<div class="line"><a name="l04022"></a><span class="lineno"> 4022</span>&#160;                                            bc_mom_wv_diff_ten_ext,</div>
<div class="line"><a name="l04023"></a><span class="lineno"> 4023</span>&#160;                                            bc_mom_u_source_ext,</div>
<div class="line"><a name="l04024"></a><span class="lineno"> 4024</span>&#160;                                            bc_mom_v_source_ext,</div>
<div class="line"><a name="l04025"></a><span class="lineno"> 4025</span>&#160;                                            bc_mom_w_source_ext);</div>
<div class="line"><a name="l04026"></a><span class="lineno"> 4026</span>&#160;                  }</div>
<div class="line"><a name="l04027"></a><span class="lineno"> 4027</span>&#160; </div>
<div class="line"><a name="l04028"></a><span class="lineno"> 4028</span>&#160; </div>
<div class="line"><a name="l04029"></a><span class="lineno"> 4029</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l04030"></a><span class="lineno"> 4030</span>&#160;                <span class="comment">//moving domain</span></div>
<div class="line"><a name="l04031"></a><span class="lineno"> 4031</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l04032"></a><span class="lineno"> 4032</span>&#160;                <span class="keywordflow">if</span> (NONCONSERVATIVE_FORM &gt; 0.0)</div>
<div class="line"><a name="l04033"></a><span class="lineno"> 4033</span>&#160;                  {</div>
<div class="line"><a name="l04034"></a><span class="lineno"> 4034</span>&#160;                    mom_u_ham_ext -= MOVING_DOMAIN*dmom_u_acc_u_ext*(grad_u_ext[0]*xt_ext + grad_u_ext[1]*yt_ext + grad_u_ext[2]*zt_ext);</div>
<div class="line"><a name="l04035"></a><span class="lineno"> 4035</span>&#160;                    dmom_u_ham_grad_u_ext[0] -= MOVING_DOMAIN*dmom_u_acc_u_ext*xt_ext;</div>
<div class="line"><a name="l04036"></a><span class="lineno"> 4036</span>&#160;                    dmom_u_ham_grad_u_ext[1] -= MOVING_DOMAIN*dmom_u_acc_u_ext*yt_ext;</div>
<div class="line"><a name="l04037"></a><span class="lineno"> 4037</span>&#160;                    dmom_u_ham_grad_u_ext[2] -= MOVING_DOMAIN*dmom_u_acc_u_ext*zt_ext;</div>
<div class="line"><a name="l04038"></a><span class="lineno"> 4038</span>&#160;                  }</div>
<div class="line"><a name="l04039"></a><span class="lineno"> 4039</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l04040"></a><span class="lineno"> 4040</span>&#160;                  {</div>
<div class="line"><a name="l04041"></a><span class="lineno"> 4041</span>&#160;                    mom_u_adv_ext[0] -= MOVING_DOMAIN*mom_u_acc_ext*xt_ext;</div>
<div class="line"><a name="l04042"></a><span class="lineno"> 4042</span>&#160;                    mom_u_adv_ext[1] -= MOVING_DOMAIN*mom_u_acc_ext*yt_ext;</div>
<div class="line"><a name="l04043"></a><span class="lineno"> 4043</span>&#160;                    mom_u_adv_ext[2] -= MOVING_DOMAIN*mom_u_acc_ext*zt_ext;</div>
<div class="line"><a name="l04044"></a><span class="lineno"> 4044</span>&#160;                    dmom_u_adv_u_ext[0] -= MOVING_DOMAIN*dmom_u_acc_u_ext*xt_ext;</div>
<div class="line"><a name="l04045"></a><span class="lineno"> 4045</span>&#160;                    dmom_u_adv_u_ext[1] -= MOVING_DOMAIN*dmom_u_acc_u_ext*yt_ext;</div>
<div class="line"><a name="l04046"></a><span class="lineno"> 4046</span>&#160;                    dmom_u_adv_u_ext[2] -= MOVING_DOMAIN*dmom_u_acc_u_ext*zt_ext;</div>
<div class="line"><a name="l04047"></a><span class="lineno"> 4047</span>&#160;                  }</div>
<div class="line"><a name="l04048"></a><span class="lineno"> 4048</span>&#160; </div>
<div class="line"><a name="l04049"></a><span class="lineno"> 4049</span>&#160; </div>
<div class="line"><a name="l04050"></a><span class="lineno"> 4050</span>&#160;                <span class="keywordflow">if</span> (NONCONSERVATIVE_FORM &gt; 0.0)</div>
<div class="line"><a name="l04051"></a><span class="lineno"> 4051</span>&#160;                  {</div>
<div class="line"><a name="l04052"></a><span class="lineno"> 4052</span>&#160;                    mom_v_ham_ext -= MOVING_DOMAIN*dmom_v_acc_v_ext*(grad_v_ext[0]*xt_ext + grad_v_ext[1]*yt_ext + grad_v_ext[2]*zt_ext);</div>
<div class="line"><a name="l04053"></a><span class="lineno"> 4053</span>&#160;                    dmom_v_ham_grad_v_ext[0] -= MOVING_DOMAIN*dmom_v_acc_v_ext*xt_ext;</div>
<div class="line"><a name="l04054"></a><span class="lineno"> 4054</span>&#160;                    dmom_v_ham_grad_v_ext[1] -= MOVING_DOMAIN*dmom_v_acc_v_ext*yt_ext;</div>
<div class="line"><a name="l04055"></a><span class="lineno"> 4055</span>&#160;                    dmom_v_ham_grad_v_ext[2] -= MOVING_DOMAIN*dmom_v_acc_v_ext*zt_ext;</div>
<div class="line"><a name="l04056"></a><span class="lineno"> 4056</span>&#160;                  }</div>
<div class="line"><a name="l04057"></a><span class="lineno"> 4057</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l04058"></a><span class="lineno"> 4058</span>&#160;                  {</div>
<div class="line"><a name="l04059"></a><span class="lineno"> 4059</span>&#160;                    mom_v_adv_ext[0] -= MOVING_DOMAIN*mom_v_acc_ext*xt_ext;</div>
<div class="line"><a name="l04060"></a><span class="lineno"> 4060</span>&#160;                    mom_v_adv_ext[1] -= MOVING_DOMAIN*mom_v_acc_ext*yt_ext;</div>
<div class="line"><a name="l04061"></a><span class="lineno"> 4061</span>&#160;                    mom_v_adv_ext[2] -= MOVING_DOMAIN*mom_v_acc_ext*zt_ext;</div>
<div class="line"><a name="l04062"></a><span class="lineno"> 4062</span>&#160;                    dmom_v_adv_v_ext[0] -= MOVING_DOMAIN*dmom_v_acc_v_ext*xt_ext;</div>
<div class="line"><a name="l04063"></a><span class="lineno"> 4063</span>&#160;                    dmom_v_adv_v_ext[1] -= MOVING_DOMAIN*dmom_v_acc_v_ext*yt_ext;</div>
<div class="line"><a name="l04064"></a><span class="lineno"> 4064</span>&#160;                    dmom_v_adv_v_ext[2] -= MOVING_DOMAIN*dmom_v_acc_v_ext*zt_ext;</div>
<div class="line"><a name="l04065"></a><span class="lineno"> 4065</span>&#160;                  }</div>
<div class="line"><a name="l04066"></a><span class="lineno"> 4066</span>&#160; </div>
<div class="line"><a name="l04067"></a><span class="lineno"> 4067</span>&#160; </div>
<div class="line"><a name="l04068"></a><span class="lineno"> 4068</span>&#160;                <span class="keywordflow">if</span> (NONCONSERVATIVE_FORM &gt; 0.0)</div>
<div class="line"><a name="l04069"></a><span class="lineno"> 4069</span>&#160;                  {</div>
<div class="line"><a name="l04070"></a><span class="lineno"> 4070</span>&#160;                    mom_w_ham_ext -= MOVING_DOMAIN*dmom_w_acc_w_ext*(grad_w_ext[0]*xt_ext + grad_w_ext[1]*yt_ext + grad_w_ext[2]*zt_ext);</div>
<div class="line"><a name="l04071"></a><span class="lineno"> 4071</span>&#160;                    dmom_w_ham_grad_w_ext[0] -= MOVING_DOMAIN*dmom_w_acc_w_ext*xt_ext;</div>
<div class="line"><a name="l04072"></a><span class="lineno"> 4072</span>&#160;                    dmom_w_ham_grad_w_ext[1] -= MOVING_DOMAIN*dmom_w_acc_w_ext*yt_ext;</div>
<div class="line"><a name="l04073"></a><span class="lineno"> 4073</span>&#160;                    dmom_w_ham_grad_w_ext[2] -= MOVING_DOMAIN*dmom_w_acc_w_ext*zt_ext;</div>
<div class="line"><a name="l04074"></a><span class="lineno"> 4074</span>&#160;                  }</div>
<div class="line"><a name="l04075"></a><span class="lineno"> 4075</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l04076"></a><span class="lineno"> 4076</span>&#160;                  {</div>
<div class="line"><a name="l04077"></a><span class="lineno"> 4077</span>&#160;                    mom_w_adv_ext[0] -= MOVING_DOMAIN*mom_w_acc_ext*xt_ext;</div>
<div class="line"><a name="l04078"></a><span class="lineno"> 4078</span>&#160;                    mom_w_adv_ext[1] -= MOVING_DOMAIN*mom_w_acc_ext*yt_ext;</div>
<div class="line"><a name="l04079"></a><span class="lineno"> 4079</span>&#160;                    mom_w_adv_ext[2] -= MOVING_DOMAIN*mom_w_acc_ext*zt_ext;</div>
<div class="line"><a name="l04080"></a><span class="lineno"> 4080</span>&#160;                    dmom_w_adv_w_ext[0] -= MOVING_DOMAIN*dmom_w_acc_w_ext*xt_ext;</div>
<div class="line"><a name="l04081"></a><span class="lineno"> 4081</span>&#160;                    dmom_w_adv_w_ext[1] -= MOVING_DOMAIN*dmom_w_acc_w_ext*yt_ext;</div>
<div class="line"><a name="l04082"></a><span class="lineno"> 4082</span>&#160;                    dmom_w_adv_w_ext[2] -= MOVING_DOMAIN*dmom_w_acc_w_ext*zt_ext;</div>
<div class="line"><a name="l04083"></a><span class="lineno"> 4083</span>&#160;                  }</div>
<div class="line"><a name="l04084"></a><span class="lineno"> 4084</span>&#160; </div>
<div class="line"><a name="l04085"></a><span class="lineno"> 4085</span>&#160; </div>
<div class="line"><a name="l04086"></a><span class="lineno"> 4086</span>&#160;                <span class="comment">//bc&#39;s</span></div>
<div class="line"><a name="l04087"></a><span class="lineno"> 4087</span>&#160;                <span class="keywordflow">if</span> (NONCONSERVATIVE_FORM &lt; 1.0)</div>
<div class="line"><a name="l04088"></a><span class="lineno"> 4088</span>&#160;                  {</div>
<div class="line"><a name="l04089"></a><span class="lineno"> 4089</span>&#160;                    bc_mom_u_adv_ext[0] -= MOVING_DOMAIN*bc_mom_u_acc_ext*xt_ext;</div>
<div class="line"><a name="l04090"></a><span class="lineno"> 4090</span>&#160;                    bc_mom_u_adv_ext[1] -= MOVING_DOMAIN*bc_mom_u_acc_ext*yt_ext;</div>
<div class="line"><a name="l04091"></a><span class="lineno"> 4091</span>&#160;                    bc_mom_u_adv_ext[2] -= MOVING_DOMAIN*bc_mom_u_acc_ext*zt_ext;</div>
<div class="line"><a name="l04092"></a><span class="lineno"> 4092</span>&#160; </div>
<div class="line"><a name="l04093"></a><span class="lineno"> 4093</span>&#160;                    bc_mom_v_adv_ext[0] -= MOVING_DOMAIN*bc_mom_v_acc_ext*xt_ext;</div>
<div class="line"><a name="l04094"></a><span class="lineno"> 4094</span>&#160;                    bc_mom_v_adv_ext[1] -= MOVING_DOMAIN*bc_mom_v_acc_ext*yt_ext;</div>
<div class="line"><a name="l04095"></a><span class="lineno"> 4095</span>&#160;                    bc_mom_v_adv_ext[2] -= MOVING_DOMAIN*bc_mom_v_acc_ext*zt_ext;</div>
<div class="line"><a name="l04096"></a><span class="lineno"> 4096</span>&#160; </div>
<div class="line"><a name="l04097"></a><span class="lineno"> 4097</span>&#160;                    bc_mom_w_adv_ext[0] -= MOVING_DOMAIN*bc_mom_w_acc_ext*xt_ext;</div>
<div class="line"><a name="l04098"></a><span class="lineno"> 4098</span>&#160;                    bc_mom_w_adv_ext[1] -= MOVING_DOMAIN*bc_mom_w_acc_ext*yt_ext;</div>
<div class="line"><a name="l04099"></a><span class="lineno"> 4099</span>&#160;                    bc_mom_w_adv_ext[2] -= MOVING_DOMAIN*bc_mom_w_acc_ext*zt_ext;</div>
<div class="line"><a name="l04100"></a><span class="lineno"> 4100</span>&#160;                  }</div>
<div class="line"><a name="l04101"></a><span class="lineno"> 4101</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l04102"></a><span class="lineno"> 4102</span>&#160;                <span class="comment">//calculate the numerical fluxes</span></div>
<div class="line"><a name="l04103"></a><span class="lineno"> 4103</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l04104"></a><span class="lineno"> 4104</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.calculateGScale(G,normal,h_penalty);</div>
<div class="line"><a name="l04105"></a><span class="lineno"> 4105</span>&#160;                penalty = useMetrics*C_b/h_penalty + (1.0-useMetrics)*ebqe_penalty_ext[ebNE_kb];</div>
<div class="line"><a name="l04106"></a><span class="lineno"> 4106</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#ab987f978eddb3b321b25be02d34f517d">exteriorNumericalAdvectiveFlux</a>(NONCONSERVATIVE_FORM,</div>
<div class="line"><a name="l04107"></a><span class="lineno"> 4107</span>&#160;                                               isDOFBoundary_p[ebNE_kb],</div>
<div class="line"><a name="l04108"></a><span class="lineno"> 4108</span>&#160;                                               isDOFBoundary_u[ebNE_kb],</div>
<div class="line"><a name="l04109"></a><span class="lineno"> 4109</span>&#160;                                               isDOFBoundary_v[ebNE_kb],</div>
<div class="line"><a name="l04110"></a><span class="lineno"> 4110</span>&#160;                                               isDOFBoundary_w[ebNE_kb],</div>
<div class="line"><a name="l04111"></a><span class="lineno"> 4111</span>&#160;                                               isAdvectiveFluxBoundary_p[ebNE_kb],</div>
<div class="line"><a name="l04112"></a><span class="lineno"> 4112</span>&#160;                                               isAdvectiveFluxBoundary_u[ebNE_kb],</div>
<div class="line"><a name="l04113"></a><span class="lineno"> 4113</span>&#160;                                               isAdvectiveFluxBoundary_v[ebNE_kb],</div>
<div class="line"><a name="l04114"></a><span class="lineno"> 4114</span>&#160;                                               isAdvectiveFluxBoundary_w[ebNE_kb],</div>
<div class="line"><a name="l04115"></a><span class="lineno"> 4115</span>&#160;                                               dmom_u_ham_grad_p_ext[0],<span class="comment">//=1/rho,</span></div>
<div class="line"><a name="l04116"></a><span class="lineno"> 4116</span>&#160;                                               bc_dmom_u_ham_grad_p_ext[0],<span class="comment">//=1/bc_rho,</span></div>
<div class="line"><a name="l04117"></a><span class="lineno"> 4117</span>&#160;                                               normal,</div>
<div class="line"><a name="l04118"></a><span class="lineno"> 4118</span>&#160;                                               bc_p_ext,</div>
<div class="line"><a name="l04119"></a><span class="lineno"> 4119</span>&#160;                                               bc_u_ext,</div>
<div class="line"><a name="l04120"></a><span class="lineno"> 4120</span>&#160;                                               bc_v_ext,</div>
<div class="line"><a name="l04121"></a><span class="lineno"> 4121</span>&#160;                                               bc_w_ext,</div>
<div class="line"><a name="l04122"></a><span class="lineno"> 4122</span>&#160;                                               bc_mass_adv_ext,</div>
<div class="line"><a name="l04123"></a><span class="lineno"> 4123</span>&#160;                                               bc_mom_u_adv_ext,</div>
<div class="line"><a name="l04124"></a><span class="lineno"> 4124</span>&#160;                                               bc_mom_v_adv_ext,</div>
<div class="line"><a name="l04125"></a><span class="lineno"> 4125</span>&#160;                                               bc_mom_w_adv_ext,</div>
<div class="line"><a name="l04126"></a><span class="lineno"> 4126</span>&#160;                                               ebqe_bc_flux_mass_ext[ebNE_kb]+MOVING_DOMAIN*(xt_ext*normal[0]+yt_ext*normal[1]+zt_ext*normal[2]),<span class="comment">//BC is relative mass flux</span></div>
<div class="line"><a name="l04127"></a><span class="lineno"> 4127</span>&#160;                                               ebqe_bc_flux_mom_u_adv_ext[ebNE_kb],</div>
<div class="line"><a name="l04128"></a><span class="lineno"> 4128</span>&#160;                                               ebqe_bc_flux_mom_v_adv_ext[ebNE_kb],</div>
<div class="line"><a name="l04129"></a><span class="lineno"> 4129</span>&#160;                                               ebqe_bc_flux_mom_w_adv_ext[ebNE_kb],</div>
<div class="line"><a name="l04130"></a><span class="lineno"> 4130</span>&#160;                                               p_ext,</div>
<div class="line"><a name="l04131"></a><span class="lineno"> 4131</span>&#160;                                               u_ext,</div>
<div class="line"><a name="l04132"></a><span class="lineno"> 4132</span>&#160;                                               v_ext,</div>
<div class="line"><a name="l04133"></a><span class="lineno"> 4133</span>&#160;                                               w_ext,</div>
<div class="line"><a name="l04134"></a><span class="lineno"> 4134</span>&#160;                                               mass_adv_ext,</div>
<div class="line"><a name="l04135"></a><span class="lineno"> 4135</span>&#160;                                               mom_u_adv_ext,</div>
<div class="line"><a name="l04136"></a><span class="lineno"> 4136</span>&#160;                                               mom_v_adv_ext,</div>
<div class="line"><a name="l04137"></a><span class="lineno"> 4137</span>&#160;                                               mom_w_adv_ext,</div>
<div class="line"><a name="l04138"></a><span class="lineno"> 4138</span>&#160;                                               dmass_adv_u_ext,</div>
<div class="line"><a name="l04139"></a><span class="lineno"> 4139</span>&#160;                                               dmass_adv_v_ext,</div>
<div class="line"><a name="l04140"></a><span class="lineno"> 4140</span>&#160;                                               dmass_adv_w_ext,</div>
<div class="line"><a name="l04141"></a><span class="lineno"> 4141</span>&#160;                                               dmom_u_adv_p_ext,</div>
<div class="line"><a name="l04142"></a><span class="lineno"> 4142</span>&#160;                                               dmom_u_ham_grad_u_ext,</div>
<div class="line"><a name="l04143"></a><span class="lineno"> 4143</span>&#160;                                               dmom_u_adv_u_ext,</div>
<div class="line"><a name="l04144"></a><span class="lineno"> 4144</span>&#160;                                               dmom_u_adv_v_ext,</div>
<div class="line"><a name="l04145"></a><span class="lineno"> 4145</span>&#160;                                               dmom_u_adv_w_ext,</div>
<div class="line"><a name="l04146"></a><span class="lineno"> 4146</span>&#160;                                               dmom_v_adv_p_ext,</div>
<div class="line"><a name="l04147"></a><span class="lineno"> 4147</span>&#160;                                               dmom_v_adv_u_ext,</div>
<div class="line"><a name="l04148"></a><span class="lineno"> 4148</span>&#160;                                               dmom_v_adv_v_ext,</div>
<div class="line"><a name="l04149"></a><span class="lineno"> 4149</span>&#160;                                               dmom_v_adv_w_ext,</div>
<div class="line"><a name="l04150"></a><span class="lineno"> 4150</span>&#160;                                               dmom_w_adv_p_ext,</div>
<div class="line"><a name="l04151"></a><span class="lineno"> 4151</span>&#160;                                               dmom_w_adv_u_ext,</div>
<div class="line"><a name="l04152"></a><span class="lineno"> 4152</span>&#160;                                               dmom_w_adv_v_ext,</div>
<div class="line"><a name="l04153"></a><span class="lineno"> 4153</span>&#160;                                               dmom_w_adv_w_ext,</div>
<div class="line"><a name="l04154"></a><span class="lineno"> 4154</span>&#160;                                               flux_mass_ext,</div>
<div class="line"><a name="l04155"></a><span class="lineno"> 4155</span>&#160;                                               flux_mom_u_adv_ext,</div>
<div class="line"><a name="l04156"></a><span class="lineno"> 4156</span>&#160;                                               flux_mom_v_adv_ext,</div>
<div class="line"><a name="l04157"></a><span class="lineno"> 4157</span>&#160;                                               flux_mom_w_adv_ext,</div>
<div class="line"><a name="l04158"></a><span class="lineno"> 4158</span>&#160;                                               &amp;ebqe_velocity[ebNE_kb_nSpace]);</div>
<div class="line"><a name="l04159"></a><span class="lineno"> 4159</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#aba606100197bd1648a169d46dcf84ad0">exteriorNumericalDiffusiveFlux</a>(eps_rho,</div>
<div class="line"><a name="l04160"></a><span class="lineno"> 4160</span>&#160;                                               ebqe_phi_ext[ebNE_kb],</div>
<div class="line"><a name="l04161"></a><span class="lineno"> 4161</span>&#160;                                               sdInfo_u_u_rowptr,</div>
<div class="line"><a name="l04162"></a><span class="lineno"> 4162</span>&#160;                                               sdInfo_u_u_colind,</div>
<div class="line"><a name="l04163"></a><span class="lineno"> 4163</span>&#160;                                               isDOFBoundary_u[ebNE_kb],</div>
<div class="line"><a name="l04164"></a><span class="lineno"> 4164</span>&#160;                                               isDiffusiveFluxBoundary_u[ebNE_kb],</div>
<div class="line"><a name="l04165"></a><span class="lineno"> 4165</span>&#160;                                               normal,</div>
<div class="line"><a name="l04166"></a><span class="lineno"> 4166</span>&#160;                                               bc_mom_uu_diff_ten_ext,</div>
<div class="line"><a name="l04167"></a><span class="lineno"> 4167</span>&#160;                                               bc_u_ext,</div>
<div class="line"><a name="l04168"></a><span class="lineno"> 4168</span>&#160;                                               ebqe_bc_flux_u_diff_ext[ebNE_kb],</div>
<div class="line"><a name="l04169"></a><span class="lineno"> 4169</span>&#160;                                               mom_uu_diff_ten_ext,</div>
<div class="line"><a name="l04170"></a><span class="lineno"> 4170</span>&#160;                                               grad_u_ext,</div>
<div class="line"><a name="l04171"></a><span class="lineno"> 4171</span>&#160;                                               u_ext,</div>
<div class="line"><a name="l04172"></a><span class="lineno"> 4172</span>&#160;                                               penalty,<span class="comment">//ebqe_penalty_ext[ebNE_kb],</span></div>
<div class="line"><a name="l04173"></a><span class="lineno"> 4173</span>&#160;                                               flux_mom_uu_diff_ext);</div>
<div class="line"><a name="l04174"></a><span class="lineno"> 4174</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#aba606100197bd1648a169d46dcf84ad0">exteriorNumericalDiffusiveFlux</a>(eps_rho,</div>
<div class="line"><a name="l04175"></a><span class="lineno"> 4175</span>&#160;                                               ebqe_phi_ext[ebNE_kb],</div>
<div class="line"><a name="l04176"></a><span class="lineno"> 4176</span>&#160;                                               sdInfo_u_v_rowptr,</div>
<div class="line"><a name="l04177"></a><span class="lineno"> 4177</span>&#160;                                               sdInfo_u_v_colind,</div>
<div class="line"><a name="l04178"></a><span class="lineno"> 4178</span>&#160;                                               isDOFBoundary_v[ebNE_kb],</div>
<div class="line"><a name="l04179"></a><span class="lineno"> 4179</span>&#160;                                               isDiffusiveFluxBoundary_v[ebNE_kb],</div>
<div class="line"><a name="l04180"></a><span class="lineno"> 4180</span>&#160;                                               normal,</div>
<div class="line"><a name="l04181"></a><span class="lineno"> 4181</span>&#160;                                               bc_mom_uv_diff_ten_ext,</div>
<div class="line"><a name="l04182"></a><span class="lineno"> 4182</span>&#160;                                               bc_v_ext,</div>
<div class="line"><a name="l04183"></a><span class="lineno"> 4183</span>&#160;                                               0.0,<span class="comment">//assume all of the flux gets applied in diagonal component</span></div>
<div class="line"><a name="l04184"></a><span class="lineno"> 4184</span>&#160;                                               mom_uv_diff_ten_ext,</div>
<div class="line"><a name="l04185"></a><span class="lineno"> 4185</span>&#160;                                               grad_v_ext,</div>
<div class="line"><a name="l04186"></a><span class="lineno"> 4186</span>&#160;                                               v_ext,</div>
<div class="line"><a name="l04187"></a><span class="lineno"> 4187</span>&#160;                                               penalty,<span class="comment">//ebqe_penalty_ext[ebNE_kb],</span></div>
<div class="line"><a name="l04188"></a><span class="lineno"> 4188</span>&#160;                                               flux_mom_uv_diff_ext);</div>
<div class="line"><a name="l04189"></a><span class="lineno"> 4189</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#aba606100197bd1648a169d46dcf84ad0">exteriorNumericalDiffusiveFlux</a>(eps_rho,</div>
<div class="line"><a name="l04190"></a><span class="lineno"> 4190</span>&#160;                                               ebqe_phi_ext[ebNE_kb],</div>
<div class="line"><a name="l04191"></a><span class="lineno"> 4191</span>&#160;                                               sdInfo_u_w_rowptr,</div>
<div class="line"><a name="l04192"></a><span class="lineno"> 4192</span>&#160;                                               sdInfo_u_w_colind,</div>
<div class="line"><a name="l04193"></a><span class="lineno"> 4193</span>&#160;                                               isDOFBoundary_w[ebNE_kb],</div>
<div class="line"><a name="l04194"></a><span class="lineno"> 4194</span>&#160;                                               isDiffusiveFluxBoundary_w[ebNE_kb],</div>
<div class="line"><a name="l04195"></a><span class="lineno"> 4195</span>&#160;                                               normal,</div>
<div class="line"><a name="l04196"></a><span class="lineno"> 4196</span>&#160;                                               bc_mom_uw_diff_ten_ext,</div>
<div class="line"><a name="l04197"></a><span class="lineno"> 4197</span>&#160;                                               bc_w_ext,</div>
<div class="line"><a name="l04198"></a><span class="lineno"> 4198</span>&#160;                                               0.0,<span class="comment">//see above</span></div>
<div class="line"><a name="l04199"></a><span class="lineno"> 4199</span>&#160;                                               mom_uw_diff_ten_ext,</div>
<div class="line"><a name="l04200"></a><span class="lineno"> 4200</span>&#160;                                               grad_w_ext,</div>
<div class="line"><a name="l04201"></a><span class="lineno"> 4201</span>&#160;                                               w_ext,</div>
<div class="line"><a name="l04202"></a><span class="lineno"> 4202</span>&#160;                                               penalty,<span class="comment">//ebqe_penalty_ext[ebNE_kb],</span></div>
<div class="line"><a name="l04203"></a><span class="lineno"> 4203</span>&#160;                                               flux_mom_uw_diff_ext);</div>
<div class="line"><a name="l04204"></a><span class="lineno"> 4204</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#aba606100197bd1648a169d46dcf84ad0">exteriorNumericalDiffusiveFlux</a>(eps_rho,</div>
<div class="line"><a name="l04205"></a><span class="lineno"> 4205</span>&#160;                                               ebqe_phi_ext[ebNE_kb],</div>
<div class="line"><a name="l04206"></a><span class="lineno"> 4206</span>&#160;                                               sdInfo_v_u_rowptr,</div>
<div class="line"><a name="l04207"></a><span class="lineno"> 4207</span>&#160;                                               sdInfo_v_u_colind,</div>
<div class="line"><a name="l04208"></a><span class="lineno"> 4208</span>&#160;                                               isDOFBoundary_u[ebNE_kb],</div>
<div class="line"><a name="l04209"></a><span class="lineno"> 4209</span>&#160;                                               isDiffusiveFluxBoundary_u[ebNE_kb],</div>
<div class="line"><a name="l04210"></a><span class="lineno"> 4210</span>&#160;                                               normal,</div>
<div class="line"><a name="l04211"></a><span class="lineno"> 4211</span>&#160;                                               bc_mom_vu_diff_ten_ext,</div>
<div class="line"><a name="l04212"></a><span class="lineno"> 4212</span>&#160;                                               bc_u_ext,</div>
<div class="line"><a name="l04213"></a><span class="lineno"> 4213</span>&#160;                                               0.0,<span class="comment">//see above</span></div>
<div class="line"><a name="l04214"></a><span class="lineno"> 4214</span>&#160;                                               mom_vu_diff_ten_ext,</div>
<div class="line"><a name="l04215"></a><span class="lineno"> 4215</span>&#160;                                               grad_u_ext,</div>
<div class="line"><a name="l04216"></a><span class="lineno"> 4216</span>&#160;                                               u_ext,</div>
<div class="line"><a name="l04217"></a><span class="lineno"> 4217</span>&#160;                                               penalty,<span class="comment">//ebqe_penalty_ext[ebNE_kb],</span></div>
<div class="line"><a name="l04218"></a><span class="lineno"> 4218</span>&#160;                                               flux_mom_vu_diff_ext);</div>
<div class="line"><a name="l04219"></a><span class="lineno"> 4219</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#aba606100197bd1648a169d46dcf84ad0">exteriorNumericalDiffusiveFlux</a>(eps_rho,</div>
<div class="line"><a name="l04220"></a><span class="lineno"> 4220</span>&#160;                                               ebqe_phi_ext[ebNE_kb],</div>
<div class="line"><a name="l04221"></a><span class="lineno"> 4221</span>&#160;                                               sdInfo_v_v_rowptr,</div>
<div class="line"><a name="l04222"></a><span class="lineno"> 4222</span>&#160;                                               sdInfo_v_v_colind,</div>
<div class="line"><a name="l04223"></a><span class="lineno"> 4223</span>&#160;                                               isDOFBoundary_v[ebNE_kb],</div>
<div class="line"><a name="l04224"></a><span class="lineno"> 4224</span>&#160;                                               isDiffusiveFluxBoundary_v[ebNE_kb],</div>
<div class="line"><a name="l04225"></a><span class="lineno"> 4225</span>&#160;                                               normal,</div>
<div class="line"><a name="l04226"></a><span class="lineno"> 4226</span>&#160;                                               bc_mom_vv_diff_ten_ext,</div>
<div class="line"><a name="l04227"></a><span class="lineno"> 4227</span>&#160;                                               bc_v_ext,</div>
<div class="line"><a name="l04228"></a><span class="lineno"> 4228</span>&#160;                                               ebqe_bc_flux_v_diff_ext[ebNE_kb],</div>
<div class="line"><a name="l04229"></a><span class="lineno"> 4229</span>&#160;                                               mom_vv_diff_ten_ext,</div>
<div class="line"><a name="l04230"></a><span class="lineno"> 4230</span>&#160;                                               grad_v_ext,</div>
<div class="line"><a name="l04231"></a><span class="lineno"> 4231</span>&#160;                                               v_ext,</div>
<div class="line"><a name="l04232"></a><span class="lineno"> 4232</span>&#160;                                               penalty,<span class="comment">//ebqe_penalty_ext[ebNE_kb],</span></div>
<div class="line"><a name="l04233"></a><span class="lineno"> 4233</span>&#160;                                               flux_mom_vv_diff_ext);</div>
<div class="line"><a name="l04234"></a><span class="lineno"> 4234</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#aba606100197bd1648a169d46dcf84ad0">exteriorNumericalDiffusiveFlux</a>(eps_rho,</div>
<div class="line"><a name="l04235"></a><span class="lineno"> 4235</span>&#160;                                               ebqe_phi_ext[ebNE_kb],</div>
<div class="line"><a name="l04236"></a><span class="lineno"> 4236</span>&#160;                                               sdInfo_v_w_rowptr,</div>
<div class="line"><a name="l04237"></a><span class="lineno"> 4237</span>&#160;                                               sdInfo_v_w_colind,</div>
<div class="line"><a name="l04238"></a><span class="lineno"> 4238</span>&#160;                                               isDOFBoundary_w[ebNE_kb],</div>
<div class="line"><a name="l04239"></a><span class="lineno"> 4239</span>&#160;                                               isDiffusiveFluxBoundary_w[ebNE_kb],</div>
<div class="line"><a name="l04240"></a><span class="lineno"> 4240</span>&#160;                                               normal,</div>
<div class="line"><a name="l04241"></a><span class="lineno"> 4241</span>&#160;                                               bc_mom_vw_diff_ten_ext,</div>
<div class="line"><a name="l04242"></a><span class="lineno"> 4242</span>&#160;                                               bc_w_ext,</div>
<div class="line"><a name="l04243"></a><span class="lineno"> 4243</span>&#160;                                               0.0,<span class="comment">//see above</span></div>
<div class="line"><a name="l04244"></a><span class="lineno"> 4244</span>&#160;                                               mom_vw_diff_ten_ext,</div>
<div class="line"><a name="l04245"></a><span class="lineno"> 4245</span>&#160;                                               grad_w_ext,</div>
<div class="line"><a name="l04246"></a><span class="lineno"> 4246</span>&#160;                                               w_ext,</div>
<div class="line"><a name="l04247"></a><span class="lineno"> 4247</span>&#160;                                               penalty,<span class="comment">//ebqe_penalty_ext[ebNE_kb],</span></div>
<div class="line"><a name="l04248"></a><span class="lineno"> 4248</span>&#160;                                               flux_mom_vw_diff_ext);</div>
<div class="line"><a name="l04249"></a><span class="lineno"> 4249</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#aba606100197bd1648a169d46dcf84ad0">exteriorNumericalDiffusiveFlux</a>(eps_rho,</div>
<div class="line"><a name="l04250"></a><span class="lineno"> 4250</span>&#160;                                               ebqe_phi_ext[ebNE_kb],</div>
<div class="line"><a name="l04251"></a><span class="lineno"> 4251</span>&#160;                                               sdInfo_w_u_rowptr,</div>
<div class="line"><a name="l04252"></a><span class="lineno"> 4252</span>&#160;                                               sdInfo_w_u_colind,</div>
<div class="line"><a name="l04253"></a><span class="lineno"> 4253</span>&#160;                                               isDOFBoundary_u[ebNE_kb],</div>
<div class="line"><a name="l04254"></a><span class="lineno"> 4254</span>&#160;                                               isDiffusiveFluxBoundary_u[ebNE_kb],</div>
<div class="line"><a name="l04255"></a><span class="lineno"> 4255</span>&#160;                                               normal,</div>
<div class="line"><a name="l04256"></a><span class="lineno"> 4256</span>&#160;                                               bc_mom_wu_diff_ten_ext,</div>
<div class="line"><a name="l04257"></a><span class="lineno"> 4257</span>&#160;                                               bc_u_ext,</div>
<div class="line"><a name="l04258"></a><span class="lineno"> 4258</span>&#160;                                               0.0,<span class="comment">//see above</span></div>
<div class="line"><a name="l04259"></a><span class="lineno"> 4259</span>&#160;                                               mom_wu_diff_ten_ext,</div>
<div class="line"><a name="l04260"></a><span class="lineno"> 4260</span>&#160;                                               grad_u_ext,</div>
<div class="line"><a name="l04261"></a><span class="lineno"> 4261</span>&#160;                                               u_ext,</div>
<div class="line"><a name="l04262"></a><span class="lineno"> 4262</span>&#160;                                               penalty,<span class="comment">//ebqe_penalty_ext[ebNE_kb],</span></div>
<div class="line"><a name="l04263"></a><span class="lineno"> 4263</span>&#160;                                               flux_mom_wu_diff_ext);</div>
<div class="line"><a name="l04264"></a><span class="lineno"> 4264</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#aba606100197bd1648a169d46dcf84ad0">exteriorNumericalDiffusiveFlux</a>(eps_rho,</div>
<div class="line"><a name="l04265"></a><span class="lineno"> 4265</span>&#160;                                               ebqe_phi_ext[ebNE_kb],</div>
<div class="line"><a name="l04266"></a><span class="lineno"> 4266</span>&#160;                                               sdInfo_w_v_rowptr,</div>
<div class="line"><a name="l04267"></a><span class="lineno"> 4267</span>&#160;                                               sdInfo_w_v_colind,</div>
<div class="line"><a name="l04268"></a><span class="lineno"> 4268</span>&#160;                                               isDOFBoundary_v[ebNE_kb],</div>
<div class="line"><a name="l04269"></a><span class="lineno"> 4269</span>&#160;                                               isDiffusiveFluxBoundary_v[ebNE_kb],</div>
<div class="line"><a name="l04270"></a><span class="lineno"> 4270</span>&#160;                                               normal,</div>
<div class="line"><a name="l04271"></a><span class="lineno"> 4271</span>&#160;                                               bc_mom_wv_diff_ten_ext,</div>
<div class="line"><a name="l04272"></a><span class="lineno"> 4272</span>&#160;                                               bc_v_ext,</div>
<div class="line"><a name="l04273"></a><span class="lineno"> 4273</span>&#160;                                               0.0,<span class="comment">//see above</span></div>
<div class="line"><a name="l04274"></a><span class="lineno"> 4274</span>&#160;                                               mom_wv_diff_ten_ext,</div>
<div class="line"><a name="l04275"></a><span class="lineno"> 4275</span>&#160;                                               grad_v_ext,</div>
<div class="line"><a name="l04276"></a><span class="lineno"> 4276</span>&#160;                                               v_ext,</div>
<div class="line"><a name="l04277"></a><span class="lineno"> 4277</span>&#160;                                               penalty,<span class="comment">//ebqe_penalty_ext[ebNE_kb],</span></div>
<div class="line"><a name="l04278"></a><span class="lineno"> 4278</span>&#160;                                               flux_mom_wv_diff_ext);</div>
<div class="line"><a name="l04279"></a><span class="lineno"> 4279</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#aba606100197bd1648a169d46dcf84ad0">exteriorNumericalDiffusiveFlux</a>(eps_rho,</div>
<div class="line"><a name="l04280"></a><span class="lineno"> 4280</span>&#160;                                               ebqe_phi_ext[ebNE_kb],</div>
<div class="line"><a name="l04281"></a><span class="lineno"> 4281</span>&#160;                                               sdInfo_w_w_rowptr,</div>
<div class="line"><a name="l04282"></a><span class="lineno"> 4282</span>&#160;                                               sdInfo_w_w_colind,</div>
<div class="line"><a name="l04283"></a><span class="lineno"> 4283</span>&#160;                                               isDOFBoundary_w[ebNE_kb],</div>
<div class="line"><a name="l04284"></a><span class="lineno"> 4284</span>&#160;                                               isDiffusiveFluxBoundary_w[ebNE_kb],</div>
<div class="line"><a name="l04285"></a><span class="lineno"> 4285</span>&#160;                                               normal,</div>
<div class="line"><a name="l04286"></a><span class="lineno"> 4286</span>&#160;                                               bc_mom_ww_diff_ten_ext,</div>
<div class="line"><a name="l04287"></a><span class="lineno"> 4287</span>&#160;                                               bc_w_ext,</div>
<div class="line"><a name="l04288"></a><span class="lineno"> 4288</span>&#160;                                               ebqe_bc_flux_w_diff_ext[ebNE_kb],</div>
<div class="line"><a name="l04289"></a><span class="lineno"> 4289</span>&#160;                                               mom_ww_diff_ten_ext,</div>
<div class="line"><a name="l04290"></a><span class="lineno"> 4290</span>&#160;                                               grad_w_ext,</div>
<div class="line"><a name="l04291"></a><span class="lineno"> 4291</span>&#160;                                               w_ext,</div>
<div class="line"><a name="l04292"></a><span class="lineno"> 4292</span>&#160;                                               penalty,<span class="comment">//ebqe_penalty_ext[ebNE_kb],</span></div>
<div class="line"><a name="l04293"></a><span class="lineno"> 4293</span>&#160;                                               flux_mom_ww_diff_ext);</div>
<div class="line"><a name="l04294"></a><span class="lineno"> 4294</span>&#160;                flux[ebN*nQuadraturePoints_elementBoundary+kb] = flux_mass_ext;</div>
<div class="line"><a name="l04295"></a><span class="lineno"> 4295</span>&#160;                <span class="comment">/* std::cout&lt;&lt;&quot;external u,v,u_n &quot; */</span></div>
<div class="line"><a name="l04296"></a><span class="lineno"> 4296</span>&#160;                <span class="comment">/*             &lt;&lt;ebqe_velocity[ebNE_kb_nSpace+0]&lt;&lt;&#39;\t&#39; */</span></div>
<div class="line"><a name="l04297"></a><span class="lineno"> 4297</span>&#160;                <span class="comment">/*             &lt;&lt;ebqe_velocity[ebNE_kb_nSpace+1]&lt;&lt;&#39;\t&#39; */</span></div>
<div class="line"><a name="l04298"></a><span class="lineno"> 4298</span>&#160;                <span class="comment">/*             &lt;&lt;flux[ebN*nQuadraturePoints_elementBoundary+kb]&lt;&lt;std::endl; */</span></div>
<div class="line"><a name="l04299"></a><span class="lineno"> 4299</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l04300"></a><span class="lineno"> 4300</span>&#160;                <span class="comment">//integrate the net force and moment on flagged boundaries</span></div>
<div class="line"><a name="l04301"></a><span class="lineno"> 4301</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l04302"></a><span class="lineno"> 4302</span>&#160;                <span class="keywordflow">if</span> (ebN &lt; nElementBoundaries_owned)</div>
<div class="line"><a name="l04303"></a><span class="lineno"> 4303</span>&#160;                  {</div>
<div class="line"><a name="l04304"></a><span class="lineno"> 4304</span>&#160;                    force_v_x = (flux_mom_u_adv_ext + flux_mom_uu_diff_ext + flux_mom_uv_diff_ext + flux_mom_uw_diff_ext)/dmom_u_ham_grad_p_ext[0];<span class="comment">//same as *rho</span></div>
<div class="line"><a name="l04305"></a><span class="lineno"> 4305</span>&#160;                    force_v_y = (flux_mom_v_adv_ext + flux_mom_vu_diff_ext + flux_mom_vv_diff_ext + flux_mom_vw_diff_ext)/dmom_u_ham_grad_p_ext[0];</div>
<div class="line"><a name="l04306"></a><span class="lineno"> 4306</span>&#160;                    force_v_z = (flux_mom_w_adv_ext + flux_mom_wu_diff_ext + flux_mom_wv_diff_ext + flux_mom_ww_diff_ext)/dmom_u_ham_grad_p_ext[0];</div>
<div class="line"><a name="l04307"></a><span class="lineno"> 4307</span>&#160; </div>
<div class="line"><a name="l04308"></a><span class="lineno"> 4308</span>&#160;                    force_p_x = p_ext*normal[0];</div>
<div class="line"><a name="l04309"></a><span class="lineno"> 4309</span>&#160;                    force_p_y = p_ext*normal[1];</div>
<div class="line"><a name="l04310"></a><span class="lineno"> 4310</span>&#160;                    force_p_z = p_ext*normal[2];</div>
<div class="line"><a name="l04311"></a><span class="lineno"> 4311</span>&#160; </div>
<div class="line"><a name="l04312"></a><span class="lineno"> 4312</span>&#160;                    force_x = force_p_x + force_v_x;</div>
<div class="line"><a name="l04313"></a><span class="lineno"> 4313</span>&#160;                    force_y = force_p_y + force_v_y;</div>
<div class="line"><a name="l04314"></a><span class="lineno"> 4314</span>&#160;                    force_z = force_p_z + force_v_z;</div>
<div class="line"><a name="l04315"></a><span class="lineno"> 4315</span>&#160; </div>
<div class="line"><a name="l04316"></a><span class="lineno"> 4316</span>&#160;                    r_x = x_ext - barycenters[3*boundaryFlags[ebN]+0];</div>
<div class="line"><a name="l04317"></a><span class="lineno"> 4317</span>&#160;                    r_y = y_ext - barycenters[3*boundaryFlags[ebN]+1];</div>
<div class="line"><a name="l04318"></a><span class="lineno"> 4318</span>&#160;                    r_z = z_ext - barycenters[3*boundaryFlags[ebN]+2];</div>
<div class="line"><a name="l04319"></a><span class="lineno"> 4319</span>&#160; </div>
<div class="line"><a name="l04320"></a><span class="lineno"> 4320</span>&#160;                    wettedAreas[boundaryFlags[ebN]] += dS*(1.0-ebqe_vf_ext[ebNE_kb]);</div>
<div class="line"><a name="l04321"></a><span class="lineno"> 4321</span>&#160; </div>
<div class="line"><a name="l04322"></a><span class="lineno"> 4322</span>&#160;                    netForces_p[3*boundaryFlags[ebN]+0] += force_p_x*dS;</div>
<div class="line"><a name="l04323"></a><span class="lineno"> 4323</span>&#160;                    netForces_p[3*boundaryFlags[ebN]+1] += force_p_y*dS;</div>
<div class="line"><a name="l04324"></a><span class="lineno"> 4324</span>&#160;                    netForces_p[3*boundaryFlags[ebN]+2] += force_p_z*dS;</div>
<div class="line"><a name="l04325"></a><span class="lineno"> 4325</span>&#160; </div>
<div class="line"><a name="l04326"></a><span class="lineno"> 4326</span>&#160;                    netForces_v[3*boundaryFlags[ebN]+0] += force_v_x*dS;</div>
<div class="line"><a name="l04327"></a><span class="lineno"> 4327</span>&#160;                    netForces_v[3*boundaryFlags[ebN]+1] += force_v_y*dS;</div>
<div class="line"><a name="l04328"></a><span class="lineno"> 4328</span>&#160;                    netForces_v[3*boundaryFlags[ebN]+2] += force_v_z*dS;</div>
<div class="line"><a name="l04329"></a><span class="lineno"> 4329</span>&#160; </div>
<div class="line"><a name="l04330"></a><span class="lineno"> 4330</span>&#160;                    netMoments[3*boundaryFlags[ebN]+0] += (r_y*force_z - r_z*force_y)*dS;</div>
<div class="line"><a name="l04331"></a><span class="lineno"> 4331</span>&#160;                    netMoments[3*boundaryFlags[ebN]+1] += (r_z*force_x - r_x*force_z)*dS;</div>
<div class="line"><a name="l04332"></a><span class="lineno"> 4332</span>&#160;                    netMoments[3*boundaryFlags[ebN]+2] += (r_x*force_y - r_y*force_x)*dS;</div>
<div class="line"><a name="l04333"></a><span class="lineno"> 4333</span>&#160;                  }</div>
<div class="line"><a name="l04334"></a><span class="lineno"> 4334</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l04335"></a><span class="lineno"> 4335</span>&#160;                <span class="comment">//update residuals</span></div>
<div class="line"><a name="l04336"></a><span class="lineno"> 4336</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l04337"></a><span class="lineno"> 4337</span>&#160;                <span class="keywordflow">if</span>(<span class="keyword">true</span>)<span class="comment">//boundaryFlags[ebN] &gt; 0)</span></div>
<div class="line"><a name="l04338"></a><span class="lineno"> 4338</span>&#160;                  { <span class="comment">//ignore flux contributions on interpart boundaries</span></div>
<div class="line"><a name="l04339"></a><span class="lineno"> 4339</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;nDOF_test_element;i++)</div>
<div class="line"><a name="l04340"></a><span class="lineno"> 4340</span>&#160;                      {</div>
<div class="line"><a name="l04341"></a><span class="lineno"> 4341</span>&#160;                        elementResidual_mesh[i] -= <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.ExteriorElementBoundaryFlux(MOVING_DOMAIN*(xt_ext*normal[0]+yt_ext*normal[1]+zt_ext*normal[2]),p_test_dS[i]);</div>
<div class="line"><a name="l04342"></a><span class="lineno"> 4342</span>&#160;                        elementResidual_p[i] += <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.ExteriorElementBoundaryFlux(flux_mass_ext,p_test_dS[i]);</div>
<div class="line"><a name="l04343"></a><span class="lineno"> 4343</span>&#160;                        elementResidual_p[i] -= <a class="code" href="_r_a_n_s2_p_8h.html#aaef02b6e1d46c51958a20651954c60b0">DM</a>*<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.ExteriorElementBoundaryFlux(MOVING_DOMAIN*(xt_ext*normal[0]+yt_ext*normal[1]+zt_ext*normal[2]),p_test_dS[i]);</div>
<div class="line"><a name="l04344"></a><span class="lineno"> 4344</span>&#160;                        globalConservationError += <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.ExteriorElementBoundaryFlux(flux_mass_ext,p_test_dS[i]);</div>
<div class="line"><a name="l04345"></a><span class="lineno"> 4345</span>&#160;                      }</div>
<div class="line"><a name="l04346"></a><span class="lineno"> 4346</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;nDOF_v_test_element;i++)</div>
<div class="line"><a name="l04347"></a><span class="lineno"> 4347</span>&#160;                      {</div>
<div class="line"><a name="l04348"></a><span class="lineno"> 4348</span>&#160;                        elementResidual_u[i] += <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.ExteriorElementBoundaryFlux(flux_mom_u_adv_ext,vel_test_dS[i])+</div>
<div class="line"><a name="l04349"></a><span class="lineno"> 4349</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.ExteriorElementBoundaryFlux(flux_mom_uu_diff_ext,vel_test_dS[i])+</div>
<div class="line"><a name="l04350"></a><span class="lineno"> 4350</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.ExteriorElementBoundaryFlux(flux_mom_uv_diff_ext,vel_test_dS[i])+</div>
<div class="line"><a name="l04351"></a><span class="lineno"> 4351</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.ExteriorElementBoundaryFlux(flux_mom_uw_diff_ext,vel_test_dS[i])+</div>
<div class="line"><a name="l04352"></a><span class="lineno"> 4352</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.ExteriorElementBoundaryDiffusionAdjoint(isDOFBoundary_u[ebNE_kb],</div>
<div class="line"><a name="l04353"></a><span class="lineno"> 4353</span>&#160;                                                                     isDiffusiveFluxBoundary_u[ebNE_kb],</div>
<div class="line"><a name="l04354"></a><span class="lineno"> 4354</span>&#160;                                                                     eb_adjoint_sigma,</div>
<div class="line"><a name="l04355"></a><span class="lineno"> 4355</span>&#160;                                                                     u_ext,</div>
<div class="line"><a name="l04356"></a><span class="lineno"> 4356</span>&#160;                                                                     bc_u_ext,</div>
<div class="line"><a name="l04357"></a><span class="lineno"> 4357</span>&#160;                                                                     normal,</div>
<div class="line"><a name="l04358"></a><span class="lineno"> 4358</span>&#160;                                                                     sdInfo_u_u_rowptr,</div>
<div class="line"><a name="l04359"></a><span class="lineno"> 4359</span>&#160;                                                                     sdInfo_u_u_colind,</div>
<div class="line"><a name="l04360"></a><span class="lineno"> 4360</span>&#160;                                                                     mom_uu_diff_ten_ext,</div>
<div class="line"><a name="l04361"></a><span class="lineno"> 4361</span>&#160;                                                                     &amp;vel_grad_test_dS[i*nSpace])+</div>
<div class="line"><a name="l04362"></a><span class="lineno"> 4362</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.ExteriorElementBoundaryDiffusionAdjoint(isDOFBoundary_v[ebNE_kb],</div>
<div class="line"><a name="l04363"></a><span class="lineno"> 4363</span>&#160;                                                                     isDiffusiveFluxBoundary_u[ebNE_kb],</div>
<div class="line"><a name="l04364"></a><span class="lineno"> 4364</span>&#160;                                                                     eb_adjoint_sigma,</div>
<div class="line"><a name="l04365"></a><span class="lineno"> 4365</span>&#160;                                                                     v_ext,</div>
<div class="line"><a name="l04366"></a><span class="lineno"> 4366</span>&#160;                                                                     bc_v_ext,</div>
<div class="line"><a name="l04367"></a><span class="lineno"> 4367</span>&#160;                                                                     normal,</div>
<div class="line"><a name="l04368"></a><span class="lineno"> 4368</span>&#160;                                                                     sdInfo_u_v_rowptr,</div>
<div class="line"><a name="l04369"></a><span class="lineno"> 4369</span>&#160;                                                                     sdInfo_u_v_colind,</div>
<div class="line"><a name="l04370"></a><span class="lineno"> 4370</span>&#160;                                                                     mom_uv_diff_ten_ext,</div>
<div class="line"><a name="l04371"></a><span class="lineno"> 4371</span>&#160;                                                                     &amp;vel_grad_test_dS[i*nSpace])+</div>
<div class="line"><a name="l04372"></a><span class="lineno"> 4372</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.ExteriorElementBoundaryDiffusionAdjoint(isDOFBoundary_w[ebNE_kb],</div>
<div class="line"><a name="l04373"></a><span class="lineno"> 4373</span>&#160;                                                                     isDiffusiveFluxBoundary_u[ebNE_kb],</div>
<div class="line"><a name="l04374"></a><span class="lineno"> 4374</span>&#160;                                                                     eb_adjoint_sigma,</div>
<div class="line"><a name="l04375"></a><span class="lineno"> 4375</span>&#160;                                                                     w_ext,</div>
<div class="line"><a name="l04376"></a><span class="lineno"> 4376</span>&#160;                                                                     bc_w_ext,</div>
<div class="line"><a name="l04377"></a><span class="lineno"> 4377</span>&#160;                                                                     normal,</div>
<div class="line"><a name="l04378"></a><span class="lineno"> 4378</span>&#160;                                                                     sdInfo_u_w_rowptr,</div>
<div class="line"><a name="l04379"></a><span class="lineno"> 4379</span>&#160;                                                                     sdInfo_u_w_colind,</div>
<div class="line"><a name="l04380"></a><span class="lineno"> 4380</span>&#160;                                                                     mom_uw_diff_ten_ext,</div>
<div class="line"><a name="l04381"></a><span class="lineno"> 4381</span>&#160;                                                                     &amp;vel_grad_test_dS[i*nSpace]);</div>
<div class="line"><a name="l04382"></a><span class="lineno"> 4382</span>&#160;                        elementResidual_v[i] += <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.ExteriorElementBoundaryFlux(flux_mom_v_adv_ext,vel_test_dS[i]) +</div>
<div class="line"><a name="l04383"></a><span class="lineno"> 4383</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.ExteriorElementBoundaryFlux(flux_mom_vu_diff_ext,vel_test_dS[i])+</div>
<div class="line"><a name="l04384"></a><span class="lineno"> 4384</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.ExteriorElementBoundaryFlux(flux_mom_vv_diff_ext,vel_test_dS[i])+</div>
<div class="line"><a name="l04385"></a><span class="lineno"> 4385</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.ExteriorElementBoundaryFlux(flux_mom_vw_diff_ext,vel_test_dS[i])+</div>
<div class="line"><a name="l04386"></a><span class="lineno"> 4386</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.ExteriorElementBoundaryDiffusionAdjoint(isDOFBoundary_u[ebNE_kb],</div>
<div class="line"><a name="l04387"></a><span class="lineno"> 4387</span>&#160;                                                                     isDiffusiveFluxBoundary_v[ebNE_kb],</div>
<div class="line"><a name="l04388"></a><span class="lineno"> 4388</span>&#160;                                                                     eb_adjoint_sigma,</div>
<div class="line"><a name="l04389"></a><span class="lineno"> 4389</span>&#160;                                                                     u_ext,</div>
<div class="line"><a name="l04390"></a><span class="lineno"> 4390</span>&#160;                                                                     bc_u_ext,</div>
<div class="line"><a name="l04391"></a><span class="lineno"> 4391</span>&#160;                                                                     normal,</div>
<div class="line"><a name="l04392"></a><span class="lineno"> 4392</span>&#160;                                                                     sdInfo_v_u_rowptr,</div>
<div class="line"><a name="l04393"></a><span class="lineno"> 4393</span>&#160;                                                                     sdInfo_v_u_colind,</div>
<div class="line"><a name="l04394"></a><span class="lineno"> 4394</span>&#160;                                                                     mom_vu_diff_ten_ext,</div>
<div class="line"><a name="l04395"></a><span class="lineno"> 4395</span>&#160;                                                                     &amp;vel_grad_test_dS[i*nSpace])+</div>
<div class="line"><a name="l04396"></a><span class="lineno"> 4396</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.ExteriorElementBoundaryDiffusionAdjoint(isDOFBoundary_v[ebNE_kb],</div>
<div class="line"><a name="l04397"></a><span class="lineno"> 4397</span>&#160;                                                                     isDiffusiveFluxBoundary_v[ebNE_kb],</div>
<div class="line"><a name="l04398"></a><span class="lineno"> 4398</span>&#160;                                                                     eb_adjoint_sigma,</div>
<div class="line"><a name="l04399"></a><span class="lineno"> 4399</span>&#160;                                                                     v_ext,</div>
<div class="line"><a name="l04400"></a><span class="lineno"> 4400</span>&#160;                                                                     bc_v_ext,</div>
<div class="line"><a name="l04401"></a><span class="lineno"> 4401</span>&#160;                                                                     normal,</div>
<div class="line"><a name="l04402"></a><span class="lineno"> 4402</span>&#160;                                                                     sdInfo_v_v_rowptr,</div>
<div class="line"><a name="l04403"></a><span class="lineno"> 4403</span>&#160;                                                                     sdInfo_v_v_colind,</div>
<div class="line"><a name="l04404"></a><span class="lineno"> 4404</span>&#160;                                                                     mom_vv_diff_ten_ext,</div>
<div class="line"><a name="l04405"></a><span class="lineno"> 4405</span>&#160;                                                                     &amp;vel_grad_test_dS[i*nSpace])+</div>
<div class="line"><a name="l04406"></a><span class="lineno"> 4406</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.ExteriorElementBoundaryDiffusionAdjoint(isDOFBoundary_w[ebNE_kb],</div>
<div class="line"><a name="l04407"></a><span class="lineno"> 4407</span>&#160;                                                                     isDiffusiveFluxBoundary_v[ebNE_kb],</div>
<div class="line"><a name="l04408"></a><span class="lineno"> 4408</span>&#160;                                                                     eb_adjoint_sigma,</div>
<div class="line"><a name="l04409"></a><span class="lineno"> 4409</span>&#160;                                                                     w_ext,</div>
<div class="line"><a name="l04410"></a><span class="lineno"> 4410</span>&#160;                                                                     bc_w_ext,</div>
<div class="line"><a name="l04411"></a><span class="lineno"> 4411</span>&#160;                                                                     normal,</div>
<div class="line"><a name="l04412"></a><span class="lineno"> 4412</span>&#160;                                                                     sdInfo_v_w_rowptr,</div>
<div class="line"><a name="l04413"></a><span class="lineno"> 4413</span>&#160;                                                                     sdInfo_v_w_colind,</div>
<div class="line"><a name="l04414"></a><span class="lineno"> 4414</span>&#160;                                                                     mom_vw_diff_ten_ext,</div>
<div class="line"><a name="l04415"></a><span class="lineno"> 4415</span>&#160;                                                                     &amp;vel_grad_test_dS[i*nSpace]);</div>
<div class="line"><a name="l04416"></a><span class="lineno"> 4416</span>&#160; </div>
<div class="line"><a name="l04417"></a><span class="lineno"> 4417</span>&#160;                        elementResidual_w[i] += <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.ExteriorElementBoundaryFlux(flux_mom_w_adv_ext,vel_test_dS[i]) +</div>
<div class="line"><a name="l04418"></a><span class="lineno"> 4418</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.ExteriorElementBoundaryFlux(flux_mom_wu_diff_ext,vel_test_dS[i])+</div>
<div class="line"><a name="l04419"></a><span class="lineno"> 4419</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.ExteriorElementBoundaryFlux(flux_mom_wv_diff_ext,vel_test_dS[i])+</div>
<div class="line"><a name="l04420"></a><span class="lineno"> 4420</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.ExteriorElementBoundaryFlux(flux_mom_ww_diff_ext,vel_test_dS[i])+</div>
<div class="line"><a name="l04421"></a><span class="lineno"> 4421</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.ExteriorElementBoundaryDiffusionAdjoint(isDOFBoundary_u[ebNE_kb],</div>
<div class="line"><a name="l04422"></a><span class="lineno"> 4422</span>&#160;                                                                     isDiffusiveFluxBoundary_w[ebNE_kb],</div>
<div class="line"><a name="l04423"></a><span class="lineno"> 4423</span>&#160;                                                                     eb_adjoint_sigma,</div>
<div class="line"><a name="l04424"></a><span class="lineno"> 4424</span>&#160;                                                                     u_ext,</div>
<div class="line"><a name="l04425"></a><span class="lineno"> 4425</span>&#160;                                                                     bc_u_ext,</div>
<div class="line"><a name="l04426"></a><span class="lineno"> 4426</span>&#160;                                                                     normal,</div>
<div class="line"><a name="l04427"></a><span class="lineno"> 4427</span>&#160;                                                                     sdInfo_w_u_rowptr,</div>
<div class="line"><a name="l04428"></a><span class="lineno"> 4428</span>&#160;                                                                     sdInfo_w_u_colind,</div>
<div class="line"><a name="l04429"></a><span class="lineno"> 4429</span>&#160;                                                                     mom_wu_diff_ten_ext,</div>
<div class="line"><a name="l04430"></a><span class="lineno"> 4430</span>&#160;                                                                     &amp;vel_grad_test_dS[i*nSpace])+</div>
<div class="line"><a name="l04431"></a><span class="lineno"> 4431</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.ExteriorElementBoundaryDiffusionAdjoint(isDOFBoundary_v[ebNE_kb],</div>
<div class="line"><a name="l04432"></a><span class="lineno"> 4432</span>&#160;                                                                     isDiffusiveFluxBoundary_w[ebNE_kb],</div>
<div class="line"><a name="l04433"></a><span class="lineno"> 4433</span>&#160;                                                                     eb_adjoint_sigma,</div>
<div class="line"><a name="l04434"></a><span class="lineno"> 4434</span>&#160;                                                                     v_ext,</div>
<div class="line"><a name="l04435"></a><span class="lineno"> 4435</span>&#160;                                                                     bc_v_ext,</div>
<div class="line"><a name="l04436"></a><span class="lineno"> 4436</span>&#160;                                                                     normal,</div>
<div class="line"><a name="l04437"></a><span class="lineno"> 4437</span>&#160;                                                                     sdInfo_w_v_rowptr,</div>
<div class="line"><a name="l04438"></a><span class="lineno"> 4438</span>&#160;                                                                     sdInfo_w_v_colind,</div>
<div class="line"><a name="l04439"></a><span class="lineno"> 4439</span>&#160;                                                                     mom_wv_diff_ten_ext,</div>
<div class="line"><a name="l04440"></a><span class="lineno"> 4440</span>&#160;                                                                     &amp;vel_grad_test_dS[i*nSpace])+</div>
<div class="line"><a name="l04441"></a><span class="lineno"> 4441</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.ExteriorElementBoundaryDiffusionAdjoint(isDOFBoundary_w[ebNE_kb],</div>
<div class="line"><a name="l04442"></a><span class="lineno"> 4442</span>&#160;                                                                     isDiffusiveFluxBoundary_w[ebNE_kb],</div>
<div class="line"><a name="l04443"></a><span class="lineno"> 4443</span>&#160;                                                                     eb_adjoint_sigma,</div>
<div class="line"><a name="l04444"></a><span class="lineno"> 4444</span>&#160;                                                                     w_ext,</div>
<div class="line"><a name="l04445"></a><span class="lineno"> 4445</span>&#160;                                                                     bc_w_ext,</div>
<div class="line"><a name="l04446"></a><span class="lineno"> 4446</span>&#160;                                                                     normal,</div>
<div class="line"><a name="l04447"></a><span class="lineno"> 4447</span>&#160;                                                                     sdInfo_w_w_rowptr,</div>
<div class="line"><a name="l04448"></a><span class="lineno"> 4448</span>&#160;                                                                     sdInfo_w_w_colind,</div>
<div class="line"><a name="l04449"></a><span class="lineno"> 4449</span>&#160;                                                                     mom_ww_diff_ten_ext,</div>
<div class="line"><a name="l04450"></a><span class="lineno"> 4450</span>&#160;                                                                     &amp;vel_grad_test_dS[i*nSpace]);</div>
<div class="line"><a name="l04451"></a><span class="lineno"> 4451</span>&#160;                      }<span class="comment">//i</span></div>
<div class="line"><a name="l04452"></a><span class="lineno"> 4452</span>&#160;                  }<span class="comment">//if boundary flag positive</span></div>
<div class="line"><a name="l04453"></a><span class="lineno"> 4453</span>&#160;              }<span class="comment">//kb</span></div>
<div class="line"><a name="l04454"></a><span class="lineno"> 4454</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l04455"></a><span class="lineno"> 4455</span>&#160;            <span class="comment">//update the element and global residual storage</span></div>
<div class="line"><a name="l04456"></a><span class="lineno"> 4456</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l04457"></a><span class="lineno"> 4457</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;nDOF_test_element;i++)</div>
<div class="line"><a name="l04458"></a><span class="lineno"> 4458</span>&#160;              {</div>
<div class="line"><a name="l04459"></a><span class="lineno"> 4459</span>&#160;                <span class="keywordtype">int</span> eN_i = eN*nDOF_test_element+i;</div>
<div class="line"><a name="l04460"></a><span class="lineno"> 4460</span>&#160; </div>
<div class="line"><a name="l04461"></a><span class="lineno"> 4461</span>&#160;                elementResidual_p_save[eN_i] +=  elementResidual_p[i];</div>
<div class="line"><a name="l04462"></a><span class="lineno"> 4462</span>&#160;                mesh_volume_conservation_weak += elementResidual_mesh[i];</div>
<div class="line"><a name="l04463"></a><span class="lineno"> 4463</span>&#160;                globalResidual[offset_p+stride_p*rp_l2g[eN_i]]+=elementResidual_p[i];</div>
<div class="line"><a name="l04464"></a><span class="lineno"> 4464</span>&#160;              }</div>
<div class="line"><a name="l04465"></a><span class="lineno"> 4465</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;nDOF_v_test_element;i++)</div>
<div class="line"><a name="l04466"></a><span class="lineno"> 4466</span>&#160;              {</div>
<div class="line"><a name="l04467"></a><span class="lineno"> 4467</span>&#160;                <span class="keywordtype">int</span> eN_i = eN*nDOF_v_test_element+i;</div>
<div class="line"><a name="l04468"></a><span class="lineno"> 4468</span>&#160; </div>
<div class="line"><a name="l04469"></a><span class="lineno"> 4469</span>&#160;                globalResidual[offset_u+stride_u*rvel_l2g[eN_i]]+=elementResidual_u[i];</div>
<div class="line"><a name="l04470"></a><span class="lineno"> 4470</span>&#160;                globalResidual[offset_v+stride_v*rvel_l2g[eN_i]]+=elementResidual_v[i];</div>
<div class="line"><a name="l04471"></a><span class="lineno"> 4471</span>&#160;                globalResidual[offset_w+stride_w*rvel_l2g[eN_i]]+=elementResidual_w[i];</div>
<div class="line"><a name="l04472"></a><span class="lineno"> 4472</span>&#160;              }<span class="comment">//i</span></div>
<div class="line"><a name="l04473"></a><span class="lineno"> 4473</span>&#160;          }<span class="comment">//ebNE</span></div>
<div class="line"><a name="l04474"></a><span class="lineno"> 4474</span>&#160; </div>
<div class="line"><a name="l04475"></a><span class="lineno"> 4475</span>&#160;        <span class="comment">/* std::cout&lt;&lt;&quot;mesh volume conservation = &quot;&lt;&lt;mesh_volume_conservation&lt;&lt;std::endl; */</span></div>
<div class="line"><a name="l04476"></a><span class="lineno"> 4476</span>&#160;        <span class="comment">/* std::cout&lt;&lt;&quot;mesh volume conservation weak = &quot;&lt;&lt;mesh_volume_conservation_weak&lt;&lt;std::endl; */</span></div>
<div class="line"><a name="l04477"></a><span class="lineno"> 4477</span>&#160;        <span class="comment">/* std::cout&lt;&lt;&quot;mesh volume conservation err max= &quot;&lt;&lt;mesh_volume_conservation_err_max&lt;&lt;std::endl; */</span></div>
<div class="line"><a name="l04478"></a><span class="lineno"> 4478</span>&#160;        <span class="comment">/* std::cout&lt;&lt;&quot;mesh volume conservation err max weak = &quot;&lt;&lt;mesh_volume_conservation_err_max_weak&lt;&lt;std::endl; */</span></div>
<div class="line"><a name="l04479"></a><span class="lineno"> 4479</span>&#160;      }</div>
<div class="line"><a name="l04480"></a><span class="lineno"> 4480</span>&#160; </div>
<div class="line"><a name="l04481"></a><span class="lineno"><a class="line" href="classproteus_1_1_r_a_n_s2_p.html#ad2290233cf9a2819b93f040e5639beaf"> 4481</a></span>&#160;      <span class="keywordtype">void</span> <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#ad2290233cf9a2819b93f040e5639beaf">calculateJacobian</a>(<span class="keywordtype">double</span> NONCONSERVATIVE_FORM,</div>
<div class="line"><a name="l04482"></a><span class="lineno"> 4482</span>&#160;                             <span class="keywordtype">double</span> MOMENTUM_SGE,</div>
<div class="line"><a name="l04483"></a><span class="lineno"> 4483</span>&#160;                             <span class="keywordtype">double</span> PRESSURE_SGE,</div>
<div class="line"><a name="l04484"></a><span class="lineno"> 4484</span>&#160;                             <span class="keywordtype">double</span> VELOCITY_SGE,</div>
<div class="line"><a name="l04485"></a><span class="lineno"> 4485</span>&#160;                             <span class="keywordtype">double</span> PRESSURE_PROJECTION_STABILIZATION,</div>
<div class="line"><a name="l04486"></a><span class="lineno"> 4486</span>&#160;                             <span class="comment">//element</span></div>
<div class="line"><a name="l04487"></a><span class="lineno"> 4487</span>&#160;                             <span class="keywordtype">double</span>* mesh_trial_ref,</div>
<div class="line"><a name="l04488"></a><span class="lineno"> 4488</span>&#160;                             <span class="keywordtype">double</span>* mesh_grad_trial_ref,</div>
<div class="line"><a name="l04489"></a><span class="lineno"> 4489</span>&#160;                             <span class="keywordtype">double</span>* mesh_dof,</div>
<div class="line"><a name="l04490"></a><span class="lineno"> 4490</span>&#160;                             <span class="keywordtype">double</span>* mesh_velocity_dof,</div>
<div class="line"><a name="l04491"></a><span class="lineno"> 4491</span>&#160;                             <span class="keywordtype">double</span> MOVING_DOMAIN,</div>
<div class="line"><a name="l04492"></a><span class="lineno"> 4492</span>&#160;                             <span class="keywordtype">int</span>* mesh_l2g,</div>
<div class="line"><a name="l04493"></a><span class="lineno"> 4493</span>&#160;                             <span class="keywordtype">double</span>* x_ref,</div>
<div class="line"><a name="l04494"></a><span class="lineno"> 4494</span>&#160;                             <span class="keywordtype">double</span>* dV_ref,</div>
<div class="line"><a name="l04495"></a><span class="lineno"> 4495</span>&#160;                             <span class="keywordtype">double</span>* p_trial_ref,</div>
<div class="line"><a name="l04496"></a><span class="lineno"> 4496</span>&#160;                             <span class="keywordtype">double</span>* p_grad_trial_ref,</div>
<div class="line"><a name="l04497"></a><span class="lineno"> 4497</span>&#160;                             <span class="keywordtype">double</span>* p_test_ref,</div>
<div class="line"><a name="l04498"></a><span class="lineno"> 4498</span>&#160;                             <span class="keywordtype">double</span>* p_grad_test_ref,</div>
<div class="line"><a name="l04499"></a><span class="lineno"> 4499</span>&#160;                             <span class="keywordtype">double</span>* vel_trial_ref,</div>
<div class="line"><a name="l04500"></a><span class="lineno"> 4500</span>&#160;                             <span class="keywordtype">double</span>* vel_grad_trial_ref,</div>
<div class="line"><a name="l04501"></a><span class="lineno"> 4501</span>&#160;                             <span class="keywordtype">double</span>* vel_test_ref,</div>
<div class="line"><a name="l04502"></a><span class="lineno"> 4502</span>&#160;                             <span class="keywordtype">double</span>* vel_grad_test_ref,</div>
<div class="line"><a name="l04503"></a><span class="lineno"> 4503</span>&#160;                             <span class="comment">//element boundary</span></div>
<div class="line"><a name="l04504"></a><span class="lineno"> 4504</span>&#160;                             <span class="keywordtype">double</span>* mesh_trial_trace_ref,</div>
<div class="line"><a name="l04505"></a><span class="lineno"> 4505</span>&#160;                             <span class="keywordtype">double</span>* mesh_grad_trial_trace_ref,</div>
<div class="line"><a name="l04506"></a><span class="lineno"> 4506</span>&#160;                             <span class="keywordtype">double</span>* dS_ref,</div>
<div class="line"><a name="l04507"></a><span class="lineno"> 4507</span>&#160;                             <span class="keywordtype">double</span>* p_trial_trace_ref,</div>
<div class="line"><a name="l04508"></a><span class="lineno"> 4508</span>&#160;                             <span class="keywordtype">double</span>* p_grad_trial_trace_ref,</div>
<div class="line"><a name="l04509"></a><span class="lineno"> 4509</span>&#160;                             <span class="keywordtype">double</span>* p_test_trace_ref,</div>
<div class="line"><a name="l04510"></a><span class="lineno"> 4510</span>&#160;                             <span class="keywordtype">double</span>* p_grad_test_trace_ref,</div>
<div class="line"><a name="l04511"></a><span class="lineno"> 4511</span>&#160;                             <span class="keywordtype">double</span>* vel_trial_trace_ref,</div>
<div class="line"><a name="l04512"></a><span class="lineno"> 4512</span>&#160;                             <span class="keywordtype">double</span>* vel_grad_trial_trace_ref,</div>
<div class="line"><a name="l04513"></a><span class="lineno"> 4513</span>&#160;                             <span class="keywordtype">double</span>* vel_test_trace_ref,</div>
<div class="line"><a name="l04514"></a><span class="lineno"> 4514</span>&#160;                             <span class="keywordtype">double</span>* vel_grad_test_trace_ref,</div>
<div class="line"><a name="l04515"></a><span class="lineno"> 4515</span>&#160;                             <span class="keywordtype">double</span>* normal_ref,</div>
<div class="line"><a name="l04516"></a><span class="lineno"> 4516</span>&#160;                             <span class="keywordtype">double</span>* boundaryJac_ref,</div>
<div class="line"><a name="l04517"></a><span class="lineno"> 4517</span>&#160;                             <span class="comment">//physics</span></div>
<div class="line"><a name="l04518"></a><span class="lineno"> 4518</span>&#160;                             <span class="keywordtype">double</span> eb_adjoint_sigma,</div>
<div class="line"><a name="l04519"></a><span class="lineno"> 4519</span>&#160;                             <span class="keywordtype">double</span>* elementDiameter,</div>
<div class="line"><a name="l04520"></a><span class="lineno"> 4520</span>&#160;                             <span class="keywordtype">double</span>* nodeDiametersArray,</div>
<div class="line"><a name="l04521"></a><span class="lineno"> 4521</span>&#160;                             <span class="keywordtype">double</span> hFactor,</div>
<div class="line"><a name="l04522"></a><span class="lineno"> 4522</span>&#160;                             <span class="keywordtype">int</span> nElements_global,</div>
<div class="line"><a name="l04523"></a><span class="lineno"> 4523</span>&#160;                             <span class="keywordtype">double</span> useRBLES,</div>
<div class="line"><a name="l04524"></a><span class="lineno"> 4524</span>&#160;                             <span class="keywordtype">double</span> useMetrics,</div>
<div class="line"><a name="l04525"></a><span class="lineno"> 4525</span>&#160;                             <span class="keywordtype">double</span> alphaBDF,</div>
<div class="line"><a name="l04526"></a><span class="lineno"> 4526</span>&#160;                             <span class="keywordtype">double</span> epsFact_rho,</div>
<div class="line"><a name="l04527"></a><span class="lineno"> 4527</span>&#160;                             <span class="keywordtype">double</span> epsFact_mu,</div>
<div class="line"><a name="l04528"></a><span class="lineno"> 4528</span>&#160;                             <span class="keywordtype">double</span> sigma,</div>
<div class="line"><a name="l04529"></a><span class="lineno"> 4529</span>&#160;                             <span class="keywordtype">double</span> <a class="code" href="_error_residual_method_8cpp.html#ae5f5d9edb66645eab31a7c8389493ce7">rho_0</a>,</div>
<div class="line"><a name="l04530"></a><span class="lineno"> 4530</span>&#160;                             <span class="keywordtype">double</span> <a class="code" href="_error_residual_method_8cpp.html#a383b07af68441ce2b4adaaf8d8cc9d90">nu_0</a>,</div>
<div class="line"><a name="l04531"></a><span class="lineno"> 4531</span>&#160;                             <span class="keywordtype">double</span> <a class="code" href="_error_residual_method_8cpp.html#a751e53c9d8dfaf696b11b86e0c1b42e9">rho_1</a>,</div>
<div class="line"><a name="l04532"></a><span class="lineno"> 4532</span>&#160;                             <span class="keywordtype">double</span> <a class="code" href="_error_residual_method_8cpp.html#ae5896ebfee35f22242123e4ae82c81d9">nu_1</a>,</div>
<div class="line"><a name="l04533"></a><span class="lineno"> 4533</span>&#160;                             <span class="keywordtype">double</span> smagorinskyConstant,</div>
<div class="line"><a name="l04534"></a><span class="lineno"> 4534</span>&#160;                             <span class="keywordtype">int</span> turbulenceClosureModel,</div>
<div class="line"><a name="l04535"></a><span class="lineno"> 4535</span>&#160;                             <span class="keywordtype">double</span> Ct_sge,</div>
<div class="line"><a name="l04536"></a><span class="lineno"> 4536</span>&#160;                             <span class="keywordtype">double</span> Cd_sge,</div>
<div class="line"><a name="l04537"></a><span class="lineno"> 4537</span>&#160;                             <span class="keywordtype">double</span> C_dg,</div>
<div class="line"><a name="l04538"></a><span class="lineno"> 4538</span>&#160;                             <span class="keywordtype">double</span> C_b,</div>
<div class="line"><a name="l04539"></a><span class="lineno"> 4539</span>&#160;                             <span class="comment">//VRANS</span></div>
<div class="line"><a name="l04540"></a><span class="lineno"> 4540</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">double</span>* eps_solid,</div>
<div class="line"><a name="l04541"></a><span class="lineno"> 4541</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">double</span>* phi_solid,</div>
<div class="line"><a name="l04542"></a><span class="lineno"> 4542</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">double</span>* q_velocity_solid,</div>
<div class="line"><a name="l04543"></a><span class="lineno"> 4543</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">double</span>* q_porosity,</div>
<div class="line"><a name="l04544"></a><span class="lineno"> 4544</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">double</span>* q_dragAlpha,</div>
<div class="line"><a name="l04545"></a><span class="lineno"> 4545</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">double</span>* q_dragBeta,</div>
<div class="line"><a name="l04546"></a><span class="lineno"> 4546</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">double</span>* q_mass_source,</div>
<div class="line"><a name="l04547"></a><span class="lineno"> 4547</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">double</span>* q_turb_var_0,</div>
<div class="line"><a name="l04548"></a><span class="lineno"> 4548</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">double</span>* q_turb_var_1,</div>
<div class="line"><a name="l04549"></a><span class="lineno"> 4549</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">double</span>* q_turb_var_grad_0,</div>
<div class="line"><a name="l04550"></a><span class="lineno"> 4550</span>&#160;                             <span class="comment">//</span></div>
<div class="line"><a name="l04551"></a><span class="lineno"> 4551</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">double</span> LAG_LES,</div>
<div class="line"><a name="l04552"></a><span class="lineno"> 4552</span>&#160;                             <span class="keywordtype">double</span> * q_eddy_viscosity_last,</div>
<div class="line"><a name="l04553"></a><span class="lineno"> 4553</span>&#160;                             <span class="keywordtype">double</span> * ebqe_eddy_viscosity_last,</div>
<div class="line"><a name="l04554"></a><span class="lineno"> 4554</span>&#160;                             <span class="keywordtype">int</span>* p_l2g,</div>
<div class="line"><a name="l04555"></a><span class="lineno"> 4555</span>&#160;                             <span class="keywordtype">int</span>* vel_l2g,</div>
<div class="line"><a name="l04556"></a><span class="lineno"> 4556</span>&#160;                             <span class="keywordtype">double</span>* p_dof, <span class="keywordtype">double</span>* u_dof, <span class="keywordtype">double</span>* v_dof, <span class="keywordtype">double</span>* w_dof,</div>
<div class="line"><a name="l04557"></a><span class="lineno"> 4557</span>&#160;                             <span class="keywordtype">double</span>* p_old_dof,</div>
<div class="line"><a name="l04558"></a><span class="lineno"> 4558</span>&#160;                             <span class="keywordtype">double</span>* u_old_dof,</div>
<div class="line"><a name="l04559"></a><span class="lineno"> 4559</span>&#160;                             <span class="keywordtype">double</span>* v_old_dof,</div>
<div class="line"><a name="l04560"></a><span class="lineno"> 4560</span>&#160;                             <span class="keywordtype">double</span>* w_old_dof,</div>
<div class="line"><a name="l04561"></a><span class="lineno"> 4561</span>&#160;                             <span class="keywordtype">double</span>* g,</div>
<div class="line"><a name="l04562"></a><span class="lineno"> 4562</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">double</span> useVF,</div>
<div class="line"><a name="l04563"></a><span class="lineno"> 4563</span>&#160;                             <span class="keywordtype">double</span>* vf,</div>
<div class="line"><a name="l04564"></a><span class="lineno"> 4564</span>&#160;                             <span class="keywordtype">double</span>* <a class="code" href="namespaceproteus.html#a17bf106c5df3b1331ed2a18392384813">phi</a>,</div>
<div class="line"><a name="l04565"></a><span class="lineno"> 4565</span>&#160;                             <span class="keywordtype">double</span>* phi_nodes,</div>
<div class="line"><a name="l04566"></a><span class="lineno"> 4566</span>&#160;                             <span class="keywordtype">double</span>* normal_phi,</div>
<div class="line"><a name="l04567"></a><span class="lineno"> 4567</span>&#160;                             <span class="keywordtype">double</span>* kappa_phi,</div>
<div class="line"><a name="l04568"></a><span class="lineno"> 4568</span>&#160;                             <span class="keywordtype">double</span>* q_mom_u_acc_beta_bdf, <span class="keywordtype">double</span>* q_mom_v_acc_beta_bdf, <span class="keywordtype">double</span>* q_mom_w_acc_beta_bdf,</div>
<div class="line"><a name="l04569"></a><span class="lineno"> 4569</span>&#160;                             <span class="keywordtype">double</span>* q_dV,</div>
<div class="line"><a name="l04570"></a><span class="lineno"> 4570</span>&#160;                             <span class="keywordtype">double</span>* q_dV_last,</div>
<div class="line"><a name="l04571"></a><span class="lineno"> 4571</span>&#160;                             <span class="keywordtype">double</span>* q_velocity_sge,</div>
<div class="line"><a name="l04572"></a><span class="lineno"> 4572</span>&#160;                             <span class="keywordtype">double</span>* q_cfl,</div>
<div class="line"><a name="l04573"></a><span class="lineno"> 4573</span>&#160;                             <span class="keywordtype">double</span>* q_numDiff_u_last, <span class="keywordtype">double</span>* q_numDiff_v_last, <span class="keywordtype">double</span>* q_numDiff_w_last,</div>
<div class="line"><a name="l04574"></a><span class="lineno"> 4574</span>&#160;                             <span class="keywordtype">int</span>* sdInfo_u_u_rowptr,<span class="keywordtype">int</span>* sdInfo_u_u_colind,</div>
<div class="line"><a name="l04575"></a><span class="lineno"> 4575</span>&#160;                             <span class="keywordtype">int</span>* sdInfo_u_v_rowptr,<span class="keywordtype">int</span>* sdInfo_u_v_colind,</div>
<div class="line"><a name="l04576"></a><span class="lineno"> 4576</span>&#160;                             <span class="keywordtype">int</span>* sdInfo_u_w_rowptr,<span class="keywordtype">int</span>* sdInfo_u_w_colind,</div>
<div class="line"><a name="l04577"></a><span class="lineno"> 4577</span>&#160;                             <span class="keywordtype">int</span>* sdInfo_v_v_rowptr,<span class="keywordtype">int</span>* sdInfo_v_v_colind,</div>
<div class="line"><a name="l04578"></a><span class="lineno"> 4578</span>&#160;                             <span class="keywordtype">int</span>* sdInfo_v_u_rowptr,<span class="keywordtype">int</span>* sdInfo_v_u_colind,</div>
<div class="line"><a name="l04579"></a><span class="lineno"> 4579</span>&#160;                             <span class="keywordtype">int</span>* sdInfo_v_w_rowptr,<span class="keywordtype">int</span>* sdInfo_v_w_colind,</div>
<div class="line"><a name="l04580"></a><span class="lineno"> 4580</span>&#160;                             <span class="keywordtype">int</span>* sdInfo_w_w_rowptr,<span class="keywordtype">int</span>* sdInfo_w_w_colind,</div>
<div class="line"><a name="l04581"></a><span class="lineno"> 4581</span>&#160;                             <span class="keywordtype">int</span>* sdInfo_w_u_rowptr,<span class="keywordtype">int</span>* sdInfo_w_u_colind,</div>
<div class="line"><a name="l04582"></a><span class="lineno"> 4582</span>&#160;                             <span class="keywordtype">int</span>* sdInfo_w_v_rowptr,<span class="keywordtype">int</span>* sdInfo_w_v_colind,</div>
<div class="line"><a name="l04583"></a><span class="lineno"> 4583</span>&#160;                             <span class="keywordtype">int</span>* csrRowIndeces_p_p,<span class="keywordtype">int</span>* csrColumnOffsets_p_p,</div>
<div class="line"><a name="l04584"></a><span class="lineno"> 4584</span>&#160;                             <span class="keywordtype">int</span>* csrRowIndeces_p_u,<span class="keywordtype">int</span>* csrColumnOffsets_p_u,</div>
<div class="line"><a name="l04585"></a><span class="lineno"> 4585</span>&#160;                             <span class="keywordtype">int</span>* csrRowIndeces_p_v,<span class="keywordtype">int</span>* csrColumnOffsets_p_v,</div>
<div class="line"><a name="l04586"></a><span class="lineno"> 4586</span>&#160;                             <span class="keywordtype">int</span>* csrRowIndeces_p_w,<span class="keywordtype">int</span>* csrColumnOffsets_p_w,</div>
<div class="line"><a name="l04587"></a><span class="lineno"> 4587</span>&#160;                             <span class="keywordtype">int</span>* csrRowIndeces_u_p,<span class="keywordtype">int</span>* csrColumnOffsets_u_p,</div>
<div class="line"><a name="l04588"></a><span class="lineno"> 4588</span>&#160;                             <span class="keywordtype">int</span>* csrRowIndeces_u_u,<span class="keywordtype">int</span>* csrColumnOffsets_u_u,</div>
<div class="line"><a name="l04589"></a><span class="lineno"> 4589</span>&#160;                             <span class="keywordtype">int</span>* csrRowIndeces_u_v,<span class="keywordtype">int</span>* csrColumnOffsets_u_v,</div>
<div class="line"><a name="l04590"></a><span class="lineno"> 4590</span>&#160;                             <span class="keywordtype">int</span>* csrRowIndeces_u_w,<span class="keywordtype">int</span>* csrColumnOffsets_u_w,</div>
<div class="line"><a name="l04591"></a><span class="lineno"> 4591</span>&#160;                             <span class="keywordtype">int</span>* csrRowIndeces_v_p,<span class="keywordtype">int</span>* csrColumnOffsets_v_p,</div>
<div class="line"><a name="l04592"></a><span class="lineno"> 4592</span>&#160;                             <span class="keywordtype">int</span>* csrRowIndeces_v_u,<span class="keywordtype">int</span>* csrColumnOffsets_v_u,</div>
<div class="line"><a name="l04593"></a><span class="lineno"> 4593</span>&#160;                             <span class="keywordtype">int</span>* csrRowIndeces_v_v,<span class="keywordtype">int</span>* csrColumnOffsets_v_v,</div>
<div class="line"><a name="l04594"></a><span class="lineno"> 4594</span>&#160;                             <span class="keywordtype">int</span>* csrRowIndeces_v_w,<span class="keywordtype">int</span>* csrColumnOffsets_v_w,</div>
<div class="line"><a name="l04595"></a><span class="lineno"> 4595</span>&#160;                             <span class="keywordtype">int</span>* csrRowIndeces_w_p,<span class="keywordtype">int</span>* csrColumnOffsets_w_p,</div>
<div class="line"><a name="l04596"></a><span class="lineno"> 4596</span>&#160;                             <span class="keywordtype">int</span>* csrRowIndeces_w_u,<span class="keywordtype">int</span>* csrColumnOffsets_w_u,</div>
<div class="line"><a name="l04597"></a><span class="lineno"> 4597</span>&#160;                             <span class="keywordtype">int</span>* csrRowIndeces_w_v,<span class="keywordtype">int</span>* csrColumnOffsets_w_v,</div>
<div class="line"><a name="l04598"></a><span class="lineno"> 4598</span>&#160;                             <span class="keywordtype">int</span>* csrRowIndeces_w_w,<span class="keywordtype">int</span>* csrColumnOffsets_w_w,</div>
<div class="line"><a name="l04599"></a><span class="lineno"> 4599</span>&#160;                             <span class="keywordtype">double</span>* globalJacobian,</div>
<div class="line"><a name="l04600"></a><span class="lineno"> 4600</span>&#160;                             <span class="keywordtype">int</span> nExteriorElementBoundaries_global,</div>
<div class="line"><a name="l04601"></a><span class="lineno"> 4601</span>&#160;                             <span class="keywordtype">int</span>* exteriorElementBoundariesArray,</div>
<div class="line"><a name="l04602"></a><span class="lineno"> 4602</span>&#160;                             <span class="keywordtype">int</span>* elementBoundaryElementsArray,</div>
<div class="line"><a name="l04603"></a><span class="lineno"> 4603</span>&#160;                             <span class="keywordtype">int</span>* elementBoundaryLocalElementBoundariesArray,</div>
<div class="line"><a name="l04604"></a><span class="lineno"> 4604</span>&#160;                             <span class="keywordtype">double</span>* ebqe_vf_ext,</div>
<div class="line"><a name="l04605"></a><span class="lineno"> 4605</span>&#160;                             <span class="keywordtype">double</span>* bc_ebqe_vf_ext,</div>
<div class="line"><a name="l04606"></a><span class="lineno"> 4606</span>&#160;                             <span class="keywordtype">double</span>* ebqe_phi_ext,</div>
<div class="line"><a name="l04607"></a><span class="lineno"> 4607</span>&#160;                             <span class="keywordtype">double</span>* bc_ebqe_phi_ext,</div>
<div class="line"><a name="l04608"></a><span class="lineno"> 4608</span>&#160;                             <span class="keywordtype">double</span>* ebqe_normal_phi_ext,</div>
<div class="line"><a name="l04609"></a><span class="lineno"> 4609</span>&#160;                             <span class="keywordtype">double</span>* ebqe_kappa_phi_ext,</div>
<div class="line"><a name="l04610"></a><span class="lineno"> 4610</span>&#160;                             <span class="comment">//VRANS</span></div>
<div class="line"><a name="l04611"></a><span class="lineno"> 4611</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">double</span>* ebqe_porosity_ext,</div>
<div class="line"><a name="l04612"></a><span class="lineno"> 4612</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">double</span>* ebqe_turb_var_0,</div>
<div class="line"><a name="l04613"></a><span class="lineno"> 4613</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">double</span>* ebqe_turb_var_1,</div>
<div class="line"><a name="l04614"></a><span class="lineno"> 4614</span>&#160;                             <span class="comment">//</span></div>
<div class="line"><a name="l04615"></a><span class="lineno"> 4615</span>&#160;                             <span class="keywordtype">int</span>* isDOFBoundary_p,</div>
<div class="line"><a name="l04616"></a><span class="lineno"> 4616</span>&#160;                             <span class="keywordtype">int</span>* isDOFBoundary_u,</div>
<div class="line"><a name="l04617"></a><span class="lineno"> 4617</span>&#160;                             <span class="keywordtype">int</span>* isDOFBoundary_v,</div>
<div class="line"><a name="l04618"></a><span class="lineno"> 4618</span>&#160;                             <span class="keywordtype">int</span>* isDOFBoundary_w,</div>
<div class="line"><a name="l04619"></a><span class="lineno"> 4619</span>&#160;                             <span class="keywordtype">int</span>* isAdvectiveFluxBoundary_p,</div>
<div class="line"><a name="l04620"></a><span class="lineno"> 4620</span>&#160;                             <span class="keywordtype">int</span>* isAdvectiveFluxBoundary_u,</div>
<div class="line"><a name="l04621"></a><span class="lineno"> 4621</span>&#160;                             <span class="keywordtype">int</span>* isAdvectiveFluxBoundary_v,</div>
<div class="line"><a name="l04622"></a><span class="lineno"> 4622</span>&#160;                             <span class="keywordtype">int</span>* isAdvectiveFluxBoundary_w,</div>
<div class="line"><a name="l04623"></a><span class="lineno"> 4623</span>&#160;                             <span class="keywordtype">int</span>* isDiffusiveFluxBoundary_u,</div>
<div class="line"><a name="l04624"></a><span class="lineno"> 4624</span>&#160;                             <span class="keywordtype">int</span>* isDiffusiveFluxBoundary_v,</div>
<div class="line"><a name="l04625"></a><span class="lineno"> 4625</span>&#160;                             <span class="keywordtype">int</span>* isDiffusiveFluxBoundary_w,</div>
<div class="line"><a name="l04626"></a><span class="lineno"> 4626</span>&#160;                             <span class="keywordtype">double</span>* ebqe_bc_p_ext,</div>
<div class="line"><a name="l04627"></a><span class="lineno"> 4627</span>&#160;                             <span class="keywordtype">double</span>* ebqe_bc_flux_mass_ext,</div>
<div class="line"><a name="l04628"></a><span class="lineno"> 4628</span>&#160;                             <span class="keywordtype">double</span>* ebqe_bc_flux_mom_u_adv_ext,</div>
<div class="line"><a name="l04629"></a><span class="lineno"> 4629</span>&#160;                             <span class="keywordtype">double</span>* ebqe_bc_flux_mom_v_adv_ext,</div>
<div class="line"><a name="l04630"></a><span class="lineno"> 4630</span>&#160;                             <span class="keywordtype">double</span>* ebqe_bc_flux_mom_w_adv_ext,</div>
<div class="line"><a name="l04631"></a><span class="lineno"> 4631</span>&#160;                             <span class="keywordtype">double</span>* ebqe_bc_u_ext,</div>
<div class="line"><a name="l04632"></a><span class="lineno"> 4632</span>&#160;                             <span class="keywordtype">double</span>* ebqe_bc_flux_u_diff_ext,</div>
<div class="line"><a name="l04633"></a><span class="lineno"> 4633</span>&#160;                             <span class="keywordtype">double</span>* ebqe_penalty_ext,</div>
<div class="line"><a name="l04634"></a><span class="lineno"> 4634</span>&#160;                             <span class="keywordtype">double</span>* ebqe_bc_v_ext,</div>
<div class="line"><a name="l04635"></a><span class="lineno"> 4635</span>&#160;                             <span class="keywordtype">double</span>* ebqe_bc_flux_v_diff_ext,</div>
<div class="line"><a name="l04636"></a><span class="lineno"> 4636</span>&#160;                             <span class="keywordtype">double</span>* ebqe_bc_w_ext,</div>
<div class="line"><a name="l04637"></a><span class="lineno"> 4637</span>&#160;                             <span class="keywordtype">double</span>* ebqe_bc_flux_w_diff_ext,</div>
<div class="line"><a name="l04638"></a><span class="lineno"> 4638</span>&#160;                             <span class="keywordtype">int</span>* csrColumnOffsets_eb_p_p,</div>
<div class="line"><a name="l04639"></a><span class="lineno"> 4639</span>&#160;                             <span class="keywordtype">int</span>* csrColumnOffsets_eb_p_u,</div>
<div class="line"><a name="l04640"></a><span class="lineno"> 4640</span>&#160;                             <span class="keywordtype">int</span>* csrColumnOffsets_eb_p_v,</div>
<div class="line"><a name="l04641"></a><span class="lineno"> 4641</span>&#160;                             <span class="keywordtype">int</span>* csrColumnOffsets_eb_p_w,</div>
<div class="line"><a name="l04642"></a><span class="lineno"> 4642</span>&#160;                             <span class="keywordtype">int</span>* csrColumnOffsets_eb_u_p,</div>
<div class="line"><a name="l04643"></a><span class="lineno"> 4643</span>&#160;                             <span class="keywordtype">int</span>* csrColumnOffsets_eb_u_u,</div>
<div class="line"><a name="l04644"></a><span class="lineno"> 4644</span>&#160;                             <span class="keywordtype">int</span>* csrColumnOffsets_eb_u_v,</div>
<div class="line"><a name="l04645"></a><span class="lineno"> 4645</span>&#160;                             <span class="keywordtype">int</span>* csrColumnOffsets_eb_u_w,</div>
<div class="line"><a name="l04646"></a><span class="lineno"> 4646</span>&#160;                             <span class="keywordtype">int</span>* csrColumnOffsets_eb_v_p,</div>
<div class="line"><a name="l04647"></a><span class="lineno"> 4647</span>&#160;                             <span class="keywordtype">int</span>* csrColumnOffsets_eb_v_u,</div>
<div class="line"><a name="l04648"></a><span class="lineno"> 4648</span>&#160;                             <span class="keywordtype">int</span>* csrColumnOffsets_eb_v_v,</div>
<div class="line"><a name="l04649"></a><span class="lineno"> 4649</span>&#160;                             <span class="keywordtype">int</span>* csrColumnOffsets_eb_v_w,</div>
<div class="line"><a name="l04650"></a><span class="lineno"> 4650</span>&#160;                             <span class="keywordtype">int</span>* csrColumnOffsets_eb_w_p,</div>
<div class="line"><a name="l04651"></a><span class="lineno"> 4651</span>&#160;                             <span class="keywordtype">int</span>* csrColumnOffsets_eb_w_u,</div>
<div class="line"><a name="l04652"></a><span class="lineno"> 4652</span>&#160;                             <span class="keywordtype">int</span>* csrColumnOffsets_eb_w_v,</div>
<div class="line"><a name="l04653"></a><span class="lineno"> 4653</span>&#160;                             <span class="keywordtype">int</span>* csrColumnOffsets_eb_w_w,</div>
<div class="line"><a name="l04654"></a><span class="lineno"> 4654</span>&#160;                             <span class="keywordtype">int</span>* elementFlags,</div>
<div class="line"><a name="l04655"></a><span class="lineno"> 4655</span>&#160;                             <span class="keywordtype">int</span>* boundaryFlags,</div>
<div class="line"><a name="l04656"></a><span class="lineno"> 4656</span>&#160;                             <span class="keywordtype">int</span> use_ball_as_particle,</div>
<div class="line"><a name="l04657"></a><span class="lineno"> 4657</span>&#160;                             <span class="keywordtype">double</span>* ball_center,</div>
<div class="line"><a name="l04658"></a><span class="lineno"> 4658</span>&#160;                             <span class="keywordtype">double</span>* ball_radius,</div>
<div class="line"><a name="l04659"></a><span class="lineno"> 4659</span>&#160;                             <span class="keywordtype">double</span>* ball_velocity,</div>
<div class="line"><a name="l04660"></a><span class="lineno"> 4660</span>&#160;                             <span class="keywordtype">double</span>* ball_angular_velocity,</div>
<div class="line"><a name="l04661"></a><span class="lineno"> 4661</span>&#160;                             <span class="keywordtype">double</span>* ball_center_acceleration,</div>
<div class="line"><a name="l04662"></a><span class="lineno"> 4662</span>&#160;                             <span class="keywordtype">double</span>* ball_angular_acceleration,</div>
<div class="line"><a name="l04663"></a><span class="lineno"> 4663</span>&#160;                             <span class="keywordtype">double</span>* ball_density,</div>
<div class="line"><a name="l04664"></a><span class="lineno"> 4664</span>&#160;                             <span class="keywordtype">double</span>* particle_signed_distances,</div>
<div class="line"><a name="l04665"></a><span class="lineno"> 4665</span>&#160;                             <span class="keywordtype">double</span>* particle_signed_distance_normals,</div>
<div class="line"><a name="l04666"></a><span class="lineno"> 4666</span>&#160;                             <span class="keywordtype">double</span>* particle_velocities,</div>
<div class="line"><a name="l04667"></a><span class="lineno"> 4667</span>&#160;                             <span class="keywordtype">double</span>* particle_centroids,</div>
<div class="line"><a name="l04668"></a><span class="lineno"> 4668</span>&#160;                             <span class="keywordtype">double</span>* ebq_global_phi_s,</div>
<div class="line"><a name="l04669"></a><span class="lineno"> 4669</span>&#160;                             <span class="keywordtype">double</span>* ebq_global_grad_phi_s,</div>
<div class="line"><a name="l04670"></a><span class="lineno"> 4670</span>&#160;                             <span class="keywordtype">double</span>* ebq_particle_velocity_s,</div>
<div class="line"><a name="l04671"></a><span class="lineno"> 4671</span>&#160;                             <span class="keywordtype">double</span>* phi_solid_nodes,</div>
<div class="line"><a name="l04672"></a><span class="lineno"> 4672</span>&#160;                             <span class="keywordtype">double</span>* distance_to_solids,</div>
<div class="line"><a name="l04673"></a><span class="lineno"> 4673</span>&#160;                             <span class="keywordtype">int</span> nParticles,</div>
<div class="line"><a name="l04674"></a><span class="lineno"> 4674</span>&#160;                             <span class="keywordtype">int</span> nElements_owned,</div>
<div class="line"><a name="l04675"></a><span class="lineno"> 4675</span>&#160;                             <span class="keywordtype">double</span> particle_nitsche,</div>
<div class="line"><a name="l04676"></a><span class="lineno"> 4676</span>&#160;                             <span class="keywordtype">double</span> particle_epsFact,</div>
<div class="line"><a name="l04677"></a><span class="lineno"> 4677</span>&#160;                             <span class="keywordtype">double</span> particle_alpha,</div>
<div class="line"><a name="l04678"></a><span class="lineno"> 4678</span>&#160;                             <span class="keywordtype">double</span> particle_beta,</div>
<div class="line"><a name="l04679"></a><span class="lineno"> 4679</span>&#160;                             <span class="keywordtype">double</span> particle_penalty_constant,</div>
<div class="line"><a name="l04680"></a><span class="lineno"> 4680</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">int</span> use_pseudo_penalty,</div>
<div class="line"><a name="l04681"></a><span class="lineno"> 4681</span>&#160;                             <span class="keywordtype">bool</span> useExact)</div>
<div class="line"><a name="l04682"></a><span class="lineno"> 4682</span>&#160;      {</div>
<div class="line"><a name="l04683"></a><span class="lineno"> 4683</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">int</span> nQuadraturePoints_global(nElements_global*nQuadraturePoints_element);</div>
<div class="line"><a name="l04684"></a><span class="lineno"> 4684</span>&#160;          std::valarray&lt;double&gt; particle_surfaceArea(nParticles), particle_netForces(nParticles*3*3), particle_netMoments(nParticles*3);</div>
<div class="line"><a name="l04685"></a><span class="lineno"> 4685</span>&#160;        <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a25259ea48a9bc3708796a96164a3b8de">gf</a>.useExact = useExact;</div>
<div class="line"><a name="l04686"></a><span class="lineno"> 4686</span>&#160;        <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#aa6183d3c81313639cd5ec6c4697ccdde">gf_s</a>.useExact = useExact;</div>
<div class="line"><a name="l04687"></a><span class="lineno"> 4687</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l04688"></a><span class="lineno"> 4688</span>&#160;        <span class="comment">//loop over elements to compute volume integrals and load them into the element Jacobians and global Jacobian</span></div>
<div class="line"><a name="l04689"></a><span class="lineno"> 4689</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l04690"></a><span class="lineno"> 4690</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> eN=0;eN&lt;nElements_global;eN++)</div>
<div class="line"><a name="l04691"></a><span class="lineno"> 4691</span>&#160;          {</div>
<div class="line"><a name="l04692"></a><span class="lineno"> 4692</span>&#160;            <span class="keyword">register</span> <span class="keywordtype">double</span> eps_rho,eps_mu;</div>
<div class="line"><a name="l04693"></a><span class="lineno"> 4693</span>&#160; </div>
<div class="line"><a name="l04694"></a><span class="lineno"> 4694</span>&#160;            <span class="keyword">register</span> <span class="keywordtype">double</span>  elementJacobian_p_p[nDOF_test_element][nDOF_trial_element],</div>
<div class="line"><a name="l04695"></a><span class="lineno"> 4695</span>&#160;              elementJacobian_p_u[nDOF_test_element][nDOF_v_trial_element],</div>
<div class="line"><a name="l04696"></a><span class="lineno"> 4696</span>&#160;              elementJacobian_p_v[nDOF_test_element][nDOF_v_trial_element],</div>
<div class="line"><a name="l04697"></a><span class="lineno"> 4697</span>&#160;              elementJacobian_p_w[nDOF_test_element][nDOF_v_trial_element],</div>
<div class="line"><a name="l04698"></a><span class="lineno"> 4698</span>&#160;              elementJacobian_u_p[nDOF_v_test_element][nDOF_trial_element],</div>
<div class="line"><a name="l04699"></a><span class="lineno"> 4699</span>&#160;              elementJacobian_u_u[nDOF_v_test_element][nDOF_v_trial_element],</div>
<div class="line"><a name="l04700"></a><span class="lineno"> 4700</span>&#160;              elementJacobian_u_v[nDOF_v_test_element][nDOF_v_trial_element],</div>
<div class="line"><a name="l04701"></a><span class="lineno"> 4701</span>&#160;              elementJacobian_u_w[nDOF_v_test_element][nDOF_v_trial_element],</div>
<div class="line"><a name="l04702"></a><span class="lineno"> 4702</span>&#160;              elementJacobian_v_p[nDOF_v_test_element][nDOF_trial_element],</div>
<div class="line"><a name="l04703"></a><span class="lineno"> 4703</span>&#160;              elementJacobian_v_u[nDOF_v_test_element][nDOF_v_trial_element],</div>
<div class="line"><a name="l04704"></a><span class="lineno"> 4704</span>&#160;              elementJacobian_v_v[nDOF_v_test_element][nDOF_v_trial_element],</div>
<div class="line"><a name="l04705"></a><span class="lineno"> 4705</span>&#160;              elementJacobian_v_w[nDOF_v_test_element][nDOF_v_trial_element],</div>
<div class="line"><a name="l04706"></a><span class="lineno"> 4706</span>&#160;              elementJacobian_w_p[nDOF_v_test_element][nDOF_trial_element],</div>
<div class="line"><a name="l04707"></a><span class="lineno"> 4707</span>&#160;              elementJacobian_w_u[nDOF_v_test_element][nDOF_v_trial_element],</div>
<div class="line"><a name="l04708"></a><span class="lineno"> 4708</span>&#160;              elementJacobian_w_v[nDOF_v_test_element][nDOF_v_trial_element],</div>
<div class="line"><a name="l04709"></a><span class="lineno"> 4709</span>&#160;              elementJacobian_w_w[nDOF_v_test_element][nDOF_v_trial_element];</div>
<div class="line"><a name="l04710"></a><span class="lineno"> 4710</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;nDOF_test_element;i++)</div>
<div class="line"><a name="l04711"></a><span class="lineno"> 4711</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0;j&lt;nDOF_trial_element;j++)</div>
<div class="line"><a name="l04712"></a><span class="lineno"> 4712</span>&#160;                {</div>
<div class="line"><a name="l04713"></a><span class="lineno"> 4713</span>&#160;                  elementJacobian_p_p[i][j]=0.0;</div>
<div class="line"><a name="l04714"></a><span class="lineno"> 4714</span>&#160;                }</div>
<div class="line"><a name="l04715"></a><span class="lineno"> 4715</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;nDOF_test_element;i++)</div>
<div class="line"><a name="l04716"></a><span class="lineno"> 4716</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0;j&lt;nDOF_v_trial_element;j++)</div>
<div class="line"><a name="l04717"></a><span class="lineno"> 4717</span>&#160;                {</div>
<div class="line"><a name="l04718"></a><span class="lineno"> 4718</span>&#160;                  elementJacobian_p_u[i][j]=0.0;</div>
<div class="line"><a name="l04719"></a><span class="lineno"> 4719</span>&#160;                  elementJacobian_p_v[i][j]=0.0;</div>
<div class="line"><a name="l04720"></a><span class="lineno"> 4720</span>&#160;                  elementJacobian_p_w[i][j]=0.0;</div>
<div class="line"><a name="l04721"></a><span class="lineno"> 4721</span>&#160;                  elementJacobian_u_p[j][i]=0.0;</div>
<div class="line"><a name="l04722"></a><span class="lineno"> 4722</span>&#160;                  elementJacobian_v_p[j][i]=0.0;</div>
<div class="line"><a name="l04723"></a><span class="lineno"> 4723</span>&#160;                  elementJacobian_w_p[j][i]=0.0;</div>
<div class="line"><a name="l04724"></a><span class="lineno"> 4724</span>&#160;                }</div>
<div class="line"><a name="l04725"></a><span class="lineno"> 4725</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;nDOF_v_test_element;i++)</div>
<div class="line"><a name="l04726"></a><span class="lineno"> 4726</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0;j&lt;nDOF_v_trial_element;j++)</div>
<div class="line"><a name="l04727"></a><span class="lineno"> 4727</span>&#160;                {</div>
<div class="line"><a name="l04728"></a><span class="lineno"> 4728</span>&#160;                  elementJacobian_u_u[i][j]=0.0;</div>
<div class="line"><a name="l04729"></a><span class="lineno"> 4729</span>&#160;                  elementJacobian_u_v[i][j]=0.0;</div>
<div class="line"><a name="l04730"></a><span class="lineno"> 4730</span>&#160;                  elementJacobian_u_w[i][j]=0.0;</div>
<div class="line"><a name="l04731"></a><span class="lineno"> 4731</span>&#160;                  elementJacobian_v_u[i][j]=0.0;</div>
<div class="line"><a name="l04732"></a><span class="lineno"> 4732</span>&#160;                  elementJacobian_v_v[i][j]=0.0;</div>
<div class="line"><a name="l04733"></a><span class="lineno"> 4733</span>&#160;                  elementJacobian_v_w[i][j]=0.0;</div>
<div class="line"><a name="l04734"></a><span class="lineno"> 4734</span>&#160;                  elementJacobian_w_u[i][j]=0.0;</div>
<div class="line"><a name="l04735"></a><span class="lineno"> 4735</span>&#160;                  elementJacobian_w_v[i][j]=0.0;</div>
<div class="line"><a name="l04736"></a><span class="lineno"> 4736</span>&#160;                  elementJacobian_w_w[i][j]=0.0;</div>
<div class="line"><a name="l04737"></a><span class="lineno"> 4737</span>&#160;                }</div>
<div class="line"><a name="l04738"></a><span class="lineno"> 4738</span>&#160;            <span class="keywordtype">double</span> element_phi[nDOF_mesh_trial_element], element_phi_s[nDOF_mesh_trial_element];</div>
<div class="line"><a name="l04739"></a><span class="lineno"> 4739</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0;j&lt;nDOF_mesh_trial_element;j++)</div>
<div class="line"><a name="l04740"></a><span class="lineno"> 4740</span>&#160;              {</div>
<div class="line"><a name="l04741"></a><span class="lineno"> 4741</span>&#160;                <span class="keyword">register</span> <span class="keywordtype">int</span> eN_j = eN*nDOF_mesh_trial_element+j;</div>
<div class="line"><a name="l04742"></a><span class="lineno"> 4742</span>&#160;                element_phi[j] = phi_nodes[p_l2g[eN_j]];</div>
<div class="line"><a name="l04743"></a><span class="lineno"> 4743</span>&#160;                element_phi_s[j] = phi_solid_nodes[p_l2g[eN_j]];</div>
<div class="line"><a name="l04744"></a><span class="lineno"> 4744</span>&#160;              }</div>
<div class="line"><a name="l04745"></a><span class="lineno"> 4745</span>&#160;            <span class="keywordtype">double</span> element_nodes[nDOF_mesh_trial_element*3];</div>
<div class="line"><a name="l04746"></a><span class="lineno"> 4746</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;nDOF_mesh_trial_element;i++)</div>
<div class="line"><a name="l04747"></a><span class="lineno"> 4747</span>&#160;              {</div>
<div class="line"><a name="l04748"></a><span class="lineno"> 4748</span>&#160;                <span class="keyword">register</span> <span class="keywordtype">int</span> eN_i=eN*nDOF_mesh_trial_element+i;</div>
<div class="line"><a name="l04749"></a><span class="lineno"> 4749</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">int</span> I=0;I&lt;3;I++)</div>
<div class="line"><a name="l04750"></a><span class="lineno"> 4750</span>&#160;                  element_nodes[i*3 + I] = mesh_dof[mesh_l2g[eN_i]*3 + I];</div>
<div class="line"><a name="l04751"></a><span class="lineno"> 4751</span>&#160;              }<span class="comment">//i</span></div>
<div class="line"><a name="l04752"></a><span class="lineno"> 4752</span>&#160;            <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#aa6183d3c81313639cd5ec6c4697ccdde">gf_s</a>.calculate(element_phi_s, element_nodes, x_ref);</div>
<div class="line"><a name="l04753"></a><span class="lineno"> 4753</span>&#160;            <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a25259ea48a9bc3708796a96164a3b8de">gf</a>.calculate(element_phi, element_nodes, x_ref);</div>
<div class="line"><a name="l04754"></a><span class="lineno"> 4754</span>&#160;            <span class="keywordflow">for</span>  (<span class="keywordtype">int</span> k=0;k&lt;nQuadraturePoints_element;k++)</div>
<div class="line"><a name="l04755"></a><span class="lineno"> 4755</span>&#160;              {</div>
<div class="line"><a name="l04756"></a><span class="lineno"> 4756</span>&#160;                <span class="keywordtype">int</span> eN_k = eN*nQuadraturePoints_element+k, <span class="comment">//index to a scalar at a quadrature point</span></div>
<div class="line"><a name="l04757"></a><span class="lineno"> 4757</span>&#160;                  eN_k_nSpace = eN_k*nSpace,</div>
<div class="line"><a name="l04758"></a><span class="lineno"> 4758</span>&#160;                  eN_k_3d = eN_k*3,</div>
<div class="line"><a name="l04759"></a><span class="lineno"> 4759</span>&#160;                  eN_nDOF_trial_element = eN*nDOF_trial_element, <span class="comment">//index to a vector at a quadrature point</span></div>
<div class="line"><a name="l04760"></a><span class="lineno"> 4760</span>&#160;                  eN_nDOF_v_trial_element = eN*nDOF_v_trial_element; <span class="comment">//index to a vector at a quadrature point</span></div>
<div class="line"><a name="l04761"></a><span class="lineno"> 4761</span>&#160; </div>
<div class="line"><a name="l04762"></a><span class="lineno"> 4762</span>&#160;                <span class="comment">//declare local storage</span></div>
<div class="line"><a name="l04763"></a><span class="lineno"> 4763</span>&#160;                <span class="keyword">register</span> <span class="keywordtype">double</span> p=0.0,<a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>=0.0,<a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>=0.0,<a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a>=0.0,</div>
<div class="line"><a name="l04764"></a><span class="lineno"> 4764</span>&#160;                  grad_p[nSpace],grad_u[nSpace],grad_v[nSpace],grad_w[nSpace],</div>
<div class="line"><a name="l04765"></a><span class="lineno"> 4765</span>&#160;                  p_old=0.0,u_old=0.0,v_old=0.0,w_old=0.0,</div>
<div class="line"><a name="l04766"></a><span class="lineno"> 4766</span>&#160;                  grad_p_old[nSpace],grad_u_old[nSpace],grad_v_old[nSpace],grad_w_old[nSpace],</div>
<div class="line"><a name="l04767"></a><span class="lineno"> 4767</span>&#160;                  mom_u_acc=0.0,</div>
<div class="line"><a name="l04768"></a><span class="lineno"> 4768</span>&#160;                  dmom_u_acc_u=0.0,</div>
<div class="line"><a name="l04769"></a><span class="lineno"> 4769</span>&#160;                  mom_v_acc=0.0,</div>
<div class="line"><a name="l04770"></a><span class="lineno"> 4770</span>&#160;                  dmom_v_acc_v=0.0,</div>
<div class="line"><a name="l04771"></a><span class="lineno"> 4771</span>&#160;                  mom_w_acc=0.0,</div>
<div class="line"><a name="l04772"></a><span class="lineno"> 4772</span>&#160;                  dmom_w_acc_w=0.0,</div>
<div class="line"><a name="l04773"></a><span class="lineno"> 4773</span>&#160;                  mass_adv[nSpace],</div>
<div class="line"><a name="l04774"></a><span class="lineno"> 4774</span>&#160;                  dmass_adv_u[nSpace],</div>
<div class="line"><a name="l04775"></a><span class="lineno"> 4775</span>&#160;                  dmass_adv_v[nSpace],</div>
<div class="line"><a name="l04776"></a><span class="lineno"> 4776</span>&#160;                  dmass_adv_w[nSpace],</div>
<div class="line"><a name="l04777"></a><span class="lineno"> 4777</span>&#160;                  mass_ham=0.0,</div>
<div class="line"><a name="l04778"></a><span class="lineno"> 4778</span>&#160;                  dmass_ham_u=0.0,</div>
<div class="line"><a name="l04779"></a><span class="lineno"> 4779</span>&#160;                  dmass_ham_v=0.0,</div>
<div class="line"><a name="l04780"></a><span class="lineno"> 4780</span>&#160;                  dmass_ham_w=0.0,</div>
<div class="line"><a name="l04781"></a><span class="lineno"> 4781</span>&#160;                  mom_u_adv[nSpace],</div>
<div class="line"><a name="l04782"></a><span class="lineno"> 4782</span>&#160;                  dmom_u_adv_u[nSpace],</div>
<div class="line"><a name="l04783"></a><span class="lineno"> 4783</span>&#160;                  dmom_u_adv_v[nSpace],</div>
<div class="line"><a name="l04784"></a><span class="lineno"> 4784</span>&#160;                  dmom_u_adv_w[nSpace],</div>
<div class="line"><a name="l04785"></a><span class="lineno"> 4785</span>&#160;                  mom_v_adv[nSpace],</div>
<div class="line"><a name="l04786"></a><span class="lineno"> 4786</span>&#160;                  dmom_v_adv_u[nSpace],</div>
<div class="line"><a name="l04787"></a><span class="lineno"> 4787</span>&#160;                  dmom_v_adv_v[nSpace],</div>
<div class="line"><a name="l04788"></a><span class="lineno"> 4788</span>&#160;                  dmom_v_adv_w[nSpace],</div>
<div class="line"><a name="l04789"></a><span class="lineno"> 4789</span>&#160;                  mom_w_adv[nSpace],</div>
<div class="line"><a name="l04790"></a><span class="lineno"> 4790</span>&#160;                  dmom_w_adv_u[nSpace],</div>
<div class="line"><a name="l04791"></a><span class="lineno"> 4791</span>&#160;                  dmom_w_adv_v[nSpace],</div>
<div class="line"><a name="l04792"></a><span class="lineno"> 4792</span>&#160;                  dmom_w_adv_w[nSpace],</div>
<div class="line"><a name="l04793"></a><span class="lineno"> 4793</span>&#160;                  mom_uu_diff_ten[nSpace],</div>
<div class="line"><a name="l04794"></a><span class="lineno"> 4794</span>&#160;                  mom_vv_diff_ten[nSpace],</div>
<div class="line"><a name="l04795"></a><span class="lineno"> 4795</span>&#160;                  mom_ww_diff_ten[nSpace],</div>
<div class="line"><a name="l04796"></a><span class="lineno"> 4796</span>&#160;                  mom_uv_diff_ten[1],</div>
<div class="line"><a name="l04797"></a><span class="lineno"> 4797</span>&#160;                  mom_uw_diff_ten[1],</div>
<div class="line"><a name="l04798"></a><span class="lineno"> 4798</span>&#160;                  mom_vu_diff_ten[1],</div>
<div class="line"><a name="l04799"></a><span class="lineno"> 4799</span>&#160;                  mom_vw_diff_ten[1],</div>
<div class="line"><a name="l04800"></a><span class="lineno"> 4800</span>&#160;                  mom_wu_diff_ten[1],</div>
<div class="line"><a name="l04801"></a><span class="lineno"> 4801</span>&#160;                  mom_wv_diff_ten[1],</div>
<div class="line"><a name="l04802"></a><span class="lineno"> 4802</span>&#160;                  mom_u_source=0.0,</div>
<div class="line"><a name="l04803"></a><span class="lineno"> 4803</span>&#160;                  mom_v_source=0.0,</div>
<div class="line"><a name="l04804"></a><span class="lineno"> 4804</span>&#160;                  mom_w_source=0.0,</div>
<div class="line"><a name="l04805"></a><span class="lineno"> 4805</span>&#160;                  mom_u_ham=0.0,</div>
<div class="line"><a name="l04806"></a><span class="lineno"> 4806</span>&#160;                  dmom_u_ham_grad_p[nSpace],</div>
<div class="line"><a name="l04807"></a><span class="lineno"> 4807</span>&#160;                  dmom_u_ham_grad_u[nSpace],</div>
<div class="line"><a name="l04808"></a><span class="lineno"> 4808</span>&#160;                  dmom_u_ham_u=0.0,</div>
<div class="line"><a name="l04809"></a><span class="lineno"> 4809</span>&#160;                  dmom_u_ham_v=0.0,</div>
<div class="line"><a name="l04810"></a><span class="lineno"> 4810</span>&#160;                  dmom_u_ham_w=0.0,</div>
<div class="line"><a name="l04811"></a><span class="lineno"> 4811</span>&#160;                  mom_v_ham=0.0,</div>
<div class="line"><a name="l04812"></a><span class="lineno"> 4812</span>&#160;                  dmom_v_ham_grad_p[nSpace],</div>
<div class="line"><a name="l04813"></a><span class="lineno"> 4813</span>&#160;                  dmom_v_ham_grad_v[nSpace],</div>
<div class="line"><a name="l04814"></a><span class="lineno"> 4814</span>&#160;                  dmom_v_ham_u=0.0,</div>
<div class="line"><a name="l04815"></a><span class="lineno"> 4815</span>&#160;                  dmom_v_ham_v=0.0,</div>
<div class="line"><a name="l04816"></a><span class="lineno"> 4816</span>&#160;                  dmom_v_ham_w=0.0,</div>
<div class="line"><a name="l04817"></a><span class="lineno"> 4817</span>&#160;                  mom_w_ham=0.0,</div>
<div class="line"><a name="l04818"></a><span class="lineno"> 4818</span>&#160;                  dmom_w_ham_grad_p[nSpace],</div>
<div class="line"><a name="l04819"></a><span class="lineno"> 4819</span>&#160;                  dmom_w_ham_grad_w[nSpace],</div>
<div class="line"><a name="l04820"></a><span class="lineno"> 4820</span>&#160;                  dmom_w_ham_u=0.0,</div>
<div class="line"><a name="l04821"></a><span class="lineno"> 4821</span>&#160;                  dmom_w_ham_v=0.0,</div>
<div class="line"><a name="l04822"></a><span class="lineno"> 4822</span>&#160;                  dmom_w_ham_w=0.0,</div>
<div class="line"><a name="l04823"></a><span class="lineno"> 4823</span>&#160;                  mom_u_acc_t=0.0,</div>
<div class="line"><a name="l04824"></a><span class="lineno"> 4824</span>&#160;                  dmom_u_acc_u_t=0.0,</div>
<div class="line"><a name="l04825"></a><span class="lineno"> 4825</span>&#160;                  mom_v_acc_t=0.0,</div>
<div class="line"><a name="l04826"></a><span class="lineno"> 4826</span>&#160;                  dmom_v_acc_v_t=0.0,</div>
<div class="line"><a name="l04827"></a><span class="lineno"> 4827</span>&#160;                  mom_w_acc_t=0.0,</div>
<div class="line"><a name="l04828"></a><span class="lineno"> 4828</span>&#160;                  dmom_w_acc_w_t=0.0,</div>
<div class="line"><a name="l04829"></a><span class="lineno"> 4829</span>&#160;                  pdeResidual_p=0.0,</div>
<div class="line"><a name="l04830"></a><span class="lineno"> 4830</span>&#160;                  pdeResidual_u=0.0,</div>
<div class="line"><a name="l04831"></a><span class="lineno"> 4831</span>&#160;                  pdeResidual_v=0.0,</div>
<div class="line"><a name="l04832"></a><span class="lineno"> 4832</span>&#160;                  pdeResidual_w=0.0,</div>
<div class="line"><a name="l04833"></a><span class="lineno"> 4833</span>&#160;                  dpdeResidual_p_u[nDOF_v_trial_element],dpdeResidual_p_v[nDOF_v_trial_element],dpdeResidual_p_w[nDOF_v_trial_element],</div>
<div class="line"><a name="l04834"></a><span class="lineno"> 4834</span>&#160;                  dpdeResidual_u_p[nDOF_trial_element],dpdeResidual_u_u[nDOF_v_trial_element],</div>
<div class="line"><a name="l04835"></a><span class="lineno"> 4835</span>&#160;                  dpdeResidual_v_p[nDOF_trial_element],dpdeResidual_v_v[nDOF_v_trial_element],</div>
<div class="line"><a name="l04836"></a><span class="lineno"> 4836</span>&#160;                  dpdeResidual_w_p[nDOF_trial_element],dpdeResidual_w_w[nDOF_v_trial_element],</div>
<div class="line"><a name="l04837"></a><span class="lineno"> 4837</span>&#160;                  Lstar_u_p[nDOF_test_element],</div>
<div class="line"><a name="l04838"></a><span class="lineno"> 4838</span>&#160;                  Lstar_v_p[nDOF_test_element],</div>
<div class="line"><a name="l04839"></a><span class="lineno"> 4839</span>&#160;                  Lstar_w_p[nDOF_test_element],</div>
<div class="line"><a name="l04840"></a><span class="lineno"> 4840</span>&#160;                  Lstar_u_u[nDOF_v_test_element],</div>
<div class="line"><a name="l04841"></a><span class="lineno"> 4841</span>&#160;                  Lstar_v_v[nDOF_v_test_element],</div>
<div class="line"><a name="l04842"></a><span class="lineno"> 4842</span>&#160;                  Lstar_w_w[nDOF_v_test_element],</div>
<div class="line"><a name="l04843"></a><span class="lineno"> 4843</span>&#160;                  Lstar_p_u[nDOF_v_test_element],</div>
<div class="line"><a name="l04844"></a><span class="lineno"> 4844</span>&#160;                  Lstar_p_v[nDOF_v_test_element],</div>
<div class="line"><a name="l04845"></a><span class="lineno"> 4845</span>&#160;                  Lstar_p_w[nDOF_v_test_element],</div>
<div class="line"><a name="l04846"></a><span class="lineno"> 4846</span>&#160;                  subgridError_p=0.0,</div>
<div class="line"><a name="l04847"></a><span class="lineno"> 4847</span>&#160;                  subgridError_u=0.0,</div>
<div class="line"><a name="l04848"></a><span class="lineno"> 4848</span>&#160;                  subgridError_v=0.0,</div>
<div class="line"><a name="l04849"></a><span class="lineno"> 4849</span>&#160;                  subgridError_w=0.0,</div>
<div class="line"><a name="l04850"></a><span class="lineno"> 4850</span>&#160;                  dsubgridError_p_u[nDOF_v_trial_element],</div>
<div class="line"><a name="l04851"></a><span class="lineno"> 4851</span>&#160;                  dsubgridError_p_v[nDOF_v_trial_element],</div>
<div class="line"><a name="l04852"></a><span class="lineno"> 4852</span>&#160;                  dsubgridError_p_w[nDOF_v_trial_element],</div>
<div class="line"><a name="l04853"></a><span class="lineno"> 4853</span>&#160;                  dsubgridError_u_p[nDOF_trial_element],</div>
<div class="line"><a name="l04854"></a><span class="lineno"> 4854</span>&#160;                  dsubgridError_u_u[nDOF_v_trial_element],</div>
<div class="line"><a name="l04855"></a><span class="lineno"> 4855</span>&#160;                  dsubgridError_v_p[nDOF_trial_element],</div>
<div class="line"><a name="l04856"></a><span class="lineno"> 4856</span>&#160;                  dsubgridError_v_v[nDOF_v_trial_element],</div>
<div class="line"><a name="l04857"></a><span class="lineno"> 4857</span>&#160;                  dsubgridError_w_p[nDOF_trial_element],</div>
<div class="line"><a name="l04858"></a><span class="lineno"> 4858</span>&#160;                  dsubgridError_w_w[nDOF_v_trial_element],</div>
<div class="line"><a name="l04859"></a><span class="lineno"> 4859</span>&#160;                  tau_p=0.0,tau_p0=0.0,tau_p1=0.0,</div>
<div class="line"><a name="l04860"></a><span class="lineno"> 4860</span>&#160;                  tau_v=0.0,tau_v0=0.0,tau_v1=0.0,</div>
<div class="line"><a name="l04861"></a><span class="lineno"> 4861</span>&#160;                  jac[nSpace*nSpace],</div>
<div class="line"><a name="l04862"></a><span class="lineno"> 4862</span>&#160;                  jacDet,</div>
<div class="line"><a name="l04863"></a><span class="lineno"> 4863</span>&#160;                  jacInv[nSpace*nSpace],</div>
<div class="line"><a name="l04864"></a><span class="lineno"> 4864</span>&#160;                  p_grad_trial[nDOF_trial_element*nSpace],vel_grad_trial[nDOF_v_trial_element*nSpace],</div>
<div class="line"><a name="l04865"></a><span class="lineno"> 4865</span>&#160;                  dV,</div>
<div class="line"><a name="l04866"></a><span class="lineno"> 4866</span>&#160;                  p_test_dV[nDOF_test_element],vel_test_dV[nDOF_v_test_element],</div>
<div class="line"><a name="l04867"></a><span class="lineno"> 4867</span>&#160;                  p_grad_test_dV[nDOF_test_element*nSpace],vel_grad_test_dV[nDOF_v_test_element*nSpace],</div>
<div class="line"><a name="l04868"></a><span class="lineno"> 4868</span>&#160;                  x,y,<a class="code" href="_headers_8h.html#a9d199fcfc162b9ad09d4c9426e713a74">z</a>,xt,yt,zt,</div>
<div class="line"><a name="l04869"></a><span class="lineno"> 4869</span>&#160;                  <span class="comment">//VRANS</span></div>
<div class="line"><a name="l04870"></a><span class="lineno"> 4870</span>&#160;                  porosity,</div>
<div class="line"><a name="l04871"></a><span class="lineno"> 4871</span>&#160;                  <span class="comment">//meanGrainSize,</span></div>
<div class="line"><a name="l04872"></a><span class="lineno"> 4872</span>&#160;                  dmom_u_source[nSpace],</div>
<div class="line"><a name="l04873"></a><span class="lineno"> 4873</span>&#160;                  dmom_v_source[nSpace],</div>
<div class="line"><a name="l04874"></a><span class="lineno"> 4874</span>&#160;                  dmom_w_source[nSpace],</div>
<div class="line"><a name="l04875"></a><span class="lineno"> 4875</span>&#160;                  mass_source,</div>
<div class="line"><a name="l04876"></a><span class="lineno"> 4876</span>&#160;                  <span class="comment">//</span></div>
<div class="line"><a name="l04877"></a><span class="lineno"> 4877</span>&#160;                  G[nSpace*nSpace],G_dd_G,tr_G,h_phi, dmom_adv_star[nSpace], dmom_adv_sge[nSpace], dmom_ham_grad_sge[nSpace];</div>
<div class="line"><a name="l04878"></a><span class="lineno"> 4878</span>&#160;                <span class="comment">//get jacobian, etc for mapping reference element</span></div>
<div class="line"><a name="l04879"></a><span class="lineno"> 4879</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#aa6183d3c81313639cd5ec6c4697ccdde">gf_s</a>.set_quad(k);</div>
<div class="line"><a name="l04880"></a><span class="lineno"> 4880</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a25259ea48a9bc3708796a96164a3b8de">gf</a>.set_quad(k);</div>
<div class="line"><a name="l04881"></a><span class="lineno"> 4881</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.calculateMapping_element(eN,</div>
<div class="line"><a name="l04882"></a><span class="lineno"> 4882</span>&#160;                                            k,</div>
<div class="line"><a name="l04883"></a><span class="lineno"> 4883</span>&#160;                                            mesh_dof,</div>
<div class="line"><a name="l04884"></a><span class="lineno"> 4884</span>&#160;                                            mesh_l2g,</div>
<div class="line"><a name="l04885"></a><span class="lineno"> 4885</span>&#160;                                            mesh_trial_ref,</div>
<div class="line"><a name="l04886"></a><span class="lineno"> 4886</span>&#160;                                            mesh_grad_trial_ref,</div>
<div class="line"><a name="l04887"></a><span class="lineno"> 4887</span>&#160;                                            jac,</div>
<div class="line"><a name="l04888"></a><span class="lineno"> 4888</span>&#160;                                            jacDet,</div>
<div class="line"><a name="l04889"></a><span class="lineno"> 4889</span>&#160;                                            jacInv,</div>
<div class="line"><a name="l04890"></a><span class="lineno"> 4890</span>&#160;                                            x,y,<a class="code" href="_headers_8h.html#a9d199fcfc162b9ad09d4c9426e713a74">z</a>);</div>
<div class="line"><a name="l04891"></a><span class="lineno"> 4891</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.calculateH_element(eN,</div>
<div class="line"><a name="l04892"></a><span class="lineno"> 4892</span>&#160;                                      k,</div>
<div class="line"><a name="l04893"></a><span class="lineno"> 4893</span>&#160;                                      nodeDiametersArray,</div>
<div class="line"><a name="l04894"></a><span class="lineno"> 4894</span>&#160;                                      mesh_l2g,</div>
<div class="line"><a name="l04895"></a><span class="lineno"> 4895</span>&#160;                                      mesh_trial_ref,</div>
<div class="line"><a name="l04896"></a><span class="lineno"> 4896</span>&#160;                                      h_phi);</div>
<div class="line"><a name="l04897"></a><span class="lineno"> 4897</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.calculateMappingVelocity_element(eN,</div>
<div class="line"><a name="l04898"></a><span class="lineno"> 4898</span>&#160;                                                    k,</div>
<div class="line"><a name="l04899"></a><span class="lineno"> 4899</span>&#160;                                                    mesh_velocity_dof,</div>
<div class="line"><a name="l04900"></a><span class="lineno"> 4900</span>&#160;                                                    mesh_l2g,</div>
<div class="line"><a name="l04901"></a><span class="lineno"> 4901</span>&#160;                                                    mesh_trial_ref,</div>
<div class="line"><a name="l04902"></a><span class="lineno"> 4902</span>&#160;                                                    xt,yt,zt);</div>
<div class="line"><a name="l04903"></a><span class="lineno"> 4903</span>&#160;                <span class="comment">//xt=0.0;yt=0.0;zt=0.0;</span></div>
<div class="line"><a name="l04904"></a><span class="lineno"> 4904</span>&#160;                <span class="comment">//std::cout&lt;&lt;&quot;xt &quot;&lt;&lt;xt&lt;&lt;&#39;\t&#39;&lt;&lt;yt&lt;&lt;&#39;\t&#39;&lt;&lt;zt&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l04905"></a><span class="lineno"> 4905</span>&#160;                <span class="comment">//get the physical integration weight</span></div>
<div class="line"><a name="l04906"></a><span class="lineno"> 4906</span>&#160;                dV = fabs(jacDet)*dV_ref[k];</div>
<div class="line"><a name="l04907"></a><span class="lineno"> 4907</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.calculateG(jacInv,G,G_dd_G,tr_G);</div>
<div class="line"><a name="l04908"></a><span class="lineno"> 4908</span>&#160;                <span class="comment">//ck.calculateGScale(G,&amp;normal_phi[eN_k_nSpace],h_phi);</span></div>
<div class="line"><a name="l04909"></a><span class="lineno"> 4909</span>&#160; </div>
<div class="line"><a name="l04910"></a><span class="lineno"> 4910</span>&#160;                eps_rho = epsFact_rho*(useMetrics*h_phi+(1.0-useMetrics)*elementDiameter[eN]);</div>
<div class="line"><a name="l04911"></a><span class="lineno"> 4911</span>&#160;                eps_mu  = epsFact_mu *(useMetrics*h_phi+(1.0-useMetrics)*elementDiameter[eN]);</div>
<div class="line"><a name="l04912"></a><span class="lineno"> 4912</span>&#160; </div>
<div class="line"><a name="l04913"></a><span class="lineno"> 4913</span>&#160;                <span class="comment">//get the trial function gradients</span></div>
<div class="line"><a name="l04914"></a><span class="lineno"> 4914</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.gradTrialFromRef(&amp;p_grad_trial_ref[k*nDOF_trial_element*nSpace],jacInv,p_grad_trial);</div>
<div class="line"><a name="l04915"></a><span class="lineno"> 4915</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a7a7848813d299e5d43a0c4872556a476">ck_v</a>.gradTrialFromRef(&amp;vel_grad_trial_ref[k*nDOF_v_trial_element*nSpace],jacInv,vel_grad_trial);</div>
<div class="line"><a name="l04916"></a><span class="lineno"> 4916</span>&#160;                <span class="comment">//get the solution</span></div>
<div class="line"><a name="l04917"></a><span class="lineno"> 4917</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.valFromDOF(p_dof,&amp;p_l2g[eN_nDOF_trial_element],&amp;p_trial_ref[k*nDOF_trial_element],p);</div>
<div class="line"><a name="l04918"></a><span class="lineno"> 4918</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a7a7848813d299e5d43a0c4872556a476">ck_v</a>.valFromDOF(u_dof,&amp;vel_l2g[eN_nDOF_v_trial_element],&amp;vel_trial_ref[k*nDOF_v_trial_element],<a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>);</div>
<div class="line"><a name="l04919"></a><span class="lineno"> 4919</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a7a7848813d299e5d43a0c4872556a476">ck_v</a>.valFromDOF(v_dof,&amp;vel_l2g[eN_nDOF_v_trial_element],&amp;vel_trial_ref[k*nDOF_v_trial_element],<a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>);</div>
<div class="line"><a name="l04920"></a><span class="lineno"> 4920</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a7a7848813d299e5d43a0c4872556a476">ck_v</a>.valFromDOF(w_dof,&amp;vel_l2g[eN_nDOF_v_trial_element],&amp;vel_trial_ref[k*nDOF_v_trial_element],<a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a>);</div>
<div class="line"><a name="l04921"></a><span class="lineno"> 4921</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.valFromDOF(p_old_dof,&amp;p_l2g[eN_nDOF_trial_element],&amp;p_trial_ref[k*nDOF_trial_element],p_old);</div>
<div class="line"><a name="l04922"></a><span class="lineno"> 4922</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a7a7848813d299e5d43a0c4872556a476">ck_v</a>.valFromDOF(u_old_dof,&amp;vel_l2g[eN_nDOF_v_trial_element],&amp;vel_trial_ref[k*nDOF_v_trial_element],u_old);</div>
<div class="line"><a name="l04923"></a><span class="lineno"> 4923</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a7a7848813d299e5d43a0c4872556a476">ck_v</a>.valFromDOF(v_old_dof,&amp;vel_l2g[eN_nDOF_v_trial_element],&amp;vel_trial_ref[k*nDOF_v_trial_element],v_old);</div>
<div class="line"><a name="l04924"></a><span class="lineno"> 4924</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a7a7848813d299e5d43a0c4872556a476">ck_v</a>.valFromDOF(w_old_dof,&amp;vel_l2g[eN_nDOF_v_trial_element],&amp;vel_trial_ref[k*nDOF_v_trial_element],w_old);</div>
<div class="line"><a name="l04925"></a><span class="lineno"> 4925</span>&#160;                <span class="comment">//get the solution gradients</span></div>
<div class="line"><a name="l04926"></a><span class="lineno"> 4926</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.gradFromDOF(p_dof,&amp;p_l2g[eN_nDOF_trial_element],p_grad_trial,grad_p);</div>
<div class="line"><a name="l04927"></a><span class="lineno"> 4927</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a7a7848813d299e5d43a0c4872556a476">ck_v</a>.gradFromDOF(u_dof,&amp;vel_l2g[eN_nDOF_v_trial_element],vel_grad_trial,grad_u);</div>
<div class="line"><a name="l04928"></a><span class="lineno"> 4928</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a7a7848813d299e5d43a0c4872556a476">ck_v</a>.gradFromDOF(v_dof,&amp;vel_l2g[eN_nDOF_v_trial_element],vel_grad_trial,grad_v);</div>
<div class="line"><a name="l04929"></a><span class="lineno"> 4929</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a7a7848813d299e5d43a0c4872556a476">ck_v</a>.gradFromDOF(w_dof,&amp;vel_l2g[eN_nDOF_v_trial_element],vel_grad_trial,grad_w);</div>
<div class="line"><a name="l04930"></a><span class="lineno"> 4930</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.gradFromDOF(p_old_dof,&amp;p_l2g[eN_nDOF_trial_element],p_grad_trial,grad_p_old);</div>
<div class="line"><a name="l04931"></a><span class="lineno"> 4931</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a7a7848813d299e5d43a0c4872556a476">ck_v</a>.gradFromDOF(u_old_dof,&amp;vel_l2g[eN_nDOF_v_trial_element],vel_grad_trial,grad_u_old);</div>
<div class="line"><a name="l04932"></a><span class="lineno"> 4932</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a7a7848813d299e5d43a0c4872556a476">ck_v</a>.gradFromDOF(v_old_dof,&amp;vel_l2g[eN_nDOF_v_trial_element],vel_grad_trial,grad_v_old);</div>
<div class="line"><a name="l04933"></a><span class="lineno"> 4933</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a7a7848813d299e5d43a0c4872556a476">ck_v</a>.gradFromDOF(w_old_dof,&amp;vel_l2g[eN_nDOF_v_trial_element],vel_grad_trial,grad_w_old);</div>
<div class="line"><a name="l04934"></a><span class="lineno"> 4934</span>&#160;                <span class="comment">//precalculate test function products with integration weights</span></div>
<div class="line"><a name="l04935"></a><span class="lineno"> 4935</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0;j&lt;nDOF_test_element;j++)</div>
<div class="line"><a name="l04936"></a><span class="lineno"> 4936</span>&#160;                  {</div>
<div class="line"><a name="l04937"></a><span class="lineno"> 4937</span>&#160;                    p_test_dV[j] = p_test_ref[k*nDOF_trial_element+j]*dV;</div>
<div class="line"><a name="l04938"></a><span class="lineno"> 4938</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> I=0;I&lt;nSpace;I++)</div>
<div class="line"><a name="l04939"></a><span class="lineno"> 4939</span>&#160;                      {</div>
<div class="line"><a name="l04940"></a><span class="lineno"> 4940</span>&#160;                        p_grad_test_dV[j*nSpace+I]   = p_grad_trial[j*nSpace+I]*dV;<span class="comment">//assume test_j == trial_j</span></div>
<div class="line"><a name="l04941"></a><span class="lineno"> 4941</span>&#160;                      }</div>
<div class="line"><a name="l04942"></a><span class="lineno"> 4942</span>&#160;                  }</div>
<div class="line"><a name="l04943"></a><span class="lineno"> 4943</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0;j&lt;nDOF_v_test_element;j++)</div>
<div class="line"><a name="l04944"></a><span class="lineno"> 4944</span>&#160;                  {</div>
<div class="line"><a name="l04945"></a><span class="lineno"> 4945</span>&#160;                    vel_test_dV[j] = vel_test_ref[k*nDOF_v_trial_element+j]*dV;</div>
<div class="line"><a name="l04946"></a><span class="lineno"> 4946</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> I=0;I&lt;nSpace;I++)</div>
<div class="line"><a name="l04947"></a><span class="lineno"> 4947</span>&#160;                      {</div>
<div class="line"><a name="l04948"></a><span class="lineno"> 4948</span>&#160;                        vel_grad_test_dV[j*nSpace+I] = vel_grad_trial[j*nSpace+I]*dV;<span class="comment">//assume test_j == trial_j</span></div>
<div class="line"><a name="l04949"></a><span class="lineno"> 4949</span>&#160;                      }</div>
<div class="line"><a name="l04950"></a><span class="lineno"> 4950</span>&#160;                  }</div>
<div class="line"><a name="l04951"></a><span class="lineno"> 4951</span>&#160;                <span class="comment">//needs to be fixed for higher-order meshes, assuming mesh trial is same as p trial</span></div>
<div class="line"><a name="l04952"></a><span class="lineno"> 4952</span>&#160;                <span class="keywordtype">double</span> div_mesh_velocity=0.0;</div>
<div class="line"><a name="l04953"></a><span class="lineno"> 4953</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0;j&lt;nDOF_trial_element;j++)</div>
<div class="line"><a name="l04954"></a><span class="lineno"> 4954</span>&#160;                  {</div>
<div class="line"><a name="l04955"></a><span class="lineno"> 4955</span>&#160;                    <span class="keywordtype">int</span> eN_j=eN*nDOF_trial_element+j;</div>
<div class="line"><a name="l04956"></a><span class="lineno"> 4956</span>&#160;                    div_mesh_velocity +=</div>
<div class="line"><a name="l04957"></a><span class="lineno"> 4957</span>&#160;                      mesh_velocity_dof[mesh_l2g[eN_j]*3+0]*p_grad_trial[j*3+0] +</div>
<div class="line"><a name="l04958"></a><span class="lineno"> 4958</span>&#160;                      mesh_velocity_dof[mesh_l2g[eN_j]*3+1]*p_grad_trial[j*3+1] +</div>
<div class="line"><a name="l04959"></a><span class="lineno"> 4959</span>&#160;                      mesh_velocity_dof[mesh_l2g[eN_j]*3+2]*p_grad_trial[j*3+2];</div>
<div class="line"><a name="l04960"></a><span class="lineno"> 4960</span>&#160;                  }</div>
<div class="line"><a name="l04961"></a><span class="lineno"> 4961</span>&#160;                div_mesh_velocity = <a class="code" href="_r_a_n_s2_p_8h.html#a5c858c7944d8ca1cbd20d6eeb52a1ae3">DM3</a>*div_mesh_velocity + (1.0-<a class="code" href="_r_a_n_s2_p_8h.html#a5c858c7944d8ca1cbd20d6eeb52a1ae3">DM3</a>)*alphaBDF*(dV-q_dV_last[eN_k])/dV;</div>
<div class="line"><a name="l04962"></a><span class="lineno"> 4962</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l04963"></a><span class="lineno"> 4963</span>&#160;                <span class="comment">//VRANS</span></div>
<div class="line"><a name="l04964"></a><span class="lineno"> 4964</span>&#160;                porosity = q_porosity[eN_k];</div>
<div class="line"><a name="l04965"></a><span class="lineno"> 4965</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l04966"></a><span class="lineno"> 4966</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l04967"></a><span class="lineno"> 4967</span>&#160;                <span class="comment">//calculate pde coefficients and derivatives at quadrature points</span></div>
<div class="line"><a name="l04968"></a><span class="lineno"> 4968</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l04969"></a><span class="lineno"> 4969</span>&#160;                <span class="keywordtype">double</span> eddy_viscosity(0.);<span class="comment">//not really interested in saving eddy_viscosity in jacobian</span></div>
<div class="line"><a name="l04970"></a><span class="lineno"> 4970</span>&#160;                <span class="keywordtype">double</span> rho;</div>
<div class="line"><a name="l04971"></a><span class="lineno"> 4971</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#adff72a3cebc8b98398097095827e7aa6">evaluateCoefficients</a>(NONCONSERVATIVE_FORM,</div>
<div class="line"><a name="l04972"></a><span class="lineno"> 4972</span>&#160;                                     eps_rho,</div>
<div class="line"><a name="l04973"></a><span class="lineno"> 4973</span>&#160;                                     eps_mu,</div>
<div class="line"><a name="l04974"></a><span class="lineno"> 4974</span>&#160;                                     sigma,</div>
<div class="line"><a name="l04975"></a><span class="lineno"> 4975</span>&#160;                                     <a class="code" href="_error_residual_method_8cpp.html#ae5f5d9edb66645eab31a7c8389493ce7">rho_0</a>,</div>
<div class="line"><a name="l04976"></a><span class="lineno"> 4976</span>&#160;                                     <a class="code" href="_error_residual_method_8cpp.html#a383b07af68441ce2b4adaaf8d8cc9d90">nu_0</a>,</div>
<div class="line"><a name="l04977"></a><span class="lineno"> 4977</span>&#160;                                     <a class="code" href="_error_residual_method_8cpp.html#a751e53c9d8dfaf696b11b86e0c1b42e9">rho_1</a>,</div>
<div class="line"><a name="l04978"></a><span class="lineno"> 4978</span>&#160;                                     <a class="code" href="_error_residual_method_8cpp.html#ae5896ebfee35f22242123e4ae82c81d9">nu_1</a>,</div>
<div class="line"><a name="l04979"></a><span class="lineno"> 4979</span>&#160;                                     elementDiameter[eN],</div>
<div class="line"><a name="l04980"></a><span class="lineno"> 4980</span>&#160;                                     smagorinskyConstant,</div>
<div class="line"><a name="l04981"></a><span class="lineno"> 4981</span>&#160;                                     turbulenceClosureModel,</div>
<div class="line"><a name="l04982"></a><span class="lineno"> 4982</span>&#160;                                     g,</div>
<div class="line"><a name="l04983"></a><span class="lineno"> 4983</span>&#160;                                     useVF,</div>
<div class="line"><a name="l04984"></a><span class="lineno"> 4984</span>&#160;                                     vf[eN_k],</div>
<div class="line"><a name="l04985"></a><span class="lineno"> 4985</span>&#160;                                     <a class="code" href="namespaceproteus.html#a17bf106c5df3b1331ed2a18392384813">phi</a>[eN_k],</div>
<div class="line"><a name="l04986"></a><span class="lineno"> 4986</span>&#160;                                     &amp;normal_phi[eN_k_nSpace],</div>
<div class="line"><a name="l04987"></a><span class="lineno"> 4987</span>&#160;                                     kappa_phi[eN_k],</div>
<div class="line"><a name="l04988"></a><span class="lineno"> 4988</span>&#160;                                     <span class="comment">//VRANS</span></div>
<div class="line"><a name="l04989"></a><span class="lineno"> 4989</span>&#160;                                     porosity,</div>
<div class="line"><a name="l04990"></a><span class="lineno"> 4990</span>&#160;                                     <span class="comment">//</span></div>
<div class="line"><a name="l04991"></a><span class="lineno"> 4991</span>&#160;                                     phi_solid[eN_k],<span class="comment">//updated in get residual</span></div>
<div class="line"><a name="l04992"></a><span class="lineno"> 4992</span>&#160;                                     p_old,</div>
<div class="line"><a name="l04993"></a><span class="lineno"> 4993</span>&#160;                                     u_old,</div>
<div class="line"><a name="l04994"></a><span class="lineno"> 4994</span>&#160;                                     v_old,</div>
<div class="line"><a name="l04995"></a><span class="lineno"> 4995</span>&#160;                                     w_old,</div>
<div class="line"><a name="l04996"></a><span class="lineno"> 4996</span>&#160;                                     grad_p_old,</div>
<div class="line"><a name="l04997"></a><span class="lineno"> 4997</span>&#160;                                     grad_u_old,</div>
<div class="line"><a name="l04998"></a><span class="lineno"> 4998</span>&#160;                                     grad_v_old,</div>
<div class="line"><a name="l04999"></a><span class="lineno"> 4999</span>&#160;                                     grad_w_old,</div>
<div class="line"><a name="l05000"></a><span class="lineno"> 5000</span>&#160;                                     use_pseudo_penalty,</div>
<div class="line"><a name="l05001"></a><span class="lineno"> 5001</span>&#160;                                     p,</div>
<div class="line"><a name="l05002"></a><span class="lineno"> 5002</span>&#160;                                     grad_p,</div>
<div class="line"><a name="l05003"></a><span class="lineno"> 5003</span>&#160;                                     grad_u,</div>
<div class="line"><a name="l05004"></a><span class="lineno"> 5004</span>&#160;                                     grad_v,</div>
<div class="line"><a name="l05005"></a><span class="lineno"> 5005</span>&#160;                                     grad_w,</div>
<div class="line"><a name="l05006"></a><span class="lineno"> 5006</span>&#160;                                     <a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>,</div>
<div class="line"><a name="l05007"></a><span class="lineno"> 5007</span>&#160;                                     <a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>,</div>
<div class="line"><a name="l05008"></a><span class="lineno"> 5008</span>&#160;                                     <a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a>,</div>
<div class="line"><a name="l05009"></a><span class="lineno"> 5009</span>&#160;                                     LAG_LES,</div>
<div class="line"><a name="l05010"></a><span class="lineno"> 5010</span>&#160;                                     eddy_viscosity,</div>
<div class="line"><a name="l05011"></a><span class="lineno"> 5011</span>&#160;                                     q_eddy_viscosity_last[eN_k],</div>
<div class="line"><a name="l05012"></a><span class="lineno"> 5012</span>&#160;                                     mom_u_acc,</div>
<div class="line"><a name="l05013"></a><span class="lineno"> 5013</span>&#160;                                     dmom_u_acc_u,</div>
<div class="line"><a name="l05014"></a><span class="lineno"> 5014</span>&#160;                                     mom_v_acc,</div>
<div class="line"><a name="l05015"></a><span class="lineno"> 5015</span>&#160;                                     dmom_v_acc_v,</div>
<div class="line"><a name="l05016"></a><span class="lineno"> 5016</span>&#160;                                     mom_w_acc,</div>
<div class="line"><a name="l05017"></a><span class="lineno"> 5017</span>&#160;                                     dmom_w_acc_w,</div>
<div class="line"><a name="l05018"></a><span class="lineno"> 5018</span>&#160;                                     mass_adv,</div>
<div class="line"><a name="l05019"></a><span class="lineno"> 5019</span>&#160;                                     dmass_adv_u,</div>
<div class="line"><a name="l05020"></a><span class="lineno"> 5020</span>&#160;                                     dmass_adv_v,</div>
<div class="line"><a name="l05021"></a><span class="lineno"> 5021</span>&#160;                                     dmass_adv_w,</div>
<div class="line"><a name="l05022"></a><span class="lineno"> 5022</span>&#160;                                     mom_u_adv,</div>
<div class="line"><a name="l05023"></a><span class="lineno"> 5023</span>&#160;                                     dmom_u_adv_u,</div>
<div class="line"><a name="l05024"></a><span class="lineno"> 5024</span>&#160;                                     dmom_u_adv_v,</div>
<div class="line"><a name="l05025"></a><span class="lineno"> 5025</span>&#160;                                     dmom_u_adv_w,</div>
<div class="line"><a name="l05026"></a><span class="lineno"> 5026</span>&#160;                                     mom_v_adv,</div>
<div class="line"><a name="l05027"></a><span class="lineno"> 5027</span>&#160;                                     dmom_v_adv_u,</div>
<div class="line"><a name="l05028"></a><span class="lineno"> 5028</span>&#160;                                     dmom_v_adv_v,</div>
<div class="line"><a name="l05029"></a><span class="lineno"> 5029</span>&#160;                                     dmom_v_adv_w,</div>
<div class="line"><a name="l05030"></a><span class="lineno"> 5030</span>&#160;                                     mom_w_adv,</div>
<div class="line"><a name="l05031"></a><span class="lineno"> 5031</span>&#160;                                     dmom_w_adv_u,</div>
<div class="line"><a name="l05032"></a><span class="lineno"> 5032</span>&#160;                                     dmom_w_adv_v,</div>
<div class="line"><a name="l05033"></a><span class="lineno"> 5033</span>&#160;                                     dmom_w_adv_w,</div>
<div class="line"><a name="l05034"></a><span class="lineno"> 5034</span>&#160;                                     mom_uu_diff_ten,</div>
<div class="line"><a name="l05035"></a><span class="lineno"> 5035</span>&#160;                                     mom_vv_diff_ten,</div>
<div class="line"><a name="l05036"></a><span class="lineno"> 5036</span>&#160;                                     mom_ww_diff_ten,</div>
<div class="line"><a name="l05037"></a><span class="lineno"> 5037</span>&#160;                                     mom_uv_diff_ten,</div>
<div class="line"><a name="l05038"></a><span class="lineno"> 5038</span>&#160;                                     mom_uw_diff_ten,</div>
<div class="line"><a name="l05039"></a><span class="lineno"> 5039</span>&#160;                                     mom_vu_diff_ten,</div>
<div class="line"><a name="l05040"></a><span class="lineno"> 5040</span>&#160;                                     mom_vw_diff_ten,</div>
<div class="line"><a name="l05041"></a><span class="lineno"> 5041</span>&#160;                                     mom_wu_diff_ten,</div>
<div class="line"><a name="l05042"></a><span class="lineno"> 5042</span>&#160;                                     mom_wv_diff_ten,</div>
<div class="line"><a name="l05043"></a><span class="lineno"> 5043</span>&#160;                                     mom_u_source,</div>
<div class="line"><a name="l05044"></a><span class="lineno"> 5044</span>&#160;                                     mom_v_source,</div>
<div class="line"><a name="l05045"></a><span class="lineno"> 5045</span>&#160;                                     mom_w_source,</div>
<div class="line"><a name="l05046"></a><span class="lineno"> 5046</span>&#160;                                     mom_u_ham,</div>
<div class="line"><a name="l05047"></a><span class="lineno"> 5047</span>&#160;                                     dmom_u_ham_grad_p,</div>
<div class="line"><a name="l05048"></a><span class="lineno"> 5048</span>&#160;                                     dmom_u_ham_grad_u,</div>
<div class="line"><a name="l05049"></a><span class="lineno"> 5049</span>&#160;                                     dmom_u_ham_u,</div>
<div class="line"><a name="l05050"></a><span class="lineno"> 5050</span>&#160;                                     dmom_u_ham_v,</div>
<div class="line"><a name="l05051"></a><span class="lineno"> 5051</span>&#160;                                     dmom_u_ham_w,</div>
<div class="line"><a name="l05052"></a><span class="lineno"> 5052</span>&#160;                                     mom_v_ham,</div>
<div class="line"><a name="l05053"></a><span class="lineno"> 5053</span>&#160;                                     dmom_v_ham_grad_p,</div>
<div class="line"><a name="l05054"></a><span class="lineno"> 5054</span>&#160;                                     dmom_v_ham_grad_v,</div>
<div class="line"><a name="l05055"></a><span class="lineno"> 5055</span>&#160;                                     dmom_v_ham_u,</div>
<div class="line"><a name="l05056"></a><span class="lineno"> 5056</span>&#160;                                     dmom_v_ham_v,</div>
<div class="line"><a name="l05057"></a><span class="lineno"> 5057</span>&#160;                                     dmom_v_ham_w,</div>
<div class="line"><a name="l05058"></a><span class="lineno"> 5058</span>&#160;                                     mom_w_ham,</div>
<div class="line"><a name="l05059"></a><span class="lineno"> 5059</span>&#160;                                     dmom_w_ham_grad_p,</div>
<div class="line"><a name="l05060"></a><span class="lineno"> 5060</span>&#160;                                     dmom_w_ham_grad_w,</div>
<div class="line"><a name="l05061"></a><span class="lineno"> 5061</span>&#160;                                     dmom_w_ham_u,</div>
<div class="line"><a name="l05062"></a><span class="lineno"> 5062</span>&#160;                                     dmom_w_ham_v,</div>
<div class="line"><a name="l05063"></a><span class="lineno"> 5063</span>&#160;                                     dmom_w_ham_w,</div>
<div class="line"><a name="l05064"></a><span class="lineno"> 5064</span>&#160;                                     rho,</div>
<div class="line"><a name="l05065"></a><span class="lineno"> 5065</span>&#160;                                     0.0,</div>
<div class="line"><a name="l05066"></a><span class="lineno"> 5066</span>&#160;                                     0.0,</div>
<div class="line"><a name="l05067"></a><span class="lineno"> 5067</span>&#160;                                     0.0);</div>
<div class="line"><a name="l05068"></a><span class="lineno"> 5068</span>&#160;                <span class="comment">//VRANS</span></div>
<div class="line"><a name="l05069"></a><span class="lineno"> 5069</span>&#160;                mass_source = q_mass_source[eN_k];</div>
<div class="line"><a name="l05070"></a><span class="lineno"> 5070</span>&#160;                <span class="comment">//todo: decide if these should be lagged or not</span></div>
<div class="line"><a name="l05071"></a><span class="lineno"> 5071</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#ad2e43c8a8d5e8cbaf4434992e9bf9a7d">updateDarcyForchheimerTerms_Ergun</a>(NONCONSERVATIVE_FORM,</div>
<div class="line"><a name="l05072"></a><span class="lineno"> 5072</span>&#160;                                                  <span class="comment">/* linearDragFactor, */</span></div>
<div class="line"><a name="l05073"></a><span class="lineno"> 5073</span>&#160;                                                  <span class="comment">/* nonlinearDragFactor, */</span></div>
<div class="line"><a name="l05074"></a><span class="lineno"> 5074</span>&#160;                                                  <span class="comment">/* porosity, */</span></div>
<div class="line"><a name="l05075"></a><span class="lineno"> 5075</span>&#160;                                                  <span class="comment">/* meanGrainSize, */</span></div>
<div class="line"><a name="l05076"></a><span class="lineno"> 5076</span>&#160;                                                  q_dragAlpha[eN_k],</div>
<div class="line"><a name="l05077"></a><span class="lineno"> 5077</span>&#160;                                                  q_dragBeta[eN_k],</div>
<div class="line"><a name="l05078"></a><span class="lineno"> 5078</span>&#160;                                                  eps_rho,</div>
<div class="line"><a name="l05079"></a><span class="lineno"> 5079</span>&#160;                                                  eps_mu,</div>
<div class="line"><a name="l05080"></a><span class="lineno"> 5080</span>&#160;                                                  <a class="code" href="_error_residual_method_8cpp.html#ae5f5d9edb66645eab31a7c8389493ce7">rho_0</a>,</div>
<div class="line"><a name="l05081"></a><span class="lineno"> 5081</span>&#160;                                                  <a class="code" href="_error_residual_method_8cpp.html#a383b07af68441ce2b4adaaf8d8cc9d90">nu_0</a>,</div>
<div class="line"><a name="l05082"></a><span class="lineno"> 5082</span>&#160;                                                  <a class="code" href="_error_residual_method_8cpp.html#a751e53c9d8dfaf696b11b86e0c1b42e9">rho_1</a>,</div>
<div class="line"><a name="l05083"></a><span class="lineno"> 5083</span>&#160;                                                  <a class="code" href="_error_residual_method_8cpp.html#ae5896ebfee35f22242123e4ae82c81d9">nu_1</a>,</div>
<div class="line"><a name="l05084"></a><span class="lineno"> 5084</span>&#160;                                                  useVF,</div>
<div class="line"><a name="l05085"></a><span class="lineno"> 5085</span>&#160;                                                  vf[eN_k],</div>
<div class="line"><a name="l05086"></a><span class="lineno"> 5086</span>&#160;                                                  <a class="code" href="namespaceproteus.html#a17bf106c5df3b1331ed2a18392384813">phi</a>[eN_k],</div>
<div class="line"><a name="l05087"></a><span class="lineno"> 5087</span>&#160;                                                  <a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>,</div>
<div class="line"><a name="l05088"></a><span class="lineno"> 5088</span>&#160;                                                  <a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>,</div>
<div class="line"><a name="l05089"></a><span class="lineno"> 5089</span>&#160;                                                  <a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a>,</div>
<div class="line"><a name="l05090"></a><span class="lineno"> 5090</span>&#160;                                                  q_velocity_sge[eN_k_nSpace+0],</div>
<div class="line"><a name="l05091"></a><span class="lineno"> 5091</span>&#160;                                                  q_velocity_sge[eN_k_nSpace+1],</div>
<div class="line"><a name="l05092"></a><span class="lineno"> 5092</span>&#160;                                                  q_velocity_sge[eN_k_nSpace+2],</div>
<div class="line"><a name="l05093"></a><span class="lineno"> 5093</span>&#160;                                                  eps_solid[elementFlags[eN]],</div>
<div class="line"><a name="l05094"></a><span class="lineno"> 5094</span>&#160;                                                  phi_solid[eN_k],</div>
<div class="line"><a name="l05095"></a><span class="lineno"> 5095</span>&#160;                                                  q_velocity_solid[eN_k_nSpace+0],</div>
<div class="line"><a name="l05096"></a><span class="lineno"> 5096</span>&#160;                                                  q_velocity_solid[eN_k_nSpace+1],</div>
<div class="line"><a name="l05097"></a><span class="lineno"> 5097</span>&#160;                                                  q_velocity_solid[eN_k_nSpace+2],</div>
<div class="line"><a name="l05098"></a><span class="lineno"> 5098</span>&#160;                                                  mom_u_source,</div>
<div class="line"><a name="l05099"></a><span class="lineno"> 5099</span>&#160;                                                  mom_v_source,</div>
<div class="line"><a name="l05100"></a><span class="lineno"> 5100</span>&#160;                                                  mom_w_source,</div>
<div class="line"><a name="l05101"></a><span class="lineno"> 5101</span>&#160;                                                  dmom_u_source,</div>
<div class="line"><a name="l05102"></a><span class="lineno"> 5102</span>&#160;                                                  dmom_v_source,</div>
<div class="line"><a name="l05103"></a><span class="lineno"> 5103</span>&#160;                                                  dmom_w_source);</div>
<div class="line"><a name="l05104"></a><span class="lineno"> 5104</span>&#160; </div>
<div class="line"><a name="l05105"></a><span class="lineno"> 5105</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">double</span> particle_eps  = particle_epsFact*(useMetrics*h_phi+(1.0-useMetrics)*elementDiameter[eN]);</div>
<div class="line"><a name="l05106"></a><span class="lineno"> 5106</span>&#160;                <span class="keywordflow">if</span>(nParticles &gt; 0)</div>
<div class="line"><a name="l05107"></a><span class="lineno"> 5107</span>&#160;                  <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#ae66ab530966d1d5fbc2e170ef698a4f3">updateSolidParticleTerms</a>(NONCONSERVATIVE_FORM,</div>
<div class="line"><a name="l05108"></a><span class="lineno"> 5108</span>&#160;                                           eN &lt; nElements_owned,</div>
<div class="line"><a name="l05109"></a><span class="lineno"> 5109</span>&#160;                                           particle_nitsche,</div>
<div class="line"><a name="l05110"></a><span class="lineno"> 5110</span>&#160;                                           dV,</div>
<div class="line"><a name="l05111"></a><span class="lineno"> 5111</span>&#160;                                           nParticles,</div>
<div class="line"><a name="l05112"></a><span class="lineno"> 5112</span>&#160;                                           nQuadraturePoints_global,</div>
<div class="line"><a name="l05113"></a><span class="lineno"> 5113</span>&#160;                                           &amp;particle_signed_distances[eN_k],</div>
<div class="line"><a name="l05114"></a><span class="lineno"> 5114</span>&#160;                                           &amp;particle_signed_distance_normals[eN_k_3d],</div>
<div class="line"><a name="l05115"></a><span class="lineno"> 5115</span>&#160;                                           &amp;particle_velocities[eN_k_3d],</div>
<div class="line"><a name="l05116"></a><span class="lineno"> 5116</span>&#160;                                           particle_centroids,</div>
<div class="line"><a name="l05117"></a><span class="lineno"> 5117</span>&#160;                                           use_ball_as_particle,</div>
<div class="line"><a name="l05118"></a><span class="lineno"> 5118</span>&#160;                                           ball_center,</div>
<div class="line"><a name="l05119"></a><span class="lineno"> 5119</span>&#160;                                           ball_radius,</div>
<div class="line"><a name="l05120"></a><span class="lineno"> 5120</span>&#160;                                           ball_velocity,</div>
<div class="line"><a name="l05121"></a><span class="lineno"> 5121</span>&#160;                                           ball_angular_velocity,</div>
<div class="line"><a name="l05122"></a><span class="lineno"> 5122</span>&#160;                                           ball_center_acceleration,</div>
<div class="line"><a name="l05123"></a><span class="lineno"> 5123</span>&#160;                                           ball_angular_acceleration,</div>
<div class="line"><a name="l05124"></a><span class="lineno"> 5124</span>&#160;                                           ball_density,</div>
<div class="line"><a name="l05125"></a><span class="lineno"> 5125</span>&#160;                                           porosity,</div>
<div class="line"><a name="l05126"></a><span class="lineno"> 5126</span>&#160;                                           particle_penalty_constant/h_phi,<span class="comment">//penalty,</span></div>
<div class="line"><a name="l05127"></a><span class="lineno"> 5127</span>&#160;                                           particle_alpha,</div>
<div class="line"><a name="l05128"></a><span class="lineno"> 5128</span>&#160;                                           particle_beta,</div>
<div class="line"><a name="l05129"></a><span class="lineno"> 5129</span>&#160;                                           eps_rho,</div>
<div class="line"><a name="l05130"></a><span class="lineno"> 5130</span>&#160;                                           eps_mu,</div>
<div class="line"><a name="l05131"></a><span class="lineno"> 5131</span>&#160;                                           <a class="code" href="_error_residual_method_8cpp.html#ae5f5d9edb66645eab31a7c8389493ce7">rho_0</a>,</div>
<div class="line"><a name="l05132"></a><span class="lineno"> 5132</span>&#160;                                           <a class="code" href="_error_residual_method_8cpp.html#a383b07af68441ce2b4adaaf8d8cc9d90">nu_0</a>,</div>
<div class="line"><a name="l05133"></a><span class="lineno"> 5133</span>&#160;                                           <a class="code" href="_error_residual_method_8cpp.html#a751e53c9d8dfaf696b11b86e0c1b42e9">rho_1</a>,</div>
<div class="line"><a name="l05134"></a><span class="lineno"> 5134</span>&#160;                                           <a class="code" href="_error_residual_method_8cpp.html#ae5896ebfee35f22242123e4ae82c81d9">nu_1</a>,</div>
<div class="line"><a name="l05135"></a><span class="lineno"> 5135</span>&#160;                                           useVF,</div>
<div class="line"><a name="l05136"></a><span class="lineno"> 5136</span>&#160;                                           vf[eN_k],</div>
<div class="line"><a name="l05137"></a><span class="lineno"> 5137</span>&#160;                                           <a class="code" href="namespaceproteus.html#a17bf106c5df3b1331ed2a18392384813">phi</a>[eN_k],</div>
<div class="line"><a name="l05138"></a><span class="lineno"> 5138</span>&#160;                                           x,</div>
<div class="line"><a name="l05139"></a><span class="lineno"> 5139</span>&#160;                                           y,</div>
<div class="line"><a name="l05140"></a><span class="lineno"> 5140</span>&#160;                                           <a class="code" href="_headers_8h.html#a9d199fcfc162b9ad09d4c9426e713a74">z</a>,</div>
<div class="line"><a name="l05141"></a><span class="lineno"> 5141</span>&#160;                                           p,</div>
<div class="line"><a name="l05142"></a><span class="lineno"> 5142</span>&#160;                                           <a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>,</div>
<div class="line"><a name="l05143"></a><span class="lineno"> 5143</span>&#160;                                           <a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>,</div>
<div class="line"><a name="l05144"></a><span class="lineno"> 5144</span>&#160;                                           <a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a>,</div>
<div class="line"><a name="l05145"></a><span class="lineno"> 5145</span>&#160;                                           q_velocity_sge[eN_k_nSpace+0],</div>
<div class="line"><a name="l05146"></a><span class="lineno"> 5146</span>&#160;                                           q_velocity_sge[eN_k_nSpace+1],</div>
<div class="line"><a name="l05147"></a><span class="lineno"> 5147</span>&#160;                                           q_velocity_sge[eN_k_nSpace+1],</div>
<div class="line"><a name="l05148"></a><span class="lineno"> 5148</span>&#160;                                           particle_eps,</div>
<div class="line"><a name="l05149"></a><span class="lineno"> 5149</span>&#160;                                           grad_u,</div>
<div class="line"><a name="l05150"></a><span class="lineno"> 5150</span>&#160;                                           grad_v,</div>
<div class="line"><a name="l05151"></a><span class="lineno"> 5151</span>&#160;                                           grad_w,</div>
<div class="line"><a name="l05152"></a><span class="lineno"> 5152</span>&#160;                                           mom_u_source,</div>
<div class="line"><a name="l05153"></a><span class="lineno"> 5153</span>&#160;                                           mom_v_source,</div>
<div class="line"><a name="l05154"></a><span class="lineno"> 5154</span>&#160;                                           mom_w_source,</div>
<div class="line"><a name="l05155"></a><span class="lineno"> 5155</span>&#160;                                           dmom_u_source,</div>
<div class="line"><a name="l05156"></a><span class="lineno"> 5156</span>&#160;                                           dmom_v_source,</div>
<div class="line"><a name="l05157"></a><span class="lineno"> 5157</span>&#160;                                           dmom_w_source,</div>
<div class="line"><a name="l05158"></a><span class="lineno"> 5158</span>&#160;                                           mom_u_adv,</div>
<div class="line"><a name="l05159"></a><span class="lineno"> 5159</span>&#160;                                           mom_v_adv,</div>
<div class="line"><a name="l05160"></a><span class="lineno"> 5160</span>&#160;                                           mom_w_adv,</div>
<div class="line"><a name="l05161"></a><span class="lineno"> 5161</span>&#160;                                           dmom_u_adv_u,</div>
<div class="line"><a name="l05162"></a><span class="lineno"> 5162</span>&#160;                                           dmom_v_adv_v,</div>
<div class="line"><a name="l05163"></a><span class="lineno"> 5163</span>&#160;                                           dmom_w_adv_w,</div>
<div class="line"><a name="l05164"></a><span class="lineno"> 5164</span>&#160;                                           mom_u_ham,</div>
<div class="line"><a name="l05165"></a><span class="lineno"> 5165</span>&#160;                                           dmom_u_ham_grad_u,</div>
<div class="line"><a name="l05166"></a><span class="lineno"> 5166</span>&#160;                                           dmom_u_ham_u,</div>
<div class="line"><a name="l05167"></a><span class="lineno"> 5167</span>&#160;                                           dmom_u_ham_v,</div>
<div class="line"><a name="l05168"></a><span class="lineno"> 5168</span>&#160;                                           dmom_u_ham_w,</div>
<div class="line"><a name="l05169"></a><span class="lineno"> 5169</span>&#160;                                           mom_v_ham,</div>
<div class="line"><a name="l05170"></a><span class="lineno"> 5170</span>&#160;                                           dmom_v_ham_grad_v,</div>
<div class="line"><a name="l05171"></a><span class="lineno"> 5171</span>&#160;                                           dmom_v_ham_u,</div>
<div class="line"><a name="l05172"></a><span class="lineno"> 5172</span>&#160;                                           dmom_v_ham_v,</div>
<div class="line"><a name="l05173"></a><span class="lineno"> 5173</span>&#160;                                           dmom_v_ham_w,</div>
<div class="line"><a name="l05174"></a><span class="lineno"> 5174</span>&#160;                                           mom_w_ham,</div>
<div class="line"><a name="l05175"></a><span class="lineno"> 5175</span>&#160;                                           dmom_w_ham_grad_w,</div>
<div class="line"><a name="l05176"></a><span class="lineno"> 5176</span>&#160;                                           dmom_w_ham_u,</div>
<div class="line"><a name="l05177"></a><span class="lineno"> 5177</span>&#160;                                           dmom_w_ham_v,</div>
<div class="line"><a name="l05178"></a><span class="lineno"> 5178</span>&#160;                                           dmom_w_ham_w,</div>
<div class="line"><a name="l05179"></a><span class="lineno"> 5179</span>&#160;                                           mass_ham,</div>
<div class="line"><a name="l05180"></a><span class="lineno"> 5180</span>&#160;                                           dmass_ham_u,</div>
<div class="line"><a name="l05181"></a><span class="lineno"> 5181</span>&#160;                                           dmass_ham_v,</div>
<div class="line"><a name="l05182"></a><span class="lineno"> 5182</span>&#160;                                           dmass_ham_w,</div>
<div class="line"><a name="l05183"></a><span class="lineno"> 5183</span>&#160;                                           &amp;particle_netForces[0],</div>
<div class="line"><a name="l05184"></a><span class="lineno"> 5184</span>&#160;                                           &amp;particle_netMoments[0],</div>
<div class="line"><a name="l05185"></a><span class="lineno"> 5185</span>&#160;                                           &amp;particle_surfaceArea[0],</div>
<div class="line"><a name="l05186"></a><span class="lineno"> 5186</span>&#160;                                           use_pseudo_penalty);</div>
<div class="line"><a name="l05187"></a><span class="lineno"> 5187</span>&#160;                <span class="comment">//Turbulence closure model</span></div>
<div class="line"><a name="l05188"></a><span class="lineno"> 5188</span>&#160;                <span class="keywordflow">if</span> (turbulenceClosureModel &gt;= 3)</div>
<div class="line"><a name="l05189"></a><span class="lineno"> 5189</span>&#160;                  {</div>
<div class="line"><a name="l05190"></a><span class="lineno"> 5190</span>&#160;                    <span class="keyword">const</span> <span class="keywordtype">double</span> c_mu = 0.09;<span class="comment">//mwf hack</span></div>
<div class="line"><a name="l05191"></a><span class="lineno"> 5191</span>&#160;                    <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#aab46065ecbde76bd2d9ef320ad287b76">updateTurbulenceClosure</a>(NONCONSERVATIVE_FORM,</div>
<div class="line"><a name="l05192"></a><span class="lineno"> 5192</span>&#160;                                            turbulenceClosureModel,</div>
<div class="line"><a name="l05193"></a><span class="lineno"> 5193</span>&#160;                                            eps_rho,</div>
<div class="line"><a name="l05194"></a><span class="lineno"> 5194</span>&#160;                                            eps_mu,</div>
<div class="line"><a name="l05195"></a><span class="lineno"> 5195</span>&#160;                                            <a class="code" href="_error_residual_method_8cpp.html#ae5f5d9edb66645eab31a7c8389493ce7">rho_0</a>,</div>
<div class="line"><a name="l05196"></a><span class="lineno"> 5196</span>&#160;                                            <a class="code" href="_error_residual_method_8cpp.html#a383b07af68441ce2b4adaaf8d8cc9d90">nu_0</a>,</div>
<div class="line"><a name="l05197"></a><span class="lineno"> 5197</span>&#160;                                            <a class="code" href="_error_residual_method_8cpp.html#a751e53c9d8dfaf696b11b86e0c1b42e9">rho_1</a>,</div>
<div class="line"><a name="l05198"></a><span class="lineno"> 5198</span>&#160;                                            <a class="code" href="_error_residual_method_8cpp.html#ae5896ebfee35f22242123e4ae82c81d9">nu_1</a>,</div>
<div class="line"><a name="l05199"></a><span class="lineno"> 5199</span>&#160;                                            useVF,</div>
<div class="line"><a name="l05200"></a><span class="lineno"> 5200</span>&#160;                                            vf[eN_k],</div>
<div class="line"><a name="l05201"></a><span class="lineno"> 5201</span>&#160;                                            <a class="code" href="namespaceproteus.html#a17bf106c5df3b1331ed2a18392384813">phi</a>[eN_k],</div>
<div class="line"><a name="l05202"></a><span class="lineno"> 5202</span>&#160;                                            porosity,</div>
<div class="line"><a name="l05203"></a><span class="lineno"> 5203</span>&#160;                                            c_mu, <span class="comment">//mwf hack</span></div>
<div class="line"><a name="l05204"></a><span class="lineno"> 5204</span>&#160;                                            q_turb_var_0[eN_k],</div>
<div class="line"><a name="l05205"></a><span class="lineno"> 5205</span>&#160;                                            q_turb_var_1[eN_k],</div>
<div class="line"><a name="l05206"></a><span class="lineno"> 5206</span>&#160;                                            &amp;q_turb_var_grad_0[eN_k_nSpace],</div>
<div class="line"><a name="l05207"></a><span class="lineno"> 5207</span>&#160;                                            eddy_viscosity,</div>
<div class="line"><a name="l05208"></a><span class="lineno"> 5208</span>&#160;                                            mom_uu_diff_ten,</div>
<div class="line"><a name="l05209"></a><span class="lineno"> 5209</span>&#160;                                            mom_vv_diff_ten,</div>
<div class="line"><a name="l05210"></a><span class="lineno"> 5210</span>&#160;                                            mom_ww_diff_ten,</div>
<div class="line"><a name="l05211"></a><span class="lineno"> 5211</span>&#160;                                            mom_uv_diff_ten,</div>
<div class="line"><a name="l05212"></a><span class="lineno"> 5212</span>&#160;                                            mom_uw_diff_ten,</div>
<div class="line"><a name="l05213"></a><span class="lineno"> 5213</span>&#160;                                            mom_vu_diff_ten,</div>
<div class="line"><a name="l05214"></a><span class="lineno"> 5214</span>&#160;                                            mom_vw_diff_ten,</div>
<div class="line"><a name="l05215"></a><span class="lineno"> 5215</span>&#160;                                            mom_wu_diff_ten,</div>
<div class="line"><a name="l05216"></a><span class="lineno"> 5216</span>&#160;                                            mom_wv_diff_ten,</div>
<div class="line"><a name="l05217"></a><span class="lineno"> 5217</span>&#160;                                            mom_u_source,</div>
<div class="line"><a name="l05218"></a><span class="lineno"> 5218</span>&#160;                                            mom_v_source,</div>
<div class="line"><a name="l05219"></a><span class="lineno"> 5219</span>&#160;                                            mom_w_source);</div>
<div class="line"><a name="l05220"></a><span class="lineno"> 5220</span>&#160; </div>
<div class="line"><a name="l05221"></a><span class="lineno"> 5221</span>&#160;                  }</div>
<div class="line"><a name="l05222"></a><span class="lineno"> 5222</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l05223"></a><span class="lineno"> 5223</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l05224"></a><span class="lineno"> 5224</span>&#160;                <span class="comment">//moving mesh</span></div>
<div class="line"><a name="l05225"></a><span class="lineno"> 5225</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l05226"></a><span class="lineno"> 5226</span>&#160;                <span class="keywordflow">if</span> (NONCONSERVATIVE_FORM &gt; 0.0)</div>
<div class="line"><a name="l05227"></a><span class="lineno"> 5227</span>&#160;                  {</div>
<div class="line"><a name="l05228"></a><span class="lineno"> 5228</span>&#160;                    mom_u_ham -= MOVING_DOMAIN*dmom_u_acc_u*(grad_u[0]*xt + grad_u[1]*yt + grad_u[2]*zt);</div>
<div class="line"><a name="l05229"></a><span class="lineno"> 5229</span>&#160;                    dmom_u_ham_grad_u[0] -= MOVING_DOMAIN*dmom_u_acc_u*xt;</div>
<div class="line"><a name="l05230"></a><span class="lineno"> 5230</span>&#160;                    dmom_u_ham_grad_u[1] -= MOVING_DOMAIN*dmom_u_acc_u*yt;</div>
<div class="line"><a name="l05231"></a><span class="lineno"> 5231</span>&#160;                    dmom_u_ham_grad_u[2] -= MOVING_DOMAIN*dmom_u_acc_u*zt;</div>
<div class="line"><a name="l05232"></a><span class="lineno"> 5232</span>&#160;                  }</div>
<div class="line"><a name="l05233"></a><span class="lineno"> 5233</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l05234"></a><span class="lineno"> 5234</span>&#160;                  {</div>
<div class="line"><a name="l05235"></a><span class="lineno"> 5235</span>&#160;                    mom_u_adv[0] -= MOVING_DOMAIN*mom_u_acc*xt;</div>
<div class="line"><a name="l05236"></a><span class="lineno"> 5236</span>&#160;                    mom_u_adv[1] -= MOVING_DOMAIN*mom_u_acc*yt;</div>
<div class="line"><a name="l05237"></a><span class="lineno"> 5237</span>&#160;                    mom_u_adv[2] -= MOVING_DOMAIN*mom_u_acc*zt;</div>
<div class="line"><a name="l05238"></a><span class="lineno"> 5238</span>&#160;                    dmom_u_adv_u[0] -= MOVING_DOMAIN*dmom_u_acc_u*xt;</div>
<div class="line"><a name="l05239"></a><span class="lineno"> 5239</span>&#160;                    dmom_u_adv_u[1] -= MOVING_DOMAIN*dmom_u_acc_u*yt;</div>
<div class="line"><a name="l05240"></a><span class="lineno"> 5240</span>&#160;                    dmom_u_adv_u[2] -= MOVING_DOMAIN*dmom_u_acc_u*zt;</div>
<div class="line"><a name="l05241"></a><span class="lineno"> 5241</span>&#160;                  }</div>
<div class="line"><a name="l05242"></a><span class="lineno"> 5242</span>&#160; </div>
<div class="line"><a name="l05243"></a><span class="lineno"> 5243</span>&#160;                <span class="keywordflow">if</span> (NONCONSERVATIVE_FORM &gt; 0.0)</div>
<div class="line"><a name="l05244"></a><span class="lineno"> 5244</span>&#160;                  {</div>
<div class="line"><a name="l05245"></a><span class="lineno"> 5245</span>&#160;                    mom_v_ham -= MOVING_DOMAIN*dmom_v_acc_v*(grad_v[0]*xt + grad_v[1]*yt + grad_v[2]*zt);</div>
<div class="line"><a name="l05246"></a><span class="lineno"> 5246</span>&#160;                    dmom_v_ham_grad_v[0] -= MOVING_DOMAIN*dmom_v_acc_v*xt;</div>
<div class="line"><a name="l05247"></a><span class="lineno"> 5247</span>&#160;                    dmom_v_ham_grad_v[1] -= MOVING_DOMAIN*dmom_v_acc_v*yt;</div>
<div class="line"><a name="l05248"></a><span class="lineno"> 5248</span>&#160;                    dmom_v_ham_grad_v[2] -= MOVING_DOMAIN*dmom_v_acc_v*zt;</div>
<div class="line"><a name="l05249"></a><span class="lineno"> 5249</span>&#160;                  }</div>
<div class="line"><a name="l05250"></a><span class="lineno"> 5250</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l05251"></a><span class="lineno"> 5251</span>&#160;                  {</div>
<div class="line"><a name="l05252"></a><span class="lineno"> 5252</span>&#160;                    mom_v_adv[0] -= MOVING_DOMAIN*mom_v_acc*xt;</div>
<div class="line"><a name="l05253"></a><span class="lineno"> 5253</span>&#160;                    mom_v_adv[1] -= MOVING_DOMAIN*mom_v_acc*yt;</div>
<div class="line"><a name="l05254"></a><span class="lineno"> 5254</span>&#160;                    mom_v_adv[2] -= MOVING_DOMAIN*mom_v_acc*zt;</div>
<div class="line"><a name="l05255"></a><span class="lineno"> 5255</span>&#160;                    dmom_v_adv_v[0] -= MOVING_DOMAIN*dmom_v_acc_v*xt;</div>
<div class="line"><a name="l05256"></a><span class="lineno"> 5256</span>&#160;                    dmom_v_adv_v[1] -= MOVING_DOMAIN*dmom_v_acc_v*yt;</div>
<div class="line"><a name="l05257"></a><span class="lineno"> 5257</span>&#160;                    dmom_v_adv_v[2] -= MOVING_DOMAIN*dmom_v_acc_v*zt;</div>
<div class="line"><a name="l05258"></a><span class="lineno"> 5258</span>&#160;                  }</div>
<div class="line"><a name="l05259"></a><span class="lineno"> 5259</span>&#160; </div>
<div class="line"><a name="l05260"></a><span class="lineno"> 5260</span>&#160;                <span class="keywordflow">if</span> (NONCONSERVATIVE_FORM &gt; 0.0)</div>
<div class="line"><a name="l05261"></a><span class="lineno"> 5261</span>&#160;                  {</div>
<div class="line"><a name="l05262"></a><span class="lineno"> 5262</span>&#160;                    mom_w_ham -= MOVING_DOMAIN*dmom_w_acc_w*(grad_w[0]*xt + grad_w[1]*yt + grad_w[2]*zt);</div>
<div class="line"><a name="l05263"></a><span class="lineno"> 5263</span>&#160;                    dmom_w_ham_grad_w[0] -= MOVING_DOMAIN*dmom_w_acc_w*xt;</div>
<div class="line"><a name="l05264"></a><span class="lineno"> 5264</span>&#160;                    dmom_w_ham_grad_w[1] -= MOVING_DOMAIN*dmom_w_acc_w*yt;</div>
<div class="line"><a name="l05265"></a><span class="lineno"> 5265</span>&#160;                    dmom_w_ham_grad_w[2] -= MOVING_DOMAIN*dmom_w_acc_w*zt;</div>
<div class="line"><a name="l05266"></a><span class="lineno"> 5266</span>&#160;                  }</div>
<div class="line"><a name="l05267"></a><span class="lineno"> 5267</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l05268"></a><span class="lineno"> 5268</span>&#160;                  {</div>
<div class="line"><a name="l05269"></a><span class="lineno"> 5269</span>&#160;                    mom_w_adv[0] -= MOVING_DOMAIN*mom_w_acc*xt;</div>
<div class="line"><a name="l05270"></a><span class="lineno"> 5270</span>&#160;                    mom_w_adv[1] -= MOVING_DOMAIN*mom_w_acc*yt;</div>
<div class="line"><a name="l05271"></a><span class="lineno"> 5271</span>&#160;                    mom_w_adv[2] -= MOVING_DOMAIN*mom_w_acc*zt;</div>
<div class="line"><a name="l05272"></a><span class="lineno"> 5272</span>&#160;                    dmom_w_adv_w[0] -= MOVING_DOMAIN*dmom_w_acc_w*xt;</div>
<div class="line"><a name="l05273"></a><span class="lineno"> 5273</span>&#160;                    dmom_w_adv_w[1] -= MOVING_DOMAIN*dmom_w_acc_w*yt;</div>
<div class="line"><a name="l05274"></a><span class="lineno"> 5274</span>&#160;                    dmom_w_adv_w[2] -= MOVING_DOMAIN*dmom_w_acc_w*zt;</div>
<div class="line"><a name="l05275"></a><span class="lineno"> 5275</span>&#160;                  }</div>
<div class="line"><a name="l05276"></a><span class="lineno"> 5276</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l05277"></a><span class="lineno"> 5277</span>&#160;                <span class="comment">//calculate time derivatives</span></div>
<div class="line"><a name="l05278"></a><span class="lineno"> 5278</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l05279"></a><span class="lineno"> 5279</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.bdf(alphaBDF,</div>
<div class="line"><a name="l05280"></a><span class="lineno"> 5280</span>&#160;                       q_mom_u_acc_beta_bdf[eN_k]*q_dV_last[eN_k]/dV,</div>
<div class="line"><a name="l05281"></a><span class="lineno"> 5281</span>&#160;                       mom_u_acc,</div>
<div class="line"><a name="l05282"></a><span class="lineno"> 5282</span>&#160;                       dmom_u_acc_u,</div>
<div class="line"><a name="l05283"></a><span class="lineno"> 5283</span>&#160;                       mom_u_acc_t,</div>
<div class="line"><a name="l05284"></a><span class="lineno"> 5284</span>&#160;                       dmom_u_acc_u_t);</div>
<div class="line"><a name="l05285"></a><span class="lineno"> 5285</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.bdf(alphaBDF,</div>
<div class="line"><a name="l05286"></a><span class="lineno"> 5286</span>&#160;                       q_mom_v_acc_beta_bdf[eN_k]*q_dV_last[eN_k]/dV,</div>
<div class="line"><a name="l05287"></a><span class="lineno"> 5287</span>&#160;                       mom_v_acc,</div>
<div class="line"><a name="l05288"></a><span class="lineno"> 5288</span>&#160;                       dmom_v_acc_v,</div>
<div class="line"><a name="l05289"></a><span class="lineno"> 5289</span>&#160;                       mom_v_acc_t,</div>
<div class="line"><a name="l05290"></a><span class="lineno"> 5290</span>&#160;                       dmom_v_acc_v_t);</div>
<div class="line"><a name="l05291"></a><span class="lineno"> 5291</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.bdf(alphaBDF,</div>
<div class="line"><a name="l05292"></a><span class="lineno"> 5292</span>&#160;                       q_mom_w_acc_beta_bdf[eN_k]*q_dV_last[eN_k]/dV,</div>
<div class="line"><a name="l05293"></a><span class="lineno"> 5293</span>&#160;                       mom_w_acc,</div>
<div class="line"><a name="l05294"></a><span class="lineno"> 5294</span>&#160;                       dmom_w_acc_w,</div>
<div class="line"><a name="l05295"></a><span class="lineno"> 5295</span>&#160;                       mom_w_acc_t,</div>
<div class="line"><a name="l05296"></a><span class="lineno"> 5296</span>&#160;                       dmom_w_acc_w_t);</div>
<div class="line"><a name="l05297"></a><span class="lineno"> 5297</span>&#160;                <span class="keywordflow">if</span>(use_pseudo_penalty == -1 &amp;&amp; phi_solid[eN_k]&lt;0.0)<span class="comment">//no derivative term inside the solid; Has to change Jacobian</span></div>
<div class="line"><a name="l05298"></a><span class="lineno"> 5298</span>&#160;                {</div>
<div class="line"><a name="l05299"></a><span class="lineno"> 5299</span>&#160;                  mom_u_acc_t = 0.0;</div>
<div class="line"><a name="l05300"></a><span class="lineno"> 5300</span>&#160;                  mom_v_acc_t = 0.0;</div>
<div class="line"><a name="l05301"></a><span class="lineno"> 5301</span>&#160;                  mom_w_acc_t = 0.0;</div>
<div class="line"><a name="l05302"></a><span class="lineno"> 5302</span>&#160;                  dmom_u_acc_u = 0.0;</div>
<div class="line"><a name="l05303"></a><span class="lineno"> 5303</span>&#160;                  dmom_v_acc_v = 0.0;</div>
<div class="line"><a name="l05304"></a><span class="lineno"> 5304</span>&#160;                  dmom_w_acc_w = 0.0;</div>
<div class="line"><a name="l05305"></a><span class="lineno"> 5305</span>&#160;                }</div>
<div class="line"><a name="l05306"></a><span class="lineno"> 5306</span>&#160;                <span class="keywordflow">if</span> (NONCONSERVATIVE_FORM &gt; 0.0)</div>
<div class="line"><a name="l05307"></a><span class="lineno"> 5307</span>&#160;                  {</div>
<div class="line"><a name="l05308"></a><span class="lineno"> 5308</span>&#160;                    mom_u_acc_t *= dmom_u_acc_u;</div>
<div class="line"><a name="l05309"></a><span class="lineno"> 5309</span>&#160;                    mom_v_acc_t *= dmom_v_acc_v;</div>
<div class="line"><a name="l05310"></a><span class="lineno"> 5310</span>&#160;                    mom_w_acc_t *= dmom_w_acc_w;</div>
<div class="line"><a name="l05311"></a><span class="lineno"> 5311</span>&#160;                  }</div>
<div class="line"><a name="l05312"></a><span class="lineno"> 5312</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l05313"></a><span class="lineno"> 5313</span>&#160;                <span class="comment">//calculate subgrid error contribution to the Jacobian (strong residual, adjoint, jacobian of strong residual)</span></div>
<div class="line"><a name="l05314"></a><span class="lineno"> 5314</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l05315"></a><span class="lineno"> 5315</span>&#160;                <span class="keywordflow">if</span> (NONCONSERVATIVE_FORM &gt; 0.0)</div>
<div class="line"><a name="l05316"></a><span class="lineno"> 5316</span>&#160;                  {</div>
<div class="line"><a name="l05317"></a><span class="lineno"> 5317</span>&#160;                    dmom_adv_sge[0] = 0.0;</div>
<div class="line"><a name="l05318"></a><span class="lineno"> 5318</span>&#160;                    dmom_adv_sge[1] = 0.0;</div>
<div class="line"><a name="l05319"></a><span class="lineno"> 5319</span>&#160;                    dmom_adv_sge[2] = 0.0;</div>
<div class="line"><a name="l05320"></a><span class="lineno"> 5320</span>&#160;                    dmom_ham_grad_sge[0] = dmom_u_acc_u*(q_velocity_sge[eN_k_nSpace+0] - MOVING_DOMAIN*xt);</div>
<div class="line"><a name="l05321"></a><span class="lineno"> 5321</span>&#160;                    dmom_ham_grad_sge[1] = dmom_u_acc_u*(q_velocity_sge[eN_k_nSpace+1] - MOVING_DOMAIN*yt);</div>
<div class="line"><a name="l05322"></a><span class="lineno"> 5322</span>&#160;                    dmom_ham_grad_sge[2] = dmom_u_acc_u*(q_velocity_sge[eN_k_nSpace+2] - MOVING_DOMAIN*zt);</div>
<div class="line"><a name="l05323"></a><span class="lineno"> 5323</span>&#160;                  }</div>
<div class="line"><a name="l05324"></a><span class="lineno"> 5324</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l05325"></a><span class="lineno"> 5325</span>&#160;                  {</div>
<div class="line"><a name="l05326"></a><span class="lineno"> 5326</span>&#160;                    dmom_adv_sge[0] = dmom_u_acc_u*(q_velocity_sge[eN_k_nSpace+0] - MOVING_DOMAIN*xt);</div>
<div class="line"><a name="l05327"></a><span class="lineno"> 5327</span>&#160;                    dmom_adv_sge[1] = dmom_u_acc_u*(q_velocity_sge[eN_k_nSpace+1] - MOVING_DOMAIN*yt);</div>
<div class="line"><a name="l05328"></a><span class="lineno"> 5328</span>&#160;                    dmom_adv_sge[2] = dmom_u_acc_u*(q_velocity_sge[eN_k_nSpace+2] - MOVING_DOMAIN*zt);</div>
<div class="line"><a name="l05329"></a><span class="lineno"> 5329</span>&#160;                    dmom_ham_grad_sge[0] = 0.0;</div>
<div class="line"><a name="l05330"></a><span class="lineno"> 5330</span>&#160;                    dmom_ham_grad_sge[1] = 0.0;</div>
<div class="line"><a name="l05331"></a><span class="lineno"> 5331</span>&#160;                    dmom_ham_grad_sge[2] = 0.0;</div>
<div class="line"><a name="l05332"></a><span class="lineno"> 5332</span>&#160;                  }</div>
<div class="line"><a name="l05333"></a><span class="lineno"> 5333</span>&#160;                <span class="keywordtype">double</span> mv_tau[nSpace];</div>
<div class="line"><a name="l05334"></a><span class="lineno"> 5334</span>&#160;                mv_tau[0] = dmom_adv_sge[0] + dmom_ham_grad_sge[0];</div>
<div class="line"><a name="l05335"></a><span class="lineno"> 5335</span>&#160;                mv_tau[1] = dmom_adv_sge[1] + dmom_ham_grad_sge[1];</div>
<div class="line"><a name="l05336"></a><span class="lineno"> 5336</span>&#160;                mv_tau[2] = dmom_adv_sge[2] + dmom_ham_grad_sge[2];</div>
<div class="line"><a name="l05337"></a><span class="lineno"> 5337</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l05338"></a><span class="lineno"> 5338</span>&#160;                <span class="comment">//calculate strong residual</span></div>
<div class="line"><a name="l05339"></a><span class="lineno"> 5339</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l05340"></a><span class="lineno"> 5340</span>&#160;                pdeResidual_p = <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Advection_strong(dmass_adv_u,grad_u) +</div>
<div class="line"><a name="l05341"></a><span class="lineno"> 5341</span>&#160;                  <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Advection_strong(dmass_adv_v,grad_v) +</div>
<div class="line"><a name="l05342"></a><span class="lineno"> 5342</span>&#160;                  <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Advection_strong(dmass_adv_w,grad_w) +</div>
<div class="line"><a name="l05343"></a><span class="lineno"> 5343</span>&#160;                  <a class="code" href="_r_a_n_s2_p_8h.html#af4c90b58f2b5c70d46004521b792f727">DM2</a>*MOVING_DOMAIN*<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Reaction_strong(alphaBDF*(dV-q_dV_last[eN_k])/dV - div_mesh_velocity) +</div>
<div class="line"><a name="l05344"></a><span class="lineno"> 5344</span>&#160;                  <span class="comment">//VRANS</span></div>
<div class="line"><a name="l05345"></a><span class="lineno"> 5345</span>&#160;                  <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Reaction_strong(mass_source);</div>
<div class="line"><a name="l05346"></a><span class="lineno"> 5346</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l05347"></a><span class="lineno"> 5347</span>&#160; </div>
<div class="line"><a name="l05348"></a><span class="lineno"> 5348</span>&#160;                pdeResidual_u = <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Mass_strong(mom_u_acc_t) +</div>
<div class="line"><a name="l05349"></a><span class="lineno"> 5349</span>&#160;                  <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Advection_strong(dmom_adv_sge,grad_u) +</div>
<div class="line"><a name="l05350"></a><span class="lineno"> 5350</span>&#160;                  <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Hamiltonian_strong(dmom_ham_grad_sge,grad_u) +</div>
<div class="line"><a name="l05351"></a><span class="lineno"> 5351</span>&#160;                  <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Hamiltonian_strong(dmom_u_ham_grad_p,grad_p) +</div>
<div class="line"><a name="l05352"></a><span class="lineno"> 5352</span>&#160;                  <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Reaction_strong(mom_u_source) -</div>
<div class="line"><a name="l05353"></a><span class="lineno"> 5353</span>&#160;                  <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Reaction_strong(dmom_u_acc_u*<a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>*div_mesh_velocity);</div>
<div class="line"><a name="l05354"></a><span class="lineno"> 5354</span>&#160; </div>
<div class="line"><a name="l05355"></a><span class="lineno"> 5355</span>&#160;                pdeResidual_v = <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Mass_strong(mom_v_acc_t) +</div>
<div class="line"><a name="l05356"></a><span class="lineno"> 5356</span>&#160;                  <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Advection_strong(dmom_adv_sge,grad_v) +</div>
<div class="line"><a name="l05357"></a><span class="lineno"> 5357</span>&#160;                  <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Hamiltonian_strong(dmom_ham_grad_sge,grad_v) +</div>
<div class="line"><a name="l05358"></a><span class="lineno"> 5358</span>&#160;                  <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Hamiltonian_strong(dmom_v_ham_grad_p,grad_p) +</div>
<div class="line"><a name="l05359"></a><span class="lineno"> 5359</span>&#160;                  <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Reaction_strong(mom_v_source)  -</div>
<div class="line"><a name="l05360"></a><span class="lineno"> 5360</span>&#160;                  <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Reaction_strong(dmom_v_acc_v*<a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>*div_mesh_velocity);</div>
<div class="line"><a name="l05361"></a><span class="lineno"> 5361</span>&#160; </div>
<div class="line"><a name="l05362"></a><span class="lineno"> 5362</span>&#160;                pdeResidual_w = <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Mass_strong(mom_w_acc_t) +</div>
<div class="line"><a name="l05363"></a><span class="lineno"> 5363</span>&#160;                  <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Advection_strong(dmom_adv_sge,grad_w) +</div>
<div class="line"><a name="l05364"></a><span class="lineno"> 5364</span>&#160;                  <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Hamiltonian_strong(dmom_ham_grad_sge,grad_w) +</div>
<div class="line"><a name="l05365"></a><span class="lineno"> 5365</span>&#160;                  <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Hamiltonian_strong(dmom_w_ham_grad_p,grad_p) +</div>
<div class="line"><a name="l05366"></a><span class="lineno"> 5366</span>&#160;                  <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Reaction_strong(mom_w_source) -</div>
<div class="line"><a name="l05367"></a><span class="lineno"> 5367</span>&#160;                  <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Reaction_strong(dmom_w_acc_w*<a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a>*div_mesh_velocity);</div>
<div class="line"><a name="l05368"></a><span class="lineno"> 5368</span>&#160; </div>
<div class="line"><a name="l05369"></a><span class="lineno"> 5369</span>&#160;                <span class="comment">//calculate the Jacobian of strong residual</span></div>
<div class="line"><a name="l05370"></a><span class="lineno"> 5370</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0;j&lt;nDOF_v_trial_element;j++)</div>
<div class="line"><a name="l05371"></a><span class="lineno"> 5371</span>&#160;                  {</div>
<div class="line"><a name="l05372"></a><span class="lineno"> 5372</span>&#160;                    <span class="keyword">register</span> <span class="keywordtype">int</span> j_nSpace = j*nSpace;</div>
<div class="line"><a name="l05373"></a><span class="lineno"> 5373</span>&#160;                    dpdeResidual_p_u[j]=<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.AdvectionJacobian_strong(dmass_adv_u,&amp;vel_grad_trial[j_nSpace]);</div>
<div class="line"><a name="l05374"></a><span class="lineno"> 5374</span>&#160;                    dpdeResidual_p_v[j]=<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.AdvectionJacobian_strong(dmass_adv_v,&amp;vel_grad_trial[j_nSpace]);</div>
<div class="line"><a name="l05375"></a><span class="lineno"> 5375</span>&#160;                    dpdeResidual_p_w[j]=<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.AdvectionJacobian_strong(dmass_adv_w,&amp;vel_grad_trial[j_nSpace]);</div>
<div class="line"><a name="l05376"></a><span class="lineno"> 5376</span>&#160;                    dpdeResidual_u_u[j]=<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.MassJacobian_strong(dmom_u_acc_u_t,vel_trial_ref[k*nDOF_v_trial_element+j]) +</div>
<div class="line"><a name="l05377"></a><span class="lineno"> 5377</span>&#160;                      <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.HamiltonianJacobian_strong(dmom_ham_grad_sge,&amp;vel_grad_trial[j_nSpace]) +</div>
<div class="line"><a name="l05378"></a><span class="lineno"> 5378</span>&#160;                      <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.AdvectionJacobian_strong(dmom_adv_sge,&amp;vel_grad_trial[j_nSpace]) -</div>
<div class="line"><a name="l05379"></a><span class="lineno"> 5379</span>&#160;                      <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.ReactionJacobian_strong(dmom_u_acc_u*div_mesh_velocity,vel_trial_ref[k*nDOF_v_trial_element+j]);</div>
<div class="line"><a name="l05380"></a><span class="lineno"> 5380</span>&#160;                    dpdeResidual_v_v[j]=<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.MassJacobian_strong(dmom_v_acc_v_t,vel_trial_ref[k*nDOF_v_trial_element+j]) +</div>
<div class="line"><a name="l05381"></a><span class="lineno"> 5381</span>&#160;                      <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.HamiltonianJacobian_strong(dmom_ham_grad_sge,&amp;vel_grad_trial[j_nSpace]) +</div>
<div class="line"><a name="l05382"></a><span class="lineno"> 5382</span>&#160;                      <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.AdvectionJacobian_strong(dmom_adv_sge,&amp;vel_grad_trial[j_nSpace]) -</div>
<div class="line"><a name="l05383"></a><span class="lineno"> 5383</span>&#160;                      <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.ReactionJacobian_strong(dmom_v_acc_v*div_mesh_velocity,vel_trial_ref[k*nDOF_v_trial_element+j]);</div>
<div class="line"><a name="l05384"></a><span class="lineno"> 5384</span>&#160;                    dpdeResidual_w_w[j]=<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.MassJacobian_strong(dmom_w_acc_w_t,vel_trial_ref[k*nDOF_v_trial_element+j]) +</div>
<div class="line"><a name="l05385"></a><span class="lineno"> 5385</span>&#160;                      <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.HamiltonianJacobian_strong(dmom_ham_grad_sge,&amp;vel_grad_trial[j_nSpace]) +</div>
<div class="line"><a name="l05386"></a><span class="lineno"> 5386</span>&#160;                      <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.AdvectionJacobian_strong(dmom_adv_sge,&amp;vel_grad_trial[j_nSpace]) -</div>
<div class="line"><a name="l05387"></a><span class="lineno"> 5387</span>&#160;                      <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.ReactionJacobian_strong(dmom_w_acc_w*div_mesh_velocity,vel_trial_ref[k*nDOF_trial_element+j]);</div>
<div class="line"><a name="l05388"></a><span class="lineno"> 5388</span>&#160;                    <span class="comment">//VRANS account for drag terms, diagonal only here ... decide if need off diagonal terms too</span></div>
<div class="line"><a name="l05389"></a><span class="lineno"> 5389</span>&#160;                    dpdeResidual_u_u[j]+= <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.ReactionJacobian_strong(dmom_u_source[0],vel_trial_ref[k*nDOF_v_trial_element+j]);</div>
<div class="line"><a name="l05390"></a><span class="lineno"> 5390</span>&#160;                    dpdeResidual_v_v[j]+= <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.ReactionJacobian_strong(dmom_v_source[1],vel_trial_ref[k*nDOF_v_trial_element+j]);</div>
<div class="line"><a name="l05391"></a><span class="lineno"> 5391</span>&#160;                    dpdeResidual_w_w[j]+= <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.ReactionJacobian_strong(dmom_w_source[2],vel_trial_ref[k*nDOF_v_trial_element+j]);</div>
<div class="line"><a name="l05392"></a><span class="lineno"> 5392</span>&#160;                  }</div>
<div class="line"><a name="l05393"></a><span class="lineno"> 5393</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0;j&lt;nDOF_trial_element;j++)</div>
<div class="line"><a name="l05394"></a><span class="lineno"> 5394</span>&#160;                  {</div>
<div class="line"><a name="l05395"></a><span class="lineno"> 5395</span>&#160;                    <span class="keyword">register</span> <span class="keywordtype">int</span> j_nSpace = j*nSpace;</div>
<div class="line"><a name="l05396"></a><span class="lineno"> 5396</span>&#160;                    dpdeResidual_u_p[j]=<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.HamiltonianJacobian_strong(dmom_u_ham_grad_p,&amp;p_grad_trial[j_nSpace]);</div>
<div class="line"><a name="l05397"></a><span class="lineno"> 5397</span>&#160;                    dpdeResidual_v_p[j]=<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.HamiltonianJacobian_strong(dmom_v_ham_grad_p,&amp;p_grad_trial[j_nSpace]);</div>
<div class="line"><a name="l05398"></a><span class="lineno"> 5398</span>&#160;                    dpdeResidual_w_p[j]=<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.HamiltonianJacobian_strong(dmom_w_ham_grad_p,&amp;p_grad_trial[j_nSpace]);</div>
<div class="line"><a name="l05399"></a><span class="lineno"> 5399</span>&#160;                  }</div>
<div class="line"><a name="l05400"></a><span class="lineno"> 5400</span>&#160;                <span class="comment">//calculate tau and tau*Res</span></div>
<div class="line"><a name="l05401"></a><span class="lineno"> 5401</span>&#160;                <span class="comment">//add contributions from mass and sourced terms</span></div>
<div class="line"><a name="l05402"></a><span class="lineno"> 5402</span>&#160;                <span class="keywordtype">double</span> tmpR=dmom_u_acc_u_t + dmom_u_source[0];</div>
<div class="line"><a name="l05403"></a><span class="lineno"> 5403</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#addf5cd3a254683dcee98d02fc43cd5f7">calculateSubgridError_tau</a>(hFactor,</div>
<div class="line"><a name="l05404"></a><span class="lineno"> 5404</span>&#160;                                          elementDiameter[eN],</div>
<div class="line"><a name="l05405"></a><span class="lineno"> 5405</span>&#160;                                          tmpR,<span class="comment">//dmom_u_acc_u_t,</span></div>
<div class="line"><a name="l05406"></a><span class="lineno"> 5406</span>&#160;                                          dmom_u_acc_u,</div>
<div class="line"><a name="l05407"></a><span class="lineno"> 5407</span>&#160;                                          mv_tau,<span class="comment">//dmom_adv_sge,</span></div>
<div class="line"><a name="l05408"></a><span class="lineno"> 5408</span>&#160;                                          mom_uu_diff_ten[1],</div>
<div class="line"><a name="l05409"></a><span class="lineno"> 5409</span>&#160;                                          dmom_u_ham_grad_p[0],</div>
<div class="line"><a name="l05410"></a><span class="lineno"> 5410</span>&#160;                                          tau_v0,</div>
<div class="line"><a name="l05411"></a><span class="lineno"> 5411</span>&#160;                                          tau_p0,</div>
<div class="line"><a name="l05412"></a><span class="lineno"> 5412</span>&#160;                                          q_cfl[eN_k]);</div>
<div class="line"><a name="l05413"></a><span class="lineno"> 5413</span>&#160; </div>
<div class="line"><a name="l05414"></a><span class="lineno"> 5414</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#addf5cd3a254683dcee98d02fc43cd5f7">calculateSubgridError_tau</a>(Ct_sge,Cd_sge,</div>
<div class="line"><a name="l05415"></a><span class="lineno"> 5415</span>&#160;                                          G,G_dd_G,tr_G,</div>
<div class="line"><a name="l05416"></a><span class="lineno"> 5416</span>&#160;                                          tmpR,<span class="comment">//dmom_u_acc_u_t,</span></div>
<div class="line"><a name="l05417"></a><span class="lineno"> 5417</span>&#160;                                          mv_tau,<span class="comment">//dmom_adv_sge,</span></div>
<div class="line"><a name="l05418"></a><span class="lineno"> 5418</span>&#160;                                          mom_uu_diff_ten[1],</div>
<div class="line"><a name="l05419"></a><span class="lineno"> 5419</span>&#160;                                          dmom_u_ham_grad_p[0],</div>
<div class="line"><a name="l05420"></a><span class="lineno"> 5420</span>&#160;                                          tau_v1,</div>
<div class="line"><a name="l05421"></a><span class="lineno"> 5421</span>&#160;                                          tau_p1,</div>
<div class="line"><a name="l05422"></a><span class="lineno"> 5422</span>&#160;                                          q_cfl[eN_k]);</div>
<div class="line"><a name="l05423"></a><span class="lineno"> 5423</span>&#160; </div>
<div class="line"><a name="l05424"></a><span class="lineno"> 5424</span>&#160; </div>
<div class="line"><a name="l05425"></a><span class="lineno"> 5425</span>&#160;                tau_v = useMetrics*tau_v1+(1.0-useMetrics)*tau_v0;</div>
<div class="line"><a name="l05426"></a><span class="lineno"> 5426</span>&#160;                tau_p = useMetrics*tau_p1+(1.0-useMetrics)*tau_p0;</div>
<div class="line"><a name="l05427"></a><span class="lineno"> 5427</span>&#160; </div>
<div class="line"><a name="l05428"></a><span class="lineno"> 5428</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#acf8d86d92ac9b99a31df36acfc6fece3">calculateSubgridError_tauRes</a>(tau_p,</div>
<div class="line"><a name="l05429"></a><span class="lineno"> 5429</span>&#160;                                             tau_v,</div>
<div class="line"><a name="l05430"></a><span class="lineno"> 5430</span>&#160;                                             pdeResidual_p,</div>
<div class="line"><a name="l05431"></a><span class="lineno"> 5431</span>&#160;                                             pdeResidual_u,</div>
<div class="line"><a name="l05432"></a><span class="lineno"> 5432</span>&#160;                                             pdeResidual_v,</div>
<div class="line"><a name="l05433"></a><span class="lineno"> 5433</span>&#160;                                             pdeResidual_w,</div>
<div class="line"><a name="l05434"></a><span class="lineno"> 5434</span>&#160;                                             subgridError_p,</div>
<div class="line"><a name="l05435"></a><span class="lineno"> 5435</span>&#160;                                             subgridError_u,</div>
<div class="line"><a name="l05436"></a><span class="lineno"> 5436</span>&#160;                                             subgridError_v,</div>
<div class="line"><a name="l05437"></a><span class="lineno"> 5437</span>&#160;                                             subgridError_w);</div>
<div class="line"><a name="l05438"></a><span class="lineno"> 5438</span>&#160; </div>
<div class="line"><a name="l05439"></a><span class="lineno"> 5439</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a4d4318b9ef2e89282a12e519eb6ced49">calculateSubgridErrorDerivatives_tauRes</a>(tau_p,</div>
<div class="line"><a name="l05440"></a><span class="lineno"> 5440</span>&#160;                                                        tau_v,</div>
<div class="line"><a name="l05441"></a><span class="lineno"> 5441</span>&#160;                                                        dpdeResidual_p_u,</div>
<div class="line"><a name="l05442"></a><span class="lineno"> 5442</span>&#160;                                                        dpdeResidual_p_v,</div>
<div class="line"><a name="l05443"></a><span class="lineno"> 5443</span>&#160;                                                        dpdeResidual_p_w,</div>
<div class="line"><a name="l05444"></a><span class="lineno"> 5444</span>&#160;                                                        dpdeResidual_u_p,</div>
<div class="line"><a name="l05445"></a><span class="lineno"> 5445</span>&#160;                                                        dpdeResidual_u_u,</div>
<div class="line"><a name="l05446"></a><span class="lineno"> 5446</span>&#160;                                                        dpdeResidual_v_p,</div>
<div class="line"><a name="l05447"></a><span class="lineno"> 5447</span>&#160;                                                        dpdeResidual_v_v,</div>
<div class="line"><a name="l05448"></a><span class="lineno"> 5448</span>&#160;                                                        dpdeResidual_w_p,</div>
<div class="line"><a name="l05449"></a><span class="lineno"> 5449</span>&#160;                                                        dpdeResidual_w_w,</div>
<div class="line"><a name="l05450"></a><span class="lineno"> 5450</span>&#160;                                                        dsubgridError_p_u,</div>
<div class="line"><a name="l05451"></a><span class="lineno"> 5451</span>&#160;                                                        dsubgridError_p_v,</div>
<div class="line"><a name="l05452"></a><span class="lineno"> 5452</span>&#160;                                                        dsubgridError_p_w,</div>
<div class="line"><a name="l05453"></a><span class="lineno"> 5453</span>&#160;                                                        dsubgridError_u_p,</div>
<div class="line"><a name="l05454"></a><span class="lineno"> 5454</span>&#160;                                                        dsubgridError_u_u,</div>
<div class="line"><a name="l05455"></a><span class="lineno"> 5455</span>&#160;                                                        dsubgridError_v_p,</div>
<div class="line"><a name="l05456"></a><span class="lineno"> 5456</span>&#160;                                                        dsubgridError_v_v,</div>
<div class="line"><a name="l05457"></a><span class="lineno"> 5457</span>&#160;                                                        dsubgridError_w_p,</div>
<div class="line"><a name="l05458"></a><span class="lineno"> 5458</span>&#160;                                                        dsubgridError_w_w);</div>
<div class="line"><a name="l05459"></a><span class="lineno"> 5459</span>&#160;                <span class="comment">// velocity used in adjoint (VMS or RBLES, with or without lagging the grid scale velocity)</span></div>
<div class="line"><a name="l05460"></a><span class="lineno"> 5460</span>&#160;                dmom_adv_star[0] = dmom_u_acc_u*(q_velocity_sge[eN_k_nSpace+0] - MOVING_DOMAIN*xt + useRBLES*subgridError_u);</div>
<div class="line"><a name="l05461"></a><span class="lineno"> 5461</span>&#160;                dmom_adv_star[1] = dmom_u_acc_u*(q_velocity_sge[eN_k_nSpace+1] - MOVING_DOMAIN*yt + useRBLES*subgridError_v);</div>
<div class="line"><a name="l05462"></a><span class="lineno"> 5462</span>&#160;                dmom_adv_star[2] = dmom_u_acc_u*(q_velocity_sge[eN_k_nSpace+2] - MOVING_DOMAIN*zt + useRBLES*subgridError_w);</div>
<div class="line"><a name="l05463"></a><span class="lineno"> 5463</span>&#160; </div>
<div class="line"><a name="l05464"></a><span class="lineno"> 5464</span>&#160;                <span class="comment">//calculate the adjoint times the test functions</span></div>
<div class="line"><a name="l05465"></a><span class="lineno"> 5465</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;nDOF_test_element;i++)</div>
<div class="line"><a name="l05466"></a><span class="lineno"> 5466</span>&#160;                  {</div>
<div class="line"><a name="l05467"></a><span class="lineno"> 5467</span>&#160;                    <span class="keyword">register</span> <span class="keywordtype">int</span> i_nSpace = i*nSpace;</div>
<div class="line"><a name="l05468"></a><span class="lineno"> 5468</span>&#160;                    Lstar_u_p[i]=<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Advection_adjoint(dmass_adv_u,&amp;p_grad_test_dV[i_nSpace]);</div>
<div class="line"><a name="l05469"></a><span class="lineno"> 5469</span>&#160;                    Lstar_v_p[i]=<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Advection_adjoint(dmass_adv_v,&amp;p_grad_test_dV[i_nSpace]);</div>
<div class="line"><a name="l05470"></a><span class="lineno"> 5470</span>&#160;                    Lstar_w_p[i]=<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Advection_adjoint(dmass_adv_w,&amp;p_grad_test_dV[i_nSpace]);</div>
<div class="line"><a name="l05471"></a><span class="lineno"> 5471</span>&#160;                  }</div>
<div class="line"><a name="l05472"></a><span class="lineno"> 5472</span>&#160;                <span class="comment">//calculate the adjoint times the test functions</span></div>
<div class="line"><a name="l05473"></a><span class="lineno"> 5473</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;nDOF_v_test_element;i++)</div>
<div class="line"><a name="l05474"></a><span class="lineno"> 5474</span>&#160;                  {</div>
<div class="line"><a name="l05475"></a><span class="lineno"> 5475</span>&#160;                    <span class="keyword">register</span> <span class="keywordtype">int</span> i_nSpace = i*nSpace;</div>
<div class="line"><a name="l05476"></a><span class="lineno"> 5476</span>&#160;                    Lstar_u_u[i]=<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Advection_adjoint(dmom_adv_star,&amp;vel_grad_test_dV[i_nSpace]);</div>
<div class="line"><a name="l05477"></a><span class="lineno"> 5477</span>&#160;                    Lstar_v_v[i]=<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Advection_adjoint(dmom_adv_star,&amp;vel_grad_test_dV[i_nSpace]);</div>
<div class="line"><a name="l05478"></a><span class="lineno"> 5478</span>&#160;                    Lstar_w_w[i]=<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Advection_adjoint(dmom_adv_star,&amp;vel_grad_test_dV[i_nSpace]);</div>
<div class="line"><a name="l05479"></a><span class="lineno"> 5479</span>&#160;                    Lstar_p_u[i]=<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Hamiltonian_adjoint(dmom_u_ham_grad_p,&amp;vel_grad_test_dV[i_nSpace]);</div>
<div class="line"><a name="l05480"></a><span class="lineno"> 5480</span>&#160;                    Lstar_p_v[i]=<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Hamiltonian_adjoint(dmom_v_ham_grad_p,&amp;vel_grad_test_dV[i_nSpace]);</div>
<div class="line"><a name="l05481"></a><span class="lineno"> 5481</span>&#160;                    Lstar_p_w[i]=<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Hamiltonian_adjoint(dmom_w_ham_grad_p,&amp;vel_grad_test_dV[i_nSpace]);</div>
<div class="line"><a name="l05482"></a><span class="lineno"> 5482</span>&#160;                    <span class="comment">//VRANS account for drag terms, diagonal only here ... decide if need off diagonal terms too</span></div>
<div class="line"><a name="l05483"></a><span class="lineno"> 5483</span>&#160;                    Lstar_u_u[i]+=<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Reaction_adjoint(dmom_u_source[0],vel_test_dV[i]);</div>
<div class="line"><a name="l05484"></a><span class="lineno"> 5484</span>&#160;                    Lstar_v_v[i]+=<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Reaction_adjoint(dmom_v_source[1],vel_test_dV[i]);</div>
<div class="line"><a name="l05485"></a><span class="lineno"> 5485</span>&#160;                    Lstar_w_w[i]+=<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.Reaction_adjoint(dmom_w_source[2],vel_test_dV[i]);</div>
<div class="line"><a name="l05486"></a><span class="lineno"> 5486</span>&#160;                  }</div>
<div class="line"><a name="l05487"></a><span class="lineno"> 5487</span>&#160; </div>
<div class="line"><a name="l05488"></a><span class="lineno"> 5488</span>&#160;                <span class="comment">// Assumes non-lagged subgrid velocity</span></div>
<div class="line"><a name="l05489"></a><span class="lineno"> 5489</span>&#160;                dmom_u_adv_u[0] += dmom_u_acc_u*(useRBLES*subgridError_u);</div>
<div class="line"><a name="l05490"></a><span class="lineno"> 5490</span>&#160;                dmom_u_adv_u[1] += dmom_u_acc_u*(useRBLES*subgridError_v);</div>
<div class="line"><a name="l05491"></a><span class="lineno"> 5491</span>&#160;                dmom_u_adv_u[2] += dmom_u_acc_u*(useRBLES*subgridError_w);</div>
<div class="line"><a name="l05492"></a><span class="lineno"> 5492</span>&#160; </div>
<div class="line"><a name="l05493"></a><span class="lineno"> 5493</span>&#160;                dmom_v_adv_v[0] += dmom_u_acc_u*(useRBLES*subgridError_u);</div>
<div class="line"><a name="l05494"></a><span class="lineno"> 5494</span>&#160;                dmom_v_adv_v[1] += dmom_u_acc_u*(useRBLES*subgridError_v);</div>
<div class="line"><a name="l05495"></a><span class="lineno"> 5495</span>&#160;                dmom_v_adv_v[2] += dmom_u_acc_u*(useRBLES*subgridError_w);</div>
<div class="line"><a name="l05496"></a><span class="lineno"> 5496</span>&#160; </div>
<div class="line"><a name="l05497"></a><span class="lineno"> 5497</span>&#160;                dmom_w_adv_w[0] += dmom_u_acc_u*(useRBLES*subgridError_u);</div>
<div class="line"><a name="l05498"></a><span class="lineno"> 5498</span>&#160;                dmom_w_adv_w[1] += dmom_u_acc_u*(useRBLES*subgridError_v);</div>
<div class="line"><a name="l05499"></a><span class="lineno"> 5499</span>&#160;                dmom_w_adv_w[2] += dmom_u_acc_u*(useRBLES*subgridError_w);</div>
<div class="line"><a name="l05500"></a><span class="lineno"> 5500</span>&#160; </div>
<div class="line"><a name="l05501"></a><span class="lineno"> 5501</span>&#160;                <span class="comment">//cek todo add RBLES terms consistent to residual modifications or ignore the partials w.r.t the additional RBLES terms</span></div>
<div class="line"><a name="l05502"></a><span class="lineno"> 5502</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;nDOF_test_element;i++)</div>
<div class="line"><a name="l05503"></a><span class="lineno"> 5503</span>&#160;                  {</div>
<div class="line"><a name="l05504"></a><span class="lineno"> 5504</span>&#160;                    <span class="keyword">register</span> <span class="keywordtype">int</span> i_nSpace = i*nSpace;</div>
<div class="line"><a name="l05505"></a><span class="lineno"> 5505</span>&#160;                    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0;j&lt;nDOF_trial_element;j++)</div>
<div class="line"><a name="l05506"></a><span class="lineno"> 5506</span>&#160;                      {</div>
<div class="line"><a name="l05507"></a><span class="lineno"> 5507</span>&#160;                        <span class="keyword">register</span> <span class="keywordtype">int</span> j_nSpace = j*nSpace;</div>
<div class="line"><a name="l05508"></a><span class="lineno"> 5508</span>&#160;                        <span class="keywordflow">if</span> (nDOF_test_element == nDOF_v_trial_element)</div>
<div class="line"><a name="l05509"></a><span class="lineno"> 5509</span>&#160;                          {</div>
<div class="line"><a name="l05510"></a><span class="lineno"> 5510</span>&#160;                            elementJacobian_p_p[i][j] += <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.SubgridErrorJacobian(dsubgridError_u_p[j],Lstar_u_p[i]) +</div>
<div class="line"><a name="l05511"></a><span class="lineno"> 5511</span>&#160;                              <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.SubgridErrorJacobian(dsubgridError_v_p[j],Lstar_v_p[i]) +</div>
<div class="line"><a name="l05512"></a><span class="lineno"> 5512</span>&#160;                              <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.SubgridErrorJacobian(dsubgridError_w_p[j],Lstar_w_p[i]);</div>
<div class="line"><a name="l05513"></a><span class="lineno"> 5513</span>&#160;                          }</div>
<div class="line"><a name="l05514"></a><span class="lineno"> 5514</span>&#160;                      }</div>
<div class="line"><a name="l05515"></a><span class="lineno"> 5515</span>&#160;                  }</div>
<div class="line"><a name="l05516"></a><span class="lineno"> 5516</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;nDOF_test_element;i++)</div>
<div class="line"><a name="l05517"></a><span class="lineno"> 5517</span>&#160;                  {</div>
<div class="line"><a name="l05518"></a><span class="lineno"> 5518</span>&#160;                    <span class="keyword">register</span> <span class="keywordtype">int</span> i_nSpace = i*nSpace;</div>
<div class="line"><a name="l05519"></a><span class="lineno"> 5519</span>&#160;                    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0;j&lt;nDOF_v_trial_element;j++)</div>
<div class="line"><a name="l05520"></a><span class="lineno"> 5520</span>&#160;                      {</div>
<div class="line"><a name="l05521"></a><span class="lineno"> 5521</span>&#160;                        <span class="keyword">register</span> <span class="keywordtype">int</span> j_nSpace = j*nSpace;</div>
<div class="line"><a name="l05522"></a><span class="lineno"> 5522</span>&#160;                        elementJacobian_p_u[i][j] += <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.AdvectionJacobian_weak(dmass_adv_u,vel_trial_ref[k*nDOF_v_trial_element+j],&amp;p_grad_test_dV[i_nSpace])</div>
<div class="line"><a name="l05523"></a><span class="lineno"> 5523</span>&#160;                          + <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.MassJacobian_weak(dmass_ham_u,vel_trial_ref[k*nDOF_v_trial_element+j],p_test_dV[i]);</div>
<div class="line"><a name="l05524"></a><span class="lineno"> 5524</span>&#160;                        elementJacobian_p_v[i][j] += <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.AdvectionJacobian_weak(dmass_adv_v,vel_trial_ref[k*nDOF_v_trial_element+j],&amp;p_grad_test_dV[i_nSpace])</div>
<div class="line"><a name="l05525"></a><span class="lineno"> 5525</span>&#160;                          + <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.MassJacobian_weak(dmass_ham_v,vel_trial_ref[k*nDOF_v_trial_element+j],p_test_dV[i]);</div>
<div class="line"><a name="l05526"></a><span class="lineno"> 5526</span>&#160;                        elementJacobian_p_w[i][j] += <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.AdvectionJacobian_weak(dmass_adv_w,vel_trial_ref[k*nDOF_v_trial_element+j],&amp;p_grad_test_dV[i_nSpace])</div>
<div class="line"><a name="l05527"></a><span class="lineno"> 5527</span>&#160;                          + <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.MassJacobian_weak(dmass_ham_w,vel_trial_ref[k*nDOF_v_trial_element+j],p_test_dV[i]);</div>
<div class="line"><a name="l05528"></a><span class="lineno"> 5528</span>&#160;                        <span class="keywordflow">if</span> (nDOF_test_element == nDOF_v_trial_element)</div>
<div class="line"><a name="l05529"></a><span class="lineno"> 5529</span>&#160;                          {</div>
<div class="line"><a name="l05530"></a><span class="lineno"> 5530</span>&#160;                            elementJacobian_p_u[i][j] += <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.SubgridErrorJacobian(dsubgridError_u_u[j],Lstar_u_p[i]);</div>
<div class="line"><a name="l05531"></a><span class="lineno"> 5531</span>&#160;                            elementJacobian_p_v[i][j] += <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.SubgridErrorJacobian(dsubgridError_v_v[j],Lstar_v_p[i]);</div>
<div class="line"><a name="l05532"></a><span class="lineno"> 5532</span>&#160;                            elementJacobian_p_w[i][j] += <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.SubgridErrorJacobian(dsubgridError_w_w[j],Lstar_w_p[i]);</div>
<div class="line"><a name="l05533"></a><span class="lineno"> 5533</span>&#160;                          }</div>
<div class="line"><a name="l05534"></a><span class="lineno"> 5534</span>&#160;                      }</div>
<div class="line"><a name="l05535"></a><span class="lineno"> 5535</span>&#160;                  }</div>
<div class="line"><a name="l05536"></a><span class="lineno"> 5536</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;nDOF_v_test_element;i++)</div>
<div class="line"><a name="l05537"></a><span class="lineno"> 5537</span>&#160;                  {</div>
<div class="line"><a name="l05538"></a><span class="lineno"> 5538</span>&#160;                    <span class="keyword">register</span> <span class="keywordtype">int</span> i_nSpace = i*nSpace;</div>
<div class="line"><a name="l05539"></a><span class="lineno"> 5539</span>&#160;                    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0;j&lt;nDOF_trial_element;j++)</div>
<div class="line"><a name="l05540"></a><span class="lineno"> 5540</span>&#160;                      {</div>
<div class="line"><a name="l05541"></a><span class="lineno"> 5541</span>&#160;                        <span class="keyword">register</span> <span class="keywordtype">int</span> j_nSpace = j*nSpace;</div>
<div class="line"><a name="l05542"></a><span class="lineno"> 5542</span>&#160;                        elementJacobian_u_p[i][j] += <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.HamiltonianJacobian_weak(dmom_u_ham_grad_p,&amp;p_grad_trial[j_nSpace],vel_test_dV[i])+</div>
<div class="line"><a name="l05543"></a><span class="lineno"> 5543</span>&#160;                          MOMENTUM_SGE*VELOCITY_SGE*<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.SubgridErrorJacobian(dsubgridError_u_p[j],Lstar_u_u[i]);</div>
<div class="line"><a name="l05544"></a><span class="lineno"> 5544</span>&#160;                        elementJacobian_v_p[i][j] += <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.HamiltonianJacobian_weak(dmom_v_ham_grad_p,&amp;p_grad_trial[j_nSpace],vel_test_dV[i])+</div>
<div class="line"><a name="l05545"></a><span class="lineno"> 5545</span>&#160;                          MOMENTUM_SGE*VELOCITY_SGE*<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.SubgridErrorJacobian(dsubgridError_v_p[j],Lstar_v_v[i]);</div>
<div class="line"><a name="l05546"></a><span class="lineno"> 5546</span>&#160;                        elementJacobian_w_p[i][j] += <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.HamiltonianJacobian_weak(dmom_w_ham_grad_p,&amp;p_grad_trial[j_nSpace],vel_test_dV[i])+</div>
<div class="line"><a name="l05547"></a><span class="lineno"> 5547</span>&#160;                          MOMENTUM_SGE*VELOCITY_SGE*<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.SubgridErrorJacobian(dsubgridError_w_p[j],Lstar_w_w[i]);</div>
<div class="line"><a name="l05548"></a><span class="lineno"> 5548</span>&#160;                      }</div>
<div class="line"><a name="l05549"></a><span class="lineno"> 5549</span>&#160;                  }</div>
<div class="line"><a name="l05550"></a><span class="lineno"> 5550</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;nDOF_v_test_element;i++)</div>
<div class="line"><a name="l05551"></a><span class="lineno"> 5551</span>&#160;                  {</div>
<div class="line"><a name="l05552"></a><span class="lineno"> 5552</span>&#160;                    <span class="keyword">register</span> <span class="keywordtype">int</span> i_nSpace = i*nSpace;</div>
<div class="line"><a name="l05553"></a><span class="lineno"> 5553</span>&#160;                    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0;j&lt;nDOF_v_trial_element;j++)</div>
<div class="line"><a name="l05554"></a><span class="lineno"> 5554</span>&#160;                      {</div>
<div class="line"><a name="l05555"></a><span class="lineno"> 5555</span>&#160;                        <span class="keyword">register</span> <span class="keywordtype">int</span> j_nSpace = j*nSpace;</div>
<div class="line"><a name="l05556"></a><span class="lineno"> 5556</span>&#160;                        elementJacobian_u_u[i][j] += <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.MassJacobian_weak(dmom_u_acc_u_t,vel_trial_ref[k*nDOF_v_trial_element+j],vel_test_dV[i]) +</div>
<div class="line"><a name="l05557"></a><span class="lineno"> 5557</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.MassJacobian_weak(dmom_u_ham_u,vel_trial_ref[k*nDOF_v_trial_element+j],vel_test_dV[i]) + <span class="comment">//cek hack for nonlinear hamiltonian</span></div>
<div class="line"><a name="l05558"></a><span class="lineno"> 5558</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.HamiltonianJacobian_weak(dmom_u_ham_grad_u,&amp;vel_grad_trial[j_nSpace],vel_test_dV[i]) +</div>
<div class="line"><a name="l05559"></a><span class="lineno"> 5559</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.AdvectionJacobian_weak(dmom_u_adv_u,vel_trial_ref[k*nDOF_v_trial_element+j],&amp;vel_grad_test_dV[i_nSpace]) +</div>
<div class="line"><a name="l05560"></a><span class="lineno"> 5560</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.SimpleDiffusionJacobian_weak(sdInfo_u_u_rowptr,sdInfo_u_u_colind,mom_uu_diff_ten,&amp;vel_grad_trial[j_nSpace],&amp;vel_grad_test_dV[i_nSpace]) +</div>
<div class="line"><a name="l05561"></a><span class="lineno"> 5561</span>&#160;                          <span class="comment">//VRANS</span></div>
<div class="line"><a name="l05562"></a><span class="lineno"> 5562</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.ReactionJacobian_weak(dmom_u_source[0]+NONCONSERVATIVE_FORM*dmom_u_acc_u*div_mesh_velocity,vel_trial_ref[k*nDOF_v_trial_element+j],vel_test_dV[i]) +</div>
<div class="line"><a name="l05563"></a><span class="lineno"> 5563</span>&#160;                          <span class="comment">//</span></div>
<div class="line"><a name="l05564"></a><span class="lineno"> 5564</span>&#160;                          MOMENTUM_SGE*PRESSURE_SGE*<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.SubgridErrorJacobian(dsubgridError_p_u[j],Lstar_p_u[i]) +</div>
<div class="line"><a name="l05565"></a><span class="lineno"> 5565</span>&#160;                          MOMENTUM_SGE*VELOCITY_SGE*<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.SubgridErrorJacobian(dsubgridError_u_u[j],Lstar_u_u[i]) +</div>
<div class="line"><a name="l05566"></a><span class="lineno"> 5566</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.NumericalDiffusionJacobian(q_numDiff_u_last[eN_k],&amp;vel_grad_trial[j_nSpace],&amp;vel_grad_test_dV[i_nSpace]);</div>
<div class="line"><a name="l05567"></a><span class="lineno"> 5567</span>&#160; </div>
<div class="line"><a name="l05568"></a><span class="lineno"> 5568</span>&#160;                        elementJacobian_u_v[i][j] += <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.AdvectionJacobian_weak(dmom_u_adv_v,vel_trial_ref[k*nDOF_v_trial_element+j],&amp;vel_grad_test_dV[i_nSpace]) +</div>
<div class="line"><a name="l05569"></a><span class="lineno"> 5569</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.MassJacobian_weak(dmom_u_ham_v,vel_trial_ref[k*nDOF_v_trial_element+j],vel_test_dV[i]) + <span class="comment">//cek hack for nonlinear hamiltonian</span></div>
<div class="line"><a name="l05570"></a><span class="lineno"> 5570</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.SimpleDiffusionJacobian_weak(sdInfo_u_v_rowptr,sdInfo_u_v_colind,mom_uv_diff_ten,&amp;vel_grad_trial[j_nSpace],&amp;vel_grad_test_dV[i_nSpace]) +</div>
<div class="line"><a name="l05571"></a><span class="lineno"> 5571</span>&#160;                          <span class="comment">//VRANS</span></div>
<div class="line"><a name="l05572"></a><span class="lineno"> 5572</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.ReactionJacobian_weak(dmom_u_source[1],vel_trial_ref[k*nDOF_v_trial_element+j],vel_test_dV[i]) +</div>
<div class="line"><a name="l05573"></a><span class="lineno"> 5573</span>&#160;                          <span class="comment">//</span></div>
<div class="line"><a name="l05574"></a><span class="lineno"> 5574</span>&#160;                          MOMENTUM_SGE*PRESSURE_SGE*<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.SubgridErrorJacobian(dsubgridError_p_v[j],Lstar_p_u[i]);</div>
<div class="line"><a name="l05575"></a><span class="lineno"> 5575</span>&#160; </div>
<div class="line"><a name="l05576"></a><span class="lineno"> 5576</span>&#160;                        elementJacobian_u_w[i][j] += <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.AdvectionJacobian_weak(dmom_u_adv_w,vel_trial_ref[k*nDOF_v_trial_element+j],&amp;vel_grad_test_dV[i_nSpace]) +</div>
<div class="line"><a name="l05577"></a><span class="lineno"> 5577</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.MassJacobian_weak(dmom_u_ham_w,vel_trial_ref[k*nDOF_v_trial_element+j],vel_test_dV[i]) + <span class="comment">//cek hack for nonlinear hamiltonian</span></div>
<div class="line"><a name="l05578"></a><span class="lineno"> 5578</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.SimpleDiffusionJacobian_weak(sdInfo_u_w_rowptr,sdInfo_u_w_colind,mom_uw_diff_ten,&amp;vel_grad_trial[j_nSpace],&amp;vel_grad_test_dV[i_nSpace]) +</div>
<div class="line"><a name="l05579"></a><span class="lineno"> 5579</span>&#160;                          <span class="comment">//VRANS</span></div>
<div class="line"><a name="l05580"></a><span class="lineno"> 5580</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.ReactionJacobian_weak(dmom_u_source[2],vel_trial_ref[k*nDOF_v_trial_element+j],vel_test_dV[i]) +</div>
<div class="line"><a name="l05581"></a><span class="lineno"> 5581</span>&#160;                          <span class="comment">//</span></div>
<div class="line"><a name="l05582"></a><span class="lineno"> 5582</span>&#160;                          MOMENTUM_SGE*PRESSURE_SGE*<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.SubgridErrorJacobian(dsubgridError_p_w[j],Lstar_p_u[i]);</div>
<div class="line"><a name="l05583"></a><span class="lineno"> 5583</span>&#160; </div>
<div class="line"><a name="l05584"></a><span class="lineno"> 5584</span>&#160;                        elementJacobian_v_u[i][j] += <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.AdvectionJacobian_weak(dmom_v_adv_u,vel_trial_ref[k*nDOF_v_trial_element+j],&amp;vel_grad_test_dV[i_nSpace]) +</div>
<div class="line"><a name="l05585"></a><span class="lineno"> 5585</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.MassJacobian_weak(dmom_v_ham_u,vel_trial_ref[k*nDOF_v_trial_element+j],vel_test_dV[i]) + <span class="comment">//cek hack for nonlinear hamiltonian</span></div>
<div class="line"><a name="l05586"></a><span class="lineno"> 5586</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.SimpleDiffusionJacobian_weak(sdInfo_v_u_rowptr,sdInfo_v_u_colind,mom_vu_diff_ten,&amp;vel_grad_trial[j_nSpace],&amp;vel_grad_test_dV[i_nSpace]) +</div>
<div class="line"><a name="l05587"></a><span class="lineno"> 5587</span>&#160;                          <span class="comment">//VRANS</span></div>
<div class="line"><a name="l05588"></a><span class="lineno"> 5588</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.ReactionJacobian_weak(dmom_v_source[0],vel_trial_ref[k*nDOF_v_trial_element+j],vel_test_dV[i]) +</div>
<div class="line"><a name="l05589"></a><span class="lineno"> 5589</span>&#160;                          MOMENTUM_SGE*PRESSURE_SGE*<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.SubgridErrorJacobian(dsubgridError_p_u[j],Lstar_p_v[i]);</div>
<div class="line"><a name="l05590"></a><span class="lineno"> 5590</span>&#160;                        elementJacobian_v_v[i][j] += <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.MassJacobian_weak(dmom_v_acc_v_t,vel_trial_ref[k*nDOF_v_trial_element+j],vel_test_dV[i]) +</div>
<div class="line"><a name="l05591"></a><span class="lineno"> 5591</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.MassJacobian_weak(dmom_v_ham_v,vel_trial_ref[k*nDOF_v_trial_element+j],vel_test_dV[i]) + <span class="comment">//cek hack for nonlinear hamiltonian</span></div>
<div class="line"><a name="l05592"></a><span class="lineno"> 5592</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.HamiltonianJacobian_weak(dmom_v_ham_grad_v,&amp;vel_grad_trial[j_nSpace],vel_test_dV[i]) +</div>
<div class="line"><a name="l05593"></a><span class="lineno"> 5593</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.AdvectionJacobian_weak(dmom_v_adv_v,vel_trial_ref[k*nDOF_v_trial_element+j],&amp;vel_grad_test_dV[i_nSpace]) +</div>
<div class="line"><a name="l05594"></a><span class="lineno"> 5594</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.SimpleDiffusionJacobian_weak(sdInfo_v_v_rowptr,sdInfo_v_v_colind,mom_vv_diff_ten,&amp;vel_grad_trial[j_nSpace],&amp;vel_grad_test_dV[i_nSpace]) +</div>
<div class="line"><a name="l05595"></a><span class="lineno"> 5595</span>&#160;                          <span class="comment">//VRANS</span></div>
<div class="line"><a name="l05596"></a><span class="lineno"> 5596</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.ReactionJacobian_weak(dmom_v_source[1]+NONCONSERVATIVE_FORM*dmom_v_acc_v*div_mesh_velocity,vel_trial_ref[k*nDOF_v_trial_element+j],vel_test_dV[i]) +</div>
<div class="line"><a name="l05597"></a><span class="lineno"> 5597</span>&#160;                          <span class="comment">//</span></div>
<div class="line"><a name="l05598"></a><span class="lineno"> 5598</span>&#160;                          MOMENTUM_SGE*PRESSURE_SGE*<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.SubgridErrorJacobian(dsubgridError_p_v[j],Lstar_p_v[i]) +</div>
<div class="line"><a name="l05599"></a><span class="lineno"> 5599</span>&#160;                          MOMENTUM_SGE*VELOCITY_SGE*<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.SubgridErrorJacobian(dsubgridError_v_v[j],Lstar_v_v[i]) +</div>
<div class="line"><a name="l05600"></a><span class="lineno"> 5600</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.NumericalDiffusionJacobian(q_numDiff_v_last[eN_k],&amp;vel_grad_trial[j_nSpace],&amp;vel_grad_test_dV[i_nSpace]);</div>
<div class="line"><a name="l05601"></a><span class="lineno"> 5601</span>&#160; </div>
<div class="line"><a name="l05602"></a><span class="lineno"> 5602</span>&#160;                        elementJacobian_v_w[i][j] += <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.AdvectionJacobian_weak(dmom_v_adv_w,vel_trial_ref[k*nDOF_v_trial_element+j],&amp;vel_grad_test_dV[i_nSpace]) +</div>
<div class="line"><a name="l05603"></a><span class="lineno"> 5603</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.MassJacobian_weak(dmom_v_ham_w,vel_trial_ref[k*nDOF_v_trial_element+j],vel_test_dV[i]) + <span class="comment">//cek hack for nonlinear hamiltonian</span></div>
<div class="line"><a name="l05604"></a><span class="lineno"> 5604</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.SimpleDiffusionJacobian_weak(sdInfo_v_w_rowptr,sdInfo_v_w_colind,mom_vw_diff_ten,&amp;vel_grad_trial[j_nSpace],&amp;vel_grad_test_dV[i_nSpace]) +</div>
<div class="line"><a name="l05605"></a><span class="lineno"> 5605</span>&#160;                          <span class="comment">//VRANS</span></div>
<div class="line"><a name="l05606"></a><span class="lineno"> 5606</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.ReactionJacobian_weak(dmom_v_source[2],vel_trial_ref[k*nDOF_v_trial_element+j],vel_test_dV[i]) +</div>
<div class="line"><a name="l05607"></a><span class="lineno"> 5607</span>&#160;                          <span class="comment">//</span></div>
<div class="line"><a name="l05608"></a><span class="lineno"> 5608</span>&#160;                          MOMENTUM_SGE*PRESSURE_SGE*<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.SubgridErrorJacobian(dsubgridError_p_w[j],Lstar_p_v[i]);</div>
<div class="line"><a name="l05609"></a><span class="lineno"> 5609</span>&#160; </div>
<div class="line"><a name="l05610"></a><span class="lineno"> 5610</span>&#160;                        elementJacobian_w_u[i][j] += <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.AdvectionJacobian_weak(dmom_w_adv_u,vel_trial_ref[k*nDOF_v_trial_element+j],&amp;vel_grad_test_dV[i_nSpace]) +</div>
<div class="line"><a name="l05611"></a><span class="lineno"> 5611</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.MassJacobian_weak(dmom_w_ham_u,vel_trial_ref[k*nDOF_v_trial_element+j],vel_test_dV[i]) + <span class="comment">//cek hack for nonlinear hamiltonian</span></div>
<div class="line"><a name="l05612"></a><span class="lineno"> 5612</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.SimpleDiffusionJacobian_weak(sdInfo_w_u_rowptr,sdInfo_w_u_colind,mom_wu_diff_ten,&amp;vel_grad_trial[j_nSpace],&amp;vel_grad_test_dV[i_nSpace]) +</div>
<div class="line"><a name="l05613"></a><span class="lineno"> 5613</span>&#160;                          <span class="comment">//VRANS</span></div>
<div class="line"><a name="l05614"></a><span class="lineno"> 5614</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.ReactionJacobian_weak(dmom_w_source[0],vel_trial_ref[k*nDOF_v_trial_element+j],vel_test_dV[i]) +</div>
<div class="line"><a name="l05615"></a><span class="lineno"> 5615</span>&#160;                          <span class="comment">//</span></div>
<div class="line"><a name="l05616"></a><span class="lineno"> 5616</span>&#160;                          MOMENTUM_SGE*PRESSURE_SGE*<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.SubgridErrorJacobian(dsubgridError_p_u[j],Lstar_p_w[i]);</div>
<div class="line"><a name="l05617"></a><span class="lineno"> 5617</span>&#160;                        elementJacobian_w_v[i][j] += <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.AdvectionJacobian_weak(dmom_w_adv_v,vel_trial_ref[k*nDOF_v_trial_element+j],&amp;vel_grad_test_dV[i_nSpace]) +</div>
<div class="line"><a name="l05618"></a><span class="lineno"> 5618</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.MassJacobian_weak(dmom_w_ham_v,vel_trial_ref[k*nDOF_v_trial_element+j],vel_test_dV[i]) + <span class="comment">//cek hack for nonlinear hamiltonian</span></div>
<div class="line"><a name="l05619"></a><span class="lineno"> 5619</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.SimpleDiffusionJacobian_weak(sdInfo_w_v_rowptr,sdInfo_w_v_colind,mom_wv_diff_ten,&amp;vel_grad_trial[j_nSpace],&amp;vel_grad_test_dV[i_nSpace]) +</div>
<div class="line"><a name="l05620"></a><span class="lineno"> 5620</span>&#160;                          <span class="comment">//VRANS</span></div>
<div class="line"><a name="l05621"></a><span class="lineno"> 5621</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.ReactionJacobian_weak(dmom_w_source[1],vel_trial_ref[k*nDOF_v_trial_element+j],vel_test_dV[i]) +</div>
<div class="line"><a name="l05622"></a><span class="lineno"> 5622</span>&#160;                          <span class="comment">//</span></div>
<div class="line"><a name="l05623"></a><span class="lineno"> 5623</span>&#160;                          MOMENTUM_SGE*PRESSURE_SGE*<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.SubgridErrorJacobian(dsubgridError_p_v[j],Lstar_p_w[i]);</div>
<div class="line"><a name="l05624"></a><span class="lineno"> 5624</span>&#160;                        elementJacobian_w_w[i][j] += <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.MassJacobian_weak(dmom_w_acc_w_t,vel_trial_ref[k*nDOF_v_trial_element+j],vel_test_dV[i]) +</div>
<div class="line"><a name="l05625"></a><span class="lineno"> 5625</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.MassJacobian_weak(dmom_w_ham_w,vel_trial_ref[k*nDOF_v_trial_element+j],vel_test_dV[i]) + <span class="comment">//cek hack for nonlinear hamiltonian</span></div>
<div class="line"><a name="l05626"></a><span class="lineno"> 5626</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.HamiltonianJacobian_weak(dmom_w_ham_grad_w,&amp;vel_grad_trial[j_nSpace],vel_test_dV[i]) +</div>
<div class="line"><a name="l05627"></a><span class="lineno"> 5627</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.AdvectionJacobian_weak(dmom_w_adv_w,vel_trial_ref[k*nDOF_v_trial_element+j],&amp;vel_grad_test_dV[i_nSpace]) +</div>
<div class="line"><a name="l05628"></a><span class="lineno"> 5628</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.SimpleDiffusionJacobian_weak(sdInfo_w_w_rowptr,sdInfo_w_w_colind,mom_ww_diff_ten,&amp;vel_grad_trial[j_nSpace],&amp;vel_grad_test_dV[i_nSpace]) +</div>
<div class="line"><a name="l05629"></a><span class="lineno"> 5629</span>&#160;                          <span class="comment">//VRANS</span></div>
<div class="line"><a name="l05630"></a><span class="lineno"> 5630</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.ReactionJacobian_weak(dmom_w_source[2]+NONCONSERVATIVE_FORM*dmom_w_acc_w*div_mesh_velocity,vel_trial_ref[k*nDOF_v_trial_element+j],vel_test_dV[i]) +</div>
<div class="line"><a name="l05631"></a><span class="lineno"> 5631</span>&#160;                          <span class="comment">//</span></div>
<div class="line"><a name="l05632"></a><span class="lineno"> 5632</span>&#160;                          MOMENTUM_SGE*PRESSURE_SGE*<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.SubgridErrorJacobian(dsubgridError_p_w[j],Lstar_p_w[i]) +</div>
<div class="line"><a name="l05633"></a><span class="lineno"> 5633</span>&#160;                          MOMENTUM_SGE*VELOCITY_SGE*<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.SubgridErrorJacobian(dsubgridError_w_w[j],Lstar_w_w[i]) +</div>
<div class="line"><a name="l05634"></a><span class="lineno"> 5634</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.NumericalDiffusionJacobian(q_numDiff_w_last[eN_k],&amp;vel_grad_trial[j_nSpace],&amp;vel_grad_test_dV[i_nSpace]);</div>
<div class="line"><a name="l05635"></a><span class="lineno"> 5635</span>&#160;                      }<span class="comment">//j</span></div>
<div class="line"><a name="l05636"></a><span class="lineno"> 5636</span>&#160;                  }<span class="comment">//i</span></div>
<div class="line"><a name="l05637"></a><span class="lineno"> 5637</span>&#160;              }<span class="comment">//k</span></div>
<div class="line"><a name="l05638"></a><span class="lineno"> 5638</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l05639"></a><span class="lineno"> 5639</span>&#160;            <span class="comment">//load into element Jacobian into global Jacobian</span></div>
<div class="line"><a name="l05640"></a><span class="lineno"> 5640</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l05641"></a><span class="lineno"> 5641</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;nDOF_test_element;i++)</div>
<div class="line"><a name="l05642"></a><span class="lineno"> 5642</span>&#160;              {</div>
<div class="line"><a name="l05643"></a><span class="lineno"> 5643</span>&#160;                <span class="keyword">register</span> <span class="keywordtype">int</span> eN_i = eN*nDOF_test_element+i;</div>
<div class="line"><a name="l05644"></a><span class="lineno"> 5644</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0;j&lt;nDOF_trial_element;j++)</div>
<div class="line"><a name="l05645"></a><span class="lineno"> 5645</span>&#160;                  {</div>
<div class="line"><a name="l05646"></a><span class="lineno"> 5646</span>&#160;                    <span class="keyword">register</span> <span class="keywordtype">int</span> eN_i_j = eN_i*nDOF_trial_element+j;</div>
<div class="line"><a name="l05647"></a><span class="lineno"> 5647</span>&#160;                    globalJacobian[csrRowIndeces_p_p[eN_i] + csrColumnOffsets_p_p[eN_i_j]] += elementJacobian_p_p[i][j];</div>
<div class="line"><a name="l05648"></a><span class="lineno"> 5648</span>&#160;                  }</div>
<div class="line"><a name="l05649"></a><span class="lineno"> 5649</span>&#160;              }</div>
<div class="line"><a name="l05650"></a><span class="lineno"> 5650</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;nDOF_test_element;i++)</div>
<div class="line"><a name="l05651"></a><span class="lineno"> 5651</span>&#160;              {</div>
<div class="line"><a name="l05652"></a><span class="lineno"> 5652</span>&#160;                <span class="keyword">register</span> <span class="keywordtype">int</span> eN_i = eN*nDOF_test_element+i;</div>
<div class="line"><a name="l05653"></a><span class="lineno"> 5653</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0;j&lt;nDOF_v_trial_element;j++)</div>
<div class="line"><a name="l05654"></a><span class="lineno"> 5654</span>&#160;                  {</div>
<div class="line"><a name="l05655"></a><span class="lineno"> 5655</span>&#160;                    <span class="keyword">register</span> <span class="keywordtype">int</span> eN_i_j = eN_i*nDOF_v_trial_element+j;</div>
<div class="line"><a name="l05656"></a><span class="lineno"> 5656</span>&#160;                    globalJacobian[csrRowIndeces_p_u[eN_i] + csrColumnOffsets_p_u[eN_i_j]] += elementJacobian_p_u[i][j];</div>
<div class="line"><a name="l05657"></a><span class="lineno"> 5657</span>&#160;                    globalJacobian[csrRowIndeces_p_v[eN_i] + csrColumnOffsets_p_v[eN_i_j]] += elementJacobian_p_v[i][j];</div>
<div class="line"><a name="l05658"></a><span class="lineno"> 5658</span>&#160;                    globalJacobian[csrRowIndeces_p_w[eN_i] + csrColumnOffsets_p_w[eN_i_j]] += elementJacobian_p_w[i][j];</div>
<div class="line"><a name="l05659"></a><span class="lineno"> 5659</span>&#160;                  }</div>
<div class="line"><a name="l05660"></a><span class="lineno"> 5660</span>&#160;              }</div>
<div class="line"><a name="l05661"></a><span class="lineno"> 5661</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;nDOF_v_test_element;i++)</div>
<div class="line"><a name="l05662"></a><span class="lineno"> 5662</span>&#160;              {</div>
<div class="line"><a name="l05663"></a><span class="lineno"> 5663</span>&#160;                <span class="keyword">register</span> <span class="keywordtype">int</span> eN_i = eN*nDOF_v_test_element+i;</div>
<div class="line"><a name="l05664"></a><span class="lineno"> 5664</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0;j&lt;nDOF_trial_element;j++)</div>
<div class="line"><a name="l05665"></a><span class="lineno"> 5665</span>&#160;                  {</div>
<div class="line"><a name="l05666"></a><span class="lineno"> 5666</span>&#160;                    <span class="keyword">register</span> <span class="keywordtype">int</span> eN_i_j = eN_i*nDOF_trial_element+j;</div>
<div class="line"><a name="l05667"></a><span class="lineno"> 5667</span>&#160;                    globalJacobian[csrRowIndeces_u_p[eN_i] + csrColumnOffsets_u_p[eN_i_j]] += elementJacobian_u_p[i][j];</div>
<div class="line"><a name="l05668"></a><span class="lineno"> 5668</span>&#160;                    globalJacobian[csrRowIndeces_v_p[eN_i] + csrColumnOffsets_v_p[eN_i_j]] += elementJacobian_v_p[i][j];</div>
<div class="line"><a name="l05669"></a><span class="lineno"> 5669</span>&#160;                    globalJacobian[csrRowIndeces_w_p[eN_i] + csrColumnOffsets_w_p[eN_i_j]] += elementJacobian_w_p[i][j];</div>
<div class="line"><a name="l05670"></a><span class="lineno"> 5670</span>&#160;                  }</div>
<div class="line"><a name="l05671"></a><span class="lineno"> 5671</span>&#160;              }</div>
<div class="line"><a name="l05672"></a><span class="lineno"> 5672</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;nDOF_v_test_element;i++)</div>
<div class="line"><a name="l05673"></a><span class="lineno"> 5673</span>&#160;              {</div>
<div class="line"><a name="l05674"></a><span class="lineno"> 5674</span>&#160;                <span class="keyword">register</span> <span class="keywordtype">int</span> eN_i = eN*nDOF_v_test_element+i;</div>
<div class="line"><a name="l05675"></a><span class="lineno"> 5675</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0;j&lt;nDOF_v_trial_element;j++)</div>
<div class="line"><a name="l05676"></a><span class="lineno"> 5676</span>&#160;                  {</div>
<div class="line"><a name="l05677"></a><span class="lineno"> 5677</span>&#160;                    <span class="keyword">register</span> <span class="keywordtype">int</span> eN_i_j = eN_i*nDOF_v_trial_element+j;</div>
<div class="line"><a name="l05678"></a><span class="lineno"> 5678</span>&#160;                    globalJacobian[csrRowIndeces_u_u[eN_i] + csrColumnOffsets_u_u[eN_i_j]] += elementJacobian_u_u[i][j];</div>
<div class="line"><a name="l05679"></a><span class="lineno"> 5679</span>&#160;                    globalJacobian[csrRowIndeces_u_v[eN_i] + csrColumnOffsets_u_v[eN_i_j]] += elementJacobian_u_v[i][j];</div>
<div class="line"><a name="l05680"></a><span class="lineno"> 5680</span>&#160;                    globalJacobian[csrRowIndeces_u_w[eN_i] + csrColumnOffsets_u_w[eN_i_j]] += elementJacobian_u_w[i][j];</div>
<div class="line"><a name="l05681"></a><span class="lineno"> 5681</span>&#160; </div>
<div class="line"><a name="l05682"></a><span class="lineno"> 5682</span>&#160;                    globalJacobian[csrRowIndeces_v_u[eN_i] + csrColumnOffsets_v_u[eN_i_j]] += elementJacobian_v_u[i][j];</div>
<div class="line"><a name="l05683"></a><span class="lineno"> 5683</span>&#160;                    globalJacobian[csrRowIndeces_v_v[eN_i] + csrColumnOffsets_v_v[eN_i_j]] += elementJacobian_v_v[i][j];</div>
<div class="line"><a name="l05684"></a><span class="lineno"> 5684</span>&#160;                    globalJacobian[csrRowIndeces_v_w[eN_i] + csrColumnOffsets_v_w[eN_i_j]] += elementJacobian_v_w[i][j];</div>
<div class="line"><a name="l05685"></a><span class="lineno"> 5685</span>&#160; </div>
<div class="line"><a name="l05686"></a><span class="lineno"> 5686</span>&#160;                    globalJacobian[csrRowIndeces_w_u[eN_i] + csrColumnOffsets_w_u[eN_i_j]] += elementJacobian_w_u[i][j];</div>
<div class="line"><a name="l05687"></a><span class="lineno"> 5687</span>&#160;                    globalJacobian[csrRowIndeces_w_v[eN_i] + csrColumnOffsets_w_v[eN_i_j]] += elementJacobian_w_v[i][j];</div>
<div class="line"><a name="l05688"></a><span class="lineno"> 5688</span>&#160;                    globalJacobian[csrRowIndeces_w_w[eN_i] + csrColumnOffsets_w_w[eN_i_j]] += elementJacobian_w_w[i][j];</div>
<div class="line"><a name="l05689"></a><span class="lineno"> 5689</span>&#160;                  }<span class="comment">//j</span></div>
<div class="line"><a name="l05690"></a><span class="lineno"> 5690</span>&#160;              }<span class="comment">//i</span></div>
<div class="line"><a name="l05691"></a><span class="lineno"> 5691</span>&#160;          }<span class="comment">//elements</span></div>
<div class="line"><a name="l05692"></a><span class="lineno"> 5692</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l05693"></a><span class="lineno"> 5693</span>&#160;        <span class="comment">//loop over exterior element boundaries to compute the surface integrals and load them into the global Jacobian</span></div>
<div class="line"><a name="l05694"></a><span class="lineno"> 5694</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l05695"></a><span class="lineno"> 5695</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ebNE = 0; ebNE &lt; nExteriorElementBoundaries_global; ebNE++)</div>
<div class="line"><a name="l05696"></a><span class="lineno"> 5696</span>&#160;          {</div>
<div class="line"><a name="l05697"></a><span class="lineno"> 5697</span>&#160;            <span class="keyword">register</span> <span class="keywordtype">int</span> ebN = exteriorElementBoundariesArray[ebNE],</div>
<div class="line"><a name="l05698"></a><span class="lineno"> 5698</span>&#160;              eN  = elementBoundaryElementsArray[ebN*2+0],</div>
<div class="line"><a name="l05699"></a><span class="lineno"> 5699</span>&#160;              eN_nDOF_trial_element = eN*nDOF_trial_element,</div>
<div class="line"><a name="l05700"></a><span class="lineno"> 5700</span>&#160;              eN_nDOF_v_trial_element = eN*nDOF_v_trial_element,</div>
<div class="line"><a name="l05701"></a><span class="lineno"> 5701</span>&#160;              ebN_local = elementBoundaryLocalElementBoundariesArray[ebN*2+0];</div>
<div class="line"><a name="l05702"></a><span class="lineno"> 5702</span>&#160;            <span class="keyword">register</span> <span class="keywordtype">double</span> eps_rho,eps_mu;</div>
<div class="line"><a name="l05703"></a><span class="lineno"> 5703</span>&#160;            <span class="keywordflow">for</span>  (<span class="keywordtype">int</span> kb=0;kb&lt;nQuadraturePoints_elementBoundary;kb++)</div>
<div class="line"><a name="l05704"></a><span class="lineno"> 5704</span>&#160;              {</div>
<div class="line"><a name="l05705"></a><span class="lineno"> 5705</span>&#160;                <span class="keyword">register</span> <span class="keywordtype">int</span> ebNE_kb = ebNE*nQuadraturePoints_elementBoundary+kb,</div>
<div class="line"><a name="l05706"></a><span class="lineno"> 5706</span>&#160;                  ebNE_kb_nSpace = ebNE_kb*nSpace,</div>
<div class="line"><a name="l05707"></a><span class="lineno"> 5707</span>&#160;                  ebN_local_kb = ebN_local*nQuadraturePoints_elementBoundary+kb,</div>
<div class="line"><a name="l05708"></a><span class="lineno"> 5708</span>&#160;                  ebN_local_kb_nSpace = ebN_local_kb*nSpace;</div>
<div class="line"><a name="l05709"></a><span class="lineno"> 5709</span>&#160; </div>
<div class="line"><a name="l05710"></a><span class="lineno"> 5710</span>&#160;                <span class="keyword">register</span> <span class="keywordtype">double</span> p_ext=0.0,</div>
<div class="line"><a name="l05711"></a><span class="lineno"> 5711</span>&#160;                  u_ext=0.0,</div>
<div class="line"><a name="l05712"></a><span class="lineno"> 5712</span>&#160;                  v_ext=0.0,</div>
<div class="line"><a name="l05713"></a><span class="lineno"> 5713</span>&#160;                  w_ext=0.0,</div>
<div class="line"><a name="l05714"></a><span class="lineno"> 5714</span>&#160;                  grad_p_ext[nSpace],</div>
<div class="line"><a name="l05715"></a><span class="lineno"> 5715</span>&#160;                  grad_u_ext[nSpace],</div>
<div class="line"><a name="l05716"></a><span class="lineno"> 5716</span>&#160;                  grad_v_ext[nSpace],</div>
<div class="line"><a name="l05717"></a><span class="lineno"> 5717</span>&#160;                  grad_w_ext[nSpace],</div>
<div class="line"><a name="l05718"></a><span class="lineno"> 5718</span>&#160;                  p_old=0.0,u_old=0.0,v_old=0.0,w_old=0.0,</div>
<div class="line"><a name="l05719"></a><span class="lineno"> 5719</span>&#160;                  grad_p_old[nSpace],grad_u_old[nSpace],grad_v_old[nSpace],grad_w_old[nSpace],</div>
<div class="line"><a name="l05720"></a><span class="lineno"> 5720</span>&#160;                  mom_u_acc_ext=0.0,</div>
<div class="line"><a name="l05721"></a><span class="lineno"> 5721</span>&#160;                  dmom_u_acc_u_ext=0.0,</div>
<div class="line"><a name="l05722"></a><span class="lineno"> 5722</span>&#160;                  mom_v_acc_ext=0.0,</div>
<div class="line"><a name="l05723"></a><span class="lineno"> 5723</span>&#160;                  dmom_v_acc_v_ext=0.0,</div>
<div class="line"><a name="l05724"></a><span class="lineno"> 5724</span>&#160;                  mom_w_acc_ext=0.0,</div>
<div class="line"><a name="l05725"></a><span class="lineno"> 5725</span>&#160;                  dmom_w_acc_w_ext=0.0,</div>
<div class="line"><a name="l05726"></a><span class="lineno"> 5726</span>&#160;                  mass_adv_ext[nSpace],</div>
<div class="line"><a name="l05727"></a><span class="lineno"> 5727</span>&#160;                  dmass_adv_u_ext[nSpace],</div>
<div class="line"><a name="l05728"></a><span class="lineno"> 5728</span>&#160;                  dmass_adv_v_ext[nSpace],</div>
<div class="line"><a name="l05729"></a><span class="lineno"> 5729</span>&#160;                  dmass_adv_w_ext[nSpace],</div>
<div class="line"><a name="l05730"></a><span class="lineno"> 5730</span>&#160;                  mom_u_adv_ext[nSpace],</div>
<div class="line"><a name="l05731"></a><span class="lineno"> 5731</span>&#160;                  dmom_u_adv_u_ext[nSpace],</div>
<div class="line"><a name="l05732"></a><span class="lineno"> 5732</span>&#160;                  dmom_u_adv_v_ext[nSpace],</div>
<div class="line"><a name="l05733"></a><span class="lineno"> 5733</span>&#160;                  dmom_u_adv_w_ext[nSpace],</div>
<div class="line"><a name="l05734"></a><span class="lineno"> 5734</span>&#160;                  mom_v_adv_ext[nSpace],</div>
<div class="line"><a name="l05735"></a><span class="lineno"> 5735</span>&#160;                  dmom_v_adv_u_ext[nSpace],</div>
<div class="line"><a name="l05736"></a><span class="lineno"> 5736</span>&#160;                  dmom_v_adv_v_ext[nSpace],</div>
<div class="line"><a name="l05737"></a><span class="lineno"> 5737</span>&#160;                  dmom_v_adv_w_ext[nSpace],</div>
<div class="line"><a name="l05738"></a><span class="lineno"> 5738</span>&#160;                  mom_w_adv_ext[nSpace],</div>
<div class="line"><a name="l05739"></a><span class="lineno"> 5739</span>&#160;                  dmom_w_adv_u_ext[nSpace],</div>
<div class="line"><a name="l05740"></a><span class="lineno"> 5740</span>&#160;                  dmom_w_adv_v_ext[nSpace],</div>
<div class="line"><a name="l05741"></a><span class="lineno"> 5741</span>&#160;                  dmom_w_adv_w_ext[nSpace],</div>
<div class="line"><a name="l05742"></a><span class="lineno"> 5742</span>&#160;                  mom_uu_diff_ten_ext[nSpace],</div>
<div class="line"><a name="l05743"></a><span class="lineno"> 5743</span>&#160;                  mom_vv_diff_ten_ext[nSpace],</div>
<div class="line"><a name="l05744"></a><span class="lineno"> 5744</span>&#160;                  mom_ww_diff_ten_ext[nSpace],</div>
<div class="line"><a name="l05745"></a><span class="lineno"> 5745</span>&#160;                  mom_uv_diff_ten_ext[1],</div>
<div class="line"><a name="l05746"></a><span class="lineno"> 5746</span>&#160;                  mom_uw_diff_ten_ext[1],</div>
<div class="line"><a name="l05747"></a><span class="lineno"> 5747</span>&#160;                  mom_vu_diff_ten_ext[1],</div>
<div class="line"><a name="l05748"></a><span class="lineno"> 5748</span>&#160;                  mom_vw_diff_ten_ext[1],</div>
<div class="line"><a name="l05749"></a><span class="lineno"> 5749</span>&#160;                  mom_wu_diff_ten_ext[1],</div>
<div class="line"><a name="l05750"></a><span class="lineno"> 5750</span>&#160;                  mom_wv_diff_ten_ext[1],</div>
<div class="line"><a name="l05751"></a><span class="lineno"> 5751</span>&#160;                  mom_u_source_ext=0.0,</div>
<div class="line"><a name="l05752"></a><span class="lineno"> 5752</span>&#160;                  mom_v_source_ext=0.0,</div>
<div class="line"><a name="l05753"></a><span class="lineno"> 5753</span>&#160;                  mom_w_source_ext=0.0,</div>
<div class="line"><a name="l05754"></a><span class="lineno"> 5754</span>&#160;                  mom_u_ham_ext=0.0,</div>
<div class="line"><a name="l05755"></a><span class="lineno"> 5755</span>&#160;                  dmom_u_ham_grad_p_ext[nSpace],</div>
<div class="line"><a name="l05756"></a><span class="lineno"> 5756</span>&#160;                  dmom_u_ham_grad_u_ext[nSpace],</div>
<div class="line"><a name="l05757"></a><span class="lineno"> 5757</span>&#160;                  dmom_u_ham_u_ext=0.0,</div>
<div class="line"><a name="l05758"></a><span class="lineno"> 5758</span>&#160;                  dmom_u_ham_v_ext=0.0,</div>
<div class="line"><a name="l05759"></a><span class="lineno"> 5759</span>&#160;                  dmom_u_ham_w_ext=0.0,</div>
<div class="line"><a name="l05760"></a><span class="lineno"> 5760</span>&#160;                  mom_v_ham_ext=0.0,</div>
<div class="line"><a name="l05761"></a><span class="lineno"> 5761</span>&#160;                  dmom_v_ham_grad_p_ext[nSpace],</div>
<div class="line"><a name="l05762"></a><span class="lineno"> 5762</span>&#160;                  dmom_v_ham_grad_v_ext[nSpace],</div>
<div class="line"><a name="l05763"></a><span class="lineno"> 5763</span>&#160;                  dmom_v_ham_u_ext=0.0,</div>
<div class="line"><a name="l05764"></a><span class="lineno"> 5764</span>&#160;                  dmom_v_ham_v_ext=0.0,</div>
<div class="line"><a name="l05765"></a><span class="lineno"> 5765</span>&#160;                  dmom_v_ham_w_ext=0.0,</div>
<div class="line"><a name="l05766"></a><span class="lineno"> 5766</span>&#160;                  mom_w_ham_ext=0.0,</div>
<div class="line"><a name="l05767"></a><span class="lineno"> 5767</span>&#160;                  dmom_w_ham_grad_p_ext[nSpace],</div>
<div class="line"><a name="l05768"></a><span class="lineno"> 5768</span>&#160;                  dmom_w_ham_grad_w_ext[nSpace],</div>
<div class="line"><a name="l05769"></a><span class="lineno"> 5769</span>&#160;                  dmom_w_ham_u_ext=0.0,</div>
<div class="line"><a name="l05770"></a><span class="lineno"> 5770</span>&#160;                  dmom_w_ham_v_ext=0.0,</div>
<div class="line"><a name="l05771"></a><span class="lineno"> 5771</span>&#160;                  dmom_w_ham_w_ext=0.0,</div>
<div class="line"><a name="l05772"></a><span class="lineno"> 5772</span>&#160;                  dmom_u_adv_p_ext[nSpace],</div>
<div class="line"><a name="l05773"></a><span class="lineno"> 5773</span>&#160;                  dmom_v_adv_p_ext[nSpace],</div>
<div class="line"><a name="l05774"></a><span class="lineno"> 5774</span>&#160;                  dmom_w_adv_p_ext[nSpace],</div>
<div class="line"><a name="l05775"></a><span class="lineno"> 5775</span>&#160;                  dflux_mass_u_ext=0.0,</div>
<div class="line"><a name="l05776"></a><span class="lineno"> 5776</span>&#160;                  dflux_mass_v_ext=0.0,</div>
<div class="line"><a name="l05777"></a><span class="lineno"> 5777</span>&#160;                  dflux_mass_w_ext=0.0,</div>
<div class="line"><a name="l05778"></a><span class="lineno"> 5778</span>&#160;                  dflux_mom_u_adv_p_ext=0.0,</div>
<div class="line"><a name="l05779"></a><span class="lineno"> 5779</span>&#160;                  dflux_mom_u_adv_u_ext=0.0,</div>
<div class="line"><a name="l05780"></a><span class="lineno"> 5780</span>&#160;                  dflux_mom_u_adv_v_ext=0.0,</div>
<div class="line"><a name="l05781"></a><span class="lineno"> 5781</span>&#160;                  dflux_mom_u_adv_w_ext=0.0,</div>
<div class="line"><a name="l05782"></a><span class="lineno"> 5782</span>&#160;                  dflux_mom_v_adv_p_ext=0.0,</div>
<div class="line"><a name="l05783"></a><span class="lineno"> 5783</span>&#160;                  dflux_mom_v_adv_u_ext=0.0,</div>
<div class="line"><a name="l05784"></a><span class="lineno"> 5784</span>&#160;                  dflux_mom_v_adv_v_ext=0.0,</div>
<div class="line"><a name="l05785"></a><span class="lineno"> 5785</span>&#160;                  dflux_mom_v_adv_w_ext=0.0,</div>
<div class="line"><a name="l05786"></a><span class="lineno"> 5786</span>&#160;                  dflux_mom_w_adv_p_ext=0.0,</div>
<div class="line"><a name="l05787"></a><span class="lineno"> 5787</span>&#160;                  dflux_mom_w_adv_u_ext=0.0,</div>
<div class="line"><a name="l05788"></a><span class="lineno"> 5788</span>&#160;                  dflux_mom_w_adv_v_ext=0.0,</div>
<div class="line"><a name="l05789"></a><span class="lineno"> 5789</span>&#160;                  dflux_mom_w_adv_w_ext=0.0,</div>
<div class="line"><a name="l05790"></a><span class="lineno"> 5790</span>&#160;                  bc_p_ext=0.0,</div>
<div class="line"><a name="l05791"></a><span class="lineno"> 5791</span>&#160;                  bc_u_ext=0.0,</div>
<div class="line"><a name="l05792"></a><span class="lineno"> 5792</span>&#160;                  bc_v_ext=0.0,</div>
<div class="line"><a name="l05793"></a><span class="lineno"> 5793</span>&#160;                  bc_w_ext=0.0,</div>
<div class="line"><a name="l05794"></a><span class="lineno"> 5794</span>&#160;                  bc_mom_u_acc_ext=0.0,</div>
<div class="line"><a name="l05795"></a><span class="lineno"> 5795</span>&#160;                  bc_dmom_u_acc_u_ext=0.0,</div>
<div class="line"><a name="l05796"></a><span class="lineno"> 5796</span>&#160;                  bc_mom_v_acc_ext=0.0,</div>
<div class="line"><a name="l05797"></a><span class="lineno"> 5797</span>&#160;                  bc_dmom_v_acc_v_ext=0.0,</div>
<div class="line"><a name="l05798"></a><span class="lineno"> 5798</span>&#160;                  bc_mom_w_acc_ext=0.0,</div>
<div class="line"><a name="l05799"></a><span class="lineno"> 5799</span>&#160;                  bc_dmom_w_acc_w_ext=0.0,</div>
<div class="line"><a name="l05800"></a><span class="lineno"> 5800</span>&#160;                  bc_mass_adv_ext[nSpace],</div>
<div class="line"><a name="l05801"></a><span class="lineno"> 5801</span>&#160;                  bc_dmass_adv_u_ext[nSpace],</div>
<div class="line"><a name="l05802"></a><span class="lineno"> 5802</span>&#160;                  bc_dmass_adv_v_ext[nSpace],</div>
<div class="line"><a name="l05803"></a><span class="lineno"> 5803</span>&#160;                  bc_dmass_adv_w_ext[nSpace],</div>
<div class="line"><a name="l05804"></a><span class="lineno"> 5804</span>&#160;                  bc_mom_u_adv_ext[nSpace],</div>
<div class="line"><a name="l05805"></a><span class="lineno"> 5805</span>&#160;                  bc_dmom_u_adv_u_ext[nSpace],</div>
<div class="line"><a name="l05806"></a><span class="lineno"> 5806</span>&#160;                  bc_dmom_u_adv_v_ext[nSpace],</div>
<div class="line"><a name="l05807"></a><span class="lineno"> 5807</span>&#160;                  bc_dmom_u_adv_w_ext[nSpace],</div>
<div class="line"><a name="l05808"></a><span class="lineno"> 5808</span>&#160;                  bc_mom_v_adv_ext[nSpace],</div>
<div class="line"><a name="l05809"></a><span class="lineno"> 5809</span>&#160;                  bc_dmom_v_adv_u_ext[nSpace],</div>
<div class="line"><a name="l05810"></a><span class="lineno"> 5810</span>&#160;                  bc_dmom_v_adv_v_ext[nSpace],</div>
<div class="line"><a name="l05811"></a><span class="lineno"> 5811</span>&#160;                  bc_dmom_v_adv_w_ext[nSpace],</div>
<div class="line"><a name="l05812"></a><span class="lineno"> 5812</span>&#160;                  bc_mom_w_adv_ext[nSpace],</div>
<div class="line"><a name="l05813"></a><span class="lineno"> 5813</span>&#160;                  bc_dmom_w_adv_u_ext[nSpace],</div>
<div class="line"><a name="l05814"></a><span class="lineno"> 5814</span>&#160;                  bc_dmom_w_adv_v_ext[nSpace],</div>
<div class="line"><a name="l05815"></a><span class="lineno"> 5815</span>&#160;                  bc_dmom_w_adv_w_ext[nSpace],</div>
<div class="line"><a name="l05816"></a><span class="lineno"> 5816</span>&#160;                  bc_mom_uu_diff_ten_ext[nSpace],</div>
<div class="line"><a name="l05817"></a><span class="lineno"> 5817</span>&#160;                  bc_mom_vv_diff_ten_ext[nSpace],</div>
<div class="line"><a name="l05818"></a><span class="lineno"> 5818</span>&#160;                  bc_mom_ww_diff_ten_ext[nSpace],</div>
<div class="line"><a name="l05819"></a><span class="lineno"> 5819</span>&#160;                  bc_mom_uv_diff_ten_ext[1],</div>
<div class="line"><a name="l05820"></a><span class="lineno"> 5820</span>&#160;                  bc_mom_uw_diff_ten_ext[1],</div>
<div class="line"><a name="l05821"></a><span class="lineno"> 5821</span>&#160;                  bc_mom_vu_diff_ten_ext[1],</div>
<div class="line"><a name="l05822"></a><span class="lineno"> 5822</span>&#160;                  bc_mom_vw_diff_ten_ext[1],</div>
<div class="line"><a name="l05823"></a><span class="lineno"> 5823</span>&#160;                  bc_mom_wu_diff_ten_ext[1],</div>
<div class="line"><a name="l05824"></a><span class="lineno"> 5824</span>&#160;                  bc_mom_wv_diff_ten_ext[1],</div>
<div class="line"><a name="l05825"></a><span class="lineno"> 5825</span>&#160;                  bc_mom_u_source_ext=0.0,</div>
<div class="line"><a name="l05826"></a><span class="lineno"> 5826</span>&#160;                  bc_mom_v_source_ext=0.0,</div>
<div class="line"><a name="l05827"></a><span class="lineno"> 5827</span>&#160;                  bc_mom_w_source_ext=0.0,</div>
<div class="line"><a name="l05828"></a><span class="lineno"> 5828</span>&#160;                  bc_mom_u_ham_ext=0.0,</div>
<div class="line"><a name="l05829"></a><span class="lineno"> 5829</span>&#160;                  bc_dmom_u_ham_grad_p_ext[nSpace],</div>
<div class="line"><a name="l05830"></a><span class="lineno"> 5830</span>&#160;                  bc_dmom_u_ham_grad_u_ext[nSpace],</div>
<div class="line"><a name="l05831"></a><span class="lineno"> 5831</span>&#160;                  bc_dmom_u_ham_u_ext=0.0,</div>
<div class="line"><a name="l05832"></a><span class="lineno"> 5832</span>&#160;                  bc_dmom_u_ham_v_ext=0.0,</div>
<div class="line"><a name="l05833"></a><span class="lineno"> 5833</span>&#160;                  bc_dmom_u_ham_w_ext=0.0,</div>
<div class="line"><a name="l05834"></a><span class="lineno"> 5834</span>&#160;                  bc_mom_v_ham_ext=0.0,</div>
<div class="line"><a name="l05835"></a><span class="lineno"> 5835</span>&#160;                  bc_dmom_v_ham_grad_p_ext[nSpace],</div>
<div class="line"><a name="l05836"></a><span class="lineno"> 5836</span>&#160;                  bc_dmom_v_ham_grad_v_ext[nSpace],</div>
<div class="line"><a name="l05837"></a><span class="lineno"> 5837</span>&#160;                  bc_dmom_v_ham_u_ext=0.0,</div>
<div class="line"><a name="l05838"></a><span class="lineno"> 5838</span>&#160;                  bc_dmom_v_ham_v_ext=0.0,</div>
<div class="line"><a name="l05839"></a><span class="lineno"> 5839</span>&#160;                  bc_dmom_v_ham_w_ext=0.0,</div>
<div class="line"><a name="l05840"></a><span class="lineno"> 5840</span>&#160;                  bc_mom_w_ham_ext=0.0,</div>
<div class="line"><a name="l05841"></a><span class="lineno"> 5841</span>&#160;                  bc_dmom_w_ham_grad_p_ext[nSpace],</div>
<div class="line"><a name="l05842"></a><span class="lineno"> 5842</span>&#160;                  bc_dmom_w_ham_grad_w_ext[nSpace],</div>
<div class="line"><a name="l05843"></a><span class="lineno"> 5843</span>&#160;                  bc_dmom_w_ham_u_ext=0.0,</div>
<div class="line"><a name="l05844"></a><span class="lineno"> 5844</span>&#160;                  bc_dmom_w_ham_v_ext=0.0,</div>
<div class="line"><a name="l05845"></a><span class="lineno"> 5845</span>&#160;                  bc_dmom_w_ham_w_ext=0.0,</div>
<div class="line"><a name="l05846"></a><span class="lineno"> 5846</span>&#160;                  fluxJacobian_p_p[nDOF_trial_element],</div>
<div class="line"><a name="l05847"></a><span class="lineno"> 5847</span>&#160;                  fluxJacobian_p_u[nDOF_v_trial_element],</div>
<div class="line"><a name="l05848"></a><span class="lineno"> 5848</span>&#160;                  fluxJacobian_p_v[nDOF_v_trial_element],</div>
<div class="line"><a name="l05849"></a><span class="lineno"> 5849</span>&#160;                  fluxJacobian_p_w[nDOF_v_trial_element],</div>
<div class="line"><a name="l05850"></a><span class="lineno"> 5850</span>&#160;                  fluxJacobian_u_p[nDOF_trial_element],</div>
<div class="line"><a name="l05851"></a><span class="lineno"> 5851</span>&#160;                  fluxJacobian_u_u[nDOF_v_trial_element],</div>
<div class="line"><a name="l05852"></a><span class="lineno"> 5852</span>&#160;                  fluxJacobian_u_v[nDOF_v_trial_element],</div>
<div class="line"><a name="l05853"></a><span class="lineno"> 5853</span>&#160;                  fluxJacobian_u_w[nDOF_v_trial_element],</div>
<div class="line"><a name="l05854"></a><span class="lineno"> 5854</span>&#160;                  fluxJacobian_v_p[nDOF_trial_element],</div>
<div class="line"><a name="l05855"></a><span class="lineno"> 5855</span>&#160;                  fluxJacobian_v_u[nDOF_v_trial_element],</div>
<div class="line"><a name="l05856"></a><span class="lineno"> 5856</span>&#160;                  fluxJacobian_v_v[nDOF_v_trial_element],</div>
<div class="line"><a name="l05857"></a><span class="lineno"> 5857</span>&#160;                  fluxJacobian_v_w[nDOF_v_trial_element],</div>
<div class="line"><a name="l05858"></a><span class="lineno"> 5858</span>&#160;                  fluxJacobian_w_p[nDOF_trial_element],</div>
<div class="line"><a name="l05859"></a><span class="lineno"> 5859</span>&#160;                  fluxJacobian_w_u[nDOF_v_trial_element],</div>
<div class="line"><a name="l05860"></a><span class="lineno"> 5860</span>&#160;                  fluxJacobian_w_v[nDOF_v_trial_element],</div>
<div class="line"><a name="l05861"></a><span class="lineno"> 5861</span>&#160;                  fluxJacobian_w_w[nDOF_v_trial_element],</div>
<div class="line"><a name="l05862"></a><span class="lineno"> 5862</span>&#160;                  jac_ext[nSpace*nSpace],</div>
<div class="line"><a name="l05863"></a><span class="lineno"> 5863</span>&#160;                  jacDet_ext,</div>
<div class="line"><a name="l05864"></a><span class="lineno"> 5864</span>&#160;                  jacInv_ext[nSpace*nSpace],</div>
<div class="line"><a name="l05865"></a><span class="lineno"> 5865</span>&#160;                  boundaryJac[nSpace*(nSpace-1)],</div>
<div class="line"><a name="l05866"></a><span class="lineno"> 5866</span>&#160;                  metricTensor[(nSpace-1)*(nSpace-1)],</div>
<div class="line"><a name="l05867"></a><span class="lineno"> 5867</span>&#160;                  metricTensorDetSqrt,</div>
<div class="line"><a name="l05868"></a><span class="lineno"> 5868</span>&#160;                  p_grad_trial_trace[nDOF_trial_element*nSpace],</div>
<div class="line"><a name="l05869"></a><span class="lineno"> 5869</span>&#160;                  vel_grad_trial_trace[nDOF_v_trial_element*nSpace],</div>
<div class="line"><a name="l05870"></a><span class="lineno"> 5870</span>&#160;                  dS,</div>
<div class="line"><a name="l05871"></a><span class="lineno"> 5871</span>&#160;                  p_test_dS[nDOF_test_element],</div>
<div class="line"><a name="l05872"></a><span class="lineno"> 5872</span>&#160;                  vel_test_dS[nDOF_v_test_element],</div>
<div class="line"><a name="l05873"></a><span class="lineno"> 5873</span>&#160;                  normal[2],</div>
<div class="line"><a name="l05874"></a><span class="lineno"> 5874</span>&#160;                  x_ext,y_ext,z_ext,xt_ext,yt_ext,zt_ext,integralScaling,</div>
<div class="line"><a name="l05875"></a><span class="lineno"> 5875</span>&#160;                  vel_grad_test_dS[nDOF_v_trial_element*nSpace],</div>
<div class="line"><a name="l05876"></a><span class="lineno"> 5876</span>&#160;                  <span class="comment">//VRANS</span></div>
<div class="line"><a name="l05877"></a><span class="lineno"> 5877</span>&#160;                  porosity_ext,</div>
<div class="line"><a name="l05878"></a><span class="lineno"> 5878</span>&#160;                  <span class="comment">//</span></div>
<div class="line"><a name="l05879"></a><span class="lineno"> 5879</span>&#160;                  G[nSpace*nSpace],G_dd_G,tr_G,h_phi,h_penalty,penalty;</div>
<div class="line"><a name="l05880"></a><span class="lineno"> 5880</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.calculateMapping_elementBoundary(eN,</div>
<div class="line"><a name="l05881"></a><span class="lineno"> 5881</span>&#160;                                                    ebN_local,</div>
<div class="line"><a name="l05882"></a><span class="lineno"> 5882</span>&#160;                                                    kb,</div>
<div class="line"><a name="l05883"></a><span class="lineno"> 5883</span>&#160;                                                    ebN_local_kb,</div>
<div class="line"><a name="l05884"></a><span class="lineno"> 5884</span>&#160;                                                    mesh_dof,</div>
<div class="line"><a name="l05885"></a><span class="lineno"> 5885</span>&#160;                                                    mesh_l2g,</div>
<div class="line"><a name="l05886"></a><span class="lineno"> 5886</span>&#160;                                                    mesh_trial_trace_ref,</div>
<div class="line"><a name="l05887"></a><span class="lineno"> 5887</span>&#160;                                                    mesh_grad_trial_trace_ref,</div>
<div class="line"><a name="l05888"></a><span class="lineno"> 5888</span>&#160;                                                    boundaryJac_ref,</div>
<div class="line"><a name="l05889"></a><span class="lineno"> 5889</span>&#160;                                                    jac_ext,</div>
<div class="line"><a name="l05890"></a><span class="lineno"> 5890</span>&#160;                                                    jacDet_ext,</div>
<div class="line"><a name="l05891"></a><span class="lineno"> 5891</span>&#160;                                                    jacInv_ext,</div>
<div class="line"><a name="l05892"></a><span class="lineno"> 5892</span>&#160;                                                    boundaryJac,</div>
<div class="line"><a name="l05893"></a><span class="lineno"> 5893</span>&#160;                                                    metricTensor,</div>
<div class="line"><a name="l05894"></a><span class="lineno"> 5894</span>&#160;                                                    metricTensorDetSqrt,</div>
<div class="line"><a name="l05895"></a><span class="lineno"> 5895</span>&#160;                                                    normal_ref,</div>
<div class="line"><a name="l05896"></a><span class="lineno"> 5896</span>&#160;                                                    normal,</div>
<div class="line"><a name="l05897"></a><span class="lineno"> 5897</span>&#160;                                                    x_ext,y_ext,z_ext);</div>
<div class="line"><a name="l05898"></a><span class="lineno"> 5898</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.calculateMappingVelocity_elementBoundary(eN,</div>
<div class="line"><a name="l05899"></a><span class="lineno"> 5899</span>&#160;                                                            ebN_local,</div>
<div class="line"><a name="l05900"></a><span class="lineno"> 5900</span>&#160;                                                            kb,</div>
<div class="line"><a name="l05901"></a><span class="lineno"> 5901</span>&#160;                                                            ebN_local_kb,</div>
<div class="line"><a name="l05902"></a><span class="lineno"> 5902</span>&#160;                                                            mesh_velocity_dof,</div>
<div class="line"><a name="l05903"></a><span class="lineno"> 5903</span>&#160;                                                            mesh_l2g,</div>
<div class="line"><a name="l05904"></a><span class="lineno"> 5904</span>&#160;                                                            mesh_trial_trace_ref,</div>
<div class="line"><a name="l05905"></a><span class="lineno"> 5905</span>&#160;                                                            xt_ext,yt_ext,zt_ext,</div>
<div class="line"><a name="l05906"></a><span class="lineno"> 5906</span>&#160;                                                            normal,</div>
<div class="line"><a name="l05907"></a><span class="lineno"> 5907</span>&#160;                                                            boundaryJac,</div>
<div class="line"><a name="l05908"></a><span class="lineno"> 5908</span>&#160;                                                            metricTensor,</div>
<div class="line"><a name="l05909"></a><span class="lineno"> 5909</span>&#160;                                                            integralScaling);</div>
<div class="line"><a name="l05910"></a><span class="lineno"> 5910</span>&#160;                <span class="comment">//dS = ((1.0-MOVING_DOMAIN)*metricTensorDetSqrt + MOVING_DOMAIN*integralScaling)*dS_ref[kb];</span></div>
<div class="line"><a name="l05911"></a><span class="lineno"> 5911</span>&#160;                dS = metricTensorDetSqrt*dS_ref[kb];</div>
<div class="line"><a name="l05912"></a><span class="lineno"> 5912</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.calculateG(jacInv_ext,G,G_dd_G,tr_G);</div>
<div class="line"><a name="l05913"></a><span class="lineno"> 5913</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.calculateGScale(G,&amp;ebqe_normal_phi_ext[ebNE_kb_nSpace],h_phi);</div>
<div class="line"><a name="l05914"></a><span class="lineno"> 5914</span>&#160; </div>
<div class="line"><a name="l05915"></a><span class="lineno"> 5915</span>&#160;                eps_rho = epsFact_rho*(useMetrics*h_phi+(1.0-useMetrics)*elementDiameter[eN]);</div>
<div class="line"><a name="l05916"></a><span class="lineno"> 5916</span>&#160;                eps_mu  = epsFact_mu *(useMetrics*h_phi+(1.0-useMetrics)*elementDiameter[eN]);</div>
<div class="line"><a name="l05917"></a><span class="lineno"> 5917</span>&#160; </div>
<div class="line"><a name="l05918"></a><span class="lineno"> 5918</span>&#160;                <span class="comment">//compute shape and solution information</span></div>
<div class="line"><a name="l05919"></a><span class="lineno"> 5919</span>&#160;                <span class="comment">//shape</span></div>
<div class="line"><a name="l05920"></a><span class="lineno"> 5920</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.gradTrialFromRef(&amp;p_grad_trial_trace_ref[ebN_local_kb_nSpace*nDOF_trial_element],jacInv_ext,p_grad_trial_trace);</div>
<div class="line"><a name="l05921"></a><span class="lineno"> 5921</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a7a7848813d299e5d43a0c4872556a476">ck_v</a>.gradTrialFromRef(&amp;vel_grad_trial_trace_ref[ebN_local_kb_nSpace*nDOF_v_trial_element],jacInv_ext,vel_grad_trial_trace);</div>
<div class="line"><a name="l05922"></a><span class="lineno"> 5922</span>&#160;                <span class="comment">//solution and gradients</span></div>
<div class="line"><a name="l05923"></a><span class="lineno"> 5923</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.valFromDOF(p_dof,&amp;p_l2g[eN_nDOF_trial_element],&amp;p_trial_trace_ref[ebN_local_kb*nDOF_test_element],p_ext);</div>
<div class="line"><a name="l05924"></a><span class="lineno"> 5924</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a7a7848813d299e5d43a0c4872556a476">ck_v</a>.valFromDOF(u_dof,&amp;vel_l2g[eN_nDOF_v_trial_element],&amp;vel_trial_trace_ref[ebN_local_kb*nDOF_v_test_element],u_ext);</div>
<div class="line"><a name="l05925"></a><span class="lineno"> 5925</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a7a7848813d299e5d43a0c4872556a476">ck_v</a>.valFromDOF(v_dof,&amp;vel_l2g[eN_nDOF_v_trial_element],&amp;vel_trial_trace_ref[ebN_local_kb*nDOF_v_test_element],v_ext);</div>
<div class="line"><a name="l05926"></a><span class="lineno"> 5926</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a7a7848813d299e5d43a0c4872556a476">ck_v</a>.valFromDOF(w_dof,&amp;vel_l2g[eN_nDOF_v_trial_element],&amp;vel_trial_trace_ref[ebN_local_kb*nDOF_v_test_element],w_ext);</div>
<div class="line"><a name="l05927"></a><span class="lineno"> 5927</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.valFromDOF(p_old_dof,&amp;p_l2g[eN_nDOF_trial_element],&amp;p_trial_trace_ref[ebN_local_kb*nDOF_test_element],p_old);</div>
<div class="line"><a name="l05928"></a><span class="lineno"> 5928</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a7a7848813d299e5d43a0c4872556a476">ck_v</a>.valFromDOF(u_old_dof,&amp;vel_l2g[eN_nDOF_v_trial_element],&amp;vel_trial_trace_ref[ebN_local_kb*nDOF_v_test_element],u_old);</div>
<div class="line"><a name="l05929"></a><span class="lineno"> 5929</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a7a7848813d299e5d43a0c4872556a476">ck_v</a>.valFromDOF(v_old_dof,&amp;vel_l2g[eN_nDOF_v_trial_element],&amp;vel_trial_trace_ref[ebN_local_kb*nDOF_v_test_element],v_old);</div>
<div class="line"><a name="l05930"></a><span class="lineno"> 5930</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a7a7848813d299e5d43a0c4872556a476">ck_v</a>.valFromDOF(w_old_dof,&amp;vel_l2g[eN_nDOF_v_trial_element],&amp;vel_trial_trace_ref[ebN_local_kb*nDOF_v_test_element],w_old);</div>
<div class="line"><a name="l05931"></a><span class="lineno"> 5931</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.gradFromDOF(p_dof,&amp;p_l2g[eN_nDOF_trial_element],p_grad_trial_trace,grad_p_ext);</div>
<div class="line"><a name="l05932"></a><span class="lineno"> 5932</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a7a7848813d299e5d43a0c4872556a476">ck_v</a>.gradFromDOF(u_dof,&amp;vel_l2g[eN_nDOF_v_trial_element],vel_grad_trial_trace,grad_u_ext);</div>
<div class="line"><a name="l05933"></a><span class="lineno"> 5933</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a7a7848813d299e5d43a0c4872556a476">ck_v</a>.gradFromDOF(v_dof,&amp;vel_l2g[eN_nDOF_v_trial_element],vel_grad_trial_trace,grad_v_ext);</div>
<div class="line"><a name="l05934"></a><span class="lineno"> 5934</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a7a7848813d299e5d43a0c4872556a476">ck_v</a>.gradFromDOF(w_dof,&amp;vel_l2g[eN_nDOF_v_trial_element],vel_grad_trial_trace,grad_w_ext);</div>
<div class="line"><a name="l05935"></a><span class="lineno"> 5935</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.gradFromDOF(p_old_dof,&amp;p_l2g[eN_nDOF_trial_element],p_grad_trial_trace,grad_p_old);</div>
<div class="line"><a name="l05936"></a><span class="lineno"> 5936</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a7a7848813d299e5d43a0c4872556a476">ck_v</a>.gradFromDOF(u_old_dof,&amp;vel_l2g[eN_nDOF_v_trial_element],vel_grad_trial_trace,grad_u_old);</div>
<div class="line"><a name="l05937"></a><span class="lineno"> 5937</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a7a7848813d299e5d43a0c4872556a476">ck_v</a>.gradFromDOF(v_old_dof,&amp;vel_l2g[eN_nDOF_v_trial_element],vel_grad_trial_trace,grad_v_old);</div>
<div class="line"><a name="l05938"></a><span class="lineno"> 5938</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a7a7848813d299e5d43a0c4872556a476">ck_v</a>.gradFromDOF(w_old_dof,&amp;vel_l2g[eN_nDOF_v_trial_element],vel_grad_trial_trace,grad_w_old);</div>
<div class="line"><a name="l05939"></a><span class="lineno"> 5939</span>&#160;                <span class="comment">//precalculate test function products with integration weights</span></div>
<div class="line"><a name="l05940"></a><span class="lineno"> 5940</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0;j&lt;nDOF_test_element;j++)</div>
<div class="line"><a name="l05941"></a><span class="lineno"> 5941</span>&#160;                  {</div>
<div class="line"><a name="l05942"></a><span class="lineno"> 5942</span>&#160;                    p_test_dS[j] = p_test_trace_ref[ebN_local_kb*nDOF_test_element+j]*dS;</div>
<div class="line"><a name="l05943"></a><span class="lineno"> 5943</span>&#160;                  }</div>
<div class="line"><a name="l05944"></a><span class="lineno"> 5944</span>&#160;                <span class="comment">//precalculate test function products with integration weights</span></div>
<div class="line"><a name="l05945"></a><span class="lineno"> 5945</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0;j&lt;nDOF_v_test_element;j++)</div>
<div class="line"><a name="l05946"></a><span class="lineno"> 5946</span>&#160;                  {</div>
<div class="line"><a name="l05947"></a><span class="lineno"> 5947</span>&#160;                    vel_test_dS[j] = vel_test_trace_ref[ebN_local_kb*nDOF_v_test_element+j]*dS;</div>
<div class="line"><a name="l05948"></a><span class="lineno"> 5948</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> I=0;I&lt;nSpace;I++)</div>
<div class="line"><a name="l05949"></a><span class="lineno"> 5949</span>&#160;                      vel_grad_test_dS[j*nSpace+I] = vel_grad_trial_trace[j*nSpace+I]*dS;<span class="comment">//assume test_j == trial_j</span></div>
<div class="line"><a name="l05950"></a><span class="lineno"> 5950</span>&#160;                  }</div>
<div class="line"><a name="l05951"></a><span class="lineno"> 5951</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l05952"></a><span class="lineno"> 5952</span>&#160;                <span class="comment">//load the boundary values</span></div>
<div class="line"><a name="l05953"></a><span class="lineno"> 5953</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l05954"></a><span class="lineno"> 5954</span>&#160;                bc_p_ext = isDOFBoundary_p[ebNE_kb]*ebqe_bc_p_ext[ebNE_kb]+(1-isDOFBoundary_p[ebNE_kb])*p_ext;</div>
<div class="line"><a name="l05955"></a><span class="lineno"> 5955</span>&#160;                <span class="comment">//bc values at moving boundaries are specified relative to boundary motion so we need to add it here</span></div>
<div class="line"><a name="l05956"></a><span class="lineno"> 5956</span>&#160;                bc_u_ext = isDOFBoundary_u[ebNE_kb]*(ebqe_bc_u_ext[ebNE_kb] + MOVING_DOMAIN*xt_ext) + (1-isDOFBoundary_u[ebNE_kb])*u_ext;</div>
<div class="line"><a name="l05957"></a><span class="lineno"> 5957</span>&#160;                bc_v_ext = isDOFBoundary_v[ebNE_kb]*(ebqe_bc_v_ext[ebNE_kb] + MOVING_DOMAIN*yt_ext) + (1-isDOFBoundary_v[ebNE_kb])*v_ext;</div>
<div class="line"><a name="l05958"></a><span class="lineno"> 5958</span>&#160;                bc_w_ext = isDOFBoundary_w[ebNE_kb]*(ebqe_bc_w_ext[ebNE_kb] + MOVING_DOMAIN*zt_ext) + (1-isDOFBoundary_w[ebNE_kb])*w_ext;</div>
<div class="line"><a name="l05959"></a><span class="lineno"> 5959</span>&#160;                <span class="comment">//VRANS</span></div>
<div class="line"><a name="l05960"></a><span class="lineno"> 5960</span>&#160;                porosity_ext = ebqe_porosity_ext[ebNE_kb];</div>
<div class="line"><a name="l05961"></a><span class="lineno"> 5961</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l05962"></a><span class="lineno"> 5962</span>&#160;                <span class="comment">//calculate the internal and external trace of the pde coefficients</span></div>
<div class="line"><a name="l05963"></a><span class="lineno"> 5963</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l05964"></a><span class="lineno"> 5964</span>&#160;                <span class="keywordtype">double</span> eddy_viscosity_ext(0.),bc_eddy_viscosity_ext(0.);<span class="comment">//not interested in saving boundary eddy viscosity for now</span></div>
<div class="line"><a name="l05965"></a><span class="lineno"> 5965</span>&#160;                <span class="keywordtype">double</span> rho;</div>
<div class="line"><a name="l05966"></a><span class="lineno"> 5966</span>&#160;                <span class="keywordflow">if</span> (use_ball_as_particle == 1)</div>
<div class="line"><a name="l05967"></a><span class="lineno"> 5967</span>&#160;                {</div>
<div class="line"><a name="l05968"></a><span class="lineno"> 5968</span>&#160;                    <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a3e0cb3084e0e32cc2355384f2e511801">get_distance_to_ball</a>(nParticles, ball_center, ball_radius,x_ext,y_ext,z_ext,ebq_global_phi_s[ebNE_kb]);</div>
<div class="line"><a name="l05969"></a><span class="lineno"> 5969</span>&#160;                }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l05970"></a><span class="lineno"> 5970</span>&#160;                    <span class="comment">//distance_to_solids is updated in PreStep</span></div>
<div class="line"><a name="l05971"></a><span class="lineno"> 5971</span>&#160;                }</div>
<div class="line"><a name="l05972"></a><span class="lineno"> 5972</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#adff72a3cebc8b98398097095827e7aa6">evaluateCoefficients</a>(NONCONSERVATIVE_FORM,</div>
<div class="line"><a name="l05973"></a><span class="lineno"> 5973</span>&#160;                                     eps_rho,</div>
<div class="line"><a name="l05974"></a><span class="lineno"> 5974</span>&#160;                                     eps_mu,</div>
<div class="line"><a name="l05975"></a><span class="lineno"> 5975</span>&#160;                                     sigma,</div>
<div class="line"><a name="l05976"></a><span class="lineno"> 5976</span>&#160;                                     <a class="code" href="_error_residual_method_8cpp.html#ae5f5d9edb66645eab31a7c8389493ce7">rho_0</a>,</div>
<div class="line"><a name="l05977"></a><span class="lineno"> 5977</span>&#160;                                     <a class="code" href="_error_residual_method_8cpp.html#a383b07af68441ce2b4adaaf8d8cc9d90">nu_0</a>,</div>
<div class="line"><a name="l05978"></a><span class="lineno"> 5978</span>&#160;                                     <a class="code" href="_error_residual_method_8cpp.html#a751e53c9d8dfaf696b11b86e0c1b42e9">rho_1</a>,</div>
<div class="line"><a name="l05979"></a><span class="lineno"> 5979</span>&#160;                                     <a class="code" href="_error_residual_method_8cpp.html#ae5896ebfee35f22242123e4ae82c81d9">nu_1</a>,</div>
<div class="line"><a name="l05980"></a><span class="lineno"> 5980</span>&#160;                                     elementDiameter[eN],</div>
<div class="line"><a name="l05981"></a><span class="lineno"> 5981</span>&#160;                                     smagorinskyConstant,</div>
<div class="line"><a name="l05982"></a><span class="lineno"> 5982</span>&#160;                                     turbulenceClosureModel,</div>
<div class="line"><a name="l05983"></a><span class="lineno"> 5983</span>&#160;                                     g,</div>
<div class="line"><a name="l05984"></a><span class="lineno"> 5984</span>&#160;                                     useVF,</div>
<div class="line"><a name="l05985"></a><span class="lineno"> 5985</span>&#160;                                     ebqe_vf_ext[ebNE_kb],</div>
<div class="line"><a name="l05986"></a><span class="lineno"> 5986</span>&#160;                                     ebqe_phi_ext[ebNE_kb],</div>
<div class="line"><a name="l05987"></a><span class="lineno"> 5987</span>&#160;                                     &amp;ebqe_normal_phi_ext[ebNE_kb_nSpace],</div>
<div class="line"><a name="l05988"></a><span class="lineno"> 5988</span>&#160;                                     ebqe_kappa_phi_ext[ebNE_kb],</div>
<div class="line"><a name="l05989"></a><span class="lineno"> 5989</span>&#160;                                     <span class="comment">//VRANS</span></div>
<div class="line"><a name="l05990"></a><span class="lineno"> 5990</span>&#160;                                     porosity_ext,</div>
<div class="line"><a name="l05991"></a><span class="lineno"> 5991</span>&#160;                                     <span class="comment">//</span></div>
<div class="line"><a name="l05992"></a><span class="lineno"> 5992</span>&#160;                                     ebq_global_phi_s[ebNE_kb],</div>
<div class="line"><a name="l05993"></a><span class="lineno"> 5993</span>&#160;                                     p_old,</div>
<div class="line"><a name="l05994"></a><span class="lineno"> 5994</span>&#160;                                     u_old,</div>
<div class="line"><a name="l05995"></a><span class="lineno"> 5995</span>&#160;                                     v_old,</div>
<div class="line"><a name="l05996"></a><span class="lineno"> 5996</span>&#160;                                     w_old,</div>
<div class="line"><a name="l05997"></a><span class="lineno"> 5997</span>&#160;                                     grad_p_old,</div>
<div class="line"><a name="l05998"></a><span class="lineno"> 5998</span>&#160;                                     grad_u_old,</div>
<div class="line"><a name="l05999"></a><span class="lineno"> 5999</span>&#160;                                     grad_v_old,</div>
<div class="line"><a name="l06000"></a><span class="lineno"> 6000</span>&#160;                                     grad_w_old,</div>
<div class="line"><a name="l06001"></a><span class="lineno"> 6001</span>&#160;                                     use_pseudo_penalty,</div>
<div class="line"><a name="l06002"></a><span class="lineno"> 6002</span>&#160;                                     p_ext,</div>
<div class="line"><a name="l06003"></a><span class="lineno"> 6003</span>&#160;                                     grad_p_ext,</div>
<div class="line"><a name="l06004"></a><span class="lineno"> 6004</span>&#160;                                     grad_u_ext,</div>
<div class="line"><a name="l06005"></a><span class="lineno"> 6005</span>&#160;                                     grad_v_ext,</div>
<div class="line"><a name="l06006"></a><span class="lineno"> 6006</span>&#160;                                     grad_w_ext,</div>
<div class="line"><a name="l06007"></a><span class="lineno"> 6007</span>&#160;                                     u_ext,</div>
<div class="line"><a name="l06008"></a><span class="lineno"> 6008</span>&#160;                                     v_ext,</div>
<div class="line"><a name="l06009"></a><span class="lineno"> 6009</span>&#160;                                     w_ext,</div>
<div class="line"><a name="l06010"></a><span class="lineno"> 6010</span>&#160;                                     LAG_LES,</div>
<div class="line"><a name="l06011"></a><span class="lineno"> 6011</span>&#160;                                     eddy_viscosity_ext,</div>
<div class="line"><a name="l06012"></a><span class="lineno"> 6012</span>&#160;                                     ebqe_eddy_viscosity_last[ebNE_kb],</div>
<div class="line"><a name="l06013"></a><span class="lineno"> 6013</span>&#160;                                     mom_u_acc_ext,</div>
<div class="line"><a name="l06014"></a><span class="lineno"> 6014</span>&#160;                                     dmom_u_acc_u_ext,</div>
<div class="line"><a name="l06015"></a><span class="lineno"> 6015</span>&#160;                                     mom_v_acc_ext,</div>
<div class="line"><a name="l06016"></a><span class="lineno"> 6016</span>&#160;                                     dmom_v_acc_v_ext,</div>
<div class="line"><a name="l06017"></a><span class="lineno"> 6017</span>&#160;                                     mom_w_acc_ext,</div>
<div class="line"><a name="l06018"></a><span class="lineno"> 6018</span>&#160;                                     dmom_w_acc_w_ext,</div>
<div class="line"><a name="l06019"></a><span class="lineno"> 6019</span>&#160;                                     mass_adv_ext,</div>
<div class="line"><a name="l06020"></a><span class="lineno"> 6020</span>&#160;                                     dmass_adv_u_ext,</div>
<div class="line"><a name="l06021"></a><span class="lineno"> 6021</span>&#160;                                     dmass_adv_v_ext,</div>
<div class="line"><a name="l06022"></a><span class="lineno"> 6022</span>&#160;                                     dmass_adv_w_ext,</div>
<div class="line"><a name="l06023"></a><span class="lineno"> 6023</span>&#160;                                     mom_u_adv_ext,</div>
<div class="line"><a name="l06024"></a><span class="lineno"> 6024</span>&#160;                                     dmom_u_adv_u_ext,</div>
<div class="line"><a name="l06025"></a><span class="lineno"> 6025</span>&#160;                                     dmom_u_adv_v_ext,</div>
<div class="line"><a name="l06026"></a><span class="lineno"> 6026</span>&#160;                                     dmom_u_adv_w_ext,</div>
<div class="line"><a name="l06027"></a><span class="lineno"> 6027</span>&#160;                                     mom_v_adv_ext,</div>
<div class="line"><a name="l06028"></a><span class="lineno"> 6028</span>&#160;                                     dmom_v_adv_u_ext,</div>
<div class="line"><a name="l06029"></a><span class="lineno"> 6029</span>&#160;                                     dmom_v_adv_v_ext,</div>
<div class="line"><a name="l06030"></a><span class="lineno"> 6030</span>&#160;                                     dmom_v_adv_w_ext,</div>
<div class="line"><a name="l06031"></a><span class="lineno"> 6031</span>&#160;                                     mom_w_adv_ext,</div>
<div class="line"><a name="l06032"></a><span class="lineno"> 6032</span>&#160;                                     dmom_w_adv_u_ext,</div>
<div class="line"><a name="l06033"></a><span class="lineno"> 6033</span>&#160;                                     dmom_w_adv_v_ext,</div>
<div class="line"><a name="l06034"></a><span class="lineno"> 6034</span>&#160;                                     dmom_w_adv_w_ext,</div>
<div class="line"><a name="l06035"></a><span class="lineno"> 6035</span>&#160;                                     mom_uu_diff_ten_ext,</div>
<div class="line"><a name="l06036"></a><span class="lineno"> 6036</span>&#160;                                     mom_vv_diff_ten_ext,</div>
<div class="line"><a name="l06037"></a><span class="lineno"> 6037</span>&#160;                                     mom_ww_diff_ten_ext,</div>
<div class="line"><a name="l06038"></a><span class="lineno"> 6038</span>&#160;                                     mom_uv_diff_ten_ext,</div>
<div class="line"><a name="l06039"></a><span class="lineno"> 6039</span>&#160;                                     mom_uw_diff_ten_ext,</div>
<div class="line"><a name="l06040"></a><span class="lineno"> 6040</span>&#160;                                     mom_vu_diff_ten_ext,</div>
<div class="line"><a name="l06041"></a><span class="lineno"> 6041</span>&#160;                                     mom_vw_diff_ten_ext,</div>
<div class="line"><a name="l06042"></a><span class="lineno"> 6042</span>&#160;                                     mom_wu_diff_ten_ext,</div>
<div class="line"><a name="l06043"></a><span class="lineno"> 6043</span>&#160;                                     mom_wv_diff_ten_ext,</div>
<div class="line"><a name="l06044"></a><span class="lineno"> 6044</span>&#160;                                     mom_u_source_ext,</div>
<div class="line"><a name="l06045"></a><span class="lineno"> 6045</span>&#160;                                     mom_v_source_ext,</div>
<div class="line"><a name="l06046"></a><span class="lineno"> 6046</span>&#160;                                     mom_w_source_ext,</div>
<div class="line"><a name="l06047"></a><span class="lineno"> 6047</span>&#160;                                     mom_u_ham_ext,</div>
<div class="line"><a name="l06048"></a><span class="lineno"> 6048</span>&#160;                                     dmom_u_ham_grad_p_ext,</div>
<div class="line"><a name="l06049"></a><span class="lineno"> 6049</span>&#160;                                     dmom_u_ham_grad_u_ext,</div>
<div class="line"><a name="l06050"></a><span class="lineno"> 6050</span>&#160;                                     dmom_u_ham_u_ext,</div>
<div class="line"><a name="l06051"></a><span class="lineno"> 6051</span>&#160;                                     dmom_u_ham_v_ext,</div>
<div class="line"><a name="l06052"></a><span class="lineno"> 6052</span>&#160;                                     dmom_u_ham_w_ext,</div>
<div class="line"><a name="l06053"></a><span class="lineno"> 6053</span>&#160;                                     mom_v_ham_ext,</div>
<div class="line"><a name="l06054"></a><span class="lineno"> 6054</span>&#160;                                     dmom_v_ham_grad_p_ext,</div>
<div class="line"><a name="l06055"></a><span class="lineno"> 6055</span>&#160;                                     dmom_v_ham_grad_v_ext,</div>
<div class="line"><a name="l06056"></a><span class="lineno"> 6056</span>&#160;                                     dmom_v_ham_u_ext,</div>
<div class="line"><a name="l06057"></a><span class="lineno"> 6057</span>&#160;                                     dmom_v_ham_v_ext,</div>
<div class="line"><a name="l06058"></a><span class="lineno"> 6058</span>&#160;                                     dmom_v_ham_w_ext,</div>
<div class="line"><a name="l06059"></a><span class="lineno"> 6059</span>&#160;                                     mom_w_ham_ext,</div>
<div class="line"><a name="l06060"></a><span class="lineno"> 6060</span>&#160;                                     dmom_w_ham_grad_p_ext,</div>
<div class="line"><a name="l06061"></a><span class="lineno"> 6061</span>&#160;                                     dmom_w_ham_grad_w_ext,</div>
<div class="line"><a name="l06062"></a><span class="lineno"> 6062</span>&#160;                                     dmom_w_ham_u_ext,</div>
<div class="line"><a name="l06063"></a><span class="lineno"> 6063</span>&#160;                                     dmom_w_ham_v_ext,</div>
<div class="line"><a name="l06064"></a><span class="lineno"> 6064</span>&#160;                                     dmom_w_ham_w_ext,</div>
<div class="line"><a name="l06065"></a><span class="lineno"> 6065</span>&#160;                                     rho,</div>
<div class="line"><a name="l06066"></a><span class="lineno"> 6066</span>&#160;                                     0.0,</div>
<div class="line"><a name="l06067"></a><span class="lineno"> 6067</span>&#160;                                     0.0,</div>
<div class="line"><a name="l06068"></a><span class="lineno"> 6068</span>&#160;                                     0.0);</div>
<div class="line"><a name="l06069"></a><span class="lineno"> 6069</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#adff72a3cebc8b98398097095827e7aa6">evaluateCoefficients</a>(NONCONSERVATIVE_FORM,</div>
<div class="line"><a name="l06070"></a><span class="lineno"> 6070</span>&#160;                                     eps_rho,</div>
<div class="line"><a name="l06071"></a><span class="lineno"> 6071</span>&#160;                                     eps_mu,</div>
<div class="line"><a name="l06072"></a><span class="lineno"> 6072</span>&#160;                                     sigma,</div>
<div class="line"><a name="l06073"></a><span class="lineno"> 6073</span>&#160;                                     <a class="code" href="_error_residual_method_8cpp.html#ae5f5d9edb66645eab31a7c8389493ce7">rho_0</a>,</div>
<div class="line"><a name="l06074"></a><span class="lineno"> 6074</span>&#160;                                     <a class="code" href="_error_residual_method_8cpp.html#a383b07af68441ce2b4adaaf8d8cc9d90">nu_0</a>,</div>
<div class="line"><a name="l06075"></a><span class="lineno"> 6075</span>&#160;                                     <a class="code" href="_error_residual_method_8cpp.html#a751e53c9d8dfaf696b11b86e0c1b42e9">rho_1</a>,</div>
<div class="line"><a name="l06076"></a><span class="lineno"> 6076</span>&#160;                                     <a class="code" href="_error_residual_method_8cpp.html#ae5896ebfee35f22242123e4ae82c81d9">nu_1</a>,</div>
<div class="line"><a name="l06077"></a><span class="lineno"> 6077</span>&#160;                                     elementDiameter[eN],</div>
<div class="line"><a name="l06078"></a><span class="lineno"> 6078</span>&#160;                                     smagorinskyConstant,</div>
<div class="line"><a name="l06079"></a><span class="lineno"> 6079</span>&#160;                                     turbulenceClosureModel,</div>
<div class="line"><a name="l06080"></a><span class="lineno"> 6080</span>&#160;                                     g,</div>
<div class="line"><a name="l06081"></a><span class="lineno"> 6081</span>&#160;                                     useVF,</div>
<div class="line"><a name="l06082"></a><span class="lineno"> 6082</span>&#160;                                     bc_ebqe_vf_ext[ebNE_kb],</div>
<div class="line"><a name="l06083"></a><span class="lineno"> 6083</span>&#160;                                     bc_ebqe_phi_ext[ebNE_kb],</div>
<div class="line"><a name="l06084"></a><span class="lineno"> 6084</span>&#160;                                     &amp;ebqe_normal_phi_ext[ebNE_kb_nSpace],</div>
<div class="line"><a name="l06085"></a><span class="lineno"> 6085</span>&#160;                                     ebqe_kappa_phi_ext[ebNE_kb],</div>
<div class="line"><a name="l06086"></a><span class="lineno"> 6086</span>&#160;                                     <span class="comment">//VRANS</span></div>
<div class="line"><a name="l06087"></a><span class="lineno"> 6087</span>&#160;                                     porosity_ext,</div>
<div class="line"><a name="l06088"></a><span class="lineno"> 6088</span>&#160;                                     <span class="comment">//</span></div>
<div class="line"><a name="l06089"></a><span class="lineno"> 6089</span>&#160;                                     ebq_global_phi_s[ebNE_kb],</div>
<div class="line"><a name="l06090"></a><span class="lineno"> 6090</span>&#160;                                     p_old,</div>
<div class="line"><a name="l06091"></a><span class="lineno"> 6091</span>&#160;                                     u_old,</div>
<div class="line"><a name="l06092"></a><span class="lineno"> 6092</span>&#160;                                     v_old,</div>
<div class="line"><a name="l06093"></a><span class="lineno"> 6093</span>&#160;                                     w_old,</div>
<div class="line"><a name="l06094"></a><span class="lineno"> 6094</span>&#160;                                     grad_p_old,</div>
<div class="line"><a name="l06095"></a><span class="lineno"> 6095</span>&#160;                                     grad_u_old,</div>
<div class="line"><a name="l06096"></a><span class="lineno"> 6096</span>&#160;                                     grad_v_old,</div>
<div class="line"><a name="l06097"></a><span class="lineno"> 6097</span>&#160;                                     grad_w_old,</div>
<div class="line"><a name="l06098"></a><span class="lineno"> 6098</span>&#160;                                     use_pseudo_penalty,</div>
<div class="line"><a name="l06099"></a><span class="lineno"> 6099</span>&#160;                                     bc_p_ext,</div>
<div class="line"><a name="l06100"></a><span class="lineno"> 6100</span>&#160;                                     grad_p_ext,</div>
<div class="line"><a name="l06101"></a><span class="lineno"> 6101</span>&#160;                                     grad_u_ext,</div>
<div class="line"><a name="l06102"></a><span class="lineno"> 6102</span>&#160;                                     grad_v_ext,</div>
<div class="line"><a name="l06103"></a><span class="lineno"> 6103</span>&#160;                                     grad_w_ext,</div>
<div class="line"><a name="l06104"></a><span class="lineno"> 6104</span>&#160;                                     bc_u_ext,</div>
<div class="line"><a name="l06105"></a><span class="lineno"> 6105</span>&#160;                                     bc_v_ext,</div>
<div class="line"><a name="l06106"></a><span class="lineno"> 6106</span>&#160;                                     bc_w_ext,</div>
<div class="line"><a name="l06107"></a><span class="lineno"> 6107</span>&#160;                                     LAG_LES,</div>
<div class="line"><a name="l06108"></a><span class="lineno"> 6108</span>&#160;                                     bc_eddy_viscosity_ext,</div>
<div class="line"><a name="l06109"></a><span class="lineno"> 6109</span>&#160;                                     ebqe_eddy_viscosity_last[ebNE_kb],</div>
<div class="line"><a name="l06110"></a><span class="lineno"> 6110</span>&#160;                                     bc_mom_u_acc_ext,</div>
<div class="line"><a name="l06111"></a><span class="lineno"> 6111</span>&#160;                                     bc_dmom_u_acc_u_ext,</div>
<div class="line"><a name="l06112"></a><span class="lineno"> 6112</span>&#160;                                     bc_mom_v_acc_ext,</div>
<div class="line"><a name="l06113"></a><span class="lineno"> 6113</span>&#160;                                     bc_dmom_v_acc_v_ext,</div>
<div class="line"><a name="l06114"></a><span class="lineno"> 6114</span>&#160;                                     bc_mom_w_acc_ext,</div>
<div class="line"><a name="l06115"></a><span class="lineno"> 6115</span>&#160;                                     bc_dmom_w_acc_w_ext,</div>
<div class="line"><a name="l06116"></a><span class="lineno"> 6116</span>&#160;                                     bc_mass_adv_ext,</div>
<div class="line"><a name="l06117"></a><span class="lineno"> 6117</span>&#160;                                     bc_dmass_adv_u_ext,</div>
<div class="line"><a name="l06118"></a><span class="lineno"> 6118</span>&#160;                                     bc_dmass_adv_v_ext,</div>
<div class="line"><a name="l06119"></a><span class="lineno"> 6119</span>&#160;                                     bc_dmass_adv_w_ext,</div>
<div class="line"><a name="l06120"></a><span class="lineno"> 6120</span>&#160;                                     bc_mom_u_adv_ext,</div>
<div class="line"><a name="l06121"></a><span class="lineno"> 6121</span>&#160;                                     bc_dmom_u_adv_u_ext,</div>
<div class="line"><a name="l06122"></a><span class="lineno"> 6122</span>&#160;                                     bc_dmom_u_adv_v_ext,</div>
<div class="line"><a name="l06123"></a><span class="lineno"> 6123</span>&#160;                                     bc_dmom_u_adv_w_ext,</div>
<div class="line"><a name="l06124"></a><span class="lineno"> 6124</span>&#160;                                     bc_mom_v_adv_ext,</div>
<div class="line"><a name="l06125"></a><span class="lineno"> 6125</span>&#160;                                     bc_dmom_v_adv_u_ext,</div>
<div class="line"><a name="l06126"></a><span class="lineno"> 6126</span>&#160;                                     bc_dmom_v_adv_v_ext,</div>
<div class="line"><a name="l06127"></a><span class="lineno"> 6127</span>&#160;                                     bc_dmom_v_adv_w_ext,</div>
<div class="line"><a name="l06128"></a><span class="lineno"> 6128</span>&#160;                                     bc_mom_w_adv_ext,</div>
<div class="line"><a name="l06129"></a><span class="lineno"> 6129</span>&#160;                                     bc_dmom_w_adv_u_ext,</div>
<div class="line"><a name="l06130"></a><span class="lineno"> 6130</span>&#160;                                     bc_dmom_w_adv_v_ext,</div>
<div class="line"><a name="l06131"></a><span class="lineno"> 6131</span>&#160;                                     bc_dmom_w_adv_w_ext,</div>
<div class="line"><a name="l06132"></a><span class="lineno"> 6132</span>&#160;                                     bc_mom_uu_diff_ten_ext,</div>
<div class="line"><a name="l06133"></a><span class="lineno"> 6133</span>&#160;                                     bc_mom_vv_diff_ten_ext,</div>
<div class="line"><a name="l06134"></a><span class="lineno"> 6134</span>&#160;                                     bc_mom_ww_diff_ten_ext,</div>
<div class="line"><a name="l06135"></a><span class="lineno"> 6135</span>&#160;                                     bc_mom_uv_diff_ten_ext,</div>
<div class="line"><a name="l06136"></a><span class="lineno"> 6136</span>&#160;                                     bc_mom_uw_diff_ten_ext,</div>
<div class="line"><a name="l06137"></a><span class="lineno"> 6137</span>&#160;                                     bc_mom_vu_diff_ten_ext,</div>
<div class="line"><a name="l06138"></a><span class="lineno"> 6138</span>&#160;                                     bc_mom_vw_diff_ten_ext,</div>
<div class="line"><a name="l06139"></a><span class="lineno"> 6139</span>&#160;                                     bc_mom_wu_diff_ten_ext,</div>
<div class="line"><a name="l06140"></a><span class="lineno"> 6140</span>&#160;                                     bc_mom_wv_diff_ten_ext,</div>
<div class="line"><a name="l06141"></a><span class="lineno"> 6141</span>&#160;                                     bc_mom_u_source_ext,</div>
<div class="line"><a name="l06142"></a><span class="lineno"> 6142</span>&#160;                                     bc_mom_v_source_ext,</div>
<div class="line"><a name="l06143"></a><span class="lineno"> 6143</span>&#160;                                     bc_mom_w_source_ext,</div>
<div class="line"><a name="l06144"></a><span class="lineno"> 6144</span>&#160;                                     bc_mom_u_ham_ext,</div>
<div class="line"><a name="l06145"></a><span class="lineno"> 6145</span>&#160;                                     bc_dmom_u_ham_grad_p_ext,</div>
<div class="line"><a name="l06146"></a><span class="lineno"> 6146</span>&#160;                                     bc_dmom_u_ham_grad_u_ext,</div>
<div class="line"><a name="l06147"></a><span class="lineno"> 6147</span>&#160;                                     bc_dmom_u_ham_u_ext,</div>
<div class="line"><a name="l06148"></a><span class="lineno"> 6148</span>&#160;                                     bc_dmom_u_ham_v_ext,</div>
<div class="line"><a name="l06149"></a><span class="lineno"> 6149</span>&#160;                                     bc_dmom_u_ham_w_ext,</div>
<div class="line"><a name="l06150"></a><span class="lineno"> 6150</span>&#160;                                     bc_mom_v_ham_ext,</div>
<div class="line"><a name="l06151"></a><span class="lineno"> 6151</span>&#160;                                     bc_dmom_v_ham_grad_p_ext,</div>
<div class="line"><a name="l06152"></a><span class="lineno"> 6152</span>&#160;                                     bc_dmom_v_ham_grad_v_ext,</div>
<div class="line"><a name="l06153"></a><span class="lineno"> 6153</span>&#160;                                     bc_dmom_v_ham_u_ext,</div>
<div class="line"><a name="l06154"></a><span class="lineno"> 6154</span>&#160;                                     bc_dmom_v_ham_v_ext,</div>
<div class="line"><a name="l06155"></a><span class="lineno"> 6155</span>&#160;                                     bc_dmom_v_ham_w_ext,</div>
<div class="line"><a name="l06156"></a><span class="lineno"> 6156</span>&#160;                                     bc_mom_w_ham_ext,</div>
<div class="line"><a name="l06157"></a><span class="lineno"> 6157</span>&#160;                                     bc_dmom_w_ham_grad_p_ext,</div>
<div class="line"><a name="l06158"></a><span class="lineno"> 6158</span>&#160;                                     bc_dmom_w_ham_grad_w_ext,</div>
<div class="line"><a name="l06159"></a><span class="lineno"> 6159</span>&#160;                                     bc_dmom_w_ham_u_ext,</div>
<div class="line"><a name="l06160"></a><span class="lineno"> 6160</span>&#160;                                     bc_dmom_w_ham_v_ext,</div>
<div class="line"><a name="l06161"></a><span class="lineno"> 6161</span>&#160;                                     bc_dmom_w_ham_w_ext,</div>
<div class="line"><a name="l06162"></a><span class="lineno"> 6162</span>&#160;                                     rho,</div>
<div class="line"><a name="l06163"></a><span class="lineno"> 6163</span>&#160;                                     0.0,</div>
<div class="line"><a name="l06164"></a><span class="lineno"> 6164</span>&#160;                                     0.0,</div>
<div class="line"><a name="l06165"></a><span class="lineno"> 6165</span>&#160;                                     0.0);</div>
<div class="line"><a name="l06166"></a><span class="lineno"> 6166</span>&#160;                <span class="comment">//Turbulence closure model</span></div>
<div class="line"><a name="l06167"></a><span class="lineno"> 6167</span>&#160;                <span class="keywordflow">if</span> (turbulenceClosureModel &gt;= 3)</div>
<div class="line"><a name="l06168"></a><span class="lineno"> 6168</span>&#160;                  {</div>
<div class="line"><a name="l06169"></a><span class="lineno"> 6169</span>&#160;                    <span class="keyword">const</span> <span class="keywordtype">double</span> turb_var_grad_0_dummy[3] = {0.,0.,0.};</div>
<div class="line"><a name="l06170"></a><span class="lineno"> 6170</span>&#160;                    <span class="keyword">const</span> <span class="keywordtype">double</span> c_mu = 0.09;<span class="comment">//mwf hack</span></div>
<div class="line"><a name="l06171"></a><span class="lineno"> 6171</span>&#160;                    <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#aab46065ecbde76bd2d9ef320ad287b76">updateTurbulenceClosure</a>(NONCONSERVATIVE_FORM,</div>
<div class="line"><a name="l06172"></a><span class="lineno"> 6172</span>&#160;                                            turbulenceClosureModel,</div>
<div class="line"><a name="l06173"></a><span class="lineno"> 6173</span>&#160;                                            eps_rho,</div>
<div class="line"><a name="l06174"></a><span class="lineno"> 6174</span>&#160;                                            eps_mu,</div>
<div class="line"><a name="l06175"></a><span class="lineno"> 6175</span>&#160;                                            <a class="code" href="_error_residual_method_8cpp.html#ae5f5d9edb66645eab31a7c8389493ce7">rho_0</a>,</div>
<div class="line"><a name="l06176"></a><span class="lineno"> 6176</span>&#160;                                            <a class="code" href="_error_residual_method_8cpp.html#a383b07af68441ce2b4adaaf8d8cc9d90">nu_0</a>,</div>
<div class="line"><a name="l06177"></a><span class="lineno"> 6177</span>&#160;                                            <a class="code" href="_error_residual_method_8cpp.html#a751e53c9d8dfaf696b11b86e0c1b42e9">rho_1</a>,</div>
<div class="line"><a name="l06178"></a><span class="lineno"> 6178</span>&#160;                                            <a class="code" href="_error_residual_method_8cpp.html#ae5896ebfee35f22242123e4ae82c81d9">nu_1</a>,</div>
<div class="line"><a name="l06179"></a><span class="lineno"> 6179</span>&#160;                                            useVF,</div>
<div class="line"><a name="l06180"></a><span class="lineno"> 6180</span>&#160;                                            ebqe_vf_ext[ebNE_kb],</div>
<div class="line"><a name="l06181"></a><span class="lineno"> 6181</span>&#160;                                            ebqe_phi_ext[ebNE_kb],</div>
<div class="line"><a name="l06182"></a><span class="lineno"> 6182</span>&#160;                                            porosity_ext,</div>
<div class="line"><a name="l06183"></a><span class="lineno"> 6183</span>&#160;                                            c_mu, <span class="comment">//mwf hack</span></div>
<div class="line"><a name="l06184"></a><span class="lineno"> 6184</span>&#160;                                            ebqe_turb_var_0[ebNE_kb],</div>
<div class="line"><a name="l06185"></a><span class="lineno"> 6185</span>&#160;                                            ebqe_turb_var_1[ebNE_kb],</div>
<div class="line"><a name="l06186"></a><span class="lineno"> 6186</span>&#160;                                            turb_var_grad_0_dummy, <span class="comment">//not needed</span></div>
<div class="line"><a name="l06187"></a><span class="lineno"> 6187</span>&#160;                                            eddy_viscosity_ext,</div>
<div class="line"><a name="l06188"></a><span class="lineno"> 6188</span>&#160;                                            mom_uu_diff_ten_ext,</div>
<div class="line"><a name="l06189"></a><span class="lineno"> 6189</span>&#160;                                            mom_vv_diff_ten_ext,</div>
<div class="line"><a name="l06190"></a><span class="lineno"> 6190</span>&#160;                                            mom_ww_diff_ten_ext,</div>
<div class="line"><a name="l06191"></a><span class="lineno"> 6191</span>&#160;                                            mom_uv_diff_ten_ext,</div>
<div class="line"><a name="l06192"></a><span class="lineno"> 6192</span>&#160;                                            mom_uw_diff_ten_ext,</div>
<div class="line"><a name="l06193"></a><span class="lineno"> 6193</span>&#160;                                            mom_vu_diff_ten_ext,</div>
<div class="line"><a name="l06194"></a><span class="lineno"> 6194</span>&#160;                                            mom_vw_diff_ten_ext,</div>
<div class="line"><a name="l06195"></a><span class="lineno"> 6195</span>&#160;                                            mom_wu_diff_ten_ext,</div>
<div class="line"><a name="l06196"></a><span class="lineno"> 6196</span>&#160;                                            mom_wv_diff_ten_ext,</div>
<div class="line"><a name="l06197"></a><span class="lineno"> 6197</span>&#160;                                            mom_u_source_ext,</div>
<div class="line"><a name="l06198"></a><span class="lineno"> 6198</span>&#160;                                            mom_v_source_ext,</div>
<div class="line"><a name="l06199"></a><span class="lineno"> 6199</span>&#160;                                            mom_w_source_ext);</div>
<div class="line"><a name="l06200"></a><span class="lineno"> 6200</span>&#160; </div>
<div class="line"><a name="l06201"></a><span class="lineno"> 6201</span>&#160;                    <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#aab46065ecbde76bd2d9ef320ad287b76">updateTurbulenceClosure</a>(NONCONSERVATIVE_FORM,</div>
<div class="line"><a name="l06202"></a><span class="lineno"> 6202</span>&#160;                                            turbulenceClosureModel,</div>
<div class="line"><a name="l06203"></a><span class="lineno"> 6203</span>&#160;                                            eps_rho,</div>
<div class="line"><a name="l06204"></a><span class="lineno"> 6204</span>&#160;                                            eps_mu,</div>
<div class="line"><a name="l06205"></a><span class="lineno"> 6205</span>&#160;                                            <a class="code" href="_error_residual_method_8cpp.html#ae5f5d9edb66645eab31a7c8389493ce7">rho_0</a>,</div>
<div class="line"><a name="l06206"></a><span class="lineno"> 6206</span>&#160;                                            <a class="code" href="_error_residual_method_8cpp.html#a383b07af68441ce2b4adaaf8d8cc9d90">nu_0</a>,</div>
<div class="line"><a name="l06207"></a><span class="lineno"> 6207</span>&#160;                                            <a class="code" href="_error_residual_method_8cpp.html#a751e53c9d8dfaf696b11b86e0c1b42e9">rho_1</a>,</div>
<div class="line"><a name="l06208"></a><span class="lineno"> 6208</span>&#160;                                            <a class="code" href="_error_residual_method_8cpp.html#ae5896ebfee35f22242123e4ae82c81d9">nu_1</a>,</div>
<div class="line"><a name="l06209"></a><span class="lineno"> 6209</span>&#160;                                            useVF,</div>
<div class="line"><a name="l06210"></a><span class="lineno"> 6210</span>&#160;                                            ebqe_vf_ext[ebNE_kb],</div>
<div class="line"><a name="l06211"></a><span class="lineno"> 6211</span>&#160;                                            ebqe_phi_ext[ebNE_kb],</div>
<div class="line"><a name="l06212"></a><span class="lineno"> 6212</span>&#160;                                            porosity_ext,</div>
<div class="line"><a name="l06213"></a><span class="lineno"> 6213</span>&#160;                                            c_mu, <span class="comment">//mwf hack</span></div>
<div class="line"><a name="l06214"></a><span class="lineno"> 6214</span>&#160;                                            ebqe_turb_var_0[ebNE_kb],</div>
<div class="line"><a name="l06215"></a><span class="lineno"> 6215</span>&#160;                                            ebqe_turb_var_1[ebNE_kb],</div>
<div class="line"><a name="l06216"></a><span class="lineno"> 6216</span>&#160;                                            turb_var_grad_0_dummy, <span class="comment">//not needed</span></div>
<div class="line"><a name="l06217"></a><span class="lineno"> 6217</span>&#160;                                            bc_eddy_viscosity_ext,</div>
<div class="line"><a name="l06218"></a><span class="lineno"> 6218</span>&#160;                                            bc_mom_uu_diff_ten_ext,</div>
<div class="line"><a name="l06219"></a><span class="lineno"> 6219</span>&#160;                                            bc_mom_vv_diff_ten_ext,</div>
<div class="line"><a name="l06220"></a><span class="lineno"> 6220</span>&#160;                                            bc_mom_ww_diff_ten_ext,</div>
<div class="line"><a name="l06221"></a><span class="lineno"> 6221</span>&#160;                                            bc_mom_uv_diff_ten_ext,</div>
<div class="line"><a name="l06222"></a><span class="lineno"> 6222</span>&#160;                                            bc_mom_uw_diff_ten_ext,</div>
<div class="line"><a name="l06223"></a><span class="lineno"> 6223</span>&#160;                                            bc_mom_vu_diff_ten_ext,</div>
<div class="line"><a name="l06224"></a><span class="lineno"> 6224</span>&#160;                                            bc_mom_vw_diff_ten_ext,</div>
<div class="line"><a name="l06225"></a><span class="lineno"> 6225</span>&#160;                                            bc_mom_wu_diff_ten_ext,</div>
<div class="line"><a name="l06226"></a><span class="lineno"> 6226</span>&#160;                                            bc_mom_wv_diff_ten_ext,</div>
<div class="line"><a name="l06227"></a><span class="lineno"> 6227</span>&#160;                                            bc_mom_u_source_ext,</div>
<div class="line"><a name="l06228"></a><span class="lineno"> 6228</span>&#160;                                            bc_mom_v_source_ext,</div>
<div class="line"><a name="l06229"></a><span class="lineno"> 6229</span>&#160;                                            bc_mom_w_source_ext);</div>
<div class="line"><a name="l06230"></a><span class="lineno"> 6230</span>&#160;                  }</div>
<div class="line"><a name="l06231"></a><span class="lineno"> 6231</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l06232"></a><span class="lineno"> 6232</span>&#160;                <span class="comment">//moving domain</span></div>
<div class="line"><a name="l06233"></a><span class="lineno"> 6233</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l06234"></a><span class="lineno"> 6234</span>&#160;                <span class="keywordflow">if</span> (NONCONSERVATIVE_FORM &gt; 0.0)</div>
<div class="line"><a name="l06235"></a><span class="lineno"> 6235</span>&#160;                  {</div>
<div class="line"><a name="l06236"></a><span class="lineno"> 6236</span>&#160;                    mom_u_ham_ext -= MOVING_DOMAIN*dmom_u_acc_u_ext*(grad_u_ext[0]*xt_ext +</div>
<div class="line"><a name="l06237"></a><span class="lineno"> 6237</span>&#160;                                                                     grad_u_ext[1]*yt_ext +</div>
<div class="line"><a name="l06238"></a><span class="lineno"> 6238</span>&#160;                                                                     grad_u_ext[2]*zt_ext);</div>
<div class="line"><a name="l06239"></a><span class="lineno"> 6239</span>&#160;                    dmom_u_ham_grad_u_ext[0] -= MOVING_DOMAIN*dmom_u_acc_u_ext*xt_ext;</div>
<div class="line"><a name="l06240"></a><span class="lineno"> 6240</span>&#160;                    dmom_u_ham_grad_u_ext[1] -= MOVING_DOMAIN*dmom_u_acc_u_ext*yt_ext;</div>
<div class="line"><a name="l06241"></a><span class="lineno"> 6241</span>&#160;                    dmom_u_ham_grad_u_ext[2] -= MOVING_DOMAIN*dmom_u_acc_u_ext*zt_ext;</div>
<div class="line"><a name="l06242"></a><span class="lineno"> 6242</span>&#160;                  }</div>
<div class="line"><a name="l06243"></a><span class="lineno"> 6243</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l06244"></a><span class="lineno"> 6244</span>&#160;                  {</div>
<div class="line"><a name="l06245"></a><span class="lineno"> 6245</span>&#160;                    mom_u_adv_ext[0] -= MOVING_DOMAIN*mom_u_acc_ext*xt_ext;</div>
<div class="line"><a name="l06246"></a><span class="lineno"> 6246</span>&#160;                    mom_u_adv_ext[1] -= MOVING_DOMAIN*mom_u_acc_ext*yt_ext;</div>
<div class="line"><a name="l06247"></a><span class="lineno"> 6247</span>&#160;                    mom_u_adv_ext[2] -= MOVING_DOMAIN*mom_u_acc_ext*zt_ext;</div>
<div class="line"><a name="l06248"></a><span class="lineno"> 6248</span>&#160;                    dmom_u_adv_u_ext[0] -= MOVING_DOMAIN*dmom_u_acc_u_ext*xt_ext;</div>
<div class="line"><a name="l06249"></a><span class="lineno"> 6249</span>&#160;                    dmom_u_adv_u_ext[1] -= MOVING_DOMAIN*dmom_u_acc_u_ext*yt_ext;</div>
<div class="line"><a name="l06250"></a><span class="lineno"> 6250</span>&#160;                    dmom_u_adv_u_ext[2] -= MOVING_DOMAIN*dmom_u_acc_u_ext*zt_ext;</div>
<div class="line"><a name="l06251"></a><span class="lineno"> 6251</span>&#160;                  }</div>
<div class="line"><a name="l06252"></a><span class="lineno"> 6252</span>&#160; </div>
<div class="line"><a name="l06253"></a><span class="lineno"> 6253</span>&#160;                <span class="keywordflow">if</span> (NONCONSERVATIVE_FORM &gt; 0.0)</div>
<div class="line"><a name="l06254"></a><span class="lineno"> 6254</span>&#160;                  {</div>
<div class="line"><a name="l06255"></a><span class="lineno"> 6255</span>&#160;                    mom_v_ham_ext -= MOVING_DOMAIN*dmom_v_acc_v_ext*(grad_v_ext[0]*xt_ext +</div>
<div class="line"><a name="l06256"></a><span class="lineno"> 6256</span>&#160;                                                                     grad_v_ext[1]*yt_ext +</div>
<div class="line"><a name="l06257"></a><span class="lineno"> 6257</span>&#160;                                                                     grad_v_ext[2]*zt_ext);</div>
<div class="line"><a name="l06258"></a><span class="lineno"> 6258</span>&#160;                    dmom_v_ham_grad_v_ext[0] -= MOVING_DOMAIN*dmom_v_acc_v_ext*xt_ext;</div>
<div class="line"><a name="l06259"></a><span class="lineno"> 6259</span>&#160;                    dmom_v_ham_grad_v_ext[1] -= MOVING_DOMAIN*dmom_v_acc_v_ext*yt_ext;</div>
<div class="line"><a name="l06260"></a><span class="lineno"> 6260</span>&#160;                    dmom_v_ham_grad_v_ext[2] -= MOVING_DOMAIN*dmom_v_acc_v_ext*zt_ext;</div>
<div class="line"><a name="l06261"></a><span class="lineno"> 6261</span>&#160;                  }</div>
<div class="line"><a name="l06262"></a><span class="lineno"> 6262</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l06263"></a><span class="lineno"> 6263</span>&#160;                  {</div>
<div class="line"><a name="l06264"></a><span class="lineno"> 6264</span>&#160;                    mom_v_adv_ext[0] -= MOVING_DOMAIN*mom_v_acc_ext*xt_ext;</div>
<div class="line"><a name="l06265"></a><span class="lineno"> 6265</span>&#160;                    mom_v_adv_ext[1] -= MOVING_DOMAIN*mom_v_acc_ext*yt_ext;</div>
<div class="line"><a name="l06266"></a><span class="lineno"> 6266</span>&#160;                    mom_v_adv_ext[2] -= MOVING_DOMAIN*mom_v_acc_ext*zt_ext;</div>
<div class="line"><a name="l06267"></a><span class="lineno"> 6267</span>&#160;                    dmom_v_adv_v_ext[0] -= MOVING_DOMAIN*dmom_v_acc_v_ext*xt_ext;</div>
<div class="line"><a name="l06268"></a><span class="lineno"> 6268</span>&#160;                    dmom_v_adv_v_ext[1] -= MOVING_DOMAIN*dmom_v_acc_v_ext*yt_ext;</div>
<div class="line"><a name="l06269"></a><span class="lineno"> 6269</span>&#160;                    dmom_v_adv_v_ext[2] -= MOVING_DOMAIN*dmom_v_acc_v_ext*zt_ext;</div>
<div class="line"><a name="l06270"></a><span class="lineno"> 6270</span>&#160;                  }</div>
<div class="line"><a name="l06271"></a><span class="lineno"> 6271</span>&#160; </div>
<div class="line"><a name="l06272"></a><span class="lineno"> 6272</span>&#160;                <span class="keywordflow">if</span> (NONCONSERVATIVE_FORM &gt; 0.0)</div>
<div class="line"><a name="l06273"></a><span class="lineno"> 6273</span>&#160;                  {</div>
<div class="line"><a name="l06274"></a><span class="lineno"> 6274</span>&#160;                    mom_w_ham_ext -= MOVING_DOMAIN*dmom_w_acc_w_ext*(grad_w_ext[0]*xt_ext +</div>
<div class="line"><a name="l06275"></a><span class="lineno"> 6275</span>&#160;                                                                     grad_w_ext[1]*yt_ext +</div>
<div class="line"><a name="l06276"></a><span class="lineno"> 6276</span>&#160;                                                                     grad_w_ext[2]*zt_ext);</div>
<div class="line"><a name="l06277"></a><span class="lineno"> 6277</span>&#160;                    dmom_w_ham_grad_w_ext[0] -= MOVING_DOMAIN*dmom_w_acc_w_ext*xt_ext;</div>
<div class="line"><a name="l06278"></a><span class="lineno"> 6278</span>&#160;                    dmom_w_ham_grad_w_ext[1] -= MOVING_DOMAIN*dmom_w_acc_w_ext*yt_ext;</div>
<div class="line"><a name="l06279"></a><span class="lineno"> 6279</span>&#160;                    dmom_w_ham_grad_w_ext[2] -= MOVING_DOMAIN*dmom_w_acc_w_ext*zt_ext;</div>
<div class="line"><a name="l06280"></a><span class="lineno"> 6280</span>&#160;                  }</div>
<div class="line"><a name="l06281"></a><span class="lineno"> 6281</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l06282"></a><span class="lineno"> 6282</span>&#160;                  {</div>
<div class="line"><a name="l06283"></a><span class="lineno"> 6283</span>&#160;                    mom_w_adv_ext[0] -= MOVING_DOMAIN*mom_w_acc_ext*xt_ext;</div>
<div class="line"><a name="l06284"></a><span class="lineno"> 6284</span>&#160;                    mom_w_adv_ext[1] -= MOVING_DOMAIN*mom_w_acc_ext*yt_ext;</div>
<div class="line"><a name="l06285"></a><span class="lineno"> 6285</span>&#160;                    mom_w_adv_ext[2] -= MOVING_DOMAIN*mom_w_acc_ext*zt_ext;</div>
<div class="line"><a name="l06286"></a><span class="lineno"> 6286</span>&#160;                    dmom_w_adv_w_ext[0] -= MOVING_DOMAIN*dmom_w_acc_w_ext*xt_ext;</div>
<div class="line"><a name="l06287"></a><span class="lineno"> 6287</span>&#160;                    dmom_w_adv_w_ext[1] -= MOVING_DOMAIN*dmom_w_acc_w_ext*yt_ext;</div>
<div class="line"><a name="l06288"></a><span class="lineno"> 6288</span>&#160;                    dmom_w_adv_w_ext[2] -= MOVING_DOMAIN*dmom_w_acc_w_ext*zt_ext;</div>
<div class="line"><a name="l06289"></a><span class="lineno"> 6289</span>&#160;                  }</div>
<div class="line"><a name="l06290"></a><span class="lineno"> 6290</span>&#160; </div>
<div class="line"><a name="l06291"></a><span class="lineno"> 6291</span>&#160;                <span class="comment">//moving domain bc&#39;s</span></div>
<div class="line"><a name="l06292"></a><span class="lineno"> 6292</span>&#160;                <span class="keywordflow">if</span> (NONCONSERVATIVE_FORM &lt; 1.0)</div>
<div class="line"><a name="l06293"></a><span class="lineno"> 6293</span>&#160;                  {</div>
<div class="line"><a name="l06294"></a><span class="lineno"> 6294</span>&#160;                    bc_mom_u_adv_ext[0] -= MOVING_DOMAIN*bc_mom_u_acc_ext*xt_ext;</div>
<div class="line"><a name="l06295"></a><span class="lineno"> 6295</span>&#160;                    bc_mom_u_adv_ext[1] -= MOVING_DOMAIN*bc_mom_u_acc_ext*yt_ext;</div>
<div class="line"><a name="l06296"></a><span class="lineno"> 6296</span>&#160;                    bc_mom_u_adv_ext[2] -= MOVING_DOMAIN*bc_mom_u_acc_ext*zt_ext;</div>
<div class="line"><a name="l06297"></a><span class="lineno"> 6297</span>&#160; </div>
<div class="line"><a name="l06298"></a><span class="lineno"> 6298</span>&#160;                    bc_mom_v_adv_ext[0] -= MOVING_DOMAIN*bc_mom_v_acc_ext*xt_ext;</div>
<div class="line"><a name="l06299"></a><span class="lineno"> 6299</span>&#160;                    bc_mom_v_adv_ext[1] -= MOVING_DOMAIN*bc_mom_v_acc_ext*yt_ext;</div>
<div class="line"><a name="l06300"></a><span class="lineno"> 6300</span>&#160;                    bc_mom_v_adv_ext[2] -= MOVING_DOMAIN*bc_mom_v_acc_ext*zt_ext;</div>
<div class="line"><a name="l06301"></a><span class="lineno"> 6301</span>&#160; </div>
<div class="line"><a name="l06302"></a><span class="lineno"> 6302</span>&#160;                    bc_mom_w_adv_ext[0] -= MOVING_DOMAIN*bc_mom_w_acc_ext*xt_ext;</div>
<div class="line"><a name="l06303"></a><span class="lineno"> 6303</span>&#160;                    bc_mom_w_adv_ext[1] -= MOVING_DOMAIN*bc_mom_w_acc_ext*yt_ext;</div>
<div class="line"><a name="l06304"></a><span class="lineno"> 6304</span>&#160;                    bc_mom_w_adv_ext[2] -= MOVING_DOMAIN*bc_mom_w_acc_ext*zt_ext;</div>
<div class="line"><a name="l06305"></a><span class="lineno"> 6305</span>&#160;                  }</div>
<div class="line"><a name="l06306"></a><span class="lineno"> 6306</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l06307"></a><span class="lineno"> 6307</span>&#160;                <span class="comment">//calculate the numerical fluxes</span></div>
<div class="line"><a name="l06308"></a><span class="lineno"> 6308</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l06309"></a><span class="lineno"> 6309</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a25f4dd4b428fe7b1487c82d93fa3a0c7">exteriorNumericalAdvectiveFluxDerivatives</a>(NONCONSERVATIVE_FORM,</div>
<div class="line"><a name="l06310"></a><span class="lineno"> 6310</span>&#160;                                                          isDOFBoundary_p[ebNE_kb],</div>
<div class="line"><a name="l06311"></a><span class="lineno"> 6311</span>&#160;                                                          isDOFBoundary_u[ebNE_kb],</div>
<div class="line"><a name="l06312"></a><span class="lineno"> 6312</span>&#160;                                                          isDOFBoundary_v[ebNE_kb],</div>
<div class="line"><a name="l06313"></a><span class="lineno"> 6313</span>&#160;                                                          isDOFBoundary_w[ebNE_kb],</div>
<div class="line"><a name="l06314"></a><span class="lineno"> 6314</span>&#160;                                                          isAdvectiveFluxBoundary_p[ebNE_kb],</div>
<div class="line"><a name="l06315"></a><span class="lineno"> 6315</span>&#160;                                                          isAdvectiveFluxBoundary_u[ebNE_kb],</div>
<div class="line"><a name="l06316"></a><span class="lineno"> 6316</span>&#160;                                                          isAdvectiveFluxBoundary_v[ebNE_kb],</div>
<div class="line"><a name="l06317"></a><span class="lineno"> 6317</span>&#160;                                                          isAdvectiveFluxBoundary_w[ebNE_kb],</div>
<div class="line"><a name="l06318"></a><span class="lineno"> 6318</span>&#160;                                                          dmom_u_ham_grad_p_ext[0],<span class="comment">//=1/rho</span></div>
<div class="line"><a name="l06319"></a><span class="lineno"> 6319</span>&#160;                                                          normal,</div>
<div class="line"><a name="l06320"></a><span class="lineno"> 6320</span>&#160;                                                          bc_p_ext,</div>
<div class="line"><a name="l06321"></a><span class="lineno"> 6321</span>&#160;                                                          bc_u_ext,</div>
<div class="line"><a name="l06322"></a><span class="lineno"> 6322</span>&#160;                                                          bc_v_ext,</div>
<div class="line"><a name="l06323"></a><span class="lineno"> 6323</span>&#160;                                                          bc_w_ext,</div>
<div class="line"><a name="l06324"></a><span class="lineno"> 6324</span>&#160;                                                          bc_mass_adv_ext,</div>
<div class="line"><a name="l06325"></a><span class="lineno"> 6325</span>&#160;                                                          bc_mom_u_adv_ext,</div>
<div class="line"><a name="l06326"></a><span class="lineno"> 6326</span>&#160;                                                          bc_mom_v_adv_ext,</div>
<div class="line"><a name="l06327"></a><span class="lineno"> 6327</span>&#160;                                                          bc_mom_w_adv_ext,</div>
<div class="line"><a name="l06328"></a><span class="lineno"> 6328</span>&#160;                                                          ebqe_bc_flux_mass_ext[ebNE_kb]+MOVING_DOMAIN*(xt_ext*normal[0]+yt_ext*normal[1]+zt_ext*normal[2]),<span class="comment">//bc is relative mass  flux</span></div>
<div class="line"><a name="l06329"></a><span class="lineno"> 6329</span>&#160;                                                          ebqe_bc_flux_mom_u_adv_ext[ebNE_kb],</div>
<div class="line"><a name="l06330"></a><span class="lineno"> 6330</span>&#160;                                                          ebqe_bc_flux_mom_v_adv_ext[ebNE_kb],</div>
<div class="line"><a name="l06331"></a><span class="lineno"> 6331</span>&#160;                                                          ebqe_bc_flux_mom_w_adv_ext[ebNE_kb],</div>
<div class="line"><a name="l06332"></a><span class="lineno"> 6332</span>&#160;                                                          p_ext,</div>
<div class="line"><a name="l06333"></a><span class="lineno"> 6333</span>&#160;                                                          u_ext,</div>
<div class="line"><a name="l06334"></a><span class="lineno"> 6334</span>&#160;                                                          v_ext,</div>
<div class="line"><a name="l06335"></a><span class="lineno"> 6335</span>&#160;                                                          w_ext,</div>
<div class="line"><a name="l06336"></a><span class="lineno"> 6336</span>&#160;                                                          dmom_u_acc_u_ext,</div>
<div class="line"><a name="l06337"></a><span class="lineno"> 6337</span>&#160;                                                          mass_adv_ext,</div>
<div class="line"><a name="l06338"></a><span class="lineno"> 6338</span>&#160;                                                          mom_u_adv_ext,</div>
<div class="line"><a name="l06339"></a><span class="lineno"> 6339</span>&#160;                                                          mom_v_adv_ext,</div>
<div class="line"><a name="l06340"></a><span class="lineno"> 6340</span>&#160;                                                          mom_w_adv_ext,</div>
<div class="line"><a name="l06341"></a><span class="lineno"> 6341</span>&#160;                                                          dmass_adv_u_ext,</div>
<div class="line"><a name="l06342"></a><span class="lineno"> 6342</span>&#160;                                                          dmass_adv_v_ext,</div>
<div class="line"><a name="l06343"></a><span class="lineno"> 6343</span>&#160;                                                          dmass_adv_w_ext,</div>
<div class="line"><a name="l06344"></a><span class="lineno"> 6344</span>&#160;                                                          dmom_u_adv_p_ext,</div>
<div class="line"><a name="l06345"></a><span class="lineno"> 6345</span>&#160;                                                          dmom_u_ham_grad_u_ext,</div>
<div class="line"><a name="l06346"></a><span class="lineno"> 6346</span>&#160;                                                          dmom_u_adv_u_ext,</div>
<div class="line"><a name="l06347"></a><span class="lineno"> 6347</span>&#160;                                                          dmom_u_adv_v_ext,</div>
<div class="line"><a name="l06348"></a><span class="lineno"> 6348</span>&#160;                                                          dmom_u_adv_w_ext,</div>
<div class="line"><a name="l06349"></a><span class="lineno"> 6349</span>&#160;                                                          dmom_v_adv_p_ext,</div>
<div class="line"><a name="l06350"></a><span class="lineno"> 6350</span>&#160;                                                          dmom_v_adv_u_ext,</div>
<div class="line"><a name="l06351"></a><span class="lineno"> 6351</span>&#160;                                                          dmom_v_adv_v_ext,</div>
<div class="line"><a name="l06352"></a><span class="lineno"> 6352</span>&#160;                                                          dmom_v_adv_w_ext,</div>
<div class="line"><a name="l06353"></a><span class="lineno"> 6353</span>&#160;                                                          dmom_w_adv_p_ext,</div>
<div class="line"><a name="l06354"></a><span class="lineno"> 6354</span>&#160;                                                          dmom_w_adv_u_ext,</div>
<div class="line"><a name="l06355"></a><span class="lineno"> 6355</span>&#160;                                                          dmom_w_adv_v_ext,</div>
<div class="line"><a name="l06356"></a><span class="lineno"> 6356</span>&#160;                                                          dmom_w_adv_w_ext,</div>
<div class="line"><a name="l06357"></a><span class="lineno"> 6357</span>&#160;                                                          dflux_mass_u_ext,</div>
<div class="line"><a name="l06358"></a><span class="lineno"> 6358</span>&#160;                                                          dflux_mass_v_ext,</div>
<div class="line"><a name="l06359"></a><span class="lineno"> 6359</span>&#160;                                                          dflux_mass_w_ext,</div>
<div class="line"><a name="l06360"></a><span class="lineno"> 6360</span>&#160;                                                          dflux_mom_u_adv_p_ext,</div>
<div class="line"><a name="l06361"></a><span class="lineno"> 6361</span>&#160;                                                          dflux_mom_u_adv_u_ext,</div>
<div class="line"><a name="l06362"></a><span class="lineno"> 6362</span>&#160;                                                          dflux_mom_u_adv_v_ext,</div>
<div class="line"><a name="l06363"></a><span class="lineno"> 6363</span>&#160;                                                          dflux_mom_u_adv_w_ext,</div>
<div class="line"><a name="l06364"></a><span class="lineno"> 6364</span>&#160;                                                          dflux_mom_v_adv_p_ext,</div>
<div class="line"><a name="l06365"></a><span class="lineno"> 6365</span>&#160;                                                          dflux_mom_v_adv_u_ext,</div>
<div class="line"><a name="l06366"></a><span class="lineno"> 6366</span>&#160;                                                          dflux_mom_v_adv_v_ext,</div>
<div class="line"><a name="l06367"></a><span class="lineno"> 6367</span>&#160;                                                          dflux_mom_v_adv_w_ext,</div>
<div class="line"><a name="l06368"></a><span class="lineno"> 6368</span>&#160;                                                          dflux_mom_w_adv_p_ext,</div>
<div class="line"><a name="l06369"></a><span class="lineno"> 6369</span>&#160;                                                          dflux_mom_w_adv_u_ext,</div>
<div class="line"><a name="l06370"></a><span class="lineno"> 6370</span>&#160;                                                          dflux_mom_w_adv_v_ext,</div>
<div class="line"><a name="l06371"></a><span class="lineno"> 6371</span>&#160;                                                          dflux_mom_w_adv_w_ext);</div>
<div class="line"><a name="l06372"></a><span class="lineno"> 6372</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l06373"></a><span class="lineno"> 6373</span>&#160;                <span class="comment">//calculate the flux jacobian</span></div>
<div class="line"><a name="l06374"></a><span class="lineno"> 6374</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l06375"></a><span class="lineno"> 6375</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.calculateGScale(G,normal,h_penalty);</div>
<div class="line"><a name="l06376"></a><span class="lineno"> 6376</span>&#160;                penalty = useMetrics*C_b/h_penalty + (1.0-useMetrics)*ebqe_penalty_ext[ebNE_kb];</div>
<div class="line"><a name="l06377"></a><span class="lineno"> 6377</span>&#160;                <span class="keywordflow">if</span>(<span class="keyword">true</span>)<span class="comment">//boundaryFlags[ebN] &gt; 0)</span></div>
<div class="line"><a name="l06378"></a><span class="lineno"> 6378</span>&#160;                  { <span class="comment">//if boundary flag positive, then include flux contributions on interpart boundaries</span></div>
<div class="line"><a name="l06379"></a><span class="lineno"> 6379</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0;j&lt;nDOF_trial_element;j++)</div>
<div class="line"><a name="l06380"></a><span class="lineno"> 6380</span>&#160;                      {</div>
<div class="line"><a name="l06381"></a><span class="lineno"> 6381</span>&#160;                        <span class="keyword">register</span> <span class="keywordtype">int</span> j_nSpace = j*nSpace,ebN_local_kb_j=ebN_local_kb*nDOF_trial_element+j;</div>
<div class="line"><a name="l06382"></a><span class="lineno"> 6382</span>&#160;                        fluxJacobian_p_p[j]=0.0;</div>
<div class="line"><a name="l06383"></a><span class="lineno"> 6383</span>&#160;                        fluxJacobian_u_p[j]=<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.ExteriorNumericalAdvectiveFluxJacobian(dflux_mom_u_adv_p_ext,p_trial_trace_ref[ebN_local_kb_j]);</div>
<div class="line"><a name="l06384"></a><span class="lineno"> 6384</span>&#160;                        fluxJacobian_v_p[j]=<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.ExteriorNumericalAdvectiveFluxJacobian(dflux_mom_v_adv_p_ext,p_trial_trace_ref[ebN_local_kb_j]);</div>
<div class="line"><a name="l06385"></a><span class="lineno"> 6385</span>&#160;                        fluxJacobian_w_p[j]=<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.ExteriorNumericalAdvectiveFluxJacobian(dflux_mom_w_adv_p_ext,p_trial_trace_ref[ebN_local_kb_j]);</div>
<div class="line"><a name="l06386"></a><span class="lineno"> 6386</span>&#160;                      }</div>
<div class="line"><a name="l06387"></a><span class="lineno"> 6387</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0;j&lt;nDOF_v_trial_element;j++)</div>
<div class="line"><a name="l06388"></a><span class="lineno"> 6388</span>&#160;                      {</div>
<div class="line"><a name="l06389"></a><span class="lineno"> 6389</span>&#160;                        <span class="keyword">register</span> <span class="keywordtype">int</span> j_nSpace = j*nSpace,ebN_local_kb_j=ebN_local_kb*nDOF_v_trial_element+j;</div>
<div class="line"><a name="l06390"></a><span class="lineno"> 6390</span>&#160;                        fluxJacobian_p_u[j]=<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.ExteriorNumericalAdvectiveFluxJacobian(dflux_mass_u_ext,vel_trial_trace_ref[ebN_local_kb_j]);</div>
<div class="line"><a name="l06391"></a><span class="lineno"> 6391</span>&#160;                        fluxJacobian_p_v[j]=<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.ExteriorNumericalAdvectiveFluxJacobian(dflux_mass_v_ext,vel_trial_trace_ref[ebN_local_kb_j]);</div>
<div class="line"><a name="l06392"></a><span class="lineno"> 6392</span>&#160;                        fluxJacobian_p_w[j]=<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.ExteriorNumericalAdvectiveFluxJacobian(dflux_mass_w_ext,vel_trial_trace_ref[ebN_local_kb_j]);</div>
<div class="line"><a name="l06393"></a><span class="lineno"> 6393</span>&#160;                        fluxJacobian_u_u[j]=<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.ExteriorNumericalAdvectiveFluxJacobian(dflux_mom_u_adv_u_ext,vel_trial_trace_ref[ebN_local_kb_j]) +</div>
<div class="line"><a name="l06394"></a><span class="lineno"> 6394</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#ad7f7189cfca7297be05b3782551714b0">ExteriorNumericalDiffusiveFluxJacobian</a>(eps_rho,</div>
<div class="line"><a name="l06395"></a><span class="lineno"> 6395</span>&#160;                                                                 ebqe_phi_ext[ebNE_kb],</div>
<div class="line"><a name="l06396"></a><span class="lineno"> 6396</span>&#160;                                                                 sdInfo_u_u_rowptr,</div>
<div class="line"><a name="l06397"></a><span class="lineno"> 6397</span>&#160;                                                                 sdInfo_u_u_colind,</div>
<div class="line"><a name="l06398"></a><span class="lineno"> 6398</span>&#160;                                                                 isDOFBoundary_u[ebNE_kb],</div>
<div class="line"><a name="l06399"></a><span class="lineno"> 6399</span>&#160;                                                                 isDiffusiveFluxBoundary_u[ebNE_kb],</div>
<div class="line"><a name="l06400"></a><span class="lineno"> 6400</span>&#160;                                                                 normal,</div>
<div class="line"><a name="l06401"></a><span class="lineno"> 6401</span>&#160;                                                                 mom_uu_diff_ten_ext,</div>
<div class="line"><a name="l06402"></a><span class="lineno"> 6402</span>&#160;                                                                 vel_trial_trace_ref[ebN_local_kb_j],</div>
<div class="line"><a name="l06403"></a><span class="lineno"> 6403</span>&#160;                                                                 &amp;vel_grad_trial_trace[j_nSpace],</div>
<div class="line"><a name="l06404"></a><span class="lineno"> 6404</span>&#160;                                                                 penalty);<span class="comment">//ebqe_penalty_ext[ebNE_kb]);</span></div>
<div class="line"><a name="l06405"></a><span class="lineno"> 6405</span>&#160;                        fluxJacobian_u_v[j]=<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.ExteriorNumericalAdvectiveFluxJacobian(dflux_mom_u_adv_v_ext,vel_trial_trace_ref[ebN_local_kb_j]) +</div>
<div class="line"><a name="l06406"></a><span class="lineno"> 6406</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#ad7f7189cfca7297be05b3782551714b0">ExteriorNumericalDiffusiveFluxJacobian</a>(eps_rho,</div>
<div class="line"><a name="l06407"></a><span class="lineno"> 6407</span>&#160;                                                                 ebqe_phi_ext[ebNE_kb],</div>
<div class="line"><a name="l06408"></a><span class="lineno"> 6408</span>&#160;                                                                 sdInfo_u_v_rowptr,</div>
<div class="line"><a name="l06409"></a><span class="lineno"> 6409</span>&#160;                                                                 sdInfo_u_v_colind,</div>
<div class="line"><a name="l06410"></a><span class="lineno"> 6410</span>&#160;                                                                 isDOFBoundary_v[ebNE_kb],</div>
<div class="line"><a name="l06411"></a><span class="lineno"> 6411</span>&#160;                                                                 isDiffusiveFluxBoundary_v[ebNE_kb],</div>
<div class="line"><a name="l06412"></a><span class="lineno"> 6412</span>&#160;                                                                 normal,</div>
<div class="line"><a name="l06413"></a><span class="lineno"> 6413</span>&#160;                                                                 mom_uv_diff_ten_ext,</div>
<div class="line"><a name="l06414"></a><span class="lineno"> 6414</span>&#160;                                                                 vel_trial_trace_ref[ebN_local_kb_j],</div>
<div class="line"><a name="l06415"></a><span class="lineno"> 6415</span>&#160;                                                                 &amp;vel_grad_trial_trace[j_nSpace],</div>
<div class="line"><a name="l06416"></a><span class="lineno"> 6416</span>&#160;                                                                 penalty);<span class="comment">//ebqe_penalty_ext[ebNE_kb]);</span></div>
<div class="line"><a name="l06417"></a><span class="lineno"> 6417</span>&#160;                        fluxJacobian_u_w[j]=<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.ExteriorNumericalAdvectiveFluxJacobian(dflux_mom_u_adv_w_ext,vel_trial_trace_ref[ebN_local_kb_j]) +</div>
<div class="line"><a name="l06418"></a><span class="lineno"> 6418</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#ad7f7189cfca7297be05b3782551714b0">ExteriorNumericalDiffusiveFluxJacobian</a>(eps_rho,</div>
<div class="line"><a name="l06419"></a><span class="lineno"> 6419</span>&#160;                                                                 ebqe_phi_ext[ebNE_kb],</div>
<div class="line"><a name="l06420"></a><span class="lineno"> 6420</span>&#160;                                                                 sdInfo_u_w_rowptr,</div>
<div class="line"><a name="l06421"></a><span class="lineno"> 6421</span>&#160;                                                                 sdInfo_u_w_colind,</div>
<div class="line"><a name="l06422"></a><span class="lineno"> 6422</span>&#160;                                                                 isDOFBoundary_w[ebNE_kb],</div>
<div class="line"><a name="l06423"></a><span class="lineno"> 6423</span>&#160;                                                                 isDiffusiveFluxBoundary_w[ebNE_kb],</div>
<div class="line"><a name="l06424"></a><span class="lineno"> 6424</span>&#160;                                                                 normal,</div>
<div class="line"><a name="l06425"></a><span class="lineno"> 6425</span>&#160;                                                                 mom_uw_diff_ten_ext,</div>
<div class="line"><a name="l06426"></a><span class="lineno"> 6426</span>&#160;                                                                 vel_trial_trace_ref[ebN_local_kb_j],</div>
<div class="line"><a name="l06427"></a><span class="lineno"> 6427</span>&#160;                                                                 &amp;vel_grad_trial_trace[j_nSpace],</div>
<div class="line"><a name="l06428"></a><span class="lineno"> 6428</span>&#160;                                                                 penalty);<span class="comment">//ebqe_penalty_ext[ebNE_kb]);</span></div>
<div class="line"><a name="l06429"></a><span class="lineno"> 6429</span>&#160; </div>
<div class="line"><a name="l06430"></a><span class="lineno"> 6430</span>&#160;                        fluxJacobian_v_u[j]=<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.ExteriorNumericalAdvectiveFluxJacobian(dflux_mom_v_adv_u_ext,vel_trial_trace_ref[ebN_local_kb_j]) +</div>
<div class="line"><a name="l06431"></a><span class="lineno"> 6431</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#ad7f7189cfca7297be05b3782551714b0">ExteriorNumericalDiffusiveFluxJacobian</a>(eps_rho,</div>
<div class="line"><a name="l06432"></a><span class="lineno"> 6432</span>&#160;                                                                 ebqe_phi_ext[ebNE_kb],</div>
<div class="line"><a name="l06433"></a><span class="lineno"> 6433</span>&#160;                                                                 sdInfo_v_u_rowptr,</div>
<div class="line"><a name="l06434"></a><span class="lineno"> 6434</span>&#160;                                                                 sdInfo_v_u_colind,</div>
<div class="line"><a name="l06435"></a><span class="lineno"> 6435</span>&#160;                                                                 isDOFBoundary_u[ebNE_kb],</div>
<div class="line"><a name="l06436"></a><span class="lineno"> 6436</span>&#160;                                                                 isDiffusiveFluxBoundary_u[ebNE_kb],</div>
<div class="line"><a name="l06437"></a><span class="lineno"> 6437</span>&#160;                                                                 normal,</div>
<div class="line"><a name="l06438"></a><span class="lineno"> 6438</span>&#160;                                                                 mom_vu_diff_ten_ext,</div>
<div class="line"><a name="l06439"></a><span class="lineno"> 6439</span>&#160;                                                                 vel_trial_trace_ref[ebN_local_kb_j],</div>
<div class="line"><a name="l06440"></a><span class="lineno"> 6440</span>&#160;                                                                 &amp;vel_grad_trial_trace[j_nSpace],</div>
<div class="line"><a name="l06441"></a><span class="lineno"> 6441</span>&#160;                                                                 penalty);<span class="comment">//ebqe_penalty_ext[ebNE_kb]);</span></div>
<div class="line"><a name="l06442"></a><span class="lineno"> 6442</span>&#160;                        fluxJacobian_v_v[j]=<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.ExteriorNumericalAdvectiveFluxJacobian(dflux_mom_v_adv_v_ext,vel_trial_trace_ref[ebN_local_kb_j]) +</div>
<div class="line"><a name="l06443"></a><span class="lineno"> 6443</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#ad7f7189cfca7297be05b3782551714b0">ExteriorNumericalDiffusiveFluxJacobian</a>(eps_rho,</div>
<div class="line"><a name="l06444"></a><span class="lineno"> 6444</span>&#160;                                                                 ebqe_phi_ext[ebNE_kb],</div>
<div class="line"><a name="l06445"></a><span class="lineno"> 6445</span>&#160;                                                                 sdInfo_v_v_rowptr,</div>
<div class="line"><a name="l06446"></a><span class="lineno"> 6446</span>&#160;                                                                 sdInfo_v_v_colind,</div>
<div class="line"><a name="l06447"></a><span class="lineno"> 6447</span>&#160;                                                                 isDOFBoundary_v[ebNE_kb],</div>
<div class="line"><a name="l06448"></a><span class="lineno"> 6448</span>&#160;                                                                 isDiffusiveFluxBoundary_v[ebNE_kb],</div>
<div class="line"><a name="l06449"></a><span class="lineno"> 6449</span>&#160;                                                                 normal,</div>
<div class="line"><a name="l06450"></a><span class="lineno"> 6450</span>&#160;                                                                 mom_vv_diff_ten_ext,</div>
<div class="line"><a name="l06451"></a><span class="lineno"> 6451</span>&#160;                                                                 vel_trial_trace_ref[ebN_local_kb_j],</div>
<div class="line"><a name="l06452"></a><span class="lineno"> 6452</span>&#160;                                                                 &amp;vel_grad_trial_trace[j_nSpace],</div>
<div class="line"><a name="l06453"></a><span class="lineno"> 6453</span>&#160;                                                                 penalty);<span class="comment">//ebqe_penalty_ext[ebNE_kb]);</span></div>
<div class="line"><a name="l06454"></a><span class="lineno"> 6454</span>&#160;                        fluxJacobian_v_w[j]=<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.ExteriorNumericalAdvectiveFluxJacobian(dflux_mom_v_adv_w_ext,vel_trial_trace_ref[ebN_local_kb_j]) +</div>
<div class="line"><a name="l06455"></a><span class="lineno"> 6455</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#ad7f7189cfca7297be05b3782551714b0">ExteriorNumericalDiffusiveFluxJacobian</a>(eps_rho,</div>
<div class="line"><a name="l06456"></a><span class="lineno"> 6456</span>&#160;                                                                 ebqe_phi_ext[ebNE_kb],</div>
<div class="line"><a name="l06457"></a><span class="lineno"> 6457</span>&#160;                                                                 sdInfo_v_w_rowptr,</div>
<div class="line"><a name="l06458"></a><span class="lineno"> 6458</span>&#160;                                                                 sdInfo_v_w_colind,</div>
<div class="line"><a name="l06459"></a><span class="lineno"> 6459</span>&#160;                                                                 isDOFBoundary_w[ebNE_kb],</div>
<div class="line"><a name="l06460"></a><span class="lineno"> 6460</span>&#160;                                                                 isDiffusiveFluxBoundary_w[ebNE_kb],</div>
<div class="line"><a name="l06461"></a><span class="lineno"> 6461</span>&#160;                                                                 normal,</div>
<div class="line"><a name="l06462"></a><span class="lineno"> 6462</span>&#160;                                                                 mom_vw_diff_ten_ext,</div>
<div class="line"><a name="l06463"></a><span class="lineno"> 6463</span>&#160;                                                                 vel_trial_trace_ref[ebN_local_kb_j],</div>
<div class="line"><a name="l06464"></a><span class="lineno"> 6464</span>&#160;                                                                 &amp;vel_grad_trial_trace[j_nSpace],</div>
<div class="line"><a name="l06465"></a><span class="lineno"> 6465</span>&#160;                                                                 penalty);<span class="comment">//ebqe_penalty_ext[ebNE_kb]);</span></div>
<div class="line"><a name="l06466"></a><span class="lineno"> 6466</span>&#160; </div>
<div class="line"><a name="l06467"></a><span class="lineno"> 6467</span>&#160;                        fluxJacobian_w_u[j]=<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.ExteriorNumericalAdvectiveFluxJacobian(dflux_mom_w_adv_u_ext,vel_trial_trace_ref[ebN_local_kb_j]) +</div>
<div class="line"><a name="l06468"></a><span class="lineno"> 6468</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#ad7f7189cfca7297be05b3782551714b0">ExteriorNumericalDiffusiveFluxJacobian</a>(eps_rho,</div>
<div class="line"><a name="l06469"></a><span class="lineno"> 6469</span>&#160;                                                                 ebqe_phi_ext[ebNE_kb],</div>
<div class="line"><a name="l06470"></a><span class="lineno"> 6470</span>&#160;                                                                 sdInfo_w_u_rowptr,</div>
<div class="line"><a name="l06471"></a><span class="lineno"> 6471</span>&#160;                                                                 sdInfo_w_u_colind,</div>
<div class="line"><a name="l06472"></a><span class="lineno"> 6472</span>&#160;                                                                 isDOFBoundary_u[ebNE_kb],</div>
<div class="line"><a name="l06473"></a><span class="lineno"> 6473</span>&#160;                                                                 isDiffusiveFluxBoundary_u[ebNE_kb],</div>
<div class="line"><a name="l06474"></a><span class="lineno"> 6474</span>&#160;                                                                 normal,</div>
<div class="line"><a name="l06475"></a><span class="lineno"> 6475</span>&#160;                                                                 mom_wu_diff_ten_ext,</div>
<div class="line"><a name="l06476"></a><span class="lineno"> 6476</span>&#160;                                                                 vel_trial_trace_ref[ebN_local_kb_j],</div>
<div class="line"><a name="l06477"></a><span class="lineno"> 6477</span>&#160;                                                                 &amp;vel_grad_trial_trace[j_nSpace],</div>
<div class="line"><a name="l06478"></a><span class="lineno"> 6478</span>&#160;                                                                 penalty);<span class="comment">//ebqe_penalty_ext[ebNE_kb]);</span></div>
<div class="line"><a name="l06479"></a><span class="lineno"> 6479</span>&#160;                        fluxJacobian_w_v[j]=<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.ExteriorNumericalAdvectiveFluxJacobian(dflux_mom_w_adv_v_ext,vel_trial_trace_ref[ebN_local_kb_j]) +</div>
<div class="line"><a name="l06480"></a><span class="lineno"> 6480</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#ad7f7189cfca7297be05b3782551714b0">ExteriorNumericalDiffusiveFluxJacobian</a>(eps_rho,</div>
<div class="line"><a name="l06481"></a><span class="lineno"> 6481</span>&#160;                                                                 ebqe_phi_ext[ebNE_kb],</div>
<div class="line"><a name="l06482"></a><span class="lineno"> 6482</span>&#160;                                                                 sdInfo_w_v_rowptr,</div>
<div class="line"><a name="l06483"></a><span class="lineno"> 6483</span>&#160;                                                                 sdInfo_w_v_colind,</div>
<div class="line"><a name="l06484"></a><span class="lineno"> 6484</span>&#160;                                                                 isDOFBoundary_v[ebNE_kb],</div>
<div class="line"><a name="l06485"></a><span class="lineno"> 6485</span>&#160;                                                                 isDiffusiveFluxBoundary_v[ebNE_kb],</div>
<div class="line"><a name="l06486"></a><span class="lineno"> 6486</span>&#160;                                                                 normal,</div>
<div class="line"><a name="l06487"></a><span class="lineno"> 6487</span>&#160;                                                                 mom_wv_diff_ten_ext,</div>
<div class="line"><a name="l06488"></a><span class="lineno"> 6488</span>&#160;                                                                 vel_trial_trace_ref[ebN_local_kb_j],</div>
<div class="line"><a name="l06489"></a><span class="lineno"> 6489</span>&#160;                                                                 &amp;vel_grad_trial_trace[j_nSpace],</div>
<div class="line"><a name="l06490"></a><span class="lineno"> 6490</span>&#160;                                                                 penalty);<span class="comment">//ebqe_penalty_ext[ebNE_kb]);</span></div>
<div class="line"><a name="l06491"></a><span class="lineno"> 6491</span>&#160;                        fluxJacobian_w_w[j]=<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.ExteriorNumericalAdvectiveFluxJacobian(dflux_mom_w_adv_w_ext,vel_trial_trace_ref[ebN_local_kb_j]) +</div>
<div class="line"><a name="l06492"></a><span class="lineno"> 6492</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#ad7f7189cfca7297be05b3782551714b0">ExteriorNumericalDiffusiveFluxJacobian</a>(eps_rho,</div>
<div class="line"><a name="l06493"></a><span class="lineno"> 6493</span>&#160;                                                                 ebqe_phi_ext[ebNE_kb],</div>
<div class="line"><a name="l06494"></a><span class="lineno"> 6494</span>&#160;                                                                 sdInfo_w_w_rowptr,</div>
<div class="line"><a name="l06495"></a><span class="lineno"> 6495</span>&#160;                                                                 sdInfo_w_w_colind,</div>
<div class="line"><a name="l06496"></a><span class="lineno"> 6496</span>&#160;                                                                 isDOFBoundary_w[ebNE_kb],</div>
<div class="line"><a name="l06497"></a><span class="lineno"> 6497</span>&#160;                                                                 isDiffusiveFluxBoundary_w[ebNE_kb],</div>
<div class="line"><a name="l06498"></a><span class="lineno"> 6498</span>&#160;                                                                 normal,</div>
<div class="line"><a name="l06499"></a><span class="lineno"> 6499</span>&#160;                                                                 mom_ww_diff_ten_ext,</div>
<div class="line"><a name="l06500"></a><span class="lineno"> 6500</span>&#160;                                                                 vel_trial_trace_ref[ebN_local_kb_j],</div>
<div class="line"><a name="l06501"></a><span class="lineno"> 6501</span>&#160;                                                                 &amp;vel_grad_trial_trace[j_nSpace],</div>
<div class="line"><a name="l06502"></a><span class="lineno"> 6502</span>&#160;                                                                 penalty);<span class="comment">//ebqe_penalty_ext[ebNE_kb]);</span></div>
<div class="line"><a name="l06503"></a><span class="lineno"> 6503</span>&#160;                      }<span class="comment">//j</span></div>
<div class="line"><a name="l06504"></a><span class="lineno"> 6504</span>&#160;                  }<span class="comment">//if boundaryFlags[ebN] positive</span></div>
<div class="line"><a name="l06505"></a><span class="lineno"> 6505</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l06506"></a><span class="lineno"> 6506</span>&#160;                <span class="comment">//update the global Jacobian from the flux Jacobian</span></div>
<div class="line"><a name="l06507"></a><span class="lineno"> 6507</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l06508"></a><span class="lineno"> 6508</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;nDOF_test_element;i++)</div>
<div class="line"><a name="l06509"></a><span class="lineno"> 6509</span>&#160;                  {</div>
<div class="line"><a name="l06510"></a><span class="lineno"> 6510</span>&#160;                    <span class="keyword">register</span> <span class="keywordtype">int</span> eN_i = eN*nDOF_test_element+i;</div>
<div class="line"><a name="l06511"></a><span class="lineno"> 6511</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0;j&lt;nDOF_trial_element;j++)</div>
<div class="line"><a name="l06512"></a><span class="lineno"> 6512</span>&#160;                      {</div>
<div class="line"><a name="l06513"></a><span class="lineno"> 6513</span>&#160;                        <span class="keyword">register</span> <span class="keywordtype">int</span> ebN_i_j = ebN*4*<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a7b007a2b0d9961faa8f679a3db540ca3">nDOF_test_X_trial_element</a> + i*nDOF_trial_element + j,ebN_local_kb_j=ebN_local_kb*nDOF_trial_element+j;</div>
<div class="line"><a name="l06514"></a><span class="lineno"> 6514</span>&#160; </div>
<div class="line"><a name="l06515"></a><span class="lineno"> 6515</span>&#160;                        globalJacobian[csrRowIndeces_p_p[eN_i] + csrColumnOffsets_eb_p_p[ebN_i_j]] += fluxJacobian_p_p[j]*p_test_dS[i];</div>
<div class="line"><a name="l06516"></a><span class="lineno"> 6516</span>&#160;                      }</div>
<div class="line"><a name="l06517"></a><span class="lineno"> 6517</span>&#160;                  }</div>
<div class="line"><a name="l06518"></a><span class="lineno"> 6518</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;nDOF_test_element;i++)</div>
<div class="line"><a name="l06519"></a><span class="lineno"> 6519</span>&#160;                  {</div>
<div class="line"><a name="l06520"></a><span class="lineno"> 6520</span>&#160;                    <span class="keyword">register</span> <span class="keywordtype">int</span> eN_i = eN*nDOF_test_element+i;</div>
<div class="line"><a name="l06521"></a><span class="lineno"> 6521</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0;j&lt;nDOF_v_trial_element;j++)</div>
<div class="line"><a name="l06522"></a><span class="lineno"> 6522</span>&#160;                      {</div>
<div class="line"><a name="l06523"></a><span class="lineno"> 6523</span>&#160;                        <span class="keyword">register</span> <span class="keywordtype">int</span> ebN_i_j = ebN*4*<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a657d5d64a05158d6d19614555ce257e7">nDOF_test_X_v_trial_element</a> + i*nDOF_v_trial_element + j,ebN_local_kb_j=ebN_local_kb*nDOF_v_trial_element+j;</div>
<div class="line"><a name="l06524"></a><span class="lineno"> 6524</span>&#160;                        globalJacobian[csrRowIndeces_p_u[eN_i] + csrColumnOffsets_eb_p_u[ebN_i_j]] += fluxJacobian_p_u[j]*p_test_dS[i];</div>
<div class="line"><a name="l06525"></a><span class="lineno"> 6525</span>&#160;                        globalJacobian[csrRowIndeces_p_v[eN_i] + csrColumnOffsets_eb_p_v[ebN_i_j]] += fluxJacobian_p_v[j]*p_test_dS[i];</div>
<div class="line"><a name="l06526"></a><span class="lineno"> 6526</span>&#160;                        globalJacobian[csrRowIndeces_p_w[eN_i] + csrColumnOffsets_eb_p_w[ebN_i_j]] += fluxJacobian_p_w[j]*p_test_dS[i];</div>
<div class="line"><a name="l06527"></a><span class="lineno"> 6527</span>&#160;                      }</div>
<div class="line"><a name="l06528"></a><span class="lineno"> 6528</span>&#160;                  }</div>
<div class="line"><a name="l06529"></a><span class="lineno"> 6529</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;nDOF_v_test_element;i++)</div>
<div class="line"><a name="l06530"></a><span class="lineno"> 6530</span>&#160;                  {</div>
<div class="line"><a name="l06531"></a><span class="lineno"> 6531</span>&#160;                    <span class="keyword">register</span> <span class="keywordtype">int</span> eN_i = eN*nDOF_v_test_element+i;</div>
<div class="line"><a name="l06532"></a><span class="lineno"> 6532</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0;j&lt;nDOF_trial_element;j++)</div>
<div class="line"><a name="l06533"></a><span class="lineno"> 6533</span>&#160;                      {</div>
<div class="line"><a name="l06534"></a><span class="lineno"> 6534</span>&#160;                        <span class="keyword">register</span> <span class="keywordtype">int</span> ebN_i_j = ebN*4*<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a6f565d2a300310b20f932576bd743238">nDOF_v_test_X_trial_element</a> + i*nDOF_trial_element + j,ebN_local_kb_j=ebN_local_kb*nDOF_trial_element+j;</div>
<div class="line"><a name="l06535"></a><span class="lineno"> 6535</span>&#160;                        globalJacobian[csrRowIndeces_u_p[eN_i] + csrColumnOffsets_eb_u_p[ebN_i_j]] += fluxJacobian_u_p[j]*vel_test_dS[i];</div>
<div class="line"><a name="l06536"></a><span class="lineno"> 6536</span>&#160;                        globalJacobian[csrRowIndeces_v_p[eN_i] + csrColumnOffsets_eb_v_p[ebN_i_j]] += fluxJacobian_v_p[j]*vel_test_dS[i];</div>
<div class="line"><a name="l06537"></a><span class="lineno"> 6537</span>&#160;                        globalJacobian[csrRowIndeces_w_p[eN_i] + csrColumnOffsets_eb_w_p[ebN_i_j]] += fluxJacobian_w_p[j]*vel_test_dS[i];</div>
<div class="line"><a name="l06538"></a><span class="lineno"> 6538</span>&#160;                      }</div>
<div class="line"><a name="l06539"></a><span class="lineno"> 6539</span>&#160;                  }</div>
<div class="line"><a name="l06540"></a><span class="lineno"> 6540</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;nDOF_v_test_element;i++)</div>
<div class="line"><a name="l06541"></a><span class="lineno"> 6541</span>&#160;                  {</div>
<div class="line"><a name="l06542"></a><span class="lineno"> 6542</span>&#160;                    <span class="keyword">register</span> <span class="keywordtype">int</span> eN_i = eN*nDOF_v_test_element+i;</div>
<div class="line"><a name="l06543"></a><span class="lineno"> 6543</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0;j&lt;nDOF_v_trial_element;j++)</div>
<div class="line"><a name="l06544"></a><span class="lineno"> 6544</span>&#160;                      {</div>
<div class="line"><a name="l06545"></a><span class="lineno"> 6545</span>&#160;                        <span class="keyword">register</span> <span class="keywordtype">int</span> ebN_i_j = ebN*4*<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a6352965aa4dc8cd7ae8cd6cb1c028c96">nDOF_v_test_X_v_trial_element</a> + i*nDOF_v_trial_element + j,ebN_local_kb_j=ebN_local_kb*nDOF_v_trial_element+j;</div>
<div class="line"><a name="l06546"></a><span class="lineno"> 6546</span>&#160;                        globalJacobian[csrRowIndeces_u_u[eN_i] + csrColumnOffsets_eb_u_u[ebN_i_j]] += fluxJacobian_u_u[j]*vel_test_dS[i]+</div>
<div class="line"><a name="l06547"></a><span class="lineno"> 6547</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.ExteriorElementBoundaryDiffusionAdjointJacobian(isDOFBoundary_u[ebNE_kb],</div>
<div class="line"><a name="l06548"></a><span class="lineno"> 6548</span>&#160;                                                                             isDiffusiveFluxBoundary_u[ebNE_kb],</div>
<div class="line"><a name="l06549"></a><span class="lineno"> 6549</span>&#160;                                                                             eb_adjoint_sigma,</div>
<div class="line"><a name="l06550"></a><span class="lineno"> 6550</span>&#160;                                                                             vel_trial_trace_ref[ebN_local_kb_j],</div>
<div class="line"><a name="l06551"></a><span class="lineno"> 6551</span>&#160;                                                                             normal,</div>
<div class="line"><a name="l06552"></a><span class="lineno"> 6552</span>&#160;                                                                             sdInfo_u_u_rowptr,</div>
<div class="line"><a name="l06553"></a><span class="lineno"> 6553</span>&#160;                                                                             sdInfo_u_u_colind,</div>
<div class="line"><a name="l06554"></a><span class="lineno"> 6554</span>&#160;                                                                             mom_uu_diff_ten_ext,</div>
<div class="line"><a name="l06555"></a><span class="lineno"> 6555</span>&#160;                                                                             &amp;vel_grad_test_dS[i*nSpace]);</div>
<div class="line"><a name="l06556"></a><span class="lineno"> 6556</span>&#160;                        globalJacobian[csrRowIndeces_u_v[eN_i] + csrColumnOffsets_eb_u_v[ebN_i_j]] += fluxJacobian_u_v[j]*vel_test_dS[i]+</div>
<div class="line"><a name="l06557"></a><span class="lineno"> 6557</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.ExteriorElementBoundaryDiffusionAdjointJacobian(isDOFBoundary_v[ebNE_kb],</div>
<div class="line"><a name="l06558"></a><span class="lineno"> 6558</span>&#160;                                                                             isDiffusiveFluxBoundary_u[ebNE_kb],</div>
<div class="line"><a name="l06559"></a><span class="lineno"> 6559</span>&#160;                                                                             eb_adjoint_sigma,</div>
<div class="line"><a name="l06560"></a><span class="lineno"> 6560</span>&#160;                                                                             vel_trial_trace_ref[ebN_local_kb_j],</div>
<div class="line"><a name="l06561"></a><span class="lineno"> 6561</span>&#160;                                                                             normal,</div>
<div class="line"><a name="l06562"></a><span class="lineno"> 6562</span>&#160;                                                                             sdInfo_u_v_rowptr,</div>
<div class="line"><a name="l06563"></a><span class="lineno"> 6563</span>&#160;                                                                             sdInfo_u_v_colind,</div>
<div class="line"><a name="l06564"></a><span class="lineno"> 6564</span>&#160;                                                                             mom_uv_diff_ten_ext,</div>
<div class="line"><a name="l06565"></a><span class="lineno"> 6565</span>&#160;                                                                             &amp;vel_grad_test_dS[i*nSpace]);</div>
<div class="line"><a name="l06566"></a><span class="lineno"> 6566</span>&#160;                        globalJacobian[csrRowIndeces_u_w[eN_i] + csrColumnOffsets_eb_u_w[ebN_i_j]] += fluxJacobian_u_w[j]*vel_test_dS[i]+</div>
<div class="line"><a name="l06567"></a><span class="lineno"> 6567</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.ExteriorElementBoundaryDiffusionAdjointJacobian(isDOFBoundary_w[ebNE_kb],</div>
<div class="line"><a name="l06568"></a><span class="lineno"> 6568</span>&#160;                                                                             isDiffusiveFluxBoundary_u[ebNE_kb],</div>
<div class="line"><a name="l06569"></a><span class="lineno"> 6569</span>&#160;                                                                             eb_adjoint_sigma,</div>
<div class="line"><a name="l06570"></a><span class="lineno"> 6570</span>&#160;                                                                             vel_trial_trace_ref[ebN_local_kb_j],</div>
<div class="line"><a name="l06571"></a><span class="lineno"> 6571</span>&#160;                                                                             normal,</div>
<div class="line"><a name="l06572"></a><span class="lineno"> 6572</span>&#160;                                                                             sdInfo_u_w_rowptr,</div>
<div class="line"><a name="l06573"></a><span class="lineno"> 6573</span>&#160;                                                                             sdInfo_u_w_colind,</div>
<div class="line"><a name="l06574"></a><span class="lineno"> 6574</span>&#160;                                                                             mom_uw_diff_ten_ext,</div>
<div class="line"><a name="l06575"></a><span class="lineno"> 6575</span>&#160;                                                                             &amp;vel_grad_test_dS[i*nSpace]);</div>
<div class="line"><a name="l06576"></a><span class="lineno"> 6576</span>&#160; </div>
<div class="line"><a name="l06577"></a><span class="lineno"> 6577</span>&#160;                        globalJacobian[csrRowIndeces_v_u[eN_i] + csrColumnOffsets_eb_v_u[ebN_i_j]] += fluxJacobian_v_u[j]*vel_test_dS[i]+</div>
<div class="line"><a name="l06578"></a><span class="lineno"> 6578</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.ExteriorElementBoundaryDiffusionAdjointJacobian(isDOFBoundary_u[ebNE_kb],</div>
<div class="line"><a name="l06579"></a><span class="lineno"> 6579</span>&#160;                                                                             isDiffusiveFluxBoundary_v[ebNE_kb],</div>
<div class="line"><a name="l06580"></a><span class="lineno"> 6580</span>&#160;                                                                             eb_adjoint_sigma,</div>
<div class="line"><a name="l06581"></a><span class="lineno"> 6581</span>&#160;                                                                             vel_trial_trace_ref[ebN_local_kb_j],</div>
<div class="line"><a name="l06582"></a><span class="lineno"> 6582</span>&#160;                                                                             normal,</div>
<div class="line"><a name="l06583"></a><span class="lineno"> 6583</span>&#160;                                                                             sdInfo_v_u_rowptr,</div>
<div class="line"><a name="l06584"></a><span class="lineno"> 6584</span>&#160;                                                                             sdInfo_v_u_colind,</div>
<div class="line"><a name="l06585"></a><span class="lineno"> 6585</span>&#160;                                                                             mom_vu_diff_ten_ext,</div>
<div class="line"><a name="l06586"></a><span class="lineno"> 6586</span>&#160;                                                                             &amp;vel_grad_test_dS[i*nSpace]);</div>
<div class="line"><a name="l06587"></a><span class="lineno"> 6587</span>&#160;                        globalJacobian[csrRowIndeces_v_v[eN_i] + csrColumnOffsets_eb_v_v[ebN_i_j]] += fluxJacobian_v_v[j]*vel_test_dS[i]+</div>
<div class="line"><a name="l06588"></a><span class="lineno"> 6588</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.ExteriorElementBoundaryDiffusionAdjointJacobian(isDOFBoundary_v[ebNE_kb],</div>
<div class="line"><a name="l06589"></a><span class="lineno"> 6589</span>&#160;                                                                             isDiffusiveFluxBoundary_v[ebNE_kb],</div>
<div class="line"><a name="l06590"></a><span class="lineno"> 6590</span>&#160;                                                                             eb_adjoint_sigma,</div>
<div class="line"><a name="l06591"></a><span class="lineno"> 6591</span>&#160;                                                                             vel_trial_trace_ref[ebN_local_kb_j],</div>
<div class="line"><a name="l06592"></a><span class="lineno"> 6592</span>&#160;                                                                             normal,</div>
<div class="line"><a name="l06593"></a><span class="lineno"> 6593</span>&#160;                                                                             sdInfo_v_v_rowptr,</div>
<div class="line"><a name="l06594"></a><span class="lineno"> 6594</span>&#160;                                                                             sdInfo_v_v_colind,</div>
<div class="line"><a name="l06595"></a><span class="lineno"> 6595</span>&#160;                                                                             mom_vv_diff_ten_ext,</div>
<div class="line"><a name="l06596"></a><span class="lineno"> 6596</span>&#160;                                                                             &amp;vel_grad_test_dS[i*nSpace]);</div>
<div class="line"><a name="l06597"></a><span class="lineno"> 6597</span>&#160;                        globalJacobian[csrRowIndeces_v_w[eN_i] + csrColumnOffsets_eb_v_w[ebN_i_j]] += fluxJacobian_v_w[j]*vel_test_dS[i]+</div>
<div class="line"><a name="l06598"></a><span class="lineno"> 6598</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.ExteriorElementBoundaryDiffusionAdjointJacobian(isDOFBoundary_w[ebNE_kb],</div>
<div class="line"><a name="l06599"></a><span class="lineno"> 6599</span>&#160;                                                                             isDiffusiveFluxBoundary_v[ebNE_kb],</div>
<div class="line"><a name="l06600"></a><span class="lineno"> 6600</span>&#160;                                                                             eb_adjoint_sigma,</div>
<div class="line"><a name="l06601"></a><span class="lineno"> 6601</span>&#160;                                                                             vel_trial_trace_ref[ebN_local_kb_j],</div>
<div class="line"><a name="l06602"></a><span class="lineno"> 6602</span>&#160;                                                                             normal,</div>
<div class="line"><a name="l06603"></a><span class="lineno"> 6603</span>&#160;                                                                             sdInfo_v_w_rowptr,</div>
<div class="line"><a name="l06604"></a><span class="lineno"> 6604</span>&#160;                                                                             sdInfo_v_w_colind,</div>
<div class="line"><a name="l06605"></a><span class="lineno"> 6605</span>&#160;                                                                             mom_vw_diff_ten_ext,</div>
<div class="line"><a name="l06606"></a><span class="lineno"> 6606</span>&#160;                                                                             &amp;vel_grad_test_dS[i*nSpace]);</div>
<div class="line"><a name="l06607"></a><span class="lineno"> 6607</span>&#160; </div>
<div class="line"><a name="l06608"></a><span class="lineno"> 6608</span>&#160;                        globalJacobian[csrRowIndeces_w_u[eN_i] + csrColumnOffsets_eb_w_u[ebN_i_j]] += fluxJacobian_w_u[j]*vel_test_dS[i]+</div>
<div class="line"><a name="l06609"></a><span class="lineno"> 6609</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.ExteriorElementBoundaryDiffusionAdjointJacobian(isDOFBoundary_u[ebNE_kb],</div>
<div class="line"><a name="l06610"></a><span class="lineno"> 6610</span>&#160;                                                                             isDiffusiveFluxBoundary_w[ebNE_kb],</div>
<div class="line"><a name="l06611"></a><span class="lineno"> 6611</span>&#160;                                                                             eb_adjoint_sigma,</div>
<div class="line"><a name="l06612"></a><span class="lineno"> 6612</span>&#160;                                                                             vel_trial_trace_ref[ebN_local_kb_j],</div>
<div class="line"><a name="l06613"></a><span class="lineno"> 6613</span>&#160;                                                                             normal,</div>
<div class="line"><a name="l06614"></a><span class="lineno"> 6614</span>&#160;                                                                             sdInfo_w_u_rowptr,</div>
<div class="line"><a name="l06615"></a><span class="lineno"> 6615</span>&#160;                                                                             sdInfo_w_u_colind,</div>
<div class="line"><a name="l06616"></a><span class="lineno"> 6616</span>&#160;                                                                             mom_wu_diff_ten_ext,</div>
<div class="line"><a name="l06617"></a><span class="lineno"> 6617</span>&#160;                                                                             &amp;vel_grad_test_dS[i*nSpace]);</div>
<div class="line"><a name="l06618"></a><span class="lineno"> 6618</span>&#160;                        globalJacobian[csrRowIndeces_w_v[eN_i] + csrColumnOffsets_eb_w_v[ebN_i_j]] += fluxJacobian_w_v[j]*vel_test_dS[i]+</div>
<div class="line"><a name="l06619"></a><span class="lineno"> 6619</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.ExteriorElementBoundaryDiffusionAdjointJacobian(isDOFBoundary_v[ebNE_kb],</div>
<div class="line"><a name="l06620"></a><span class="lineno"> 6620</span>&#160;                                                                             isDiffusiveFluxBoundary_w[ebNE_kb],</div>
<div class="line"><a name="l06621"></a><span class="lineno"> 6621</span>&#160;                                                                             eb_adjoint_sigma,</div>
<div class="line"><a name="l06622"></a><span class="lineno"> 6622</span>&#160;                                                                             vel_trial_trace_ref[ebN_local_kb_j],</div>
<div class="line"><a name="l06623"></a><span class="lineno"> 6623</span>&#160;                                                                             normal,</div>
<div class="line"><a name="l06624"></a><span class="lineno"> 6624</span>&#160;                                                                             sdInfo_w_v_rowptr,</div>
<div class="line"><a name="l06625"></a><span class="lineno"> 6625</span>&#160;                                                                             sdInfo_w_v_colind,</div>
<div class="line"><a name="l06626"></a><span class="lineno"> 6626</span>&#160;                                                                             mom_wv_diff_ten_ext,</div>
<div class="line"><a name="l06627"></a><span class="lineno"> 6627</span>&#160;                                                                             &amp;vel_grad_test_dS[i*nSpace]);</div>
<div class="line"><a name="l06628"></a><span class="lineno"> 6628</span>&#160;                        globalJacobian[csrRowIndeces_w_w[eN_i] + csrColumnOffsets_eb_w_w[ebN_i_j]] += fluxJacobian_w_w[j]*vel_test_dS[i]+</div>
<div class="line"><a name="l06629"></a><span class="lineno"> 6629</span>&#160;                          <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.ExteriorElementBoundaryDiffusionAdjointJacobian(isDOFBoundary_w[ebNE_kb],</div>
<div class="line"><a name="l06630"></a><span class="lineno"> 6630</span>&#160;                                                                             isDiffusiveFluxBoundary_w[ebNE_kb],</div>
<div class="line"><a name="l06631"></a><span class="lineno"> 6631</span>&#160;                                                                             eb_adjoint_sigma,</div>
<div class="line"><a name="l06632"></a><span class="lineno"> 6632</span>&#160;                                                                             vel_trial_trace_ref[ebN_local_kb_j],</div>
<div class="line"><a name="l06633"></a><span class="lineno"> 6633</span>&#160;                                                                             normal,</div>
<div class="line"><a name="l06634"></a><span class="lineno"> 6634</span>&#160;                                                                             sdInfo_w_w_rowptr,</div>
<div class="line"><a name="l06635"></a><span class="lineno"> 6635</span>&#160;                                                                             sdInfo_w_w_colind,</div>
<div class="line"><a name="l06636"></a><span class="lineno"> 6636</span>&#160;                                                                             mom_ww_diff_ten_ext,</div>
<div class="line"><a name="l06637"></a><span class="lineno"> 6637</span>&#160;                                                                             &amp;vel_grad_test_dS[i*nSpace]);</div>
<div class="line"><a name="l06638"></a><span class="lineno"> 6638</span>&#160;                      }<span class="comment">//j</span></div>
<div class="line"><a name="l06639"></a><span class="lineno"> 6639</span>&#160;                  }<span class="comment">//i</span></div>
<div class="line"><a name="l06640"></a><span class="lineno"> 6640</span>&#160;              }<span class="comment">//kb</span></div>
<div class="line"><a name="l06641"></a><span class="lineno"> 6641</span>&#160;          }<span class="comment">//ebNE</span></div>
<div class="line"><a name="l06642"></a><span class="lineno"> 6642</span>&#160;      }<span class="comment">//computeJacobian</span></div>
<div class="line"><a name="l06643"></a><span class="lineno"> 6643</span>&#160;        </div>
<div class="line"><a name="l06644"></a><span class="lineno"><a class="line" href="classproteus_1_1_r_a_n_s2_p.html#a811f562fa019020df780d30394ae4ec0"> 6644</a></span>&#160;      <span class="keywordtype">void</span> <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a811f562fa019020df780d30394ae4ec0">calculateVelocityAverage</a>(<span class="keywordtype">int</span> nExteriorElementBoundaries_global,</div>
<div class="line"><a name="l06645"></a><span class="lineno"> 6645</span>&#160;                                    <span class="keywordtype">int</span>* exteriorElementBoundariesArray,</div>
<div class="line"><a name="l06646"></a><span class="lineno"> 6646</span>&#160;                                    <span class="keywordtype">int</span> nInteriorElementBoundaries_global,</div>
<div class="line"><a name="l06647"></a><span class="lineno"> 6647</span>&#160;                                    <span class="keywordtype">int</span>* interiorElementBoundariesArray,</div>
<div class="line"><a name="l06648"></a><span class="lineno"> 6648</span>&#160;                                    <span class="keywordtype">int</span>* elementBoundaryElementsArray,</div>
<div class="line"><a name="l06649"></a><span class="lineno"> 6649</span>&#160;                                    <span class="keywordtype">int</span>* elementBoundaryLocalElementBoundariesArray,</div>
<div class="line"><a name="l06650"></a><span class="lineno"> 6650</span>&#160;                                    <span class="keywordtype">double</span>* mesh_dof,</div>
<div class="line"><a name="l06651"></a><span class="lineno"> 6651</span>&#160;                                    <span class="keywordtype">double</span>* mesh_velocity_dof,</div>
<div class="line"><a name="l06652"></a><span class="lineno"> 6652</span>&#160;                                    <span class="keywordtype">double</span> MOVING_DOMAIN,<span class="comment">//0 or 1</span></div>
<div class="line"><a name="l06653"></a><span class="lineno"> 6653</span>&#160;                                    <span class="keywordtype">int</span>* mesh_l2g,</div>
<div class="line"><a name="l06654"></a><span class="lineno"> 6654</span>&#160;                                    <span class="keywordtype">double</span>* mesh_trial_trace_ref,</div>
<div class="line"><a name="l06655"></a><span class="lineno"> 6655</span>&#160;                                    <span class="keywordtype">double</span>* mesh_grad_trial_trace_ref,</div>
<div class="line"><a name="l06656"></a><span class="lineno"> 6656</span>&#160;                                    <span class="keywordtype">double</span>* normal_ref,</div>
<div class="line"><a name="l06657"></a><span class="lineno"> 6657</span>&#160;                                    <span class="keywordtype">double</span>* boundaryJac_ref,</div>
<div class="line"><a name="l06658"></a><span class="lineno"> 6658</span>&#160;                                    <span class="keywordtype">int</span>* vel_l2g,</div>
<div class="line"><a name="l06659"></a><span class="lineno"> 6659</span>&#160;                                    <span class="keywordtype">double</span>* u_dof,</div>
<div class="line"><a name="l06660"></a><span class="lineno"> 6660</span>&#160;                                    <span class="keywordtype">double</span>* v_dof,</div>
<div class="line"><a name="l06661"></a><span class="lineno"> 6661</span>&#160;                                    <span class="keywordtype">double</span>* w_dof,</div>
<div class="line"><a name="l06662"></a><span class="lineno"> 6662</span>&#160;                                    <span class="keywordtype">double</span>* vel_trial_trace_ref,</div>
<div class="line"><a name="l06663"></a><span class="lineno"> 6663</span>&#160;                                    <span class="keywordtype">double</span>* ebqe_velocity,</div>
<div class="line"><a name="l06664"></a><span class="lineno"> 6664</span>&#160;                                    <span class="keywordtype">double</span>* velocityAverage)</div>
<div class="line"><a name="l06665"></a><span class="lineno"> 6665</span>&#160;      {</div>
<div class="line"><a name="l06666"></a><span class="lineno"> 6666</span>&#160;        <span class="keywordtype">int</span> permutations[nQuadraturePoints_elementBoundary];</div>
<div class="line"><a name="l06667"></a><span class="lineno"> 6667</span>&#160;        <span class="keywordtype">double</span> xArray_left[nQuadraturePoints_elementBoundary*3],</div>
<div class="line"><a name="l06668"></a><span class="lineno"> 6668</span>&#160;          xArray_right[nQuadraturePoints_elementBoundary*3];</div>
<div class="line"><a name="l06669"></a><span class="lineno"> 6669</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;nQuadraturePoints_elementBoundary;i++)</div>
<div class="line"><a name="l06670"></a><span class="lineno"> 6670</span>&#160;          permutations[i]=i;<span class="comment">//just to initialize</span></div>
<div class="line"><a name="l06671"></a><span class="lineno"> 6671</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ebNE = 0; ebNE &lt; nExteriorElementBoundaries_global; ebNE++)</div>
<div class="line"><a name="l06672"></a><span class="lineno"> 6672</span>&#160;          {</div>
<div class="line"><a name="l06673"></a><span class="lineno"> 6673</span>&#160;            <span class="keyword">register</span> <span class="keywordtype">int</span> ebN = exteriorElementBoundariesArray[ebNE];</div>
<div class="line"><a name="l06674"></a><span class="lineno"> 6674</span>&#160;            <span class="keywordflow">for</span>  (<span class="keywordtype">int</span> kb=0;kb&lt;nQuadraturePoints_elementBoundary;kb++)</div>
<div class="line"><a name="l06675"></a><span class="lineno"> 6675</span>&#160;              {</div>
<div class="line"><a name="l06676"></a><span class="lineno"> 6676</span>&#160;                <span class="keyword">register</span> <span class="keywordtype">int</span> ebN_kb_nSpace = ebN*nQuadraturePoints_elementBoundary*nSpace+kb*nSpace,</div>
<div class="line"><a name="l06677"></a><span class="lineno"> 6677</span>&#160;                  ebNE_kb_nSpace = ebNE*nQuadraturePoints_elementBoundary*nSpace+kb*nSpace;</div>
<div class="line"><a name="l06678"></a><span class="lineno"> 6678</span>&#160;                velocityAverage[ebN_kb_nSpace+0]=ebqe_velocity[ebNE_kb_nSpace+0];</div>
<div class="line"><a name="l06679"></a><span class="lineno"> 6679</span>&#160;                velocityAverage[ebN_kb_nSpace+1]=ebqe_velocity[ebNE_kb_nSpace+1];</div>
<div class="line"><a name="l06680"></a><span class="lineno"> 6680</span>&#160;                velocityAverage[ebN_kb_nSpace+2]=ebqe_velocity[ebNE_kb_nSpace+2];</div>
<div class="line"><a name="l06681"></a><span class="lineno"> 6681</span>&#160;              }<span class="comment">//ebNE</span></div>
<div class="line"><a name="l06682"></a><span class="lineno"> 6682</span>&#160;          }</div>
<div class="line"><a name="l06683"></a><span class="lineno"> 6683</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ebNI = 0; ebNI &lt; nInteriorElementBoundaries_global; ebNI++)</div>
<div class="line"><a name="l06684"></a><span class="lineno"> 6684</span>&#160;          {</div>
<div class="line"><a name="l06685"></a><span class="lineno"> 6685</span>&#160;            <span class="keyword">register</span> <span class="keywordtype">int</span> ebN = interiorElementBoundariesArray[ebNI],</div>
<div class="line"><a name="l06686"></a><span class="lineno"> 6686</span>&#160;              left_eN_global   = elementBoundaryElementsArray[ebN*2+0],</div>
<div class="line"><a name="l06687"></a><span class="lineno"> 6687</span>&#160;              left_ebN_element  = elementBoundaryLocalElementBoundariesArray[ebN*2+0],</div>
<div class="line"><a name="l06688"></a><span class="lineno"> 6688</span>&#160;              right_eN_global  = elementBoundaryElementsArray[ebN*2+1],</div>
<div class="line"><a name="l06689"></a><span class="lineno"> 6689</span>&#160;              right_ebN_element = elementBoundaryLocalElementBoundariesArray[ebN*2+1],</div>
<div class="line"><a name="l06690"></a><span class="lineno"> 6690</span>&#160;              left_eN_nDOF_trial_element = left_eN_global*nDOF_trial_element,</div>
<div class="line"><a name="l06691"></a><span class="lineno"> 6691</span>&#160;              right_eN_nDOF_trial_element = right_eN_global*nDOF_trial_element;</div>
<div class="line"><a name="l06692"></a><span class="lineno"> 6692</span>&#160;            <span class="keywordtype">double</span> jac[nSpace*nSpace],</div>
<div class="line"><a name="l06693"></a><span class="lineno"> 6693</span>&#160;              jacDet,</div>
<div class="line"><a name="l06694"></a><span class="lineno"> 6694</span>&#160;              jacInv[nSpace*nSpace],</div>
<div class="line"><a name="l06695"></a><span class="lineno"> 6695</span>&#160;              boundaryJac[nSpace*(nSpace-1)],</div>
<div class="line"><a name="l06696"></a><span class="lineno"> 6696</span>&#160;              metricTensor[(nSpace-1)*(nSpace-1)],</div>
<div class="line"><a name="l06697"></a><span class="lineno"> 6697</span>&#160;              metricTensorDetSqrt,</div>
<div class="line"><a name="l06698"></a><span class="lineno"> 6698</span>&#160;              normal[3],</div>
<div class="line"><a name="l06699"></a><span class="lineno"> 6699</span>&#160;              x,y,<a class="code" href="_headers_8h.html#a9d199fcfc162b9ad09d4c9426e713a74">z</a>,</div>
<div class="line"><a name="l06700"></a><span class="lineno"> 6700</span>&#160;              xt,yt,zt,integralScaling;</div>
<div class="line"><a name="l06701"></a><span class="lineno"> 6701</span>&#160; </div>
<div class="line"><a name="l06702"></a><span class="lineno"> 6702</span>&#160;            <span class="keywordflow">for</span>  (<span class="keywordtype">int</span> kb=0;kb&lt;nQuadraturePoints_elementBoundary;kb++)</div>
<div class="line"><a name="l06703"></a><span class="lineno"> 6703</span>&#160;              {</div>
<div class="line"><a name="l06704"></a><span class="lineno"> 6704</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.calculateMapping_elementBoundary(left_eN_global,</div>
<div class="line"><a name="l06705"></a><span class="lineno"> 6705</span>&#160;                                                    left_ebN_element,</div>
<div class="line"><a name="l06706"></a><span class="lineno"> 6706</span>&#160;                                                    kb,</div>
<div class="line"><a name="l06707"></a><span class="lineno"> 6707</span>&#160;                                                    left_ebN_element*nQuadraturePoints_elementBoundary+kb,</div>
<div class="line"><a name="l06708"></a><span class="lineno"> 6708</span>&#160;                                                    mesh_dof,</div>
<div class="line"><a name="l06709"></a><span class="lineno"> 6709</span>&#160;                                                    mesh_l2g,</div>
<div class="line"><a name="l06710"></a><span class="lineno"> 6710</span>&#160;                                                    mesh_trial_trace_ref,</div>
<div class="line"><a name="l06711"></a><span class="lineno"> 6711</span>&#160;                                                    mesh_grad_trial_trace_ref,</div>
<div class="line"><a name="l06712"></a><span class="lineno"> 6712</span>&#160;                                                    boundaryJac_ref,</div>
<div class="line"><a name="l06713"></a><span class="lineno"> 6713</span>&#160;                                                    jac,</div>
<div class="line"><a name="l06714"></a><span class="lineno"> 6714</span>&#160;                                                    jacDet,</div>
<div class="line"><a name="l06715"></a><span class="lineno"> 6715</span>&#160;                                                    jacInv,</div>
<div class="line"><a name="l06716"></a><span class="lineno"> 6716</span>&#160;                                                    boundaryJac,</div>
<div class="line"><a name="l06717"></a><span class="lineno"> 6717</span>&#160;                                                    metricTensor,</div>
<div class="line"><a name="l06718"></a><span class="lineno"> 6718</span>&#160;                                                    metricTensorDetSqrt,</div>
<div class="line"><a name="l06719"></a><span class="lineno"> 6719</span>&#160;                                                    normal_ref,</div>
<div class="line"><a name="l06720"></a><span class="lineno"> 6720</span>&#160;                                                    normal,</div>
<div class="line"><a name="l06721"></a><span class="lineno"> 6721</span>&#160;                                                    x,y,<a class="code" href="_headers_8h.html#a9d199fcfc162b9ad09d4c9426e713a74">z</a>);</div>
<div class="line"><a name="l06722"></a><span class="lineno"> 6722</span>&#160;                xArray_left[kb*3+0] = x;</div>
<div class="line"><a name="l06723"></a><span class="lineno"> 6723</span>&#160;                xArray_left[kb*3+1] = y;</div>
<div class="line"><a name="l06724"></a><span class="lineno"> 6724</span>&#160;                xArray_left[kb*3+2] = <a class="code" href="_headers_8h.html#a9d199fcfc162b9ad09d4c9426e713a74">z</a>;</div>
<div class="line"><a name="l06725"></a><span class="lineno"> 6725</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.calculateMapping_elementBoundary(right_eN_global,</div>
<div class="line"><a name="l06726"></a><span class="lineno"> 6726</span>&#160;                                                    right_ebN_element,</div>
<div class="line"><a name="l06727"></a><span class="lineno"> 6727</span>&#160;                                                    kb,</div>
<div class="line"><a name="l06728"></a><span class="lineno"> 6728</span>&#160;                                                    right_ebN_element*nQuadraturePoints_elementBoundary+kb,</div>
<div class="line"><a name="l06729"></a><span class="lineno"> 6729</span>&#160;                                                    mesh_dof,</div>
<div class="line"><a name="l06730"></a><span class="lineno"> 6730</span>&#160;                                                    mesh_l2g,</div>
<div class="line"><a name="l06731"></a><span class="lineno"> 6731</span>&#160;                                                    mesh_trial_trace_ref,</div>
<div class="line"><a name="l06732"></a><span class="lineno"> 6732</span>&#160;                                                    mesh_grad_trial_trace_ref,</div>
<div class="line"><a name="l06733"></a><span class="lineno"> 6733</span>&#160;                                                    boundaryJac_ref,</div>
<div class="line"><a name="l06734"></a><span class="lineno"> 6734</span>&#160;                                                    jac,</div>
<div class="line"><a name="l06735"></a><span class="lineno"> 6735</span>&#160;                                                    jacDet,</div>
<div class="line"><a name="l06736"></a><span class="lineno"> 6736</span>&#160;                                                    jacInv,</div>
<div class="line"><a name="l06737"></a><span class="lineno"> 6737</span>&#160;                                                    boundaryJac,</div>
<div class="line"><a name="l06738"></a><span class="lineno"> 6738</span>&#160;                                                    metricTensor,</div>
<div class="line"><a name="l06739"></a><span class="lineno"> 6739</span>&#160;                                                    metricTensorDetSqrt,</div>
<div class="line"><a name="l06740"></a><span class="lineno"> 6740</span>&#160;                                                    normal_ref,</div>
<div class="line"><a name="l06741"></a><span class="lineno"> 6741</span>&#160;                                                    normal,</div>
<div class="line"><a name="l06742"></a><span class="lineno"> 6742</span>&#160;                                                    x,y,<a class="code" href="_headers_8h.html#a9d199fcfc162b9ad09d4c9426e713a74">z</a>);</div>
<div class="line"><a name="l06743"></a><span class="lineno"> 6743</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.calculateMappingVelocity_elementBoundary(left_eN_global,</div>
<div class="line"><a name="l06744"></a><span class="lineno"> 6744</span>&#160;                                                            left_ebN_element,</div>
<div class="line"><a name="l06745"></a><span class="lineno"> 6745</span>&#160;                                                            kb,</div>
<div class="line"><a name="l06746"></a><span class="lineno"> 6746</span>&#160;                                                            left_ebN_element*nQuadraturePoints_elementBoundary+kb,</div>
<div class="line"><a name="l06747"></a><span class="lineno"> 6747</span>&#160;                                                            mesh_velocity_dof,</div>
<div class="line"><a name="l06748"></a><span class="lineno"> 6748</span>&#160;                                                            mesh_l2g,</div>
<div class="line"><a name="l06749"></a><span class="lineno"> 6749</span>&#160;                                                            mesh_trial_trace_ref,</div>
<div class="line"><a name="l06750"></a><span class="lineno"> 6750</span>&#160;                                                            xt,yt,zt,</div>
<div class="line"><a name="l06751"></a><span class="lineno"> 6751</span>&#160;                                                            normal,</div>
<div class="line"><a name="l06752"></a><span class="lineno"> 6752</span>&#160;                                                            boundaryJac,</div>
<div class="line"><a name="l06753"></a><span class="lineno"> 6753</span>&#160;                                                            metricTensor,</div>
<div class="line"><a name="l06754"></a><span class="lineno"> 6754</span>&#160;                                                            integralScaling);</div>
<div class="line"><a name="l06755"></a><span class="lineno"> 6755</span>&#160;                xArray_right[kb*3+0] = x;</div>
<div class="line"><a name="l06756"></a><span class="lineno"> 6756</span>&#160;                xArray_right[kb*3+1] = y;</div>
<div class="line"><a name="l06757"></a><span class="lineno"> 6757</span>&#160;                xArray_right[kb*3+2] = <a class="code" href="_headers_8h.html#a9d199fcfc162b9ad09d4c9426e713a74">z</a>;</div>
<div class="line"><a name="l06758"></a><span class="lineno"> 6758</span>&#160;              }</div>
<div class="line"><a name="l06759"></a><span class="lineno"> 6759</span>&#160;            <span class="keywordflow">for</span>  (<span class="keywordtype">int</span> kb_left=0;kb_left&lt;nQuadraturePoints_elementBoundary;kb_left++)</div>
<div class="line"><a name="l06760"></a><span class="lineno"> 6760</span>&#160;              {</div>
<div class="line"><a name="l06761"></a><span class="lineno"> 6761</span>&#160;                <span class="keywordtype">double</span> errorNormMin = 1.0;</div>
<div class="line"><a name="l06762"></a><span class="lineno"> 6762</span>&#160;                <span class="keywordflow">for</span>  (<span class="keywordtype">int</span> kb_right=0;kb_right&lt;nQuadraturePoints_elementBoundary;kb_right++)</div>
<div class="line"><a name="l06763"></a><span class="lineno"> 6763</span>&#160;                  {</div>
<div class="line"><a name="l06764"></a><span class="lineno"> 6764</span>&#160;                    <span class="keywordtype">double</span> errorNorm=0.0;</div>
<div class="line"><a name="l06765"></a><span class="lineno"> 6765</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> I=0;I&lt;nSpace;I++)</div>
<div class="line"><a name="l06766"></a><span class="lineno"> 6766</span>&#160;                      {</div>
<div class="line"><a name="l06767"></a><span class="lineno"> 6767</span>&#160;                        errorNorm += fabs(xArray_left[kb_left*3+I]</div>
<div class="line"><a name="l06768"></a><span class="lineno"> 6768</span>&#160;                                          -</div>
<div class="line"><a name="l06769"></a><span class="lineno"> 6769</span>&#160;                                          xArray_right[kb_right*3+I]);</div>
<div class="line"><a name="l06770"></a><span class="lineno"> 6770</span>&#160;                      }</div>
<div class="line"><a name="l06771"></a><span class="lineno"> 6771</span>&#160;                    <span class="keywordflow">if</span> (errorNorm &lt; errorNormMin)</div>
<div class="line"><a name="l06772"></a><span class="lineno"> 6772</span>&#160;                      {</div>
<div class="line"><a name="l06773"></a><span class="lineno"> 6773</span>&#160;                        permutations[kb_right] = kb_left;</div>
<div class="line"><a name="l06774"></a><span class="lineno"> 6774</span>&#160;                        errorNormMin = errorNorm;</div>
<div class="line"><a name="l06775"></a><span class="lineno"> 6775</span>&#160;                      }</div>
<div class="line"><a name="l06776"></a><span class="lineno"> 6776</span>&#160;                  }</div>
<div class="line"><a name="l06777"></a><span class="lineno"> 6777</span>&#160;              }</div>
<div class="line"><a name="l06778"></a><span class="lineno"> 6778</span>&#160;            <span class="keywordflow">for</span>  (<span class="keywordtype">int</span> kb=0;kb&lt;nQuadraturePoints_elementBoundary;kb++)</div>
<div class="line"><a name="l06779"></a><span class="lineno"> 6779</span>&#160;              {</div>
<div class="line"><a name="l06780"></a><span class="lineno"> 6780</span>&#160;                <span class="keyword">register</span> <span class="keywordtype">int</span> ebN_kb_nSpace = ebN*nQuadraturePoints_elementBoundary*nSpace+kb*nSpace;</div>
<div class="line"><a name="l06781"></a><span class="lineno"> 6781</span>&#160;                <span class="keyword">register</span> <span class="keywordtype">double</span> u_left=0.0,</div>
<div class="line"><a name="l06782"></a><span class="lineno"> 6782</span>&#160;                  v_left=0.0,</div>
<div class="line"><a name="l06783"></a><span class="lineno"> 6783</span>&#160;                  w_left=0.0,</div>
<div class="line"><a name="l06784"></a><span class="lineno"> 6784</span>&#160;                  u_right=0.0,</div>
<div class="line"><a name="l06785"></a><span class="lineno"> 6785</span>&#160;                  v_right=0.0,</div>
<div class="line"><a name="l06786"></a><span class="lineno"> 6786</span>&#160;                  w_right=0.0;</div>
<div class="line"><a name="l06787"></a><span class="lineno"> 6787</span>&#160;                <span class="keyword">register</span> <span class="keywordtype">int</span> left_kb = kb,</div>
<div class="line"><a name="l06788"></a><span class="lineno"> 6788</span>&#160;                  right_kb = permutations[kb],</div>
<div class="line"><a name="l06789"></a><span class="lineno"> 6789</span>&#160;                  left_ebN_element_kb_nDOF_test_element=(left_ebN_element*nQuadraturePoints_elementBoundary+left_kb)*nDOF_test_element,</div>
<div class="line"><a name="l06790"></a><span class="lineno"> 6790</span>&#160;                  right_ebN_element_kb_nDOF_test_element=(right_ebN_element*nQuadraturePoints_elementBoundary+right_kb)*nDOF_test_element;</div>
<div class="line"><a name="l06791"></a><span class="lineno"> 6791</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l06792"></a><span class="lineno"> 6792</span>&#160;                <span class="comment">//calculate the velocity solution at quadrature points on left and right</span></div>
<div class="line"><a name="l06793"></a><span class="lineno"> 6793</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l06794"></a><span class="lineno"> 6794</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.valFromDOF(u_dof,&amp;vel_l2g[left_eN_nDOF_trial_element],&amp;vel_trial_trace_ref[left_ebN_element_kb_nDOF_test_element],u_left);</div>
<div class="line"><a name="l06795"></a><span class="lineno"> 6795</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.valFromDOF(v_dof,&amp;vel_l2g[left_eN_nDOF_trial_element],&amp;vel_trial_trace_ref[left_ebN_element_kb_nDOF_test_element],v_left);</div>
<div class="line"><a name="l06796"></a><span class="lineno"> 6796</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.valFromDOF(w_dof,&amp;vel_l2g[left_eN_nDOF_trial_element],&amp;vel_trial_trace_ref[left_ebN_element_kb_nDOF_test_element],w_left);</div>
<div class="line"><a name="l06797"></a><span class="lineno"> 6797</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l06798"></a><span class="lineno"> 6798</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.valFromDOF(u_dof,&amp;vel_l2g[right_eN_nDOF_trial_element],&amp;vel_trial_trace_ref[right_ebN_element_kb_nDOF_test_element],u_right);</div>
<div class="line"><a name="l06799"></a><span class="lineno"> 6799</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.valFromDOF(v_dof,&amp;vel_l2g[right_eN_nDOF_trial_element],&amp;vel_trial_trace_ref[right_ebN_element_kb_nDOF_test_element],v_right);</div>
<div class="line"><a name="l06800"></a><span class="lineno"> 6800</span>&#160;                <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.valFromDOF(w_dof,&amp;vel_l2g[right_eN_nDOF_trial_element],&amp;vel_trial_trace_ref[right_ebN_element_kb_nDOF_test_element],w_right);</div>
<div class="line"><a name="l06801"></a><span class="lineno"> 6801</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l06802"></a><span class="lineno"> 6802</span>&#160;                velocityAverage[ebN_kb_nSpace+0]=0.5*(u_left + u_right);</div>
<div class="line"><a name="l06803"></a><span class="lineno"> 6803</span>&#160;                velocityAverage[ebN_kb_nSpace+1]=0.5*(v_left + v_right);</div>
<div class="line"><a name="l06804"></a><span class="lineno"> 6804</span>&#160;                velocityAverage[ebN_kb_nSpace+2]=0.5*(w_left + w_right);</div>
<div class="line"><a name="l06805"></a><span class="lineno"> 6805</span>&#160;              }<span class="comment">//ebNI</span></div>
<div class="line"><a name="l06806"></a><span class="lineno"> 6806</span>&#160;          }</div>
<div class="line"><a name="l06807"></a><span class="lineno"> 6807</span>&#160;      }</div>
<div class="line"><a name="l06808"></a><span class="lineno"> 6808</span>&#160; </div>
<div class="line"><a name="l06809"></a><span class="lineno"> 6809</span>&#160;      <span class="keyword">inline</span></div>
<div class="line"><a name="l06810"></a><span class="lineno"><a class="line" href="classproteus_1_1_r_a_n_s2_p.html#ab66a1a6d5a9b4641792020f58af14938"> 6810</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#ab66a1a6d5a9b4641792020f58af14938">evaluateTPAdvectionCoefficients</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> eps_rho,</div>
<div class="line"><a name="l06811"></a><span class="lineno"> 6811</span>&#160;                                             <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="_error_residual_method_8cpp.html#ae5f5d9edb66645eab31a7c8389493ce7">rho_0</a>,</div>
<div class="line"><a name="l06812"></a><span class="lineno"> 6812</span>&#160;                                             <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="_error_residual_method_8cpp.html#a751e53c9d8dfaf696b11b86e0c1b42e9">rho_1</a>,</div>
<div class="line"><a name="l06813"></a><span class="lineno"> 6813</span>&#160;                                             <span class="keyword">const</span> <span class="keywordtype">double</span> useVF,</div>
<div class="line"><a name="l06814"></a><span class="lineno"> 6814</span>&#160;                                             <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; vf,</div>
<div class="line"><a name="l06815"></a><span class="lineno"> 6815</span>&#160;                                             <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; <a class="code" href="namespaceproteus.html#a17bf106c5df3b1331ed2a18392384813">phi</a>,</div>
<div class="line"><a name="l06816"></a><span class="lineno"> 6816</span>&#160;                                             <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; <a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>,</div>
<div class="line"><a name="l06817"></a><span class="lineno"> 6817</span>&#160;                                             <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; <a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>,</div>
<div class="line"><a name="l06818"></a><span class="lineno"> 6818</span>&#160;                                             <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; <a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a>,</div>
<div class="line"><a name="l06819"></a><span class="lineno"> 6819</span>&#160;                                             <span class="keywordtype">double</span> dmass_adv_p[nSpace],</div>
<div class="line"><a name="l06820"></a><span class="lineno"> 6820</span>&#160;                                             <span class="keywordtype">double</span> dmom_u_adv_u[nSpace],</div>
<div class="line"><a name="l06821"></a><span class="lineno"> 6821</span>&#160;                                             <span class="keywordtype">double</span> dmom_v_adv_v[nSpace],</div>
<div class="line"><a name="l06822"></a><span class="lineno"> 6822</span>&#160;                                             <span class="keywordtype">double</span> dmom_w_adv_w[nSpace])</div>
<div class="line"><a name="l06823"></a><span class="lineno"> 6823</span>&#160;      {</div>
<div class="line"><a name="l06824"></a><span class="lineno"> 6824</span>&#160;        <span class="keywordtype">double</span> H_rho, ImH_rho, rho;</div>
<div class="line"><a name="l06825"></a><span class="lineno"> 6825</span>&#160; </div>
<div class="line"><a name="l06826"></a><span class="lineno"> 6826</span>&#160;        H_rho = (1.0-useVF)*<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a25259ea48a9bc3708796a96164a3b8de">gf</a>.H(eps_rho,<a class="code" href="namespaceproteus.html#a17bf106c5df3b1331ed2a18392384813">phi</a>) + useVF*fmin(1.0,fmax(0.0,vf));</div>
<div class="line"><a name="l06827"></a><span class="lineno"> 6827</span>&#160;        ImH_rho = (1.0-useVF)*<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a25259ea48a9bc3708796a96164a3b8de">gf</a>.ImH(eps_rho,<a class="code" href="namespaceproteus.html#a17bf106c5df3b1331ed2a18392384813">phi</a>) + useVF*(1.0-fmin(1.0,fmax(0.0,vf)));</div>
<div class="line"><a name="l06828"></a><span class="lineno"> 6828</span>&#160; </div>
<div class="line"><a name="l06829"></a><span class="lineno"> 6829</span>&#160;        rho = <a class="code" href="_error_residual_method_8cpp.html#ae5f5d9edb66645eab31a7c8389493ce7">rho_0</a>*ImH_rho + <a class="code" href="_error_residual_method_8cpp.html#a751e53c9d8dfaf696b11b86e0c1b42e9">rho_1</a>*H_rho;</div>
<div class="line"><a name="l06830"></a><span class="lineno"> 6830</span>&#160; </div>
<div class="line"><a name="l06831"></a><span class="lineno"> 6831</span>&#160;        dmass_adv_p[0] = rho*<a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>;</div>
<div class="line"><a name="l06832"></a><span class="lineno"> 6832</span>&#160;        dmass_adv_p[1] = rho*<a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>;</div>
<div class="line"><a name="l06833"></a><span class="lineno"> 6833</span>&#160;        dmass_adv_p[2] = rho*<a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a>;</div>
<div class="line"><a name="l06834"></a><span class="lineno"> 6834</span>&#160; </div>
<div class="line"><a name="l06835"></a><span class="lineno"> 6835</span>&#160;        dmom_u_adv_u[0] = rho*<a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>;</div>
<div class="line"><a name="l06836"></a><span class="lineno"> 6836</span>&#160;        dmom_u_adv_u[1] = rho*<a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>;</div>
<div class="line"><a name="l06837"></a><span class="lineno"> 6837</span>&#160;        dmom_u_adv_u[2] = rho*<a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a>;</div>
<div class="line"><a name="l06838"></a><span class="lineno"> 6838</span>&#160; </div>
<div class="line"><a name="l06839"></a><span class="lineno"> 6839</span>&#160;        dmom_v_adv_v[0] = rho*<a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>;</div>
<div class="line"><a name="l06840"></a><span class="lineno"> 6840</span>&#160;        dmom_v_adv_v[1] = rho*<a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>;</div>
<div class="line"><a name="l06841"></a><span class="lineno"> 6841</span>&#160;        dmom_v_adv_v[2] = rho*<a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a>;</div>
<div class="line"><a name="l06842"></a><span class="lineno"> 6842</span>&#160; </div>
<div class="line"><a name="l06843"></a><span class="lineno"> 6843</span>&#160;        dmom_w_adv_w[0] = rho*<a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>;</div>
<div class="line"><a name="l06844"></a><span class="lineno"> 6844</span>&#160;        dmom_w_adv_w[1] = rho*<a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>;</div>
<div class="line"><a name="l06845"></a><span class="lineno"> 6845</span>&#160;        dmom_w_adv_w[2] = rho*<a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a>;</div>
<div class="line"><a name="l06846"></a><span class="lineno"> 6846</span>&#160;      }</div>
<div class="line"><a name="l06847"></a><span class="lineno"> 6847</span>&#160;      <span class="keyword">inline</span></div>
<div class="line"><a name="l06848"></a><span class="lineno"><a class="line" href="classproteus_1_1_r_a_n_s2_p.html#a8900d9a341b8fdab38b03c7d5571ca7a"> 6848</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a8900d9a341b8fdab38b03c7d5571ca7a">evaluateTPInvViscosityMassCoefficients</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> use_numerical_viscosity,</div>
<div class="line"><a name="l06849"></a><span class="lineno"> 6849</span>&#160;                                                    <span class="keyword">const</span> <span class="keywordtype">double</span> numerical_viscosity,</div>
<div class="line"><a name="l06850"></a><span class="lineno"> 6850</span>&#160;                                                    <span class="keyword">const</span> <span class="keywordtype">double</span> eps_rho,</div>
<div class="line"><a name="l06851"></a><span class="lineno"> 6851</span>&#160;                                                    <span class="keyword">const</span> <span class="keywordtype">double</span> eps_mu,</div>
<div class="line"><a name="l06852"></a><span class="lineno"> 6852</span>&#160;                                                    <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="_error_residual_method_8cpp.html#ae5f5d9edb66645eab31a7c8389493ce7">rho_0</a>,</div>
<div class="line"><a name="l06853"></a><span class="lineno"> 6853</span>&#160;                                                    <span class="keywordtype">double</span> <a class="code" href="_error_residual_method_8cpp.html#a383b07af68441ce2b4adaaf8d8cc9d90">nu_0</a>,</div>
<div class="line"><a name="l06854"></a><span class="lineno"> 6854</span>&#160;                                                    <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="_error_residual_method_8cpp.html#a751e53c9d8dfaf696b11b86e0c1b42e9">rho_1</a>,</div>
<div class="line"><a name="l06855"></a><span class="lineno"> 6855</span>&#160;                                                    <span class="keywordtype">double</span> <a class="code" href="_error_residual_method_8cpp.html#ae5896ebfee35f22242123e4ae82c81d9">nu_1</a>,</div>
<div class="line"><a name="l06856"></a><span class="lineno"> 6856</span>&#160;                                                    <span class="keyword">const</span> <span class="keywordtype">double</span> useVF,</div>
<div class="line"><a name="l06857"></a><span class="lineno"> 6857</span>&#160;                                                    <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; vf,</div>
<div class="line"><a name="l06858"></a><span class="lineno"> 6858</span>&#160;                                                    <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; <a class="code" href="namespaceproteus.html#a17bf106c5df3b1331ed2a18392384813">phi</a>,</div>
<div class="line"><a name="l06859"></a><span class="lineno"> 6859</span>&#160;                                                    <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; p,</div>
<div class="line"><a name="l06860"></a><span class="lineno"> 6860</span>&#160;                                                    <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; <a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>,</div>
<div class="line"><a name="l06861"></a><span class="lineno"> 6861</span>&#160;                                                    <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; <a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>,</div>
<div class="line"><a name="l06862"></a><span class="lineno"> 6862</span>&#160;                                                    <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; <a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a>,</div>
<div class="line"><a name="l06863"></a><span class="lineno"> 6863</span>&#160;                                                    <span class="keywordtype">double</span>&amp; mom_p_acc,</div>
<div class="line"><a name="l06864"></a><span class="lineno"> 6864</span>&#160;                                                    <span class="keywordtype">double</span>&amp; dmom_p_acc_p,</div>
<div class="line"><a name="l06865"></a><span class="lineno"> 6865</span>&#160;                                                    <span class="keywordtype">double</span>&amp; mom_u_acc,</div>
<div class="line"><a name="l06866"></a><span class="lineno"> 6866</span>&#160;                                                    <span class="keywordtype">double</span>&amp; dmom_u_acc_u,</div>
<div class="line"><a name="l06867"></a><span class="lineno"> 6867</span>&#160;                                                    <span class="keywordtype">double</span>&amp; mom_v_acc,</div>
<div class="line"><a name="l06868"></a><span class="lineno"> 6868</span>&#160;                                                    <span class="keywordtype">double</span>&amp; dmom_v_acc_v,</div>
<div class="line"><a name="l06869"></a><span class="lineno"> 6869</span>&#160;                                                    <span class="keywordtype">double</span>&amp; mom_w_acc,</div>
<div class="line"><a name="l06870"></a><span class="lineno"> 6870</span>&#160;                                                    <span class="keywordtype">double</span>&amp; dmom_w_acc_w)</div>
<div class="line"><a name="l06871"></a><span class="lineno"> 6871</span>&#160;      {</div>
<div class="line"><a name="l06872"></a><span class="lineno"> 6872</span>&#160;        <span class="comment">// This should be split off into a seperate function</span></div>
<div class="line"><a name="l06873"></a><span class="lineno"> 6873</span>&#160;        <span class="keywordtype">double</span> H_rho, ImH_rho, H_mu, ImH_mu, rho, nu, mu;</div>
<div class="line"><a name="l06874"></a><span class="lineno"> 6874</span>&#160; </div>
<div class="line"><a name="l06875"></a><span class="lineno"> 6875</span>&#160;        H_rho = (1.0-useVF)*<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a25259ea48a9bc3708796a96164a3b8de">gf</a>.H(eps_rho,<a class="code" href="namespaceproteus.html#a17bf106c5df3b1331ed2a18392384813">phi</a>) + useVF*fmin(1.0,fmax(0.0,vf));</div>
<div class="line"><a name="l06876"></a><span class="lineno"> 6876</span>&#160;        ImH_rho = (1.0-useVF)*<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a25259ea48a9bc3708796a96164a3b8de">gf</a>.ImH(eps_rho,<a class="code" href="namespaceproteus.html#a17bf106c5df3b1331ed2a18392384813">phi</a>) + useVF*(1.0-fmin(1.0,fmax(0.0,vf)));</div>
<div class="line"><a name="l06877"></a><span class="lineno"> 6877</span>&#160;        H_mu = (1.0-useVF)*<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a25259ea48a9bc3708796a96164a3b8de">gf</a>.H(eps_mu,<a class="code" href="namespaceproteus.html#a17bf106c5df3b1331ed2a18392384813">phi</a>) + useVF*fmin(1.0,fmax(0.0,vf));</div>
<div class="line"><a name="l06878"></a><span class="lineno"> 6878</span>&#160;        ImH_mu = (1.0-useVF)*<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a25259ea48a9bc3708796a96164a3b8de">gf</a>.ImH(eps_mu,<a class="code" href="namespaceproteus.html#a17bf106c5df3b1331ed2a18392384813">phi</a>) + useVF*(1.0-fmin(1.0,fmax(0.0,vf)));</div>
<div class="line"><a name="l06879"></a><span class="lineno"> 6879</span>&#160; </div>
<div class="line"><a name="l06880"></a><span class="lineno"> 6880</span>&#160;        rho = <a class="code" href="_error_residual_method_8cpp.html#ae5f5d9edb66645eab31a7c8389493ce7">rho_0</a>*ImH_rho + <a class="code" href="_error_residual_method_8cpp.html#a751e53c9d8dfaf696b11b86e0c1b42e9">rho_1</a>*H_rho;</div>
<div class="line"><a name="l06881"></a><span class="lineno"> 6881</span>&#160;        nu = <a class="code" href="_error_residual_method_8cpp.html#a383b07af68441ce2b4adaaf8d8cc9d90">nu_0</a>*ImH_mu + <a class="code" href="_error_residual_method_8cpp.html#ae5896ebfee35f22242123e4ae82c81d9">nu_1</a>*H_mu;</div>
<div class="line"><a name="l06882"></a><span class="lineno"> 6882</span>&#160; </div>
<div class="line"><a name="l06883"></a><span class="lineno"> 6883</span>&#160;        mu = <a class="code" href="_error_residual_method_8cpp.html#ae5f5d9edb66645eab31a7c8389493ce7">rho_0</a>*<a class="code" href="_error_residual_method_8cpp.html#a383b07af68441ce2b4adaaf8d8cc9d90">nu_0</a>*ImH_mu + <a class="code" href="_error_residual_method_8cpp.html#a751e53c9d8dfaf696b11b86e0c1b42e9">rho_1</a>*<a class="code" href="_error_residual_method_8cpp.html#ae5896ebfee35f22242123e4ae82c81d9">nu_1</a>*H_mu + use_numerical_viscosity*numerical_viscosity;</div>
<div class="line"><a name="l06884"></a><span class="lineno"> 6884</span>&#160;        <span class="comment">//mu = rho*nu;</span></div>
<div class="line"><a name="l06885"></a><span class="lineno"> 6885</span>&#160; </div>
<div class="line"><a name="l06886"></a><span class="lineno"> 6886</span>&#160;        mom_p_acc = p / mu;</div>
<div class="line"><a name="l06887"></a><span class="lineno"> 6887</span>&#160;        dmom_p_acc_p = 1. / mu;</div>
<div class="line"><a name="l06888"></a><span class="lineno"> 6888</span>&#160; </div>
<div class="line"><a name="l06889"></a><span class="lineno"> 6889</span>&#160;        mom_u_acc = <a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a> / mu;</div>
<div class="line"><a name="l06890"></a><span class="lineno"> 6890</span>&#160;        dmom_u_acc_u = 1. / mu;</div>
<div class="line"><a name="l06891"></a><span class="lineno"> 6891</span>&#160; </div>
<div class="line"><a name="l06892"></a><span class="lineno"> 6892</span>&#160;        mom_v_acc = <a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a> / mu;</div>
<div class="line"><a name="l06893"></a><span class="lineno"> 6893</span>&#160;        dmom_v_acc_v = 1. / mu;</div>
<div class="line"><a name="l06894"></a><span class="lineno"> 6894</span>&#160; </div>
<div class="line"><a name="l06895"></a><span class="lineno"> 6895</span>&#160;        mom_w_acc = <a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a> / mu;</div>
<div class="line"><a name="l06896"></a><span class="lineno"> 6896</span>&#160;        dmom_w_acc_w = 1. / mu;</div>
<div class="line"><a name="l06897"></a><span class="lineno"> 6897</span>&#160;      }</div>
<div class="line"><a name="l06898"></a><span class="lineno"> 6898</span>&#160;      <span class="keyword">inline</span></div>
<div class="line"><a name="l06899"></a><span class="lineno"><a class="line" href="classproteus_1_1_r_a_n_s2_p.html#a6c96a8ae5e2aca6096bd12b44658aa84"> 6899</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a6c96a8ae5e2aca6096bd12b44658aa84">evaluateTPDensityMassCoefficients</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> eps_rho,</div>
<div class="line"><a name="l06900"></a><span class="lineno"> 6900</span>&#160;                                               <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="_error_residual_method_8cpp.html#ae5f5d9edb66645eab31a7c8389493ce7">rho_0</a>,</div>
<div class="line"><a name="l06901"></a><span class="lineno"> 6901</span>&#160;                                               <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="_error_residual_method_8cpp.html#a751e53c9d8dfaf696b11b86e0c1b42e9">rho_1</a>,</div>
<div class="line"><a name="l06902"></a><span class="lineno"> 6902</span>&#160;                                               <span class="keyword">const</span> <span class="keywordtype">double</span> useVF,</div>
<div class="line"><a name="l06903"></a><span class="lineno"> 6903</span>&#160;                                               <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; vf,</div>
<div class="line"><a name="l06904"></a><span class="lineno"> 6904</span>&#160;                                               <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; <a class="code" href="namespaceproteus.html#a17bf106c5df3b1331ed2a18392384813">phi</a>,</div>
<div class="line"><a name="l06905"></a><span class="lineno"> 6905</span>&#160;                                               <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; p,</div>
<div class="line"><a name="l06906"></a><span class="lineno"> 6906</span>&#160;                                               <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; <a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>,</div>
<div class="line"><a name="l06907"></a><span class="lineno"> 6907</span>&#160;                                               <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; <a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>,</div>
<div class="line"><a name="l06908"></a><span class="lineno"> 6908</span>&#160;                                               <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; <a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a>,</div>
<div class="line"><a name="l06909"></a><span class="lineno"> 6909</span>&#160;                                               <span class="keywordtype">double</span>&amp; mom_p_acc,</div>
<div class="line"><a name="l06910"></a><span class="lineno"> 6910</span>&#160;                                               <span class="keywordtype">double</span>&amp; dmom_p_acc_p,</div>
<div class="line"><a name="l06911"></a><span class="lineno"> 6911</span>&#160;                                               <span class="keywordtype">double</span>&amp; mom_u_acc,</div>
<div class="line"><a name="l06912"></a><span class="lineno"> 6912</span>&#160;                                               <span class="keywordtype">double</span>&amp; dmom_u_acc_u,</div>
<div class="line"><a name="l06913"></a><span class="lineno"> 6913</span>&#160;                                               <span class="keywordtype">double</span>&amp; mom_v_acc,</div>
<div class="line"><a name="l06914"></a><span class="lineno"> 6914</span>&#160;                                               <span class="keywordtype">double</span>&amp; dmom_v_acc_v,</div>
<div class="line"><a name="l06915"></a><span class="lineno"> 6915</span>&#160;                                               <span class="keywordtype">double</span>&amp; mom_w_acc,</div>
<div class="line"><a name="l06916"></a><span class="lineno"> 6916</span>&#160;                                               <span class="keywordtype">double</span>&amp; dmom_w_acc_w)</div>
<div class="line"><a name="l06917"></a><span class="lineno"> 6917</span>&#160;      {</div>
<div class="line"><a name="l06918"></a><span class="lineno"> 6918</span>&#160;        <span class="keywordtype">double</span> H_rho, ImH_rho, rho;</div>
<div class="line"><a name="l06919"></a><span class="lineno"> 6919</span>&#160; </div>
<div class="line"><a name="l06920"></a><span class="lineno"> 6920</span>&#160;        H_rho = (1.0-useVF)*<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a25259ea48a9bc3708796a96164a3b8de">gf</a>.H(eps_rho,<a class="code" href="namespaceproteus.html#a17bf106c5df3b1331ed2a18392384813">phi</a>) + useVF*fmin(1.0,fmax(0.0,vf));</div>
<div class="line"><a name="l06921"></a><span class="lineno"> 6921</span>&#160;        ImH_rho = (1.0-useVF)*<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a25259ea48a9bc3708796a96164a3b8de">gf</a>.ImH(eps_rho,<a class="code" href="namespaceproteus.html#a17bf106c5df3b1331ed2a18392384813">phi</a>) + useVF*(1.0-fmin(1.0,fmax(0.0,vf)));</div>
<div class="line"><a name="l06922"></a><span class="lineno"> 6922</span>&#160; </div>
<div class="line"><a name="l06923"></a><span class="lineno"> 6923</span>&#160;        rho = <a class="code" href="_error_residual_method_8cpp.html#ae5f5d9edb66645eab31a7c8389493ce7">rho_0</a>*ImH_rho + <a class="code" href="_error_residual_method_8cpp.html#a751e53c9d8dfaf696b11b86e0c1b42e9">rho_1</a>*H_rho;</div>
<div class="line"><a name="l06924"></a><span class="lineno"> 6924</span>&#160; </div>
<div class="line"><a name="l06925"></a><span class="lineno"> 6925</span>&#160;        mom_p_acc = p * rho;</div>
<div class="line"><a name="l06926"></a><span class="lineno"> 6926</span>&#160;        dmom_p_acc_p = rho;</div>
<div class="line"><a name="l06927"></a><span class="lineno"> 6927</span>&#160; </div>
<div class="line"><a name="l06928"></a><span class="lineno"> 6928</span>&#160;        mom_u_acc = <a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a> * rho;</div>
<div class="line"><a name="l06929"></a><span class="lineno"> 6929</span>&#160;        dmom_u_acc_u = rho;</div>
<div class="line"><a name="l06930"></a><span class="lineno"> 6930</span>&#160; </div>
<div class="line"><a name="l06931"></a><span class="lineno"> 6931</span>&#160;        mom_v_acc = <a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a> * rho;</div>
<div class="line"><a name="l06932"></a><span class="lineno"> 6932</span>&#160;        dmom_v_acc_v = rho;</div>
<div class="line"><a name="l06933"></a><span class="lineno"> 6933</span>&#160; </div>
<div class="line"><a name="l06934"></a><span class="lineno"> 6934</span>&#160;        mom_w_acc = <a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a> * rho;</div>
<div class="line"><a name="l06935"></a><span class="lineno"> 6935</span>&#160;        dmom_w_acc_w = rho;</div>
<div class="line"><a name="l06936"></a><span class="lineno"> 6936</span>&#160;      }</div>
<div class="line"><a name="l06937"></a><span class="lineno"> 6937</span>&#160;      <span class="keyword">inline</span></div>
<div class="line"><a name="l06938"></a><span class="lineno"><a class="line" href="classproteus_1_1_r_a_n_s2_p.html#a348042ad3350e7e70a219182dc12645c"> 6938</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a348042ad3350e7e70a219182dc12645c">evaluateTPInvDensityLaplaceCoefficients</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> eps_rho,</div>
<div class="line"><a name="l06939"></a><span class="lineno"> 6939</span>&#160;                                                     <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="_error_residual_method_8cpp.html#ae5f5d9edb66645eab31a7c8389493ce7">rho_0</a>,</div>
<div class="line"><a name="l06940"></a><span class="lineno"> 6940</span>&#160;                                                     <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="_error_residual_method_8cpp.html#a751e53c9d8dfaf696b11b86e0c1b42e9">rho_1</a>,</div>
<div class="line"><a name="l06941"></a><span class="lineno"> 6941</span>&#160;                                                     <span class="keyword">const</span> <span class="keywordtype">double</span> useVF,</div>
<div class="line"><a name="l06942"></a><span class="lineno"> 6942</span>&#160;                                                     <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; vf,</div>
<div class="line"><a name="l06943"></a><span class="lineno"> 6943</span>&#160;                                                     <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; <a class="code" href="namespaceproteus.html#a17bf106c5df3b1331ed2a18392384813">phi</a>,</div>
<div class="line"><a name="l06944"></a><span class="lineno"> 6944</span>&#160;                                                     <span class="keywordtype">double</span> mom_p_diff_ten[nSpace],</div>
<div class="line"><a name="l06945"></a><span class="lineno"> 6945</span>&#160;                                                     <span class="keywordtype">double</span> mom_u_diff_ten[nSpace],</div>
<div class="line"><a name="l06946"></a><span class="lineno"> 6946</span>&#160;                                                     <span class="keywordtype">double</span> mom_v_diff_ten[nSpace],</div>
<div class="line"><a name="l06947"></a><span class="lineno"> 6947</span>&#160;                                                     <span class="keywordtype">double</span> mom_w_diff_ten[nSpace])</div>
<div class="line"><a name="l06948"></a><span class="lineno"> 6948</span>&#160;      {</div>
<div class="line"><a name="l06949"></a><span class="lineno"> 6949</span>&#160;        <span class="keywordtype">double</span> H_rho, ImH_rho, rho;</div>
<div class="line"><a name="l06950"></a><span class="lineno"> 6950</span>&#160; </div>
<div class="line"><a name="l06951"></a><span class="lineno"> 6951</span>&#160;        H_rho = (1.0-useVF)*<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a25259ea48a9bc3708796a96164a3b8de">gf</a>.H(eps_rho,<a class="code" href="namespaceproteus.html#a17bf106c5df3b1331ed2a18392384813">phi</a>) + useVF*fmin(1.0,fmax(0.0,vf));</div>
<div class="line"><a name="l06952"></a><span class="lineno"> 6952</span>&#160;        ImH_rho = (1.0-useVF)*<a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a25259ea48a9bc3708796a96164a3b8de">gf</a>.ImH(eps_rho,<a class="code" href="namespaceproteus.html#a17bf106c5df3b1331ed2a18392384813">phi</a>) + useVF*(1.0-fmin(1.0,fmax(0.0,vf)));</div>
<div class="line"><a name="l06953"></a><span class="lineno"> 6953</span>&#160; </div>
<div class="line"><a name="l06954"></a><span class="lineno"> 6954</span>&#160;        rho = <a class="code" href="_error_residual_method_8cpp.html#ae5f5d9edb66645eab31a7c8389493ce7">rho_0</a>*ImH_rho + <a class="code" href="_error_residual_method_8cpp.html#a751e53c9d8dfaf696b11b86e0c1b42e9">rho_1</a>*H_rho;</div>
<div class="line"><a name="l06955"></a><span class="lineno"> 6955</span>&#160; </div>
<div class="line"><a name="l06956"></a><span class="lineno"> 6956</span>&#160;        mom_p_diff_ten[0] = 1.0 / rho ;</div>
<div class="line"><a name="l06957"></a><span class="lineno"> 6957</span>&#160;        mom_p_diff_ten[1] = 1.0 / rho ;</div>
<div class="line"><a name="l06958"></a><span class="lineno"> 6958</span>&#160;        mom_p_diff_ten[2] = 1.0 / rho ;</div>
<div class="line"><a name="l06959"></a><span class="lineno"> 6959</span>&#160; </div>
<div class="line"><a name="l06960"></a><span class="lineno"> 6960</span>&#160;        mom_u_diff_ten[0] = 1.0 / rho ;</div>
<div class="line"><a name="l06961"></a><span class="lineno"> 6961</span>&#160;        mom_u_diff_ten[1] = 1.0 / rho ;</div>
<div class="line"><a name="l06962"></a><span class="lineno"> 6962</span>&#160;        mom_u_diff_ten[2] = 1.0 / rho ;</div>
<div class="line"><a name="l06963"></a><span class="lineno"> 6963</span>&#160; </div>
<div class="line"><a name="l06964"></a><span class="lineno"> 6964</span>&#160;        mom_v_diff_ten[0] = 1.0 / rho ;</div>
<div class="line"><a name="l06965"></a><span class="lineno"> 6965</span>&#160;        mom_v_diff_ten[1] = 1.0 / rho ;</div>
<div class="line"><a name="l06966"></a><span class="lineno"> 6966</span>&#160;        mom_v_diff_ten[2] = 1.0 / rho ;</div>
<div class="line"><a name="l06967"></a><span class="lineno"> 6967</span>&#160; </div>
<div class="line"><a name="l06968"></a><span class="lineno"> 6968</span>&#160;        mom_w_diff_ten[0] = 1.0 / rho ;</div>
<div class="line"><a name="l06969"></a><span class="lineno"> 6969</span>&#160;        mom_w_diff_ten[1] = 1.0 / rho ;</div>
<div class="line"><a name="l06970"></a><span class="lineno"> 6970</span>&#160;        mom_w_diff_ten[2] = 1.0 / rho ;</div>
<div class="line"><a name="l06971"></a><span class="lineno"> 6971</span>&#160;      }</div>
<div class="line"><a name="l06972"></a><span class="lineno"> 6972</span>&#160; </div>
<div class="line"><a name="l06973"></a><span class="lineno"><a class="line" href="classproteus_1_1_r_a_n_s2_p.html#a100fe54d0ba85bbf85e094bdaeb54576"> 6973</a></span>&#160;      <span class="keywordtype">void</span> <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a100fe54d0ba85bbf85e094bdaeb54576">getTwoPhaseAdvectionOperator</a>(<span class="keywordtype">double</span>* mesh_trial_ref,</div>
<div class="line"><a name="l06974"></a><span class="lineno"> 6974</span>&#160;                                        <span class="keywordtype">double</span>* mesh_grad_trial_ref,</div>
<div class="line"><a name="l06975"></a><span class="lineno"> 6975</span>&#160;                                        <span class="keywordtype">double</span>* mesh_dof,</div>
<div class="line"><a name="l06976"></a><span class="lineno"> 6976</span>&#160;                                        <span class="keywordtype">int</span>* mesh_l2g,</div>
<div class="line"><a name="l06977"></a><span class="lineno"> 6977</span>&#160;                                        <span class="keywordtype">double</span>* dV_ref,</div>
<div class="line"><a name="l06978"></a><span class="lineno"> 6978</span>&#160;                                        <span class="keywordtype">double</span>* p_trial_ref,</div>
<div class="line"><a name="l06979"></a><span class="lineno"> 6979</span>&#160;                                        <span class="keywordtype">double</span>* p_grad_trial_ref,</div>
<div class="line"><a name="l06980"></a><span class="lineno"> 6980</span>&#160;                                        <span class="keywordtype">double</span>* vel_trial_ref,</div>
<div class="line"><a name="l06981"></a><span class="lineno"> 6981</span>&#160;                                        <span class="keywordtype">double</span>* vel_grad_trial_ref,</div>
<div class="line"><a name="l06982"></a><span class="lineno"> 6982</span>&#160;                                        <span class="keywordtype">double</span>* elementDiameter,</div>
<div class="line"><a name="l06983"></a><span class="lineno"> 6983</span>&#160;                                        <span class="keywordtype">double</span>* nodeDiametersArray,</div>
<div class="line"><a name="l06984"></a><span class="lineno"> 6984</span>&#160;                                        <span class="keywordtype">int</span> nElements_global,</div>
<div class="line"><a name="l06985"></a><span class="lineno"> 6985</span>&#160;                                        <span class="keywordtype">double</span> useMetrics,</div>
<div class="line"><a name="l06986"></a><span class="lineno"> 6986</span>&#160;                                        <span class="keywordtype">double</span> epsFact_rho,</div>
<div class="line"><a name="l06987"></a><span class="lineno"> 6987</span>&#160;                                        <span class="keywordtype">double</span> epsFact_mu,</div>
<div class="line"><a name="l06988"></a><span class="lineno"> 6988</span>&#160;                                        <span class="keywordtype">double</span> <a class="code" href="_error_residual_method_8cpp.html#ae5f5d9edb66645eab31a7c8389493ce7">rho_0</a>,</div>
<div class="line"><a name="l06989"></a><span class="lineno"> 6989</span>&#160;                                        <span class="keywordtype">double</span> <a class="code" href="_error_residual_method_8cpp.html#a383b07af68441ce2b4adaaf8d8cc9d90">nu_0</a>,</div>
<div class="line"><a name="l06990"></a><span class="lineno"> 6990</span>&#160;                                        <span class="keywordtype">double</span> <a class="code" href="_error_residual_method_8cpp.html#a751e53c9d8dfaf696b11b86e0c1b42e9">rho_1</a>,</div>
<div class="line"><a name="l06991"></a><span class="lineno"> 6991</span>&#160;                                        <span class="keywordtype">double</span> <a class="code" href="_error_residual_method_8cpp.html#ae5896ebfee35f22242123e4ae82c81d9">nu_1</a>,</div>
<div class="line"><a name="l06992"></a><span class="lineno"> 6992</span>&#160;                                        <span class="keywordtype">int</span>* vel_l2g,</div>
<div class="line"><a name="l06993"></a><span class="lineno"> 6993</span>&#160;                                        <span class="keywordtype">double</span>* u_dof, <span class="keywordtype">double</span>* v_dof, <span class="keywordtype">double</span>* w_dof,</div>
<div class="line"><a name="l06994"></a><span class="lineno"> 6994</span>&#160;                                        <span class="keyword">const</span> <span class="keywordtype">double</span> useVF,</div>
<div class="line"><a name="l06995"></a><span class="lineno"> 6995</span>&#160;                                        <span class="keywordtype">double</span> *vf,</div>
<div class="line"><a name="l06996"></a><span class="lineno"> 6996</span>&#160;                                        <span class="keywordtype">double</span> *<a class="code" href="namespaceproteus.html#a17bf106c5df3b1331ed2a18392384813">phi</a>,</div>
<div class="line"><a name="l06997"></a><span class="lineno"> 6997</span>&#160;                                        <span class="keywordtype">int</span>* csrRowIndeces_p_p, <span class="keywordtype">int</span>* csrColumnOffsets_p_p,</div>
<div class="line"><a name="l06998"></a><span class="lineno"> 6998</span>&#160;                                        <span class="keywordtype">int</span>* csrRowIndeces_u_u, <span class="keywordtype">int</span>* csrColumnOffsets_u_u,</div>
<div class="line"><a name="l06999"></a><span class="lineno"> 6999</span>&#160;                                        <span class="keywordtype">int</span>* csrRowIndeces_v_v, <span class="keywordtype">int</span>* csrColumnOffsets_v_v,</div>
<div class="line"><a name="l07000"></a><span class="lineno"> 7000</span>&#160;                                        <span class="keywordtype">int</span>* csrRowIndeces_w_w, <span class="keywordtype">int</span>* csrColumnOffsets_w_w,</div>
<div class="line"><a name="l07001"></a><span class="lineno"> 7001</span>&#160;                                        <span class="keywordtype">double</span>* advection_matrix)</div>
<div class="line"><a name="l07002"></a><span class="lineno"> 7002</span>&#160; </div>
<div class="line"><a name="l07003"></a><span class="lineno"> 7003</span>&#160;      {</div>
<div class="line"><a name="l07004"></a><span class="lineno"> 7004</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> eN=0 ; eN &lt; nElements_global ; ++eN)</div>
<div class="line"><a name="l07005"></a><span class="lineno"> 7005</span>&#160;          {</div>
<div class="line"><a name="l07006"></a><span class="lineno"> 7006</span>&#160;            <span class="comment">// local matrix allocations</span></div>
<div class="line"><a name="l07007"></a><span class="lineno"> 7007</span>&#160;            <span class="keywordtype">double</span> eps_rho;</div>
<div class="line"><a name="l07008"></a><span class="lineno"> 7008</span>&#160; </div>
<div class="line"><a name="l07009"></a><span class="lineno"> 7009</span>&#160;            <span class="keywordtype">double</span> local_matrix_p_p[nDOF_test_element][nDOF_trial_element];</div>
<div class="line"><a name="l07010"></a><span class="lineno"> 7010</span>&#160;            <span class="keywordtype">double</span> local_matrix_u_u[nDOF_test_element][nDOF_trial_element];</div>
<div class="line"><a name="l07011"></a><span class="lineno"> 7011</span>&#160;            <span class="keywordtype">double</span> local_matrix_v_v[nDOF_test_element][nDOF_trial_element];</div>
<div class="line"><a name="l07012"></a><span class="lineno"> 7012</span>&#160;            <span class="keywordtype">double</span> local_matrix_w_w[nDOF_test_element][nDOF_trial_element];</div>
<div class="line"><a name="l07013"></a><span class="lineno"> 7013</span>&#160; </div>
<div class="line"><a name="l07014"></a><span class="lineno"> 7014</span>&#160;            <span class="comment">// clear local matrix entries</span></div>
<div class="line"><a name="l07015"></a><span class="lineno"> 7015</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0 ; i &lt; nDOF_test_element ; ++i)</div>
<div class="line"><a name="l07016"></a><span class="lineno"> 7016</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0 ; j &lt; nDOF_trial_element ; ++j){</div>
<div class="line"><a name="l07017"></a><span class="lineno"> 7017</span>&#160;                local_matrix_p_p[i][j] = 0. ;</div>
<div class="line"><a name="l07018"></a><span class="lineno"> 7018</span>&#160;                local_matrix_u_u[i][j] = 0. ;</div>
<div class="line"><a name="l07019"></a><span class="lineno"> 7019</span>&#160;                local_matrix_v_v[i][j] = 0. ;</div>
<div class="line"><a name="l07020"></a><span class="lineno"> 7020</span>&#160;              }</div>
<div class="line"><a name="l07021"></a><span class="lineno"> 7021</span>&#160; </div>
<div class="line"><a name="l07022"></a><span class="lineno"> 7022</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0 ; k &lt; nQuadraturePoints_element ; ++k){</div>
<div class="line"><a name="l07023"></a><span class="lineno"> 7023</span>&#160; </div>
<div class="line"><a name="l07024"></a><span class="lineno"> 7024</span>&#160;              <span class="keywordtype">int</span> eN_k = eN*nQuadraturePoints_element + k;</div>
<div class="line"><a name="l07025"></a><span class="lineno"> 7025</span>&#160;              <span class="keywordtype">int</span> eN_nDOF_trial_element = eN*nDOF_trial_element;</div>
<div class="line"><a name="l07026"></a><span class="lineno"> 7026</span>&#160; </div>
<div class="line"><a name="l07027"></a><span class="lineno"> 7027</span>&#160;              <span class="keywordtype">double</span> jac[nSpace*nSpace];</div>
<div class="line"><a name="l07028"></a><span class="lineno"> 7028</span>&#160;              <span class="keywordtype">double</span> jacInv[nSpace*nSpace];</div>
<div class="line"><a name="l07029"></a><span class="lineno"> 7029</span>&#160;              <span class="keywordtype">double</span> <a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>=0.0, <a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>=0.0, <a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a>=0.0;</div>
<div class="line"><a name="l07030"></a><span class="lineno"> 7030</span>&#160;              <span class="keywordtype">double</span> dmass_adv_p[nSpace], dmom_u_adv_u[nSpace], dmom_v_adv_v[nSpace] , dmom_w_adv_w[nSpace];</div>
<div class="line"><a name="l07031"></a><span class="lineno"> 7031</span>&#160;              <span class="keywordtype">double</span> p_grad_trial[nDOF_trial_element*nSpace],</div>
<div class="line"><a name="l07032"></a><span class="lineno"> 7032</span>&#160;                vel_grad_trial[nDOF_trial_element*nSpace];</div>
<div class="line"><a name="l07033"></a><span class="lineno"> 7033</span>&#160;              <span class="keywordtype">double</span> p_test_dV[nDOF_test_element], vel_test_dV[nDOF_test_element];</div>
<div class="line"><a name="l07034"></a><span class="lineno"> 7034</span>&#160;              <span class="keywordtype">double</span> p_grad_test_dV[nDOF_test_element*nSpace],</div>
<div class="line"><a name="l07035"></a><span class="lineno"> 7035</span>&#160;                vel_grad_test_dV[nDOF_test_element*nSpace];</div>
<div class="line"><a name="l07036"></a><span class="lineno"> 7036</span>&#160;              <span class="keywordtype">double</span> jacDet, x, y, <a class="code" href="_headers_8h.html#a9d199fcfc162b9ad09d4c9426e713a74">z</a>, dV, h_phi;</div>
<div class="line"><a name="l07037"></a><span class="lineno"> 7037</span>&#160; </div>
<div class="line"><a name="l07038"></a><span class="lineno"> 7038</span>&#160;              <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.calculateMapping_element(eN,</div>
<div class="line"><a name="l07039"></a><span class="lineno"> 7039</span>&#160;                                          k,</div>
<div class="line"><a name="l07040"></a><span class="lineno"> 7040</span>&#160;                                          mesh_dof,</div>
<div class="line"><a name="l07041"></a><span class="lineno"> 7041</span>&#160;                                          mesh_l2g,</div>
<div class="line"><a name="l07042"></a><span class="lineno"> 7042</span>&#160;                                          mesh_trial_ref,</div>
<div class="line"><a name="l07043"></a><span class="lineno"> 7043</span>&#160;                                          mesh_grad_trial_ref,</div>
<div class="line"><a name="l07044"></a><span class="lineno"> 7044</span>&#160;                                          jac,</div>
<div class="line"><a name="l07045"></a><span class="lineno"> 7045</span>&#160;                                          jacDet,</div>
<div class="line"><a name="l07046"></a><span class="lineno"> 7046</span>&#160;                                          jacInv,</div>
<div class="line"><a name="l07047"></a><span class="lineno"> 7047</span>&#160;                                          x,y,<a class="code" href="_headers_8h.html#a9d199fcfc162b9ad09d4c9426e713a74">z</a>);</div>
<div class="line"><a name="l07048"></a><span class="lineno"> 7048</span>&#160; </div>
<div class="line"><a name="l07049"></a><span class="lineno"> 7049</span>&#160;              <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.calculateH_element(eN,</div>
<div class="line"><a name="l07050"></a><span class="lineno"> 7050</span>&#160;                                    k,</div>
<div class="line"><a name="l07051"></a><span class="lineno"> 7051</span>&#160;                                    nodeDiametersArray,</div>
<div class="line"><a name="l07052"></a><span class="lineno"> 7052</span>&#160;                                    mesh_l2g,</div>
<div class="line"><a name="l07053"></a><span class="lineno"> 7053</span>&#160;                                    mesh_trial_ref,</div>
<div class="line"><a name="l07054"></a><span class="lineno"> 7054</span>&#160;                                    h_phi);</div>
<div class="line"><a name="l07055"></a><span class="lineno"> 7055</span>&#160; </div>
<div class="line"><a name="l07056"></a><span class="lineno"> 7056</span>&#160;              dV = fabs(jacDet)*dV_ref[k];</div>
<div class="line"><a name="l07057"></a><span class="lineno"> 7057</span>&#160; </div>
<div class="line"><a name="l07058"></a><span class="lineno"> 7058</span>&#160;              eps_rho = epsFact_rho*(useMetrics*h_phi+(1.0-useMetrics)*elementDiameter[eN]);</div>
<div class="line"><a name="l07059"></a><span class="lineno"> 7059</span>&#160; </div>
<div class="line"><a name="l07060"></a><span class="lineno"> 7060</span>&#160;              <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.gradTrialFromRef(&amp;p_grad_trial_ref[k*nDOF_trial_element*nSpace],jacInv,p_grad_trial);</div>
<div class="line"><a name="l07061"></a><span class="lineno"> 7061</span>&#160;              <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.gradTrialFromRef(&amp;vel_grad_trial_ref[k*nDOF_trial_element*nSpace],jacInv,vel_grad_trial);</div>
<div class="line"><a name="l07062"></a><span class="lineno"> 7062</span>&#160; </div>
<div class="line"><a name="l07063"></a><span class="lineno"> 7063</span>&#160;              <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.valFromDOF(u_dof,&amp;vel_l2g[eN_nDOF_trial_element],&amp;vel_trial_ref[k*nDOF_trial_element],<a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>);</div>
<div class="line"><a name="l07064"></a><span class="lineno"> 7064</span>&#160;              <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.valFromDOF(v_dof,&amp;vel_l2g[eN_nDOF_trial_element],&amp;vel_trial_ref[k*nDOF_trial_element],<a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>);</div>
<div class="line"><a name="l07065"></a><span class="lineno"> 7065</span>&#160;              <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.valFromDOF(w_dof,&amp;vel_l2g[eN_nDOF_trial_element],&amp;vel_trial_ref[k*nDOF_trial_element],<a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a>);</div>
<div class="line"><a name="l07066"></a><span class="lineno"> 7066</span>&#160; </div>
<div class="line"><a name="l07067"></a><span class="lineno"> 7067</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;nDOF_trial_element;++j)</div>
<div class="line"><a name="l07068"></a><span class="lineno"> 7068</span>&#160;                {</div>
<div class="line"><a name="l07069"></a><span class="lineno"> 7069</span>&#160;                  p_test_dV[j] = p_trial_ref[k*nDOF_trial_element+j]*dV;</div>
<div class="line"><a name="l07070"></a><span class="lineno"> 7070</span>&#160;                  vel_test_dV[j] = vel_trial_ref[k*nDOF_trial_element+j]*dV;</div>
<div class="line"><a name="l07071"></a><span class="lineno"> 7071</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nSpace; ++i)</div>
<div class="line"><a name="l07072"></a><span class="lineno"> 7072</span>&#160;                    {</div>
<div class="line"><a name="l07073"></a><span class="lineno"> 7073</span>&#160;                      p_grad_test_dV[j*nSpace+i] = p_grad_trial[j*nSpace+i]*dV;</div>
<div class="line"><a name="l07074"></a><span class="lineno"> 7074</span>&#160;                      vel_grad_test_dV[j*nSpace+i] = vel_grad_trial[j*nSpace+i]*dV;</div>
<div class="line"><a name="l07075"></a><span class="lineno"> 7075</span>&#160;                    }</div>
<div class="line"><a name="l07076"></a><span class="lineno"> 7076</span>&#160;                }</div>
<div class="line"><a name="l07077"></a><span class="lineno"> 7077</span>&#160; </div>
<div class="line"><a name="l07078"></a><span class="lineno"> 7078</span>&#160; </div>
<div class="line"><a name="l07079"></a><span class="lineno"> 7079</span>&#160;              <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#ab66a1a6d5a9b4641792020f58af14938">evaluateTPAdvectionCoefficients</a>(eps_rho,</div>
<div class="line"><a name="l07080"></a><span class="lineno"> 7080</span>&#160;                                              <a class="code" href="_error_residual_method_8cpp.html#ae5f5d9edb66645eab31a7c8389493ce7">rho_0</a>,</div>
<div class="line"><a name="l07081"></a><span class="lineno"> 7081</span>&#160;                                              <a class="code" href="_error_residual_method_8cpp.html#a751e53c9d8dfaf696b11b86e0c1b42e9">rho_1</a>,</div>
<div class="line"><a name="l07082"></a><span class="lineno"> 7082</span>&#160;                                              useVF,</div>
<div class="line"><a name="l07083"></a><span class="lineno"> 7083</span>&#160;                                              vf[eN_k],</div>
<div class="line"><a name="l07084"></a><span class="lineno"> 7084</span>&#160;                                              <a class="code" href="namespaceproteus.html#a17bf106c5df3b1331ed2a18392384813">phi</a>[eN_k],</div>
<div class="line"><a name="l07085"></a><span class="lineno"> 7085</span>&#160;                                              <a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>,</div>
<div class="line"><a name="l07086"></a><span class="lineno"> 7086</span>&#160;                                              <a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>,</div>
<div class="line"><a name="l07087"></a><span class="lineno"> 7087</span>&#160;                                              <a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a>,</div>
<div class="line"><a name="l07088"></a><span class="lineno"> 7088</span>&#160;                                              dmass_adv_p,</div>
<div class="line"><a name="l07089"></a><span class="lineno"> 7089</span>&#160;                                              dmom_u_adv_u,</div>
<div class="line"><a name="l07090"></a><span class="lineno"> 7090</span>&#160;                                              dmom_v_adv_v,</div>
<div class="line"><a name="l07091"></a><span class="lineno"> 7091</span>&#160;                                              dmom_w_adv_w);</div>
<div class="line"><a name="l07092"></a><span class="lineno"> 7092</span>&#160; </div>
<div class="line"><a name="l07093"></a><span class="lineno"> 7093</span>&#160; </div>
<div class="line"><a name="l07094"></a><span class="lineno"> 7094</span>&#160;              <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;nDOF_test_element;++i){</div>
<div class="line"><a name="l07095"></a><span class="lineno"> 7095</span>&#160;                <span class="keywordtype">int</span> i_nSpace = i*nSpace;</div>
<div class="line"><a name="l07096"></a><span class="lineno"> 7096</span>&#160; </div>
<div class="line"><a name="l07097"></a><span class="lineno"> 7097</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0; j&lt;nDOF_trial_element;++j){</div>
<div class="line"><a name="l07098"></a><span class="lineno"> 7098</span>&#160; </div>
<div class="line"><a name="l07099"></a><span class="lineno"> 7099</span>&#160;                  <span class="keywordtype">int</span> j_nSpace = j*nSpace;</div>
<div class="line"><a name="l07100"></a><span class="lineno"> 7100</span>&#160; </div>
<div class="line"><a name="l07101"></a><span class="lineno"> 7101</span>&#160;                  local_matrix_p_p[i][j] += <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.HamiltonianJacobian_weak(dmass_adv_p,&amp;p_grad_trial[j_nSpace],p_test_dV[i]);</div>
<div class="line"><a name="l07102"></a><span class="lineno"> 7102</span>&#160;                  local_matrix_u_u[i][j] += <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.HamiltonianJacobian_weak(dmom_u_adv_u,&amp;vel_grad_trial[j_nSpace],vel_test_dV[i]);</div>
<div class="line"><a name="l07103"></a><span class="lineno"> 7103</span>&#160;                  local_matrix_v_v[i][j] += <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.HamiltonianJacobian_weak(dmom_v_adv_v,&amp;vel_grad_trial[j_nSpace],vel_test_dV[i]);</div>
<div class="line"><a name="l07104"></a><span class="lineno"> 7104</span>&#160;                  local_matrix_w_w[i][j] += <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.HamiltonianJacobian_weak(dmom_w_adv_w,&amp;vel_grad_trial[j_nSpace],vel_test_dV[i]);</div>
<div class="line"><a name="l07105"></a><span class="lineno"> 7105</span>&#160;                }</div>
<div class="line"><a name="l07106"></a><span class="lineno"> 7106</span>&#160;              }</div>
<div class="line"><a name="l07107"></a><span class="lineno"> 7107</span>&#160; </div>
<div class="line"><a name="l07108"></a><span class="lineno"> 7108</span>&#160; </div>
<div class="line"><a name="l07109"></a><span class="lineno"> 7109</span>&#160;            }<span class="comment">//k</span></div>
<div class="line"><a name="l07110"></a><span class="lineno"> 7110</span>&#160; </div>
<div class="line"><a name="l07111"></a><span class="lineno"> 7111</span>&#160;            <span class="comment">// Write local matrix information into global system</span></div>
<div class="line"><a name="l07112"></a><span class="lineno"> 7112</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0 ; i &lt; nDOF_test_element ; ++i)</div>
<div class="line"><a name="l07113"></a><span class="lineno"> 7113</span>&#160;              {</div>
<div class="line"><a name="l07114"></a><span class="lineno"> 7114</span>&#160;                <span class="keywordtype">int</span> eN_i = eN*nDOF_test_element + i;</div>
<div class="line"><a name="l07115"></a><span class="lineno"> 7115</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0 ; j &lt; nDOF_trial_element ; ++j)</div>
<div class="line"><a name="l07116"></a><span class="lineno"> 7116</span>&#160;                  {</div>
<div class="line"><a name="l07117"></a><span class="lineno"> 7117</span>&#160;                    <span class="keywordtype">int</span> eN_i_j = eN_i*nDOF_trial_element + j;</div>
<div class="line"><a name="l07118"></a><span class="lineno"> 7118</span>&#160;                    advection_matrix[csrRowIndeces_p_p[eN_i] + csrColumnOffsets_p_p[eN_i_j]] += local_matrix_p_p[i][j] ;</div>
<div class="line"><a name="l07119"></a><span class="lineno"> 7119</span>&#160;                    advection_matrix[csrRowIndeces_u_u[eN_i] + csrColumnOffsets_u_u[eN_i_j]] += local_matrix_u_u[i][j] ;</div>
<div class="line"><a name="l07120"></a><span class="lineno"> 7120</span>&#160;                    advection_matrix[csrRowIndeces_v_v[eN_i] + csrColumnOffsets_v_v[eN_i_j]] += local_matrix_v_v[i][j] ;</div>
<div class="line"><a name="l07121"></a><span class="lineno"> 7121</span>&#160;                    advection_matrix[csrRowIndeces_w_w[eN_i] + csrColumnOffsets_w_w[eN_i_j]] += local_matrix_w_w[i][j] ;</div>
<div class="line"><a name="l07122"></a><span class="lineno"> 7122</span>&#160;                  }</div>
<div class="line"><a name="l07123"></a><span class="lineno"> 7123</span>&#160;              }</div>
<div class="line"><a name="l07124"></a><span class="lineno"> 7124</span>&#160; </div>
<div class="line"><a name="l07125"></a><span class="lineno"> 7125</span>&#160;          }<span class="comment">//eN</span></div>
<div class="line"><a name="l07126"></a><span class="lineno"> 7126</span>&#160;      } <span class="comment">// getTwoPhaseAdvectionOperator</span></div>
<div class="line"><a name="l07127"></a><span class="lineno"> 7127</span>&#160; </div>
<div class="line"><a name="l07128"></a><span class="lineno"><a class="line" href="classproteus_1_1_r_a_n_s2_p.html#ae7352b8f6f5d78a97c100c6e6d88f546"> 7128</a></span>&#160;      <span class="keywordtype">void</span> <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#ae7352b8f6f5d78a97c100c6e6d88f546">getTwoPhaseInvScaledLaplaceOperator</a>(<span class="keywordtype">double</span>* mesh_trial_ref,</div>
<div class="line"><a name="l07129"></a><span class="lineno"> 7129</span>&#160;                                               <span class="keywordtype">double</span>* mesh_grad_trial_ref,</div>
<div class="line"><a name="l07130"></a><span class="lineno"> 7130</span>&#160;                                               <span class="keywordtype">double</span>* mesh_dof,</div>
<div class="line"><a name="l07131"></a><span class="lineno"> 7131</span>&#160;                                               <span class="keywordtype">int</span>* mesh_l2g,</div>
<div class="line"><a name="l07132"></a><span class="lineno"> 7132</span>&#160;                                               <span class="keywordtype">double</span>* dV_ref,</div>
<div class="line"><a name="l07133"></a><span class="lineno"> 7133</span>&#160;                                               <span class="keywordtype">double</span>* p_grad_trial_ref,</div>
<div class="line"><a name="l07134"></a><span class="lineno"> 7134</span>&#160;                                               <span class="keywordtype">double</span>* vel_grad_trial_ref,</div>
<div class="line"><a name="l07135"></a><span class="lineno"> 7135</span>&#160;                                               <span class="keywordtype">double</span>* elementDiameter,</div>
<div class="line"><a name="l07136"></a><span class="lineno"> 7136</span>&#160;                                               <span class="keywordtype">double</span>* nodeDiametersArray,</div>
<div class="line"><a name="l07137"></a><span class="lineno"> 7137</span>&#160;                                               <span class="keywordtype">int</span> nElements_global,</div>
<div class="line"><a name="l07138"></a><span class="lineno"> 7138</span>&#160;                                               <span class="keywordtype">double</span> useMetrics,</div>
<div class="line"><a name="l07139"></a><span class="lineno"> 7139</span>&#160;                                               <span class="keywordtype">double</span> epsFact_rho,</div>
<div class="line"><a name="l07140"></a><span class="lineno"> 7140</span>&#160;                                               <span class="keywordtype">double</span> epsFact_mu,</div>
<div class="line"><a name="l07141"></a><span class="lineno"> 7141</span>&#160;                                               <span class="keywordtype">double</span> <a class="code" href="_error_residual_method_8cpp.html#ae5f5d9edb66645eab31a7c8389493ce7">rho_0</a>,</div>
<div class="line"><a name="l07142"></a><span class="lineno"> 7142</span>&#160;                                               <span class="keywordtype">double</span> <a class="code" href="_error_residual_method_8cpp.html#a383b07af68441ce2b4adaaf8d8cc9d90">nu_0</a>,</div>
<div class="line"><a name="l07143"></a><span class="lineno"> 7143</span>&#160;                                               <span class="keywordtype">double</span> <a class="code" href="_error_residual_method_8cpp.html#a751e53c9d8dfaf696b11b86e0c1b42e9">rho_1</a>,</div>
<div class="line"><a name="l07144"></a><span class="lineno"> 7144</span>&#160;                                               <span class="keywordtype">double</span> <a class="code" href="_error_residual_method_8cpp.html#ae5896ebfee35f22242123e4ae82c81d9">nu_1</a>,</div>
<div class="line"><a name="l07145"></a><span class="lineno"> 7145</span>&#160;                                               <span class="keywordtype">int</span>* p_l2g,</div>
<div class="line"><a name="l07146"></a><span class="lineno"> 7146</span>&#160;                                               <span class="keywordtype">int</span>* vel_l2g,</div>
<div class="line"><a name="l07147"></a><span class="lineno"> 7147</span>&#160;                                               <span class="keywordtype">double</span>* p_dof, <span class="keywordtype">double</span>* u_dof, <span class="keywordtype">double</span>* v_dof, <span class="keywordtype">double</span>* w_dof,</div>
<div class="line"><a name="l07148"></a><span class="lineno"> 7148</span>&#160;                                               <span class="keyword">const</span> <span class="keywordtype">double</span> useVF,</div>
<div class="line"><a name="l07149"></a><span class="lineno"> 7149</span>&#160;                                               <span class="keywordtype">double</span>* vf,</div>
<div class="line"><a name="l07150"></a><span class="lineno"> 7150</span>&#160;                                               <span class="keywordtype">double</span>* <a class="code" href="namespaceproteus.html#a17bf106c5df3b1331ed2a18392384813">phi</a>,</div>
<div class="line"><a name="l07151"></a><span class="lineno"> 7151</span>&#160;                                               <span class="keywordtype">int</span>* sdInfo_p_p_rowptr, <span class="keywordtype">int</span>* sdInfo_p_p_colind,</div>
<div class="line"><a name="l07152"></a><span class="lineno"> 7152</span>&#160;                                               <span class="keywordtype">int</span>* sdInfo_u_u_rowptr, <span class="keywordtype">int</span>* sdInfo_u_u_colind,</div>
<div class="line"><a name="l07153"></a><span class="lineno"> 7153</span>&#160;                                               <span class="keywordtype">int</span>* sdInfo_v_v_rowptr, <span class="keywordtype">int</span>* sdInfo_v_v_colind,</div>
<div class="line"><a name="l07154"></a><span class="lineno"> 7154</span>&#160;                                               <span class="keywordtype">int</span>* sdInfo_w_w_rowptr, <span class="keywordtype">int</span>* sdInfo_w_w_colind,</div>
<div class="line"><a name="l07155"></a><span class="lineno"> 7155</span>&#160;                                               <span class="keywordtype">int</span>* csrRowIndeces_p_p, <span class="keywordtype">int</span>* csrColumnOffsets_p_p,</div>
<div class="line"><a name="l07156"></a><span class="lineno"> 7156</span>&#160;                                               <span class="keywordtype">int</span>* csrRowIndeces_u_u, <span class="keywordtype">int</span>* csrColumnOffsets_u_u,</div>
<div class="line"><a name="l07157"></a><span class="lineno"> 7157</span>&#160;                                               <span class="keywordtype">int</span>* csrRowIndeces_v_v, <span class="keywordtype">int</span>* csrColumnOffsets_v_v,</div>
<div class="line"><a name="l07158"></a><span class="lineno"> 7158</span>&#160;                                               <span class="keywordtype">int</span>* csrRowIndeces_w_w, <span class="keywordtype">int</span>* csrColumnOffsets_w_w,</div>
<div class="line"><a name="l07159"></a><span class="lineno"> 7159</span>&#160;                                               <span class="keywordtype">double</span>* laplace_matrix)</div>
<div class="line"><a name="l07160"></a><span class="lineno"> 7160</span>&#160;      {</div>
<div class="line"><a name="l07161"></a><span class="lineno"> 7161</span>&#160;        <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a25259ea48a9bc3708796a96164a3b8de">gf</a>.useExact = <span class="keyword">false</span>;</div>
<div class="line"><a name="l07162"></a><span class="lineno"> 7162</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> eN=0 ; eN &lt; nElements_global ; ++eN)</div>
<div class="line"><a name="l07163"></a><span class="lineno"> 7163</span>&#160;          {</div>
<div class="line"><a name="l07164"></a><span class="lineno"> 7164</span>&#160;            <span class="comment">// local matrix allocations</span></div>
<div class="line"><a name="l07165"></a><span class="lineno"> 7165</span>&#160;            <span class="keywordtype">double</span> eps_rho, eps_mu;</div>
<div class="line"><a name="l07166"></a><span class="lineno"> 7166</span>&#160; </div>
<div class="line"><a name="l07167"></a><span class="lineno"> 7167</span>&#160;            <span class="keywordtype">double</span> local_matrix_p_p[nDOF_test_element][nDOF_trial_element];</div>
<div class="line"><a name="l07168"></a><span class="lineno"> 7168</span>&#160;            <span class="keywordtype">double</span> local_matrix_u_u[nDOF_test_element][nDOF_trial_element];</div>
<div class="line"><a name="l07169"></a><span class="lineno"> 7169</span>&#160;            <span class="keywordtype">double</span> local_matrix_v_v[nDOF_test_element][nDOF_trial_element];</div>
<div class="line"><a name="l07170"></a><span class="lineno"> 7170</span>&#160;            <span class="keywordtype">double</span> local_matrix_w_w[nDOF_test_element][nDOF_trial_element];</div>
<div class="line"><a name="l07171"></a><span class="lineno"> 7171</span>&#160; </div>
<div class="line"><a name="l07172"></a><span class="lineno"> 7172</span>&#160;            <span class="comment">// reset local matrix entries</span></div>
<div class="line"><a name="l07173"></a><span class="lineno"> 7173</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0 ; i &lt; nDOF_test_element ; ++i)</div>
<div class="line"><a name="l07174"></a><span class="lineno"> 7174</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0 ; j &lt; nDOF_trial_element ; ++j){</div>
<div class="line"><a name="l07175"></a><span class="lineno"> 7175</span>&#160;                <span class="comment">// set local matrices to 0</span></div>
<div class="line"><a name="l07176"></a><span class="lineno"> 7176</span>&#160;                local_matrix_p_p[i][j] = 0.;</div>
<div class="line"><a name="l07177"></a><span class="lineno"> 7177</span>&#160;                local_matrix_u_u[i][j] = 0.;</div>
<div class="line"><a name="l07178"></a><span class="lineno"> 7178</span>&#160;                local_matrix_v_v[i][j] = 0.;</div>
<div class="line"><a name="l07179"></a><span class="lineno"> 7179</span>&#160;                local_matrix_w_w[i][j] = 0.;</div>
<div class="line"><a name="l07180"></a><span class="lineno"> 7180</span>&#160;              }</div>
<div class="line"><a name="l07181"></a><span class="lineno"> 7181</span>&#160; </div>
<div class="line"><a name="l07182"></a><span class="lineno"> 7182</span>&#160;            <span class="comment">// Loop over quadrature points on element</span></div>
<div class="line"><a name="l07183"></a><span class="lineno"> 7183</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0 ; k &lt; nQuadraturePoints_element; ++k){</div>
<div class="line"><a name="l07184"></a><span class="lineno"> 7184</span>&#160; </div>
<div class="line"><a name="l07185"></a><span class="lineno"> 7185</span>&#160;              <span class="keywordtype">int</span> eN_k = eN*nQuadraturePoints_element + k;</div>
<div class="line"><a name="l07186"></a><span class="lineno"> 7186</span>&#160;              <span class="keywordtype">int</span> eN_nDOF_trial_element = eN*nDOF_trial_element;</div>
<div class="line"><a name="l07187"></a><span class="lineno"> 7187</span>&#160; </div>
<div class="line"><a name="l07188"></a><span class="lineno"> 7188</span>&#160;              <span class="keywordtype">double</span> grad_p[nSpace], grad_u[nSpace], grad_v[nSpace], grad_w[nSpace];</div>
<div class="line"><a name="l07189"></a><span class="lineno"> 7189</span>&#160;              <span class="keywordtype">double</span> jac[nSpace*nSpace];</div>
<div class="line"><a name="l07190"></a><span class="lineno"> 7190</span>&#160;              <span class="keywordtype">double</span> jacInv[nSpace*nSpace];</div>
<div class="line"><a name="l07191"></a><span class="lineno"> 7191</span>&#160;              <span class="keywordtype">double</span> mom_pp_diff_ten[nSpace];</div>
<div class="line"><a name="l07192"></a><span class="lineno"> 7192</span>&#160;              <span class="keywordtype">double</span> mom_uu_diff_ten[nSpace];</div>
<div class="line"><a name="l07193"></a><span class="lineno"> 7193</span>&#160;              <span class="keywordtype">double</span> mom_vv_diff_ten[nSpace];</div>
<div class="line"><a name="l07194"></a><span class="lineno"> 7194</span>&#160;              <span class="keywordtype">double</span> mom_ww_diff_ten[nSpace];</div>
<div class="line"><a name="l07195"></a><span class="lineno"> 7195</span>&#160;              <span class="keywordtype">double</span> p_grad_trial[nDOF_trial_element*nSpace],</div>
<div class="line"><a name="l07196"></a><span class="lineno"> 7196</span>&#160;                vel_grad_trial[nDOF_trial_element*nSpace];</div>
<div class="line"><a name="l07197"></a><span class="lineno"> 7197</span>&#160;              <span class="keywordtype">double</span> p_grad_test_dV[nDOF_test_element*nSpace],</div>
<div class="line"><a name="l07198"></a><span class="lineno"> 7198</span>&#160;                vel_grad_test_dV[nDOF_test_element*nSpace];</div>
<div class="line"><a name="l07199"></a><span class="lineno"> 7199</span>&#160;              <span class="keywordtype">double</span> jacDet, x, y, <a class="code" href="_headers_8h.html#a9d199fcfc162b9ad09d4c9426e713a74">z</a>, dV, h_phi;</div>
<div class="line"><a name="l07200"></a><span class="lineno"> 7200</span>&#160; </div>
<div class="line"><a name="l07201"></a><span class="lineno"> 7201</span>&#160;              <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.calculateMapping_element(eN,</div>
<div class="line"><a name="l07202"></a><span class="lineno"> 7202</span>&#160;                                          k,</div>
<div class="line"><a name="l07203"></a><span class="lineno"> 7203</span>&#160;                                          mesh_dof,</div>
<div class="line"><a name="l07204"></a><span class="lineno"> 7204</span>&#160;                                          mesh_l2g,</div>
<div class="line"><a name="l07205"></a><span class="lineno"> 7205</span>&#160;                                          mesh_trial_ref,</div>
<div class="line"><a name="l07206"></a><span class="lineno"> 7206</span>&#160;                                          mesh_grad_trial_ref,</div>
<div class="line"><a name="l07207"></a><span class="lineno"> 7207</span>&#160;                                          jac,</div>
<div class="line"><a name="l07208"></a><span class="lineno"> 7208</span>&#160;                                          jacDet,</div>
<div class="line"><a name="l07209"></a><span class="lineno"> 7209</span>&#160;                                          jacInv,</div>
<div class="line"><a name="l07210"></a><span class="lineno"> 7210</span>&#160;                                          x,y,<a class="code" href="_headers_8h.html#a9d199fcfc162b9ad09d4c9426e713a74">z</a>);</div>
<div class="line"><a name="l07211"></a><span class="lineno"> 7211</span>&#160; </div>
<div class="line"><a name="l07212"></a><span class="lineno"> 7212</span>&#160;              <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.calculateH_element(eN,</div>
<div class="line"><a name="l07213"></a><span class="lineno"> 7213</span>&#160;                                    k,</div>
<div class="line"><a name="l07214"></a><span class="lineno"> 7214</span>&#160;                                    nodeDiametersArray,</div>
<div class="line"><a name="l07215"></a><span class="lineno"> 7215</span>&#160;                                    mesh_l2g,</div>
<div class="line"><a name="l07216"></a><span class="lineno"> 7216</span>&#160;                                    mesh_trial_ref,</div>
<div class="line"><a name="l07217"></a><span class="lineno"> 7217</span>&#160;                                    h_phi);</div>
<div class="line"><a name="l07218"></a><span class="lineno"> 7218</span>&#160; </div>
<div class="line"><a name="l07219"></a><span class="lineno"> 7219</span>&#160;              dV = fabs(jacDet)*dV_ref[k];</div>
<div class="line"><a name="l07220"></a><span class="lineno"> 7220</span>&#160; </div>
<div class="line"><a name="l07221"></a><span class="lineno"> 7221</span>&#160;              eps_mu = epsFact_mu * (useMetrics*h_phi+(1.0-useMetrics)*elementDiameter[eN]);</div>
<div class="line"><a name="l07222"></a><span class="lineno"> 7222</span>&#160;              eps_rho = epsFact_rho * (useMetrics*h_phi+(1.0-useMetrics)*elementDiameter[eN]);</div>
<div class="line"><a name="l07223"></a><span class="lineno"> 7223</span>&#160; </div>
<div class="line"><a name="l07224"></a><span class="lineno"> 7224</span>&#160;              <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.gradTrialFromRef(&amp;p_grad_trial_ref[k*nDOF_trial_element*nSpace],jacInv,p_grad_trial);</div>
<div class="line"><a name="l07225"></a><span class="lineno"> 7225</span>&#160;              <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.gradTrialFromRef(&amp;vel_grad_trial_ref[k*nDOF_trial_element*nSpace],jacInv,vel_grad_trial);</div>
<div class="line"><a name="l07226"></a><span class="lineno"> 7226</span>&#160; </div>
<div class="line"><a name="l07227"></a><span class="lineno"> 7227</span>&#160;              <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.gradFromDOF(p_dof,&amp;p_l2g[eN_nDOF_trial_element],p_grad_trial,grad_p);</div>
<div class="line"><a name="l07228"></a><span class="lineno"> 7228</span>&#160;              <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.gradFromDOF(u_dof,&amp;vel_l2g[eN_nDOF_trial_element],vel_grad_trial,grad_u);</div>
<div class="line"><a name="l07229"></a><span class="lineno"> 7229</span>&#160;              <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.gradFromDOF(v_dof,&amp;vel_l2g[eN_nDOF_trial_element],vel_grad_trial,grad_v);</div>
<div class="line"><a name="l07230"></a><span class="lineno"> 7230</span>&#160;              <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.gradFromDOF(w_dof,&amp;vel_l2g[eN_nDOF_trial_element],vel_grad_trial,grad_w);</div>
<div class="line"><a name="l07231"></a><span class="lineno"> 7231</span>&#160; </div>
<div class="line"><a name="l07232"></a><span class="lineno"> 7232</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;nDOF_trial_element;++j)</div>
<div class="line"><a name="l07233"></a><span class="lineno"> 7233</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nSpace; ++i)</div>
<div class="line"><a name="l07234"></a><span class="lineno"> 7234</span>&#160;                  {</div>
<div class="line"><a name="l07235"></a><span class="lineno"> 7235</span>&#160;                    p_grad_test_dV[j*nSpace+i] = p_grad_trial[j*nSpace+i]*dV;</div>
<div class="line"><a name="l07236"></a><span class="lineno"> 7236</span>&#160;                    vel_grad_test_dV[j*nSpace+i] = vel_grad_trial[j*nSpace+i]*dV;</div>
<div class="line"><a name="l07237"></a><span class="lineno"> 7237</span>&#160;                  }</div>
<div class="line"><a name="l07238"></a><span class="lineno"> 7238</span>&#160; </div>
<div class="line"><a name="l07239"></a><span class="lineno"> 7239</span>&#160;              <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a348042ad3350e7e70a219182dc12645c">evaluateTPInvDensityLaplaceCoefficients</a>(eps_rho,</div>
<div class="line"><a name="l07240"></a><span class="lineno"> 7240</span>&#160;                                                      <a class="code" href="_error_residual_method_8cpp.html#ae5f5d9edb66645eab31a7c8389493ce7">rho_0</a>,</div>
<div class="line"><a name="l07241"></a><span class="lineno"> 7241</span>&#160;                                                      <a class="code" href="_error_residual_method_8cpp.html#a751e53c9d8dfaf696b11b86e0c1b42e9">rho_1</a>,</div>
<div class="line"><a name="l07242"></a><span class="lineno"> 7242</span>&#160;                                                      useVF,</div>
<div class="line"><a name="l07243"></a><span class="lineno"> 7243</span>&#160;                                                      vf[eN_k],</div>
<div class="line"><a name="l07244"></a><span class="lineno"> 7244</span>&#160;                                                      <a class="code" href="namespaceproteus.html#a17bf106c5df3b1331ed2a18392384813">phi</a>[eN_k],</div>
<div class="line"><a name="l07245"></a><span class="lineno"> 7245</span>&#160;                                                      mom_pp_diff_ten,</div>
<div class="line"><a name="l07246"></a><span class="lineno"> 7246</span>&#160;                                                      mom_uu_diff_ten,</div>
<div class="line"><a name="l07247"></a><span class="lineno"> 7247</span>&#160;                                                      mom_vv_diff_ten,</div>
<div class="line"><a name="l07248"></a><span class="lineno"> 7248</span>&#160;                                                      mom_ww_diff_ten);</div>
<div class="line"><a name="l07249"></a><span class="lineno"> 7249</span>&#160; </div>
<div class="line"><a name="l07250"></a><span class="lineno"> 7250</span>&#160;              <span class="comment">// loop over test and weighted trial functions to evaluate local inner products</span></div>
<div class="line"><a name="l07251"></a><span class="lineno"> 7251</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0 ; i &lt; nDOF_test_element ; ++i)</div>
<div class="line"><a name="l07252"></a><span class="lineno"> 7252</span>&#160;                {</div>
<div class="line"><a name="l07253"></a><span class="lineno"> 7253</span>&#160;                  <span class="keywordtype">int</span> i_nSpace = i*nSpace ;</div>
<div class="line"><a name="l07254"></a><span class="lineno"> 7254</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j &lt; nDOF_trial_element ; ++j){</div>
<div class="line"><a name="l07255"></a><span class="lineno"> 7255</span>&#160;                    <span class="keywordtype">int</span> j_nSpace = j*nSpace ;</div>
<div class="line"><a name="l07256"></a><span class="lineno"> 7256</span>&#160;                    <span class="comment">/* local_matrix_p_p[i][j] += ck.SimpleDiffusionJacobian_weak(sdInfo_p_p_rowptr, */</span></div>
<div class="line"><a name="l07257"></a><span class="lineno"> 7257</span>&#160;                    <span class="comment">/*                                                        sdInfo_p_p_colind, */</span></div>
<div class="line"><a name="l07258"></a><span class="lineno"> 7258</span>&#160;                    <span class="comment">/*                                                        mom_pp_diff_ten, */</span></div>
<div class="line"><a name="l07259"></a><span class="lineno"> 7259</span>&#160;                    <span class="comment">/*                                                        &amp;p_grad_trial[j_nSpace], */</span></div>
<div class="line"><a name="l07260"></a><span class="lineno"> 7260</span>&#160;                    <span class="comment">/*                                                        &amp;p_grad_test_dV[i_nSpace]); */</span></div>
<div class="line"><a name="l07261"></a><span class="lineno"> 7261</span>&#160; </div>
<div class="line"><a name="l07262"></a><span class="lineno"> 7262</span>&#160;                    <span class="comment">/* local_matrix_u_u[i][j] += ck.SimpleDiffusionJacobian_weak(sdInfo_u_u_rowptr, */</span></div>
<div class="line"><a name="l07263"></a><span class="lineno"> 7263</span>&#160;                    <span class="comment">/*                                                        sdInfo_u_u_colind, */</span></div>
<div class="line"><a name="l07264"></a><span class="lineno"> 7264</span>&#160;                    <span class="comment">/*                                                        mom_uu_diff_ten, */</span></div>
<div class="line"><a name="l07265"></a><span class="lineno"> 7265</span>&#160;                    <span class="comment">/*                                                        &amp;vel_grad_trial[j_nSpace], */</span></div>
<div class="line"><a name="l07266"></a><span class="lineno"> 7266</span>&#160;                    <span class="comment">/*                                                        &amp;vel_grad_test_dV[i_nSpace]); */</span></div>
<div class="line"><a name="l07267"></a><span class="lineno"> 7267</span>&#160; </div>
<div class="line"><a name="l07268"></a><span class="lineno"> 7268</span>&#160;                    <span class="comment">/* local_matrix_v_v[i][j] += ck.SimpleDiffusionJacobian_weak(sdInfo_v_v_rowptr, */</span></div>
<div class="line"><a name="l07269"></a><span class="lineno"> 7269</span>&#160;                    <span class="comment">/*                                                        sdInfo_v_v_colind, */</span></div>
<div class="line"><a name="l07270"></a><span class="lineno"> 7270</span>&#160;                    <span class="comment">/*                                                        mom_vv_diff_ten, */</span></div>
<div class="line"><a name="l07271"></a><span class="lineno"> 7271</span>&#160;                    <span class="comment">/*                                                        &amp;vel_grad_trial[j_nSpace], */</span></div>
<div class="line"><a name="l07272"></a><span class="lineno"> 7272</span>&#160;                    <span class="comment">/*                                                        &amp;vel_grad_test_dV[i_nSpace]); */</span></div>
<div class="line"><a name="l07273"></a><span class="lineno"> 7273</span>&#160;                    local_matrix_p_p[i][j] += <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.NumericalDiffusionJacobian(mom_pp_diff_ten[0],</div>
<div class="line"><a name="l07274"></a><span class="lineno"> 7274</span>&#160;                                                                            &amp;p_grad_trial[j_nSpace],</div>
<div class="line"><a name="l07275"></a><span class="lineno"> 7275</span>&#160;                                                                            &amp;p_grad_test_dV[i_nSpace]);</div>
<div class="line"><a name="l07276"></a><span class="lineno"> 7276</span>&#160; </div>
<div class="line"><a name="l07277"></a><span class="lineno"> 7277</span>&#160;                    local_matrix_u_u[i][j] += <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.NumericalDiffusionJacobian(mom_uu_diff_ten[0],</div>
<div class="line"><a name="l07278"></a><span class="lineno"> 7278</span>&#160;                                                                            &amp;vel_grad_trial[j_nSpace],</div>
<div class="line"><a name="l07279"></a><span class="lineno"> 7279</span>&#160;                                                                            &amp;vel_grad_test_dV[i_nSpace]);</div>
<div class="line"><a name="l07280"></a><span class="lineno"> 7280</span>&#160; </div>
<div class="line"><a name="l07281"></a><span class="lineno"> 7281</span>&#160;                    local_matrix_v_v[i][j] += <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.NumericalDiffusionJacobian(mom_vv_diff_ten[0],</div>
<div class="line"><a name="l07282"></a><span class="lineno"> 7282</span>&#160;                                                                            &amp;vel_grad_trial[j_nSpace],</div>
<div class="line"><a name="l07283"></a><span class="lineno"> 7283</span>&#160;                                                                            &amp;vel_grad_test_dV[i_nSpace]);</div>
<div class="line"><a name="l07284"></a><span class="lineno"> 7284</span>&#160; </div>
<div class="line"><a name="l07285"></a><span class="lineno"> 7285</span>&#160;                    local_matrix_w_w[i][j] += <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.NumericalDiffusionJacobian(mom_ww_diff_ten[0],</div>
<div class="line"><a name="l07286"></a><span class="lineno"> 7286</span>&#160;                                                                            &amp;vel_grad_trial[j_nSpace],</div>
<div class="line"><a name="l07287"></a><span class="lineno"> 7287</span>&#160;                                                                            &amp;vel_grad_test_dV[i_nSpace]);</div>
<div class="line"><a name="l07288"></a><span class="lineno"> 7288</span>&#160; </div>
<div class="line"><a name="l07289"></a><span class="lineno"> 7289</span>&#160;                  } <span class="comment">// j</span></div>
<div class="line"><a name="l07290"></a><span class="lineno"> 7290</span>&#160;                } <span class="comment">// i</span></div>
<div class="line"><a name="l07291"></a><span class="lineno"> 7291</span>&#160; </div>
<div class="line"><a name="l07292"></a><span class="lineno"> 7292</span>&#160;            } <span class="comment">// k</span></div>
<div class="line"><a name="l07293"></a><span class="lineno"> 7293</span>&#160; </div>
<div class="line"><a name="l07294"></a><span class="lineno"> 7294</span>&#160;            <span class="comment">// Write local matrix information into global system</span></div>
<div class="line"><a name="l07295"></a><span class="lineno"> 7295</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0 ; i &lt; nDOF_test_element ; ++i)</div>
<div class="line"><a name="l07296"></a><span class="lineno"> 7296</span>&#160;              {</div>
<div class="line"><a name="l07297"></a><span class="lineno"> 7297</span>&#160;                <span class="keywordtype">int</span> eN_i = eN*nDOF_test_element + i;</div>
<div class="line"><a name="l07298"></a><span class="lineno"> 7298</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0 ; j &lt; nDOF_trial_element ; ++j)</div>
<div class="line"><a name="l07299"></a><span class="lineno"> 7299</span>&#160;                  {</div>
<div class="line"><a name="l07300"></a><span class="lineno"> 7300</span>&#160;                    <span class="keywordtype">int</span> eN_i_j = eN_i*nDOF_trial_element + j;</div>
<div class="line"><a name="l07301"></a><span class="lineno"> 7301</span>&#160;                    laplace_matrix[csrRowIndeces_p_p[eN_i] + csrColumnOffsets_p_p[eN_i_j]] += local_matrix_p_p[i][j] ;</div>
<div class="line"><a name="l07302"></a><span class="lineno"> 7302</span>&#160;                    laplace_matrix[csrRowIndeces_u_u[eN_i] + csrColumnOffsets_u_u[eN_i_j]] += local_matrix_u_u[i][j] ;</div>
<div class="line"><a name="l07303"></a><span class="lineno"> 7303</span>&#160;                    laplace_matrix[csrRowIndeces_v_v[eN_i] + csrColumnOffsets_v_v[eN_i_j]] += local_matrix_v_v[i][j] ;</div>
<div class="line"><a name="l07304"></a><span class="lineno"> 7304</span>&#160;                    laplace_matrix[csrRowIndeces_w_w[eN_i] + csrColumnOffsets_w_w[eN_i_j]] += local_matrix_w_w[i][j] ;</div>
<div class="line"><a name="l07305"></a><span class="lineno"> 7305</span>&#160;                  }</div>
<div class="line"><a name="l07306"></a><span class="lineno"> 7306</span>&#160;              }</div>
<div class="line"><a name="l07307"></a><span class="lineno"> 7307</span>&#160; </div>
<div class="line"><a name="l07308"></a><span class="lineno"> 7308</span>&#160;          } <span class="comment">// eN</span></div>
<div class="line"><a name="l07309"></a><span class="lineno"> 7309</span>&#160;      }</div>
<div class="line"><a name="l07310"></a><span class="lineno"> 7310</span>&#160; </div>
<div class="line"><a name="l07311"></a><span class="lineno"><a class="line" href="classproteus_1_1_r_a_n_s2_p.html#a4184fdc06b9e962875575b22ea95ff77"> 7311</a></span>&#160;      <span class="keywordtype">void</span> <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a4184fdc06b9e962875575b22ea95ff77">getTwoPhaseScaledMassOperator</a>(<span class="keywordtype">int</span> scale_type,</div>
<div class="line"><a name="l07312"></a><span class="lineno"> 7312</span>&#160;                                         <span class="keywordtype">int</span> use_numerical_viscosity,</div>
<div class="line"><a name="l07313"></a><span class="lineno"> 7313</span>&#160;                                         <span class="keywordtype">int</span> lumped,</div>
<div class="line"><a name="l07314"></a><span class="lineno"> 7314</span>&#160;                                         <span class="keywordtype">double</span> *mesh_trial_ref,</div>
<div class="line"><a name="l07315"></a><span class="lineno"> 7315</span>&#160;                                         <span class="keywordtype">double</span> *mesh_grad_trial_ref,</div>
<div class="line"><a name="l07316"></a><span class="lineno"> 7316</span>&#160;                                         <span class="keywordtype">double</span> *mesh_dof,</div>
<div class="line"><a name="l07317"></a><span class="lineno"> 7317</span>&#160;                                         <span class="keywordtype">int</span>* mesh_l2g,</div>
<div class="line"><a name="l07318"></a><span class="lineno"> 7318</span>&#160;                                         <span class="keywordtype">double</span>* dV_ref,</div>
<div class="line"><a name="l07319"></a><span class="lineno"> 7319</span>&#160;                                         <span class="keywordtype">double</span>* p_trial_ref,</div>
<div class="line"><a name="l07320"></a><span class="lineno"> 7320</span>&#160;                                         <span class="keywordtype">double</span>* p_test_ref,</div>
<div class="line"><a name="l07321"></a><span class="lineno"> 7321</span>&#160;                                         <span class="keywordtype">double</span>* vel_trial_ref,</div>
<div class="line"><a name="l07322"></a><span class="lineno"> 7322</span>&#160;                                         <span class="keywordtype">double</span>* vel_test_ref,</div>
<div class="line"><a name="l07323"></a><span class="lineno"> 7323</span>&#160;                                         <span class="keywordtype">double</span>* elementDiameter,</div>
<div class="line"><a name="l07324"></a><span class="lineno"> 7324</span>&#160;                                         <span class="keywordtype">double</span>* nodeDiametersArray,</div>
<div class="line"><a name="l07325"></a><span class="lineno"> 7325</span>&#160;                                         <span class="keywordtype">double</span>* numerical_viscosity,</div>
<div class="line"><a name="l07326"></a><span class="lineno"> 7326</span>&#160;                                         <span class="keywordtype">int</span> nElements_global,</div>
<div class="line"><a name="l07327"></a><span class="lineno"> 7327</span>&#160;                                         <span class="keywordtype">double</span> useMetrics,</div>
<div class="line"><a name="l07328"></a><span class="lineno"> 7328</span>&#160;                                         <span class="keywordtype">double</span> epsFact_rho,</div>
<div class="line"><a name="l07329"></a><span class="lineno"> 7329</span>&#160;                                         <span class="keywordtype">double</span> epsFact_mu,</div>
<div class="line"><a name="l07330"></a><span class="lineno"> 7330</span>&#160;                                         <span class="keywordtype">double</span> <a class="code" href="_error_residual_method_8cpp.html#ae5f5d9edb66645eab31a7c8389493ce7">rho_0</a>,</div>
<div class="line"><a name="l07331"></a><span class="lineno"> 7331</span>&#160;                                         <span class="keywordtype">double</span> <a class="code" href="_error_residual_method_8cpp.html#a383b07af68441ce2b4adaaf8d8cc9d90">nu_0</a>,</div>
<div class="line"><a name="l07332"></a><span class="lineno"> 7332</span>&#160;                                         <span class="keywordtype">double</span> <a class="code" href="_error_residual_method_8cpp.html#a751e53c9d8dfaf696b11b86e0c1b42e9">rho_1</a>,</div>
<div class="line"><a name="l07333"></a><span class="lineno"> 7333</span>&#160;                                         <span class="keywordtype">double</span> <a class="code" href="_error_residual_method_8cpp.html#ae5896ebfee35f22242123e4ae82c81d9">nu_1</a>,</div>
<div class="line"><a name="l07334"></a><span class="lineno"> 7334</span>&#160;                                         <span class="keywordtype">int</span>* p_l2g,</div>
<div class="line"><a name="l07335"></a><span class="lineno"> 7335</span>&#160;                                         <span class="keywordtype">int</span>* vel_l2g,</div>
<div class="line"><a name="l07336"></a><span class="lineno"> 7336</span>&#160;                                         <span class="keywordtype">double</span>* p_dof, <span class="keywordtype">double</span>* u_dof, <span class="keywordtype">double</span>* v_dof, <span class="keywordtype">double</span>* w_dof,</div>
<div class="line"><a name="l07337"></a><span class="lineno"> 7337</span>&#160;                                         <span class="keyword">const</span> <span class="keywordtype">double</span> useVF,</div>
<div class="line"><a name="l07338"></a><span class="lineno"> 7338</span>&#160;                                         <span class="keywordtype">double</span>* vf,</div>
<div class="line"><a name="l07339"></a><span class="lineno"> 7339</span>&#160;                                         <span class="keywordtype">double</span>* <a class="code" href="namespaceproteus.html#a17bf106c5df3b1331ed2a18392384813">phi</a>,</div>
<div class="line"><a name="l07340"></a><span class="lineno"> 7340</span>&#160;                                         <span class="keywordtype">int</span>* csrRowIndeces_p_p, <span class="keywordtype">int</span>* csrColumnOffsets_p_p,</div>
<div class="line"><a name="l07341"></a><span class="lineno"> 7341</span>&#160;                                         <span class="keywordtype">int</span>* csrRowIndeces_u_u, <span class="keywordtype">int</span>* csrColumnOffsets_u_u,</div>
<div class="line"><a name="l07342"></a><span class="lineno"> 7342</span>&#160;                                         <span class="keywordtype">int</span>* csrRowIndeces_v_v, <span class="keywordtype">int</span>* csrColumnOffsets_v_v,</div>
<div class="line"><a name="l07343"></a><span class="lineno"> 7343</span>&#160;                                         <span class="keywordtype">int</span>* csrRowIndeces_w_w, <span class="keywordtype">int</span>* csrColumnOffsets_w_w,</div>
<div class="line"><a name="l07344"></a><span class="lineno"> 7344</span>&#160;                                         <span class="keywordtype">double</span>* mass_matrix)</div>
<div class="line"><a name="l07345"></a><span class="lineno"> 7345</span>&#160;      {</div>
<div class="line"><a name="l07346"></a><span class="lineno"> 7346</span>&#160;        <span class="comment">// Step 1.1 - Initialize local matrix</span></div>
<div class="line"><a name="l07347"></a><span class="lineno"> 7347</span>&#160; </div>
<div class="line"><a name="l07348"></a><span class="lineno"> 7348</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> eN=0 ; eN &lt; nElements_global; ++eN){</div>
<div class="line"><a name="l07349"></a><span class="lineno"> 7349</span>&#160; </div>
<div class="line"><a name="l07350"></a><span class="lineno"> 7350</span>&#160;          <span class="keywordtype">double</span> local_matrix_p_p[nDOF_test_element][nDOF_trial_element];</div>
<div class="line"><a name="l07351"></a><span class="lineno"> 7351</span>&#160;          <span class="keywordtype">double</span> local_matrix_u_u[nDOF_test_element][nDOF_trial_element];</div>
<div class="line"><a name="l07352"></a><span class="lineno"> 7352</span>&#160;          <span class="keywordtype">double</span> local_matrix_v_v[nDOF_test_element][nDOF_trial_element];</div>
<div class="line"><a name="l07353"></a><span class="lineno"> 7353</span>&#160;          <span class="keywordtype">double</span> local_matrix_w_w[nDOF_test_element][nDOF_trial_element];</div>
<div class="line"><a name="l07354"></a><span class="lineno"> 7354</span>&#160;          <span class="keywordtype">double</span> eps_rho, eps_mu;</div>
<div class="line"><a name="l07355"></a><span class="lineno"> 7355</span>&#160; </div>
<div class="line"><a name="l07356"></a><span class="lineno"> 7356</span>&#160;          <span class="comment">// reset local matrix entries</span></div>
<div class="line"><a name="l07357"></a><span class="lineno"> 7357</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nDOF_test_element; ++i)</div>
<div class="line"><a name="l07358"></a><span class="lineno"> 7358</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;nDOF_trial_element; ++j){</div>
<div class="line"><a name="l07359"></a><span class="lineno"> 7359</span>&#160;              local_matrix_p_p[i][j] = 0.0 ;</div>
<div class="line"><a name="l07360"></a><span class="lineno"> 7360</span>&#160;              local_matrix_u_u[i][j] = 0.0 ;</div>
<div class="line"><a name="l07361"></a><span class="lineno"> 7361</span>&#160;              local_matrix_v_v[i][j] = 0.0 ;</div>
<div class="line"><a name="l07362"></a><span class="lineno"> 7362</span>&#160;              local_matrix_w_w[i][j] = 0.0 ;</div>
<div class="line"><a name="l07363"></a><span class="lineno"> 7363</span>&#160;            }</div>
<div class="line"><a name="l07364"></a><span class="lineno"> 7364</span>&#160;          <span class="comment">// Step 1.2 - Loop over quadrature points on element</span></div>
<div class="line"><a name="l07365"></a><span class="lineno"> 7365</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0 ; k &lt; nQuadraturePoints_element; ++k){</div>
<div class="line"><a name="l07366"></a><span class="lineno"> 7366</span>&#160; </div>
<div class="line"><a name="l07367"></a><span class="lineno"> 7367</span>&#160;            <span class="keywordtype">int</span> eN_k = eN*nQuadraturePoints_element+k;</div>
<div class="line"><a name="l07368"></a><span class="lineno"> 7368</span>&#160;            <span class="keywordtype">int</span> eN_nDOF_trial_element = eN*nDOF_trial_element;</div>
<div class="line"><a name="l07369"></a><span class="lineno"> 7369</span>&#160;            <span class="comment">// *** Local storage arrays ***</span></div>
<div class="line"><a name="l07370"></a><span class="lineno"> 7370</span>&#160;            <span class="keywordtype">double</span> p = 0.0, <a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a> = 0.0, <a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>= 0.0 , <a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a>= 0.0 ;</div>
<div class="line"><a name="l07371"></a><span class="lineno"> 7371</span>&#160;            <span class="keywordtype">double</span> dV;</div>
<div class="line"><a name="l07372"></a><span class="lineno"> 7372</span>&#160;            <span class="keywordtype">double</span> mom_p_acc = 0.0, dmom_p_acc_p = 0.0;</div>
<div class="line"><a name="l07373"></a><span class="lineno"> 7373</span>&#160;            <span class="keywordtype">double</span> mom_u_acc = 0.0, dmom_u_acc_u = 0.0;</div>
<div class="line"><a name="l07374"></a><span class="lineno"> 7374</span>&#160;            <span class="keywordtype">double</span> mom_v_acc = 0.0, dmom_v_acc_v = 0.0;</div>
<div class="line"><a name="l07375"></a><span class="lineno"> 7375</span>&#160;            <span class="keywordtype">double</span> mom_w_acc = 0.0, dmom_w_acc_w = 0.0;</div>
<div class="line"><a name="l07376"></a><span class="lineno"> 7376</span>&#160;            <span class="keywordtype">double</span> jac[nSpace*nSpace] ;</div>
<div class="line"><a name="l07377"></a><span class="lineno"> 7377</span>&#160;            <span class="keywordtype">double</span> jacInv[nSpace*nSpace] ;</div>
<div class="line"><a name="l07378"></a><span class="lineno"> 7378</span>&#160;            <span class="keywordtype">double</span> jacDet,x,y,<a class="code" href="_headers_8h.html#a9d199fcfc162b9ad09d4c9426e713a74">z</a> ;</div>
<div class="line"><a name="l07379"></a><span class="lineno"> 7379</span>&#160;            <span class="keywordtype">double</span> p_test_dV[nDOF_test_element], vel_test_dV[nDOF_test_element];</div>
<div class="line"><a name="l07380"></a><span class="lineno"> 7380</span>&#160;            <span class="keywordtype">double</span> h_phi;</div>
<div class="line"><a name="l07381"></a><span class="lineno"> 7381</span>&#160; </div>
<div class="line"><a name="l07382"></a><span class="lineno"> 7382</span>&#160;            <span class="comment">// Step 1.2.1 Calculate integration weights</span></div>
<div class="line"><a name="l07383"></a><span class="lineno"> 7383</span>&#160; </div>
<div class="line"><a name="l07384"></a><span class="lineno"> 7384</span>&#160;            <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.calculateMapping_element(eN,</div>
<div class="line"><a name="l07385"></a><span class="lineno"> 7385</span>&#160;                                        k,</div>
<div class="line"><a name="l07386"></a><span class="lineno"> 7386</span>&#160;                                        mesh_dof,</div>
<div class="line"><a name="l07387"></a><span class="lineno"> 7387</span>&#160;                                        mesh_l2g,</div>
<div class="line"><a name="l07388"></a><span class="lineno"> 7388</span>&#160;                                        mesh_trial_ref,</div>
<div class="line"><a name="l07389"></a><span class="lineno"> 7389</span>&#160;                                        mesh_grad_trial_ref,</div>
<div class="line"><a name="l07390"></a><span class="lineno"> 7390</span>&#160;                                        jac,</div>
<div class="line"><a name="l07391"></a><span class="lineno"> 7391</span>&#160;                                        jacDet,</div>
<div class="line"><a name="l07392"></a><span class="lineno"> 7392</span>&#160;                                        jacInv,</div>
<div class="line"><a name="l07393"></a><span class="lineno"> 7393</span>&#160;                                        x,y,<a class="code" href="_headers_8h.html#a9d199fcfc162b9ad09d4c9426e713a74">z</a>);</div>
<div class="line"><a name="l07394"></a><span class="lineno"> 7394</span>&#160; </div>
<div class="line"><a name="l07395"></a><span class="lineno"> 7395</span>&#160;            <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.calculateH_element(eN,</div>
<div class="line"><a name="l07396"></a><span class="lineno"> 7396</span>&#160;                                  k,</div>
<div class="line"><a name="l07397"></a><span class="lineno"> 7397</span>&#160;                                  nodeDiametersArray,</div>
<div class="line"><a name="l07398"></a><span class="lineno"> 7398</span>&#160;                                  mesh_l2g,</div>
<div class="line"><a name="l07399"></a><span class="lineno"> 7399</span>&#160;                                  mesh_trial_ref,</div>
<div class="line"><a name="l07400"></a><span class="lineno"> 7400</span>&#160;                                  h_phi);</div>
<div class="line"><a name="l07401"></a><span class="lineno"> 7401</span>&#160; </div>
<div class="line"><a name="l07402"></a><span class="lineno"> 7402</span>&#160;            dV = fabs(jacDet)*dV_ref[k];</div>
<div class="line"><a name="l07403"></a><span class="lineno"> 7403</span>&#160; </div>
<div class="line"><a name="l07404"></a><span class="lineno"> 7404</span>&#160;            <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.valFromDOF(p_dof,&amp;p_l2g[eN_nDOF_trial_element],&amp;p_trial_ref[k*nDOF_trial_element],p);</div>
<div class="line"><a name="l07405"></a><span class="lineno"> 7405</span>&#160;            <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.valFromDOF(u_dof,&amp;vel_l2g[eN_nDOF_trial_element],&amp;vel_trial_ref[k*nDOF_trial_element],<a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>);</div>
<div class="line"><a name="l07406"></a><span class="lineno"> 7406</span>&#160;            <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.valFromDOF(v_dof,&amp;vel_l2g[eN_nDOF_trial_element],&amp;vel_trial_ref[k*nDOF_trial_element],<a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>);</div>
<div class="line"><a name="l07407"></a><span class="lineno"> 7407</span>&#160;            <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.valFromDOF(w_dof,&amp;vel_l2g[eN_nDOF_trial_element],&amp;vel_trial_ref[k*nDOF_trial_element],<a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a>);</div>
<div class="line"><a name="l07408"></a><span class="lineno"> 7408</span>&#160; </div>
<div class="line"><a name="l07409"></a><span class="lineno"> 7409</span>&#160;            eps_rho = epsFact_rho*(useMetrics*h_phi+(1.0-useMetrics)*elementDiameter[eN]);</div>
<div class="line"><a name="l07410"></a><span class="lineno"> 7410</span>&#160;            eps_mu = epsFact_mu * (useMetrics*h_phi+(1.0-useMetrics)*elementDiameter[eN]);</div>
<div class="line"><a name="l07411"></a><span class="lineno"> 7411</span>&#160;            <span class="comment">// Step 1.2.2 Scale test functions with integration weights.</span></div>
<div class="line"><a name="l07412"></a><span class="lineno"> 7412</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0 ; j&lt;nDOF_trial_element ; ++j){</div>
<div class="line"><a name="l07413"></a><span class="lineno"> 7413</span>&#160;              p_test_dV[j] = p_test_ref[k*nDOF_trial_element + j]*dV;</div>
<div class="line"><a name="l07414"></a><span class="lineno"> 7414</span>&#160;              vel_test_dV[j] = vel_test_ref[k*nDOF_trial_element + j] * dV;</div>
<div class="line"><a name="l07415"></a><span class="lineno"> 7415</span>&#160;            }</div>
<div class="line"><a name="l07416"></a><span class="lineno"> 7416</span>&#160; </div>
<div class="line"><a name="l07417"></a><span class="lineno"> 7417</span>&#160;            <span class="comment">// Step 1.2.2 Evaluate coefficients</span></div>
<div class="line"><a name="l07418"></a><span class="lineno"> 7418</span>&#160;            <span class="keywordflow">if</span> (scale_type==0){</div>
<div class="line"><a name="l07419"></a><span class="lineno"> 7419</span>&#160;              <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a8900d9a341b8fdab38b03c7d5571ca7a">evaluateTPInvViscosityMassCoefficients</a>(use_numerical_viscosity,</div>
<div class="line"><a name="l07420"></a><span class="lineno"> 7420</span>&#160;                                                     numerical_viscosity[eN_k],</div>
<div class="line"><a name="l07421"></a><span class="lineno"> 7421</span>&#160;                                                     eps_rho,</div>
<div class="line"><a name="l07422"></a><span class="lineno"> 7422</span>&#160;                                                     eps_mu,</div>
<div class="line"><a name="l07423"></a><span class="lineno"> 7423</span>&#160;                                                     <a class="code" href="_error_residual_method_8cpp.html#ae5f5d9edb66645eab31a7c8389493ce7">rho_0</a>,</div>
<div class="line"><a name="l07424"></a><span class="lineno"> 7424</span>&#160;                                                     <a class="code" href="_error_residual_method_8cpp.html#a383b07af68441ce2b4adaaf8d8cc9d90">nu_0</a>,</div>
<div class="line"><a name="l07425"></a><span class="lineno"> 7425</span>&#160;                                                     <a class="code" href="_error_residual_method_8cpp.html#a751e53c9d8dfaf696b11b86e0c1b42e9">rho_1</a>,</div>
<div class="line"><a name="l07426"></a><span class="lineno"> 7426</span>&#160;                                                     <a class="code" href="_error_residual_method_8cpp.html#ae5896ebfee35f22242123e4ae82c81d9">nu_1</a>,</div>
<div class="line"><a name="l07427"></a><span class="lineno"> 7427</span>&#160;                                                     useVF,</div>
<div class="line"><a name="l07428"></a><span class="lineno"> 7428</span>&#160;                                                     vf[eN_k],</div>
<div class="line"><a name="l07429"></a><span class="lineno"> 7429</span>&#160;                                                     <a class="code" href="namespaceproteus.html#a17bf106c5df3b1331ed2a18392384813">phi</a>[eN_k],</div>
<div class="line"><a name="l07430"></a><span class="lineno"> 7430</span>&#160;                                                     p,</div>
<div class="line"><a name="l07431"></a><span class="lineno"> 7431</span>&#160;                                                     <a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>,</div>
<div class="line"><a name="l07432"></a><span class="lineno"> 7432</span>&#160;                                                     <a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>,</div>
<div class="line"><a name="l07433"></a><span class="lineno"> 7433</span>&#160;                                                     <a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a>,</div>
<div class="line"><a name="l07434"></a><span class="lineno"> 7434</span>&#160;                                                     mom_p_acc,</div>
<div class="line"><a name="l07435"></a><span class="lineno"> 7435</span>&#160;                                                     dmom_p_acc_p,</div>
<div class="line"><a name="l07436"></a><span class="lineno"> 7436</span>&#160;                                                     mom_u_acc,</div>
<div class="line"><a name="l07437"></a><span class="lineno"> 7437</span>&#160;                                                     dmom_u_acc_u,</div>
<div class="line"><a name="l07438"></a><span class="lineno"> 7438</span>&#160;                                                     mom_v_acc,</div>
<div class="line"><a name="l07439"></a><span class="lineno"> 7439</span>&#160;                                                     dmom_v_acc_v,</div>
<div class="line"><a name="l07440"></a><span class="lineno"> 7440</span>&#160;                                                     mom_w_acc,</div>
<div class="line"><a name="l07441"></a><span class="lineno"> 7441</span>&#160;                                                     dmom_w_acc_w) ; }</div>
<div class="line"><a name="l07442"></a><span class="lineno"> 7442</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(scale_type==1){</div>
<div class="line"><a name="l07443"></a><span class="lineno"> 7443</span>&#160;              <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#a6c96a8ae5e2aca6096bd12b44658aa84">evaluateTPDensityMassCoefficients</a>(eps_rho,</div>
<div class="line"><a name="l07444"></a><span class="lineno"> 7444</span>&#160;                                                <a class="code" href="_error_residual_method_8cpp.html#ae5f5d9edb66645eab31a7c8389493ce7">rho_0</a>,</div>
<div class="line"><a name="l07445"></a><span class="lineno"> 7445</span>&#160;                                                <a class="code" href="_error_residual_method_8cpp.html#a751e53c9d8dfaf696b11b86e0c1b42e9">rho_1</a>,</div>
<div class="line"><a name="l07446"></a><span class="lineno"> 7446</span>&#160;                                                useVF,</div>
<div class="line"><a name="l07447"></a><span class="lineno"> 7447</span>&#160;                                                vf[eN_k],</div>
<div class="line"><a name="l07448"></a><span class="lineno"> 7448</span>&#160;                                                <a class="code" href="namespaceproteus.html#a17bf106c5df3b1331ed2a18392384813">phi</a>[eN_k],</div>
<div class="line"><a name="l07449"></a><span class="lineno"> 7449</span>&#160;                                                p,</div>
<div class="line"><a name="l07450"></a><span class="lineno"> 7450</span>&#160;                                                <a class="code" href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a>,</div>
<div class="line"><a name="l07451"></a><span class="lineno"> 7451</span>&#160;                                                <a class="code" href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a>,</div>
<div class="line"><a name="l07452"></a><span class="lineno"> 7452</span>&#160;                                                <a class="code" href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a>,</div>
<div class="line"><a name="l07453"></a><span class="lineno"> 7453</span>&#160;                                                mom_p_acc,</div>
<div class="line"><a name="l07454"></a><span class="lineno"> 7454</span>&#160;                                                dmom_p_acc_p,</div>
<div class="line"><a name="l07455"></a><span class="lineno"> 7455</span>&#160;                                                mom_u_acc,</div>
<div class="line"><a name="l07456"></a><span class="lineno"> 7456</span>&#160;                                                dmom_u_acc_u,</div>
<div class="line"><a name="l07457"></a><span class="lineno"> 7457</span>&#160;                                                mom_v_acc,</div>
<div class="line"><a name="l07458"></a><span class="lineno"> 7458</span>&#160;                                                dmom_v_acc_v,</div>
<div class="line"><a name="l07459"></a><span class="lineno"> 7459</span>&#160;                                                mom_w_acc,</div>
<div class="line"><a name="l07460"></a><span class="lineno"> 7460</span>&#160;                                                dmom_w_acc_w) ;</div>
<div class="line"><a name="l07461"></a><span class="lineno"> 7461</span>&#160;            }</div>
<div class="line"><a name="l07462"></a><span class="lineno"> 7462</span>&#160; </div>
<div class="line"><a name="l07463"></a><span class="lineno"> 7463</span>&#160;            <span class="comment">// Step 1.2.3 Loop over test and weighted trial functions</span></div>
<div class="line"><a name="l07464"></a><span class="lineno"> 7464</span>&#160;            <span class="comment">// to evaluate local inner product contrubtions</span></div>
<div class="line"><a name="l07465"></a><span class="lineno"> 7465</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0 ; i &lt; nDOF_test_element; ++i)</div>
<div class="line"><a name="l07466"></a><span class="lineno"> 7466</span>&#160;              {</div>
<div class="line"><a name="l07467"></a><span class="lineno"> 7467</span>&#160;                <span class="keywordtype">int</span> i_nSpace = i*nSpace;</div>
<div class="line"><a name="l07468"></a><span class="lineno"> 7468</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0 ; j &lt; nDOF_trial_element; ++j)</div>
<div class="line"><a name="l07469"></a><span class="lineno"> 7469</span>&#160;                  {</div>
<div class="line"><a name="l07470"></a><span class="lineno"> 7470</span>&#160;                    <span class="keywordtype">int</span> j_nSpace = j*nSpace;</div>
<div class="line"><a name="l07471"></a><span class="lineno"> 7471</span>&#160;                    local_matrix_p_p[i][j] += <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.MassJacobian_weak(dmom_p_acc_p,</div>
<div class="line"><a name="l07472"></a><span class="lineno"> 7472</span>&#160;                                                                   p_trial_ref[k*nDOF_trial_element+j],</div>
<div class="line"><a name="l07473"></a><span class="lineno"> 7473</span>&#160;                                                                   p_test_dV[i]) ;</div>
<div class="line"><a name="l07474"></a><span class="lineno"> 7474</span>&#160;                    local_matrix_u_u[i][j] += <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.MassJacobian_weak(dmom_u_acc_u,</div>
<div class="line"><a name="l07475"></a><span class="lineno"> 7475</span>&#160;                                                                   vel_trial_ref[k*nDOF_trial_element+j],</div>
<div class="line"><a name="l07476"></a><span class="lineno"> 7476</span>&#160;                                                                   vel_test_dV[i]) ;</div>
<div class="line"><a name="l07477"></a><span class="lineno"> 7477</span>&#160;                    local_matrix_v_v[i][j] += <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.MassJacobian_weak(dmom_v_acc_v,</div>
<div class="line"><a name="l07478"></a><span class="lineno"> 7478</span>&#160;                                                                   vel_trial_ref[k*nDOF_trial_element+j],</div>
<div class="line"><a name="l07479"></a><span class="lineno"> 7479</span>&#160;                                                                   vel_test_dV[i]) ;</div>
<div class="line"><a name="l07480"></a><span class="lineno"> 7480</span>&#160;                    local_matrix_w_w[i][j] += <a class="code" href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">ck</a>.MassJacobian_weak(dmom_w_acc_w,</div>
<div class="line"><a name="l07481"></a><span class="lineno"> 7481</span>&#160;                                                                   vel_trial_ref[k*nDOF_trial_element+j],</div>
<div class="line"><a name="l07482"></a><span class="lineno"> 7482</span>&#160;                                                                   vel_test_dV[i]) ;</div>
<div class="line"><a name="l07483"></a><span class="lineno"> 7483</span>&#160;                  }<span class="comment">//j</span></div>
<div class="line"><a name="l07484"></a><span class="lineno"> 7484</span>&#160;              }<span class="comment">//i</span></div>
<div class="line"><a name="l07485"></a><span class="lineno"> 7485</span>&#160; </div>
<div class="line"><a name="l07486"></a><span class="lineno"> 7486</span>&#160; </div>
<div class="line"><a name="l07487"></a><span class="lineno"> 7487</span>&#160;          } <span class="comment">// k</span></div>
<div class="line"><a name="l07488"></a><span class="lineno"> 7488</span>&#160; </div>
<div class="line"><a name="l07489"></a><span class="lineno"> 7489</span>&#160;          <span class="comment">// Step 1.3 - Write local matrix information into global system</span></div>
<div class="line"><a name="l07490"></a><span class="lineno"> 7490</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0 ; i&lt;nDOF_test_element; ++i)</div>
<div class="line"><a name="l07491"></a><span class="lineno"> 7491</span>&#160;            {</div>
<div class="line"><a name="l07492"></a><span class="lineno"> 7492</span>&#160;              <span class="keywordtype">int</span> eN_i = eN*nDOF_test_element+i;</div>
<div class="line"><a name="l07493"></a><span class="lineno"> 7493</span>&#160;              <span class="keywordtype">int</span> eN_i_i = eN_i*nDOF_trial_element + i;</div>
<div class="line"><a name="l07494"></a><span class="lineno"> 7494</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0 ; j &lt; nDOF_trial_element; ++j)</div>
<div class="line"><a name="l07495"></a><span class="lineno"> 7495</span>&#160;                {</div>
<div class="line"><a name="l07496"></a><span class="lineno"> 7496</span>&#160;                  <span class="keywordtype">int</span> eN_i_j = eN_i*nDOF_trial_element + j;</div>
<div class="line"><a name="l07497"></a><span class="lineno"> 7497</span>&#160;                  <span class="keywordflow">if</span> (lumped)</div>
<div class="line"><a name="l07498"></a><span class="lineno"> 7498</span>&#160;                    {</div>
<div class="line"><a name="l07499"></a><span class="lineno"> 7499</span>&#160;                      mass_matrix[csrRowIndeces_p_p[eN_i] + csrColumnOffsets_p_p[eN_i_i]] += local_matrix_p_p[i][j] ;</div>
<div class="line"><a name="l07500"></a><span class="lineno"> 7500</span>&#160;                      mass_matrix[csrRowIndeces_u_u[eN_i] + csrColumnOffsets_u_u[eN_i_i]] += local_matrix_u_u[i][j] ;</div>
<div class="line"><a name="l07501"></a><span class="lineno"> 7501</span>&#160;                      mass_matrix[csrRowIndeces_v_v[eN_i] + csrColumnOffsets_v_v[eN_i_i]] += local_matrix_v_v[i][j] ;</div>
<div class="line"><a name="l07502"></a><span class="lineno"> 7502</span>&#160;                      mass_matrix[csrRowIndeces_w_w[eN_i] + csrColumnOffsets_w_w[eN_i_i]] += local_matrix_w_w[i][j] ;</div>
<div class="line"><a name="l07503"></a><span class="lineno"> 7503</span>&#160;                    }</div>
<div class="line"><a name="l07504"></a><span class="lineno"> 7504</span>&#160;                  <span class="keywordflow">else</span></div>
<div class="line"><a name="l07505"></a><span class="lineno"> 7505</span>&#160;                    {</div>
<div class="line"><a name="l07506"></a><span class="lineno"> 7506</span>&#160;                      mass_matrix[csrRowIndeces_p_p[eN_i] + csrColumnOffsets_p_p[eN_i_j]] += local_matrix_p_p[i][j] ;</div>
<div class="line"><a name="l07507"></a><span class="lineno"> 7507</span>&#160;                      mass_matrix[csrRowIndeces_u_u[eN_i] + csrColumnOffsets_u_u[eN_i_j]] += local_matrix_u_u[i][j] ;</div>
<div class="line"><a name="l07508"></a><span class="lineno"> 7508</span>&#160;                      mass_matrix[csrRowIndeces_v_v[eN_i] + csrColumnOffsets_v_v[eN_i_j]] += local_matrix_v_v[i][j] ;</div>
<div class="line"><a name="l07509"></a><span class="lineno"> 7509</span>&#160;                      mass_matrix[csrRowIndeces_w_w[eN_i] + csrColumnOffsets_w_w[eN_i_j]] += local_matrix_w_w[i][j] ;</div>
<div class="line"><a name="l07510"></a><span class="lineno"> 7510</span>&#160;                    }</div>
<div class="line"><a name="l07511"></a><span class="lineno"> 7511</span>&#160;                }</div>
<div class="line"><a name="l07512"></a><span class="lineno"> 7512</span>&#160;            }</div>
<div class="line"><a name="l07513"></a><span class="lineno"> 7513</span>&#160; </div>
<div class="line"><a name="l07514"></a><span class="lineno"> 7514</span>&#160;        } <span class="comment">// eN</span></div>
<div class="line"><a name="l07515"></a><span class="lineno"> 7515</span>&#160; </div>
<div class="line"><a name="l07516"></a><span class="lineno"> 7516</span>&#160;      }</div>
<div class="line"><a name="l07517"></a><span class="lineno"> 7517</span>&#160; </div>
<div class="line"><a name="l07518"></a><span class="lineno"> 7518</span>&#160;    };<span class="comment">//RANS2P</span></div>
<div class="line"><a name="l07519"></a><span class="lineno"> 7519</span>&#160; </div>
<div class="line"><a name="l07520"></a><span class="lineno"><a class="line" href="namespaceproteus.html#a3fd0de2d97b1eb82abfd5c46ba547f32"> 7520</a></span>&#160;  <span class="keyword">inline</span> <a class="code" href="classproteus_1_1_r_a_n_s2_p__base.html">RANS2P_base</a>* <a class="code" href="namespaceproteus.html#a3fd0de2d97b1eb82abfd5c46ba547f32">newRANS2P</a>(<span class="keywordtype">int</span> nSpaceIn,</div>
<div class="line"><a name="l07521"></a><span class="lineno"> 7521</span>&#160;                                <span class="keywordtype">int</span> nQuadraturePoints_elementIn,</div>
<div class="line"><a name="l07522"></a><span class="lineno"> 7522</span>&#160;                                <span class="keywordtype">int</span> nDOF_mesh_trial_elementIn,</div>
<div class="line"><a name="l07523"></a><span class="lineno"> 7523</span>&#160;                                <span class="keywordtype">int</span> nDOF_trial_elementIn,</div>
<div class="line"><a name="l07524"></a><span class="lineno"> 7524</span>&#160;                                <span class="keywordtype">int</span> nDOF_test_elementIn,</div>
<div class="line"><a name="l07525"></a><span class="lineno"> 7525</span>&#160;                                <span class="keywordtype">int</span> nDOF_v_trial_elementIn,</div>
<div class="line"><a name="l07526"></a><span class="lineno"> 7526</span>&#160;                                <span class="keywordtype">int</span> nDOF_v_test_elementIn,</div>
<div class="line"><a name="l07527"></a><span class="lineno"> 7527</span>&#160;                                <span class="keywordtype">int</span> nQuadraturePoints_elementBoundaryIn,</div>
<div class="line"><a name="l07528"></a><span class="lineno"> 7528</span>&#160;                                <span class="keywordtype">int</span> CompKernelFlag)</div>
<div class="line"><a name="l07529"></a><span class="lineno"> 7529</span>&#160;  {</div>
<div class="line"><a name="l07530"></a><span class="lineno"> 7530</span>&#160;    <span class="keywordflow">return</span> proteus::chooseAndAllocateDiscretization&lt;RANS2P_base,RANS2P,CompKernel,CompKernel&gt;(nSpaceIn,</div>
<div class="line"><a name="l07531"></a><span class="lineno"> 7531</span>&#160;                                                                                              nQuadraturePoints_elementIn,</div>
<div class="line"><a name="l07532"></a><span class="lineno"> 7532</span>&#160;                                                                                              nDOF_mesh_trial_elementIn,</div>
<div class="line"><a name="l07533"></a><span class="lineno"> 7533</span>&#160;                                                                                              nDOF_trial_elementIn,</div>
<div class="line"><a name="l07534"></a><span class="lineno"> 7534</span>&#160;                                                                                              nDOF_test_elementIn,</div>
<div class="line"><a name="l07535"></a><span class="lineno"> 7535</span>&#160;                                                                                              nDOF_v_trial_elementIn,</div>
<div class="line"><a name="l07536"></a><span class="lineno"> 7536</span>&#160;                                                                                              nDOF_v_test_elementIn,</div>
<div class="line"><a name="l07537"></a><span class="lineno"> 7537</span>&#160;                                                                                              nQuadraturePoints_elementBoundaryIn,</div>
<div class="line"><a name="l07538"></a><span class="lineno"> 7538</span>&#160;                                                                                              CompKernelFlag);</div>
<div class="line"><a name="l07539"></a><span class="lineno"> 7539</span>&#160;  }</div>
<div class="line"><a name="l07540"></a><span class="lineno"> 7540</span>&#160;}<span class="comment">//proteus</span></div>
<div class="line"><a name="l07541"></a><span class="lineno"> 7541</span>&#160; </div>
<div class="line"><a name="l07542"></a><span class="lineno"> 7542</span>&#160;<span class="preprocessor">#endif</span></div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="aclassproteus_1_1_r_a_n_s2_p_html_a7b007a2b0d9961faa8f679a3db540ca3"><div class="ttname"><a href="classproteus_1_1_r_a_n_s2_p.html#a7b007a2b0d9961faa8f679a3db540ca3">proteus::RANS2P::nDOF_test_X_trial_element</a></div><div class="ttdeci">const int nDOF_test_X_trial_element</div><div class="ttdef"><b>Definition:</b> <a href="_r_a_n_s2_p_8h_source.html#l00561">RANS2P.h:561</a></div></div>
<div class="ttc" id="ajf_8h_html_a903054ae14c61b1d440291818185c51c"><div class="ttname"><a href="jf_8h.html#a903054ae14c61b1d440291818185c51c">w</a></div><div class="ttdeci">#define w(x)</div><div class="ttdef"><b>Definition:</b> <a href="jf_8h_source.html#l00022">jf.h:22</a></div></div>
<div class="ttc" id="aclassproteus_1_1_r_a_n_s2_p_html_addf5cd3a254683dcee98d02fc43cd5f7"><div class="ttname"><a href="classproteus_1_1_r_a_n_s2_p.html#addf5cd3a254683dcee98d02fc43cd5f7">proteus::RANS2P::calculateSubgridError_tau</a></div><div class="ttdeci">void calculateSubgridError_tau(const double &amp;hFactor, const double &amp;elementDiameter, const double &amp;dmt, const double &amp;dm, const double df[nSpace], const double &amp;a, const double &amp;pfac, double &amp;tau_v, double &amp;tau_p, double &amp;cfl)</div><div class="ttdef"><b>Definition:</b> <a href="_r_a_n_s2_p_8h_source.html#l01654">RANS2P.h:1654</a></div></div>
<div class="ttc" id="aclassproteus_1_1_r_a_n_s2_p_html_a6352965aa4dc8cd7ae8cd6cb1c028c96"><div class="ttname"><a href="classproteus_1_1_r_a_n_s2_p.html#a6352965aa4dc8cd7ae8cd6cb1c028c96">proteus::RANS2P::nDOF_v_test_X_v_trial_element</a></div><div class="ttdeci">const int nDOF_v_test_X_v_trial_element</div><div class="ttdef"><b>Definition:</b> <a href="_r_a_n_s2_p_8h_source.html#l00564">RANS2P.h:564</a></div></div>
<div class="ttc" id="a_r_a_n_s2_p_8h_html_a5c858c7944d8ca1cbd20d6eeb52a1ae3"><div class="ttname"><a href="_r_a_n_s2_p_8h.html#a5c858c7944d8ca1cbd20d6eeb52a1ae3">DM3</a></div><div class="ttdeci">const double DM3</div><div class="ttdef"><b>Definition:</b> <a href="_r_a_n_s2_p_8h_source.html#l00012">RANS2P.h:12</a></div></div>
<div class="ttc" id="aclassproteus_1_1_r_a_n_s2_p_html_a100fe54d0ba85bbf85e094bdaeb54576"><div class="ttname"><a href="classproteus_1_1_r_a_n_s2_p.html#a100fe54d0ba85bbf85e094bdaeb54576">proteus::RANS2P::getTwoPhaseAdvectionOperator</a></div><div class="ttdeci">void getTwoPhaseAdvectionOperator(double *mesh_trial_ref, double *mesh_grad_trial_ref, double *mesh_dof, int *mesh_l2g, double *dV_ref, double *p_trial_ref, double *p_grad_trial_ref, double *vel_trial_ref, double *vel_grad_trial_ref, double *elementDiameter, double *nodeDiametersArray, int nElements_global, double useMetrics, double epsFact_rho, double epsFact_mu, double rho_0, double nu_0, double rho_1, double nu_1, int *vel_l2g, double *u_dof, double *v_dof, double *w_dof, const double useVF, double *vf, double *phi, int *csrRowIndeces_p_p, int *csrColumnOffsets_p_p, int *csrRowIndeces_u_u, int *csrColumnOffsets_u_u, int *csrRowIndeces_v_v, int *csrColumnOffsets_v_v, int *csrRowIndeces_w_w, int *csrColumnOffsets_w_w, double *advection_matrix)</div><div class="ttdef"><b>Definition:</b> <a href="_r_a_n_s2_p_8h_source.html#l06973">RANS2P.h:6973</a></div></div>
<div class="ttc" id="aclassproteus_1_1_r_a_n_s2_p_html_a90291d937f750ccb2105046f007a355b"><div class="ttname"><a href="classproteus_1_1_r_a_n_s2_p.html#a90291d937f750ccb2105046f007a355b">proteus::RANS2P::get_normal_to_ith_ball</a></div><div class="ttdeci">void get_normal_to_ith_ball(int n_balls, const double *ball_center, const double *ball_radius, int I, const double x, const double y, const double z, double &amp;nx, double &amp;ny, double &amp;nz)</div><div class="ttdef"><b>Definition:</b> <a href="_r_a_n_s2_p_8h_source.html#l01090">RANS2P.h:1090</a></div></div>
<div class="ttc" id="aclassproteus_1_1_r_a_n_s2_p_html_a8900d9a341b8fdab38b03c7d5571ca7a"><div class="ttname"><a href="classproteus_1_1_r_a_n_s2_p.html#a8900d9a341b8fdab38b03c7d5571ca7a">proteus::RANS2P::evaluateTPInvViscosityMassCoefficients</a></div><div class="ttdeci">void evaluateTPInvViscosityMassCoefficients(const int use_numerical_viscosity, const double numerical_viscosity, const double eps_rho, const double eps_mu, const double rho_0, double nu_0, const double rho_1, double nu_1, const double useVF, const double &amp;vf, const double &amp;phi, const double &amp;p, const double &amp;u, const double &amp;v, const double &amp;w, double &amp;mom_p_acc, double &amp;dmom_p_acc_p, double &amp;mom_u_acc, double &amp;dmom_u_acc_u, double &amp;mom_v_acc, double &amp;dmom_v_acc_v, double &amp;mom_w_acc, double &amp;dmom_w_acc_w)</div><div class="ttdef"><b>Definition:</b> <a href="_r_a_n_s2_p_8h_source.html#l06848">RANS2P.h:6848</a></div></div>
<div class="ttc" id="aclassproteus_1_1_r_a_n_s2_p__base_html_ac98b9770a5a62b4c353b5487b6094593"><div class="ttname"><a href="classproteus_1_1_r_a_n_s2_p__base.html#ac98b9770a5a62b4c353b5487b6094593">proteus::RANS2P_base::~RANS2P_base</a></div><div class="ttdeci">virtual ~RANS2P_base()</div><div class="ttdef"><b>Definition:</b> <a href="_r_a_n_s2_p_8h_source.html#l00022">RANS2P.h:22</a></div></div>
<div class="ttc" id="aclassproteus_1_1_r_a_n_s2_p_html_a4d4318b9ef2e89282a12e519eb6ced49"><div class="ttname"><a href="classproteus_1_1_r_a_n_s2_p.html#a4d4318b9ef2e89282a12e519eb6ced49">proteus::RANS2P::calculateSubgridErrorDerivatives_tauRes</a></div><div class="ttdeci">void calculateSubgridErrorDerivatives_tauRes(const double &amp;tau_p, const double &amp;tau_v, const double dpdeResidualP_du[nDOF_v_trial_element], const double dpdeResidualP_dv[nDOF_v_trial_element], const double dpdeResidualP_dw[nDOF_v_trial_element], const double dpdeResidualU_dp[nDOF_trial_element], const double dpdeResidualU_du[nDOF_v_trial_element], const double dpdeResidualV_dp[nDOF_trial_element], const double dpdeResidualV_dv[nDOF_v_trial_element], const double dpdeResidualW_dp[nDOF_trial_element], const double dpdeResidualW_dw[nDOF_v_trial_element], double dsubgridErrorP_du[nDOF_v_trial_element], double dsubgridErrorP_dv[nDOF_v_trial_element], double dsubgridErrorP_dw[nDOF_v_trial_element], double dsubgridErrorU_dp[nDOF_trial_element], double dsubgridErrorU_du[nDOF_v_trial_element], double dsubgridErrorV_dp[nDOF_trial_element], double dsubgridErrorV_dv[nDOF_v_trial_element], double dsubgridErrorW_dp[nDOF_trial_element], double dsubgridErrorW_dw[nDOF_v_trial_element])</div><div class="ttdef"><b>Definition:</b> <a href="_r_a_n_s2_p_8h_source.html#l01723">RANS2P.h:1723</a></div></div>
<div class="ttc" id="aclassproteus_1_1_r_a_n_s2_p_html_ad2e43c8a8d5e8cbaf4434992e9bf9a7d"><div class="ttname"><a href="classproteus_1_1_r_a_n_s2_p.html#ad2e43c8a8d5e8cbaf4434992e9bf9a7d">proteus::RANS2P::updateDarcyForchheimerTerms_Ergun</a></div><div class="ttdeci">void updateDarcyForchheimerTerms_Ergun(const double NONCONSERVATIVE_FORM, const double alpha, const double beta, const double eps_rho, const double eps_mu, const double rho_0, const double nu_0, const double rho_1, const double nu_1, const double useVF, const double vf, const double phi, const double u, const double v, const double w, const double uStar, const double vStar, const double wStar, const double eps_s, const double phi_s, const double u_s, const double v_s, const double w_s, double &amp;mom_u_source, double &amp;mom_v_source, double &amp;mom_w_source, double dmom_u_source[nSpace], double dmom_v_source[nSpace], double dmom_w_source[nSpace])</div><div class="ttdef"><b>Definition:</b> <a href="_r_a_n_s2_p_8h_source.html#l01446">RANS2P.h:1446</a></div></div>
<div class="ttc" id="aclassproteus_1_1_r_a_n_s2_p_html_adff72a3cebc8b98398097095827e7aa6"><div class="ttname"><a href="classproteus_1_1_r_a_n_s2_p.html#adff72a3cebc8b98398097095827e7aa6">proteus::RANS2P::evaluateCoefficients</a></div><div class="ttdeci">void evaluateCoefficients(const double NONCONSERVATIVE_FORM, const double eps_rho, const double eps_mu, const double sigma, const double rho_0, double nu_0, const double rho_1, double nu_1, const double h_e, const double smagorinskyConstant, const int turbulenceClosureModel, const double g[nSpace], const double useVF, const double &amp;vf, const double &amp;phi, const double n[nSpace], const double &amp;kappa, const double porosity, const double phi_solid, const double p_old, const double u_old, const double v_old, const double w_old, const double grad_p_old[nSpace], const double grad_u_old[nSpace], const double grad_v_old[nSpace], const double grad_w_old[nSpace], const int use_pseudo_penalty, const double &amp;p, const double grad_p[nSpace], const double grad_u[nSpace], const double grad_v[nSpace], const double grad_w[nSpace], const double &amp;u, const double &amp;v, const double &amp;w, const double LAG_LES, double &amp;eddy_viscosity, double &amp;eddy_viscosity_last, double &amp;mom_u_acc, double &amp;dmom_u_acc_u, double &amp;mom_v_acc, double &amp;dmom_v_acc_v, double &amp;mom_w_acc, double &amp;dmom_w_acc_w, double mass_adv[nSpace], double dmass_adv_u[nSpace], double dmass_adv_v[nSpace], double dmass_adv_w[nSpace], double mom_u_adv[nSpace], double dmom_u_adv_u[nSpace], double dmom_u_adv_v[nSpace], double dmom_u_adv_w[nSpace], double mom_v_adv[nSpace], double dmom_v_adv_u[nSpace], double dmom_v_adv_v[nSpace], double dmom_v_adv_w[nSpace], double mom_w_adv[nSpace], double dmom_w_adv_u[nSpace], double dmom_w_adv_v[nSpace], double dmom_w_adv_w[nSpace], double mom_uu_diff_ten[nSpace], double mom_vv_diff_ten[nSpace], double mom_ww_diff_ten[nSpace], double mom_uv_diff_ten[1], double mom_uw_diff_ten[1], double mom_vu_diff_ten[1], double mom_vw_diff_ten[1], double mom_wu_diff_ten[1], double mom_wv_diff_ten[1], double &amp;mom_u_source, double &amp;mom_v_source, double &amp;mom_w_source, double &amp;mom_u_ham, double dmom_u_ham_grad_p[nSpace], double dmom_u_ham_grad_u[nSpace], double &amp;dmom_u_ham_u, double &amp;dmom_u_ham_v, double &amp;dmom_u_ham_w, double &amp;mom_v_ham, double dmom_v_ham_grad_p[nSpace], double dmom_v_ham_grad_v[nSpace], double &amp;dmom_v_ham_u, double &amp;dmom_v_ham_v, double &amp;dmom_v_ham_w, double &amp;mom_w_ham, double dmom_w_ham_grad_p[nSpace], double dmom_w_ham_grad_w[nSpace], double &amp;dmom_w_ham_u, double &amp;dmom_w_ham_v, double &amp;dmom_w_ham_w, double &amp;rho, double forcex, double forcey, double forcez)</div><div class="ttdef"><b>Definition:</b> <a href="_r_a_n_s2_p_8h_source.html#l00591">RANS2P.h:591</a></div></div>
<div class="ttc" id="aclassproteus_1_1_r_a_n_s2_p__base_html"><div class="ttname"><a href="classproteus_1_1_r_a_n_s2_p__base.html">proteus::RANS2P_base</a></div><div class="ttdef"><b>Definition:</b> <a href="_r_a_n_s2_p_8h_source.html#l00019">RANS2P.h:19</a></div></div>
<div class="ttc" id="aclassproteus_1_1_r_a_n_s2_p_html_ae66ab530966d1d5fbc2e170ef698a4f3"><div class="ttname"><a href="classproteus_1_1_r_a_n_s2_p.html#ae66ab530966d1d5fbc2e170ef698a4f3">proteus::RANS2P::updateSolidParticleTerms</a></div><div class="ttdeci">void updateSolidParticleTerms(const double NONCONSERVATIVE_FORM, bool element_owned, const double particle_nitsche, const double dV, const int nParticles, const int sd_offset, double *particle_signed_distances, double *particle_signed_distance_normals, double *particle_velocities, double *particle_centroids, const int use_ball_as_particle, const double *ball_center, const double *ball_radius, const double *ball_velocity, const double *ball_angular_velocity, const double *ball_center_acceleration, const double *ball_angular_acceleration, const double *ball_density, const double porosity, const double penalty, const double alpha, const double beta, const double eps_rho, const double eps_mu, const double rho_0, const double nu_0, const double rho_1, const double nu_1, const double useVF, const double vf, const double phi, const double x, const double y, const double z, const double p, const double u, const double v, const double w, const double uStar, const double vStar, const double wStar, const double eps_s, const double grad_u[nSpace], const double grad_v[nSpace], const double grad_w[nSpace], double &amp;mom_u_source, double &amp;mom_v_source, double &amp;mom_w_source, double dmom_u_source[nSpace], double dmom_v_source[nSpace], double dmom_w_source[nSpace], double mom_u_adv[nSpace], double mom_v_adv[nSpace], double mom_w_adv[nSpace], double dmom_u_adv_u[nSpace], double dmom_v_adv_v[nSpace], double dmom_w_adv_w[nSpace], double &amp;mom_u_ham, double dmom_u_ham_grad_u[nSpace], double &amp;dmom_u_ham_u, double &amp;dmom_u_ham_v, double &amp;dmom_u_ham_w, double &amp;mom_v_ham, double dmom_v_ham_grad_v[nSpace], double &amp;dmom_v_ham_u, double &amp;dmom_v_ham_v, double &amp;dmom_v_ham_w, double &amp;mom_w_ham, double dmom_w_ham_grad_w[nSpace], double &amp;dmom_w_ham_u, double &amp;dmom_w_ham_v, double &amp;dmom_w_ham_w, double &amp;mass_ham, double &amp;dmass_ham_u, double &amp;dmass_ham_v, double &amp;dmass_ham_w, double *particle_netForces, double *particle_netMoments, double *particle_surfaceArea, const int use_pseudo_penalty)</div><div class="ttdef"><b>Definition:</b> <a href="_r_a_n_s2_p_8h_source.html#l01149">RANS2P.h:1149</a></div></div>
<div class="ttc" id="anamespaceproteus_html_a3fd0de2d97b1eb82abfd5c46ba547f32"><div class="ttname"><a href="namespaceproteus.html#a3fd0de2d97b1eb82abfd5c46ba547f32">proteus::newRANS2P</a></div><div class="ttdeci">RANS2P_base * newRANS2P(int nSpaceIn, int nQuadraturePoints_elementIn, int nDOF_mesh_trial_elementIn, int nDOF_trial_elementIn, int nDOF_test_elementIn, int nDOF_v_trial_elementIn, int nDOF_v_test_elementIn, int nQuadraturePoints_elementBoundaryIn, int CompKernelFlag)</div><div class="ttdef"><b>Definition:</b> <a href="_r_a_n_s2_p_8h_source.html#l07520">RANS2P.h:7520</a></div></div>
<div class="ttc" id="a_headers_8h_html_a08a4b8173deed2dbe6993d906ff006cb"><div class="ttname"><a href="_headers_8h.html#a08a4b8173deed2dbe6993d906ff006cb">n</a></div><div class="ttdeci">Int n</div><div class="ttdef"><b>Definition:</b> <a href="_headers_8h_source.html#l00028">Headers.h:28</a></div></div>
<div class="ttc" id="agroup__analytical_solutions_html_ga31fe0a5e02da8c2ed2761f3aabf86e0d"><div class="ttname"><a href="group__analytical_solutions.html#ga31fe0a5e02da8c2ed2761f3aabf86e0d">df</a></div><div class="ttdeci">double df(double C, double b, double a, int q, int r)</div><div class="ttdef"><b>Definition:</b> <a href="analytical_solutions_8c_source.html#l02209">analyticalSolutions.c:2209</a></div></div>
<div class="ttc" id="aclassproteus_1_1_r_a_n_s2_p_html_a5aa363a0b10908c6c2ed472e343cf65b"><div class="ttname"><a href="classproteus_1_1_r_a_n_s2_p.html#a5aa363a0b10908c6c2ed472e343cf65b">proteus::RANS2P::get_distance_to_ith_ball</a></div><div class="ttdeci">void get_distance_to_ith_ball(int n_balls, const double *ball_center, const double *ball_radius, int I, const double x, const double y, const double z, double &amp;distance)</div><div class="ttdef"><b>Definition:</b> <a href="_r_a_n_s2_p_8h_source.html#l01078">RANS2P.h:1078</a></div></div>
<div class="ttc" id="a_comp_kernel_8h_html"><div class="ttname"><a href="_comp_kernel_8h.html">CompKernel.h</a></div></div>
<div class="ttc" id="aclassproteus_1_1_r_a_n_s2_p_html_abfb5b49cf342e2e5f857fb9250661615"><div class="ttname"><a href="classproteus_1_1_r_a_n_s2_p.html#abfb5b49cf342e2e5f857fb9250661615">proteus::RANS2P::ck</a></div><div class="ttdeci">CompKernelType ck</div><div class="ttdef"><b>Definition:</b> <a href="_r_a_n_s2_p_8h_source.html#l00565">RANS2P.h:565</a></div></div>
<div class="ttc" id="aclassproteus_1_1_r_a_n_s2_p_html_aab46065ecbde76bd2d9ef320ad287b76"><div class="ttname"><a href="classproteus_1_1_r_a_n_s2_p.html#aab46065ecbde76bd2d9ef320ad287b76">proteus::RANS2P::updateTurbulenceClosure</a></div><div class="ttdeci">void updateTurbulenceClosure(const double NONCONSERVATIVE_FORM, const int turbulenceClosureModel, const double eps_rho, const double eps_mu, const double rho_0, const double nu_0, const double rho_1, const double nu_1, const double useVF, const double vf, const double phi, const double porosity, const double eddy_visc_coef_0, const double turb_var_0, const double turb_var_1, const double turb_grad_0[nSpace], double &amp;eddy_viscosity, double mom_uu_diff_ten[nSpace], double mom_vv_diff_ten[nSpace], double mom_ww_diff_ten[nSpace], double mom_uv_diff_ten[1], double mom_uw_diff_ten[1], double mom_vu_diff_ten[1], double mom_vw_diff_ten[1], double mom_wu_diff_ten[1], double mom_wv_diff_ten[1], double &amp;mom_u_source, double &amp;mom_v_source, double &amp;mom_w_source)</div><div class="ttdef"><b>Definition:</b> <a href="_r_a_n_s2_p_8h_source.html#l01528">RANS2P.h:1528</a></div></div>
<div class="ttc" id="agroup__analytical_solutions_html_gac0d5ac1b71bf68c8383846ab25b5b2fa"><div class="ttname"><a href="group__analytical_solutions.html#gac0d5ac1b71bf68c8383846ab25b5b2fa">vel</a></div><div class="ttdeci">void vel(double rS, double norm_v, double r, double theta, double *vR, double *vTHETA)</div><div class="ttdef"><b>Definition:</b> <a href="analytical_solutions_8c_source.html#l02163">analyticalSolutions.c:2163</a></div></div>
<div class="ttc" id="aclassproteus_1_1_r_a_n_s2_p_html_ab987f978eddb3b321b25be02d34f517d"><div class="ttname"><a href="classproteus_1_1_r_a_n_s2_p.html#ab987f978eddb3b321b25be02d34f517d">proteus::RANS2P::exteriorNumericalAdvectiveFlux</a></div><div class="ttdeci">void exteriorNumericalAdvectiveFlux(const double NONCONSERVATIVE_FORM, const int &amp;isDOFBoundary_p, const int &amp;isDOFBoundary_u, const int &amp;isDOFBoundary_v, const int &amp;isDOFBoundary_w, const int &amp;isFluxBoundary_p, const int &amp;isFluxBoundary_u, const int &amp;isFluxBoundary_v, const int &amp;isFluxBoundary_w, const double &amp;oneByRho, const double &amp;bc_oneByRho, const double n[nSpace], const double &amp;bc_p, const double &amp;bc_u, const double &amp;bc_v, const double &amp;bc_w, const double bc_f_mass[nSpace], const double bc_f_umom[nSpace], const double bc_f_vmom[nSpace], const double bc_f_wmom[nSpace], const double &amp;bc_flux_mass, const double &amp;bc_flux_umom, const double &amp;bc_flux_vmom, const double &amp;bc_flux_wmom, const double &amp;p, const double &amp;u, const double &amp;v, const double &amp;w, const double f_mass[nSpace], const double f_umom[nSpace], const double f_vmom[nSpace], const double f_wmom[nSpace], const double df_mass_du[nSpace], const double df_mass_dv[nSpace], const double df_mass_dw[nSpace], const double df_umom_dp[nSpace], const double dham_grad[nSpace], const double df_umom_du[nSpace], const double df_umom_dv[nSpace], const double df_umom_dw[nSpace], const double df_vmom_dp[nSpace], const double df_vmom_du[nSpace], const double df_vmom_dv[nSpace], const double df_vmom_dw[nSpace], const double df_wmom_dp[nSpace], const double df_wmom_du[nSpace], const double df_wmom_dv[nSpace], const double df_wmom_dw[nSpace], double &amp;flux_mass, double &amp;flux_umom, double &amp;flux_vmom, double &amp;flux_wmom, double *velocity)</div><div class="ttdef"><b>Definition:</b> <a href="_r_a_n_s2_p_8h_source.html#l01771">RANS2P.h:1771</a></div></div>
<div class="ttc" id="a_headers_8h_html_ae920d60831fd60b11f1b758a12e87eff"><div class="ttname"><a href="_headers_8h.html#ae920d60831fd60b11f1b758a12e87eff">vx</a></div><div class="ttdeci">Double vx</div><div class="ttdef"><b>Definition:</b> <a href="_headers_8h_source.html#l00097">Headers.h:97</a></div></div>
<div class="ttc" id="aclassproteus_1_1_r_a_n_s2_p_html_ad2290233cf9a2819b93f040e5639beaf"><div class="ttname"><a href="classproteus_1_1_r_a_n_s2_p.html#ad2290233cf9a2819b93f040e5639beaf">proteus::RANS2P::calculateJacobian</a></div><div class="ttdeci">void calculateJacobian(double NONCONSERVATIVE_FORM, double MOMENTUM_SGE, double PRESSURE_SGE, double VELOCITY_SGE, double PRESSURE_PROJECTION_STABILIZATION, double *mesh_trial_ref, double *mesh_grad_trial_ref, double *mesh_dof, double *mesh_velocity_dof, double MOVING_DOMAIN, int *mesh_l2g, double *x_ref, double *dV_ref, double *p_trial_ref, double *p_grad_trial_ref, double *p_test_ref, double *p_grad_test_ref, double *vel_trial_ref, double *vel_grad_trial_ref, double *vel_test_ref, double *vel_grad_test_ref, double *mesh_trial_trace_ref, double *mesh_grad_trial_trace_ref, double *dS_ref, double *p_trial_trace_ref, double *p_grad_trial_trace_ref, double *p_test_trace_ref, double *p_grad_test_trace_ref, double *vel_trial_trace_ref, double *vel_grad_trial_trace_ref, double *vel_test_trace_ref, double *vel_grad_test_trace_ref, double *normal_ref, double *boundaryJac_ref, double eb_adjoint_sigma, double *elementDiameter, double *nodeDiametersArray, double hFactor, int nElements_global, double useRBLES, double useMetrics, double alphaBDF, double epsFact_rho, double epsFact_mu, double sigma, double rho_0, double nu_0, double rho_1, double nu_1, double smagorinskyConstant, int turbulenceClosureModel, double Ct_sge, double Cd_sge, double C_dg, double C_b, const double *eps_solid, const double *phi_solid, const double *q_velocity_solid, const double *q_porosity, const double *q_dragAlpha, const double *q_dragBeta, const double *q_mass_source, const double *q_turb_var_0, const double *q_turb_var_1, const double *q_turb_var_grad_0, const double LAG_LES, double *q_eddy_viscosity_last, double *ebqe_eddy_viscosity_last, int *p_l2g, int *vel_l2g, double *p_dof, double *u_dof, double *v_dof, double *w_dof, double *p_old_dof, double *u_old_dof, double *v_old_dof, double *w_old_dof, double *g, const double useVF, double *vf, double *phi, double *phi_nodes, double *normal_phi, double *kappa_phi, double *q_mom_u_acc_beta_bdf, double *q_mom_v_acc_beta_bdf, double *q_mom_w_acc_beta_bdf, double *q_dV, double *q_dV_last, double *q_velocity_sge, double *q_cfl, double *q_numDiff_u_last, double *q_numDiff_v_last, double *q_numDiff_w_last, int *sdInfo_u_u_rowptr, int *sdInfo_u_u_colind, int *sdInfo_u_v_rowptr, int *sdInfo_u_v_colind, int *sdInfo_u_w_rowptr, int *sdInfo_u_w_colind, int *sdInfo_v_v_rowptr, int *sdInfo_v_v_colind, int *sdInfo_v_u_rowptr, int *sdInfo_v_u_colind, int *sdInfo_v_w_rowptr, int *sdInfo_v_w_colind, int *sdInfo_w_w_rowptr, int *sdInfo_w_w_colind, int *sdInfo_w_u_rowptr, int *sdInfo_w_u_colind, int *sdInfo_w_v_rowptr, int *sdInfo_w_v_colind, int *csrRowIndeces_p_p, int *csrColumnOffsets_p_p, int *csrRowIndeces_p_u, int *csrColumnOffsets_p_u, int *csrRowIndeces_p_v, int *csrColumnOffsets_p_v, int *csrRowIndeces_p_w, int *csrColumnOffsets_p_w, int *csrRowIndeces_u_p, int *csrColumnOffsets_u_p, int *csrRowIndeces_u_u, int *csrColumnOffsets_u_u, int *csrRowIndeces_u_v, int *csrColumnOffsets_u_v, int *csrRowIndeces_u_w, int *csrColumnOffsets_u_w, int *csrRowIndeces_v_p, int *csrColumnOffsets_v_p, int *csrRowIndeces_v_u, int *csrColumnOffsets_v_u, int *csrRowIndeces_v_v, int *csrColumnOffsets_v_v, int *csrRowIndeces_v_w, int *csrColumnOffsets_v_w, int *csrRowIndeces_w_p, int *csrColumnOffsets_w_p, int *csrRowIndeces_w_u, int *csrColumnOffsets_w_u, int *csrRowIndeces_w_v, int *csrColumnOffsets_w_v, int *csrRowIndeces_w_w, int *csrColumnOffsets_w_w, double *globalJacobian, int nExteriorElementBoundaries_global, int *exteriorElementBoundariesArray, int *elementBoundaryElementsArray, int *elementBoundaryLocalElementBoundariesArray, double *ebqe_vf_ext, double *bc_ebqe_vf_ext, double *ebqe_phi_ext, double *bc_ebqe_phi_ext, double *ebqe_normal_phi_ext, double *ebqe_kappa_phi_ext, const double *ebqe_porosity_ext, const double *ebqe_turb_var_0, const double *ebqe_turb_var_1, int *isDOFBoundary_p, int *isDOFBoundary_u, int *isDOFBoundary_v, int *isDOFBoundary_w, int *isAdvectiveFluxBoundary_p, int *isAdvectiveFluxBoundary_u, int *isAdvectiveFluxBoundary_v, int *isAdvectiveFluxBoundary_w, int *isDiffusiveFluxBoundary_u, int *isDiffusiveFluxBoundary_v, int *isDiffusiveFluxBoundary_w, double *ebqe_bc_p_ext, double *ebqe_bc_flux_mass_ext, double *ebqe_bc_flux_mom_u_adv_ext, double *ebqe_bc_flux_mom_v_adv_ext, double *ebqe_bc_flux_mom_w_adv_ext, double *ebqe_bc_u_ext, double *ebqe_bc_flux_u_diff_ext, double *ebqe_penalty_ext, double *ebqe_bc_v_ext, double *ebqe_bc_flux_v_diff_ext, double *ebqe_bc_w_ext, double *ebqe_bc_flux_w_diff_ext, int *csrColumnOffsets_eb_p_p, int *csrColumnOffsets_eb_p_u, int *csrColumnOffsets_eb_p_v, int *csrColumnOffsets_eb_p_w, int *csrColumnOffsets_eb_u_p, int *csrColumnOffsets_eb_u_u, int *csrColumnOffsets_eb_u_v, int *csrColumnOffsets_eb_u_w, int *csrColumnOffsets_eb_v_p, int *csrColumnOffsets_eb_v_u, int *csrColumnOffsets_eb_v_v, int *csrColumnOffsets_eb_v_w, int *csrColumnOffsets_eb_w_p, int *csrColumnOffsets_eb_w_u, int *csrColumnOffsets_eb_w_v, int *csrColumnOffsets_eb_w_w, int *elementFlags, int *boundaryFlags, int use_ball_as_particle, double *ball_center, double *ball_radius, double *ball_velocity, double *ball_angular_velocity, double *ball_center_acceleration, double *ball_angular_acceleration, double *ball_density, double *particle_signed_distances, double *particle_signed_distance_normals, double *particle_velocities, double *particle_centroids, double *ebq_global_phi_s, double *ebq_global_grad_phi_s, double *ebq_particle_velocity_s, double *phi_solid_nodes, double *distance_to_solids, int nParticles, int nElements_owned, double particle_nitsche, double particle_epsFact, double particle_alpha, double particle_beta, double particle_penalty_constant, const int use_pseudo_penalty, bool useExact)</div><div class="ttdef"><b>Definition:</b> <a href="_r_a_n_s2_p_8h_source.html#l04481">RANS2P.h:4481</a></div></div>
<div class="ttc" id="aclassproteus_1_1_r_a_n_s2_p_html_a4184fdc06b9e962875575b22ea95ff77"><div class="ttname"><a href="classproteus_1_1_r_a_n_s2_p.html#a4184fdc06b9e962875575b22ea95ff77">proteus::RANS2P::getTwoPhaseScaledMassOperator</a></div><div class="ttdeci">void getTwoPhaseScaledMassOperator(int scale_type, int use_numerical_viscosity, int lumped, double *mesh_trial_ref, double *mesh_grad_trial_ref, double *mesh_dof, int *mesh_l2g, double *dV_ref, double *p_trial_ref, double *p_test_ref, double *vel_trial_ref, double *vel_test_ref, double *elementDiameter, double *nodeDiametersArray, double *numerical_viscosity, int nElements_global, double useMetrics, double epsFact_rho, double epsFact_mu, double rho_0, double nu_0, double rho_1, double nu_1, int *p_l2g, int *vel_l2g, double *p_dof, double *u_dof, double *v_dof, double *w_dof, const double useVF, double *vf, double *phi, int *csrRowIndeces_p_p, int *csrColumnOffsets_p_p, int *csrRowIndeces_u_u, int *csrColumnOffsets_u_u, int *csrRowIndeces_v_v, int *csrColumnOffsets_v_v, int *csrRowIndeces_w_w, int *csrColumnOffsets_w_w, double *mass_matrix)</div><div class="ttdef"><b>Definition:</b> <a href="_r_a_n_s2_p_8h_source.html#l07311">RANS2P.h:7311</a></div></div>
<div class="ttc" id="a_r_a_n_s2_p_8h_html_af4c90b58f2b5c70d46004521b792f727"><div class="ttname"><a href="_r_a_n_s2_p_8h.html#af4c90b58f2b5c70d46004521b792f727">DM2</a></div><div class="ttdeci">const double DM2</div><div class="ttdef"><b>Definition:</b> <a href="_r_a_n_s2_p_8h_source.html#l00011">RANS2P.h:11</a></div></div>
<div class="ttc" id="a_error_residual_method_8cpp_html_a383b07af68441ce2b4adaaf8d8cc9d90"><div class="ttname"><a href="_error_residual_method_8cpp.html#a383b07af68441ce2b4adaaf8d8cc9d90">nu_0</a></div><div class="ttdeci">double nu_0</div><div class="ttdef"><b>Definition:</b> <a href="_error_residual_method_8cpp_source.html#l00022">ErrorResidualMethod.cpp:22</a></div></div>
<div class="ttc" id="a_headers_8h_html_abb6e996fea4e5f276fdcec0c7d809274"><div class="ttname"><a href="_headers_8h.html#abb6e996fea4e5f276fdcec0c7d809274">v</a></div><div class="ttdeci">Double v</div><div class="ttdef"><b>Definition:</b> <a href="_headers_8h_source.html#l00095">Headers.h:95</a></div></div>
<div class="ttc" id="aclassproteus_1_1_r_a_n_s2_p__base_html_af9e615ad723539c7c8dade1a9480506f"><div class="ttname"><a href="classproteus_1_1_r_a_n_s2_p__base.html#af9e615ad723539c7c8dade1a9480506f">proteus::RANS2P_base::calculateResidual</a></div><div class="ttdeci">virtual void calculateResidual(double NONCONSERVATIVE_FORM, double MOMENTUM_SGE, double PRESSURE_SGE, double VELOCITY_SGE, double PRESSURE_PROJECTION_STABLIZATION, double *numerical_viscosity, double *mesh_trial_ref, double *mesh_grad_trial_ref, double *mesh_dof, double *mesh_velocity_dof, double MOVING_DOMAIN, int *mesh_l2g, double *x_ref, double *dV_ref, double *p_trial_ref, double *p_grad_trial_ref, double *p_test_ref, double *p_grad_test_ref, double *vel_trial_ref, double *vel_grad_trial_ref, double *vel_test_ref, double *vel_grad_test_ref, double *mesh_trial_trace_ref, double *mesh_grad_trial_trace_ref, double *dS_ref, double *p_trial_trace_ref, double *p_grad_trial_trace_ref, double *p_test_trace_ref, double *p_grad_test_trace_ref, double *vel_trial_trace_ref, double *vel_grad_trial_trace_ref, double *vel_test_trace_ref, double *vel_grad_test_trace_ref, double *normal_ref, double *boundaryJac_ref, double eb_adjoint_sigma, double *elementDiameter, double *nodeDiametersArray, double hFactor, int nElements_global, int nElementBoundaries_owned, double useRBLES, double useMetrics, double alphaBDF, double epsFact_rho, double epsFact_mu, double sigma, double rho_0, double nu_0, double rho_1, double nu_1, double smagorinskyConstant, int turbulenceClosureModel, double Ct_sge, double Cd_sge, double C_dc, double C_b, const double *eps_solid, double *phi_solid, const double *q_velocity_solid, const double *q_porosity, const double *q_dragAlpha, const double *q_dragBeta, const double *q_mass_source, const double *q_turb_var_0, const double *q_turb_var_1, const double *q_turb_var_grad_0, const double LAG_LES, double *q_eddy_viscosity, double *q_eddy_viscosity_last, double *ebqe_eddy_viscosity, double *ebqe_eddy_viscosity_last, int *p_l2g, int *vel_l2g, int *rp_l2g, int *rvel_l2g, double *p_dof, double *u_dof, double *v_dof, double *w_dof, double *p_old_dof, double *u_old_dof, double *v_old_dof, double *w_old_dof, double *g, const double useVF, double *q_rho, double *vf, double *phi, double *phi_nodes, double *normal_phi, double *kappa_phi, double *q_mom_u_acc, double *q_mom_v_acc, double *q_mom_w_acc, double *q_mass_adv, double *q_mom_u_acc_beta_bdf, double *q_mom_v_acc_beta_bdf, double *q_mom_w_acc_beta_bdf, double *q_dV, double *q_dV_last, double *q_velocity_sge, double *q_cfl, double *q_numDiff_u, double *q_numDiff_v, double *q_numDiff_w, double *q_numDiff_u_last, double *q_numDiff_v_last, double *q_numDiff_w_last, int *sdInfo_u_u_rowptr, int *sdInfo_u_u_colind, int *sdInfo_u_v_rowptr, int *sdInfo_u_v_colind, int *sdInfo_u_w_rowptr, int *sdInfo_u_w_colind, int *sdInfo_v_v_rowptr, int *sdInfo_v_v_colind, int *sdInfo_v_u_rowptr, int *sdInfo_v_u_colind, int *sdInfo_v_w_rowptr, int *sdInfo_v_w_colind, int *sdInfo_w_w_rowptr, int *sdInfo_w_w_colind, int *sdInfo_w_u_rowptr, int *sdInfo_w_u_colind, int *sdInfo_w_v_rowptr, int *sdInfo_w_v_colind, int offset_p, int offset_u, int offset_v, int offset_w, int stride_p, int stride_u, int stride_v, int stride_w, double *globalResidual, int nExteriorElementBoundaries_global, int *exteriorElementBoundariesArray, int *elementBoundaryElementsArray, int *elementBoundaryLocalElementBoundariesArray, double *ebqe_vf_ext, double *bc_ebqe_vf_ext, double *ebqe_phi_ext, double *bc_ebqe_phi_ext, double *ebqe_normal_phi_ext, double *ebqe_kappa_phi_ext, const double *ebqe_porosity_ext, const double *ebqe_turb_var_0, const double *ebqe_turb_var_1, int *isDOFBoundary_p, int *isDOFBoundary_u, int *isDOFBoundary_v, int *isDOFBoundary_w, int *isAdvectiveFluxBoundary_p, int *isAdvectiveFluxBoundary_u, int *isAdvectiveFluxBoundary_v, int *isAdvectiveFluxBoundary_w, int *isDiffusiveFluxBoundary_u, int *isDiffusiveFluxBoundary_v, int *isDiffusiveFluxBoundary_w, double *ebqe_bc_p_ext, double *ebqe_bc_flux_mass_ext, double *ebqe_bc_flux_mom_u_adv_ext, double *ebqe_bc_flux_mom_v_adv_ext, double *ebqe_bc_flux_mom_w_adv_ext, double *ebqe_bc_u_ext, double *ebqe_bc_flux_u_diff_ext, double *ebqe_penalty_ext, double *ebqe_bc_v_ext, double *ebqe_bc_flux_v_diff_ext, double *ebqe_bc_w_ext, double *ebqe_bc_flux_w_diff_ext, double *q_x, double *q_velocity, double *ebqe_velocity, double *flux, double *elementResidual_p, int *elementFlags, int *boundaryFlags, double *barycenters, double *wettedAreas, double *netForces_p, double *netForces_v, double *netMoments, double *velocityError, double *velocityErrorNodal, double *forcex, double *forcey, double *forcez, int use_ball_as_particle, double *ball_center, double *ball_radius, double *ball_velocity, double *ball_angular_velocity, double *ball_center_acceleration, double *ball_angular_acceleration, double *ball_density, double *particle_signed_distances, double *particle_signed_distance_normals, double *particle_velocities, double *particle_centroids, double *ebq_global_phi_s, double *ebq_global_grad_phi_s, double *ebq_particle_velocity_s, int nParticles, double *particle_netForces, double *particle_netMoments, double *particle_surfaceArea, int nElements_owned, double particle_nitsche, double particle_epsFact, double particle_alpha, double particle_beta, double particle_penalty_constant, double *phi_solid_nodes, double *distance_to_solids, const int use_pseudo_penalty, bool useExact)=0</div></div>
<div class="ttc" id="aclassproteus_1_1_r_a_n_s2_p__base_html_ac76453a3d1a99cd4ba3702092696bc2d"><div class="ttname"><a href="classproteus_1_1_r_a_n_s2_p__base.html#ac76453a3d1a99cd4ba3702092696bc2d">proteus::RANS2P_base::getTwoPhaseScaledMassOperator</a></div><div class="ttdeci">virtual void getTwoPhaseScaledMassOperator(int scale_type, int use_numerical_viscosity, int lumped, double *mesh_trial_ref, double *mesh_grad_trial_ref, double *mesh_dof, int *mesh_l2g, double *dV_ref, double *p_trial_ref, double *p_test_ref, double *vel_trial_ref, double *vel_test_ref, double *elementDiameter, double *nodeDiametersArray, double *numerical_viscosity, int nElements_global, double useMetrics, double epsFact_rho, double epsFact_mu, double rho_0, double nu_0, double rho_1, double nu_1, int *p_l2g, int *vel_l2g, double *p_dof, double *u_dof, double *v_dof, double *w_dof, const double useVF, double *vf, double *phi, int *csrRowIndeces_p_p, int *csrColumnOffsets_p_p, int *csrRowIndeces_u_u, int *csrColumnOffsets_u_u, int *csrRowIndeces_v_v, int *csrColumnOffsets_v_v, int *csrRowIndeces_w_w, int *csrColumnOffsets_w_w, double *mass_matrix)=0</div></div>
<div class="ttc" id="aclassproteus_1_1_r_a_n_s2_p_html_aba606100197bd1648a169d46dcf84ad0"><div class="ttname"><a href="classproteus_1_1_r_a_n_s2_p.html#aba606100197bd1648a169d46dcf84ad0">proteus::RANS2P::exteriorNumericalDiffusiveFlux</a></div><div class="ttdeci">void exteriorNumericalDiffusiveFlux(const double &amp;eps, const double &amp;phi, int *rowptr, int *colind, const int &amp;isDOFBoundary, const int &amp;isFluxBoundary, const double n[nSpace], double *bc_a, const double &amp;bc_u, const double &amp;bc_flux, double *a, const double grad_potential[nSpace], const double &amp;u, const double &amp;penalty, double &amp;flux)</div><div class="ttdef"><b>Definition:</b> <a href="_r_a_n_s2_p_8h_source.html#l02316">RANS2P.h:2316</a></div></div>
<div class="ttc" id="a_error_residual_method_8cpp_html_ae5896ebfee35f22242123e4ae82c81d9"><div class="ttname"><a href="_error_residual_method_8cpp.html#ae5896ebfee35f22242123e4ae82c81d9">nu_1</a></div><div class="ttdeci">double nu_1</div><div class="ttdef"><b>Definition:</b> <a href="_error_residual_method_8cpp_source.html#l00022">ErrorResidualMethod.cpp:22</a></div></div>
<div class="ttc" id="aclassproteus_1_1_r_a_n_s2_p_html_a6f565d2a300310b20f932576bd743238"><div class="ttname"><a href="classproteus_1_1_r_a_n_s2_p.html#a6f565d2a300310b20f932576bd743238">proteus::RANS2P::nDOF_v_test_X_trial_element</a></div><div class="ttdeci">const int nDOF_v_test_X_trial_element</div><div class="ttdef"><b>Definition:</b> <a href="_r_a_n_s2_p_8h_source.html#l00563">RANS2P.h:563</a></div></div>
<div class="ttc" id="aequivalent__polynomials_8h_html"><div class="ttname"><a href="equivalent__polynomials_8h.html">equivalent_polynomials.h</a></div></div>
<div class="ttc" id="a_headers_8h_html_a9891a031d6c4d31d28333ae6e6f6b746"><div class="ttname"><a href="_headers_8h.html#a9891a031d6c4d31d28333ae6e6f6b746">vy</a></div><div class="ttdeci">Double vy</div><div class="ttdef"><b>Definition:</b> <a href="_headers_8h_source.html#l00098">Headers.h:98</a></div></div>
<div class="ttc" id="a_headers_8h_html_a9d199fcfc162b9ad09d4c9426e713a74"><div class="ttname"><a href="_headers_8h.html#a9d199fcfc162b9ad09d4c9426e713a74">z</a></div><div class="ttdeci">Double * z</div><div class="ttdef"><b>Definition:</b> <a href="_headers_8h_source.html#l00049">Headers.h:49</a></div></div>
<div class="ttc" id="aclassproteus_1_1_r_a_n_s2_p_html_a25f4dd4b428fe7b1487c82d93fa3a0c7"><div class="ttname"><a href="classproteus_1_1_r_a_n_s2_p.html#a25f4dd4b428fe7b1487c82d93fa3a0c7">proteus::RANS2P::exteriorNumericalAdvectiveFluxDerivatives</a></div><div class="ttdeci">void exteriorNumericalAdvectiveFluxDerivatives(const double NONCONSERVATIVE_FORM, const int &amp;isDOFBoundary_p, const int &amp;isDOFBoundary_u, const int &amp;isDOFBoundary_v, const int &amp;isDOFBoundary_w, const int &amp;isFluxBoundary_p, const int &amp;isFluxBoundary_u, const int &amp;isFluxBoundary_v, const int &amp;isFluxBoundary_w, const double &amp;oneByRho, const double n[nSpace], const double &amp;bc_p, const double &amp;bc_u, const double &amp;bc_v, const double &amp;bc_w, const double bc_f_mass[nSpace], const double bc_f_umom[nSpace], const double bc_f_vmom[nSpace], const double bc_f_wmom[nSpace], const double &amp;bc_flux_mass, const double &amp;bc_flux_umom, const double &amp;bc_flux_vmom, const double &amp;bc_flux_wmom, const double &amp;p, const double &amp;u, const double &amp;v, const double &amp;w, const double &amp;dmom_u_acc_u, const double f_mass[nSpace], const double f_umom[nSpace], const double f_vmom[nSpace], const double f_wmom[nSpace], const double df_mass_du[nSpace], const double df_mass_dv[nSpace], const double df_mass_dw[nSpace], const double df_umom_dp[nSpace], const double dham_grad[nSpace], const double df_umom_du[nSpace], const double df_umom_dv[nSpace], const double df_umom_dw[nSpace], const double df_vmom_dp[nSpace], const double df_vmom_du[nSpace], const double df_vmom_dv[nSpace], const double df_vmom_dw[nSpace], const double df_wmom_dp[nSpace], const double df_wmom_du[nSpace], const double df_wmom_dv[nSpace], const double df_wmom_dw[nSpace], double &amp;dflux_mass_du, double &amp;dflux_mass_dv, double &amp;dflux_mass_dw, double &amp;dflux_umom_dp, double &amp;dflux_umom_du, double &amp;dflux_umom_dv, double &amp;dflux_umom_dw, double &amp;dflux_vmom_dp, double &amp;dflux_vmom_du, double &amp;dflux_vmom_dv, double &amp;dflux_vmom_dw, double &amp;dflux_wmom_dp, double &amp;dflux_wmom_du, double &amp;dflux_wmom_dv, double &amp;dflux_wmom_dw)</div><div class="ttdef"><b>Definition:</b> <a href="_r_a_n_s2_p_8h_source.html#l02000">RANS2P.h:2000</a></div></div>
<div class="ttc" id="a_headers_8h_html_a81073496b3df485c6b59c5823819310b"><div class="ttname"><a href="_headers_8h.html#a81073496b3df485c6b59c5823819310b">u</a></div><div class="ttdeci">Double u</div><div class="ttdef"><b>Definition:</b> <a href="_headers_8h_source.html#l00089">Headers.h:89</a></div></div>
<div class="ttc" id="anamespaceproteus_html_a17bf106c5df3b1331ed2a18392384813"><div class="ttname"><a href="namespaceproteus.html#a17bf106c5df3b1331ed2a18392384813">proteus::phi</a></div><div class="ttdeci">double phi(const double &amp;g, const double &amp;h, const double &amp;hL, const double &amp;hR, const double &amp;uL, const double &amp;uR)</div><div class="ttdef"><b>Definition:</b> <a href="_g_n___s_w2_d_c_v_8h_source.html#l00094">GN_SW2DCV.h:94</a></div></div>
<div class="ttc" id="aclassproteus_1_1_r_a_n_s2_p_html_acf8d86d92ac9b99a31df36acfc6fece3"><div class="ttname"><a href="classproteus_1_1_r_a_n_s2_p.html#acf8d86d92ac9b99a31df36acfc6fece3">proteus::RANS2P::calculateSubgridError_tauRes</a></div><div class="ttdeci">void calculateSubgridError_tauRes(const double &amp;tau_p, const double &amp;tau_v, const double &amp;pdeResidualP, const double &amp;pdeResidualU, const double &amp;pdeResidualV, const double &amp;pdeResidualW, double &amp;subgridErrorP, double &amp;subgridErrorU, double &amp;subgridErrorV, double &amp;subgridErrorW)</div><div class="ttdef"><b>Definition:</b> <a href="_r_a_n_s2_p_8h_source.html#l01703">RANS2P.h:1703</a></div></div>
<div class="ttc" id="aclassproteus_1_1_r_a_n_s2_p__base_html_acf1aa973f8b828074f917566f649d172"><div class="ttname"><a href="classproteus_1_1_r_a_n_s2_p__base.html#acf1aa973f8b828074f917566f649d172">proteus::RANS2P_base::getTwoPhaseInvScaledLaplaceOperator</a></div><div class="ttdeci">virtual void getTwoPhaseInvScaledLaplaceOperator(double *mesh_trial_ref, double *mesh_grad_trial_ref, double *mesh_dof, int *mesh_l2g, double *dV_ref, double *p_grad_trial_ref, double *vel_grad_trial_ref, double *elementDiameter, double *nodeDiametersArray, int nElements_global, double useMetrics, double epsFact_rho, double epsFact_mu, double rho_0, double nu_0, double rho_1, double nu_1, int *p_l2g, int *vel_l2g, double *p_dof, double *u_dof, double *v_dof, double *w_dof, const double useVF, double *vf, double *phi, int *sdInfo_p_p_rowptr, int *sdInfo_p_p_colind, int *sdInfo_u_u_rowptr, int *sdInfo_u_u_colind, int *sdInfo_v_v_rowptr, int *sdInfo_v_v_colind, int *sdInfo_w_w_rowptr, int *sdInfo_w_w_colind, int *csrRowIndeces_p_p, int *csrColumnOffsets_p_p, int *csrRowIndeces_u_u, int *csrColumnOffsets_u_u, int *csrRowIndeces_v_v, int *csrColumnOffsets_v_v, int *csrRowIndeces_w_w, int *csrColumnOffsets_w_w, double *laplace_matrix)=0</div></div>
<div class="ttc" id="aclassproteus_1_1_r_a_n_s2_p_html_a63146e5310c6c2c58f6d91398944a69a"><div class="ttname"><a href="classproteus_1_1_r_a_n_s2_p.html#a63146e5310c6c2c58f6d91398944a69a">proteus::RANS2P::calculateResidual</a></div><div class="ttdeci">void calculateResidual(double NONCONSERVATIVE_FORM, double MOMENTUM_SGE, double PRESSURE_SGE, double VELOCITY_SGE, double PRESSURE_PROJECTION_STABILIZATION, double *numerical_viscosity, double *mesh_trial_ref, double *mesh_grad_trial_ref, double *mesh_dof, double *mesh_velocity_dof, double MOVING_DOMAIN, int *mesh_l2g, double *x_ref, double *dV_ref, double *p_trial_ref, double *p_grad_trial_ref, double *p_test_ref, double *p_grad_test_ref, double *vel_trial_ref, double *vel_grad_trial_ref, double *vel_test_ref, double *vel_grad_test_ref, double *mesh_trial_trace_ref, double *mesh_grad_trial_trace_ref, double *dS_ref, double *p_trial_trace_ref, double *p_grad_trial_trace_ref, double *p_test_trace_ref, double *p_grad_test_trace_ref, double *vel_trial_trace_ref, double *vel_grad_trial_trace_ref, double *vel_test_trace_ref, double *vel_grad_test_trace_ref, double *normal_ref, double *boundaryJac_ref, double eb_adjoint_sigma, double *elementDiameter, double *nodeDiametersArray, double hFactor, int nElements_global, int nElementBoundaries_owned, double useRBLES, double useMetrics, double alphaBDF, double epsFact_rho, double epsFact_mu, double sigma, double rho_0, double nu_0, double rho_1, double nu_1, double smagorinskyConstant, int turbulenceClosureModel, double Ct_sge, double Cd_sge, double C_dc, double C_b, const double *eps_solid, double *phi_solid, const double *q_velocity_solid, const double *q_porosity, const double *q_dragAlpha, const double *q_dragBeta, const double *q_mass_source, const double *q_turb_var_0, const double *q_turb_var_1, const double *q_turb_var_grad_0, const double LAG_LES, double *q_eddy_viscosity, double *q_eddy_viscosity_last, double *ebqe_eddy_viscosity, double *ebqe_eddy_viscosity_last, int *p_l2g, int *vel_l2g, int *rp_l2g, int *rvel_l2g, double *p_dof, double *u_dof, double *v_dof, double *w_dof, double *p_old_dof, double *u_old_dof, double *v_old_dof, double *w_old_dof, double *g, const double useVF, double *q_rho, double *vf, double *phi, double *phi_nodes, double *normal_phi, double *kappa_phi, double *q_mom_u_acc, double *q_mom_v_acc, double *q_mom_w_acc, double *q_mass_adv, double *q_mom_u_acc_beta_bdf, double *q_mom_v_acc_beta_bdf, double *q_mom_w_acc_beta_bdf, double *q_dV, double *q_dV_last, double *q_velocity_sge, double *q_cfl, double *q_numDiff_u, double *q_numDiff_v, double *q_numDiff_w, double *q_numDiff_u_last, double *q_numDiff_v_last, double *q_numDiff_w_last, int *sdInfo_u_u_rowptr, int *sdInfo_u_u_colind, int *sdInfo_u_v_rowptr, int *sdInfo_u_v_colind, int *sdInfo_u_w_rowptr, int *sdInfo_u_w_colind, int *sdInfo_v_v_rowptr, int *sdInfo_v_v_colind, int *sdInfo_v_u_rowptr, int *sdInfo_v_u_colind, int *sdInfo_v_w_rowptr, int *sdInfo_v_w_colind, int *sdInfo_w_w_rowptr, int *sdInfo_w_w_colind, int *sdInfo_w_u_rowptr, int *sdInfo_w_u_colind, int *sdInfo_w_v_rowptr, int *sdInfo_w_v_colind, int offset_p, int offset_u, int offset_v, int offset_w, int stride_p, int stride_u, int stride_v, int stride_w, double *globalResidual, int nExteriorElementBoundaries_global, int *exteriorElementBoundariesArray, int *elementBoundaryElementsArray, int *elementBoundaryLocalElementBoundariesArray, double *ebqe_vf_ext, double *bc_ebqe_vf_ext, double *ebqe_phi_ext, double *bc_ebqe_phi_ext, double *ebqe_normal_phi_ext, double *ebqe_kappa_phi_ext, const double *ebqe_porosity_ext, const double *ebqe_turb_var_0, const double *ebqe_turb_var_1, int *isDOFBoundary_p, int *isDOFBoundary_u, int *isDOFBoundary_v, int *isDOFBoundary_w, int *isAdvectiveFluxBoundary_p, int *isAdvectiveFluxBoundary_u, int *isAdvectiveFluxBoundary_v, int *isAdvectiveFluxBoundary_w, int *isDiffusiveFluxBoundary_u, int *isDiffusiveFluxBoundary_v, int *isDiffusiveFluxBoundary_w, double *ebqe_bc_p_ext, double *ebqe_bc_flux_mass_ext, double *ebqe_bc_flux_mom_u_adv_ext, double *ebqe_bc_flux_mom_v_adv_ext, double *ebqe_bc_flux_mom_w_adv_ext, double *ebqe_bc_u_ext, double *ebqe_bc_flux_u_diff_ext, double *ebqe_penalty_ext, double *ebqe_bc_v_ext, double *ebqe_bc_flux_v_diff_ext, double *ebqe_bc_w_ext, double *ebqe_bc_flux_w_diff_ext, double *q_x, double *q_velocity, double *ebqe_velocity, double *flux, double *elementResidual_p_save, int *elementFlags, int *boundaryFlags, double *barycenters, double *wettedAreas, double *netForces_p, double *netForces_v, double *netMoments, double *velocityError, double *velocityErrorNodal, double *forcex, double *forcey, double *forcez, int use_ball_as_particle, double *ball_center, double *ball_radius, double *ball_velocity, double *ball_angular_velocity, double *ball_center_acceleration, double *ball_angular_acceleration, double *ball_density, double *particle_signed_distances, double *particle_signed_distance_normals, double *particle_velocities, double *particle_centroids, double *ebq_global_phi_s, double *ebq_global_grad_phi_s, double *ebq_particle_velocity_s, int nParticles, double *particle_netForces, double *particle_netMoments, double *particle_surfaceArea, int nElements_owned, double particle_nitsche, double particle_epsFact, double particle_alpha, double particle_beta, double particle_penalty_constant, double *phi_solid_nodes, double *distance_to_solids, const int use_pseudo_penalty, bool useExact)</div><div class="ttdef"><b>Definition:</b> <a href="_r_a_n_s2_p_8h_source.html#l02399">RANS2P.h:2399</a></div></div>
<div class="ttc" id="a_error_residual_method_8cpp_html_a751e53c9d8dfaf696b11b86e0c1b42e9"><div class="ttname"><a href="_error_residual_method_8cpp.html#a751e53c9d8dfaf696b11b86e0c1b42e9">rho_1</a></div><div class="ttdeci">double rho_1</div><div class="ttdef"><b>Definition:</b> <a href="_error_residual_method_8cpp_source.html#l00022">ErrorResidualMethod.cpp:22</a></div></div>
<div class="ttc" id="a_py_embedded_functions_8h_html_a3ddeb1b85023f01e48ff330ed82632b4"><div class="ttname"><a href="_py_embedded_functions_8h.html#a3ddeb1b85023f01e48ff330ed82632b4">logEvent</a></div><div class="ttdeci">int logEvent(char *logString, int logLevel)</div><div class="ttdef"><b>Definition:</b> <a href="_py_embedded_functions_8h_source.html#l00007">PyEmbeddedFunctions.h:7</a></div></div>
<div class="ttc" id="a_mixed_model_factory_8h_html"><div class="ttname"><a href="_mixed_model_factory_8h.html">MixedModelFactory.h</a></div></div>
<div class="ttc" id="aclassproteus_1_1_r_a_n_s2_p__base_html_aa57937b9b5702e2d0cf3f5ca4a33aeb7"><div class="ttname"><a href="classproteus_1_1_r_a_n_s2_p__base.html#aa57937b9b5702e2d0cf3f5ca4a33aeb7">proteus::RANS2P_base::calculateJacobian</a></div><div class="ttdeci">virtual void calculateJacobian(double NONCONSERVATIVE_FORM, double MOMENTUM_SGE, double PRESSURE_SGE, double VELOCITY_SGE, double PRESSURE_PROJECTION_STABILIZATION, double *mesh_trial_ref, double *mesh_grad_trial_ref, double *mesh_dof, double *mesh_velocity_dof, double MOVING_DOMAIN, int *mesh_l2g, double *x_ref, double *dV_ref, double *p_trial_ref, double *p_grad_trial_ref, double *p_test_ref, double *p_grad_test_ref, double *vel_trial_ref, double *vel_grad_trial_ref, double *vel_test_ref, double *vel_grad_test_ref, double *mesh_trial_trace_ref, double *mesh_grad_trial_trace_ref, double *dS_ref, double *p_trial_trace_ref, double *p_grad_trial_trace_ref, double *p_test_trace_ref, double *p_grad_test_trace_ref, double *vel_trial_trace_ref, double *vel_grad_trial_trace_ref, double *vel_test_trace_ref, double *vel_grad_test_trace_ref, double *normal_ref, double *boundaryJac_ref, double eb_adjoint_sigma, double *elementDiameter, double *nodeDiametersArray, double hFactor, int nElements_global, double useRBLES, double useMetrics, double alphaBDF, double epsFact_rho, double epsFact_mu, double sigma, double rho_0, double nu_0, double rho_1, double nu_1, double smagorinskyConstant, int turbulenceClosureModel, double Ct_sge, double Cd_sge, double C_dg, double C_b, const double *eps_solid, const double *phi_solid, const double *q_velocity_solid, const double *q_porosity, const double *q_dragAlpha, const double *q_dragBeta, const double *q_mass_source, const double *q_turb_var_0, const double *q_turb_var_1, const double *q_turb_var_grad_0, const double LAG_LES, double *q_eddy_viscosity_last, double *ebqe_eddy_viscosity_last, int *p_l2g, int *vel_l2g, double *p_dof, double *u_dof, double *v_dof, double *w_dof, double *p_old_dof, double *u_old_dof, double *v_old_dof, double *w_old_dof, double *g, const double useVF, double *vf, double *phi, double *phi_nodes, double *normal_phi, double *kappa_phi, double *q_mom_u_acc_beta_bdf, double *q_mom_v_acc_beta_bdf, double *q_mom_w_acc_beta_bdf, double *q_dV, double *q_dV_last, double *q_velocity_sge, double *q_cfl, double *q_numDiff_u_last, double *q_numDiff_v_last, double *q_numDiff_w_last, int *sdInfo_u_u_rowptr, int *sdInfo_u_u_colind, int *sdInfo_u_v_rowptr, int *sdInfo_u_v_colind, int *sdInfo_u_w_rowptr, int *sdInfo_u_w_colind, int *sdInfo_v_v_rowptr, int *sdInfo_v_v_colind, int *sdInfo_v_u_rowptr, int *sdInfo_v_u_colind, int *sdInfo_v_w_rowptr, int *sdInfo_v_w_colind, int *sdInfo_w_w_rowptr, int *sdInfo_w_w_colind, int *sdInfo_w_u_rowptr, int *sdInfo_w_u_colind, int *sdInfo_w_v_rowptr, int *sdInfo_w_v_colind, int *csrRowIndeces_p_p, int *csrColumnOffsets_p_p, int *csrRowIndeces_p_u, int *csrColumnOffsets_p_u, int *csrRowIndeces_p_v, int *csrColumnOffsets_p_v, int *csrRowIndeces_p_w, int *csrColumnOffsets_p_w, int *csrRowIndeces_u_p, int *csrColumnOffsets_u_p, int *csrRowIndeces_u_u, int *csrColumnOffsets_u_u, int *csrRowIndeces_u_v, int *csrColumnOffsets_u_v, int *csrRowIndeces_u_w, int *csrColumnOffsets_u_w, int *csrRowIndeces_v_p, int *csrColumnOffsets_v_p, int *csrRowIndeces_v_u, int *csrColumnOffsets_v_u, int *csrRowIndeces_v_v, int *csrColumnOffsets_v_v, int *csrRowIndeces_v_w, int *csrColumnOffsets_v_w, int *csrRowIndeces_w_p, int *csrColumnOffsets_w_p, int *csrRowIndeces_w_u, int *csrColumnOffsets_w_u, int *csrRowIndeces_w_v, int *csrColumnOffsets_w_v, int *csrRowIndeces_w_w, int *csrColumnOffsets_w_w, double *globalJacobian, int nExteriorElementBoundaries_global, int *exteriorElementBoundariesArray, int *elementBoundaryElementsArray, int *elementBoundaryLocalElementBoundariesArray, double *ebqe_vf_ext, double *bc_ebqe_vf_ext, double *ebqe_phi_ext, double *bc_ebqe_phi_ext, double *ebqe_normal_phi_ext, double *ebqe_kappa_phi_ext, const double *ebqe_porosity_ext, const double *ebqe_turb_var_0, const double *ebqe_turb_var_1, int *isDOFBoundary_p, int *isDOFBoundary_u, int *isDOFBoundary_v, int *isDOFBoundary_w, int *isAdvectiveFluxBoundary_p, int *isAdvectiveFluxBoundary_u, int *isAdvectiveFluxBoundary_v, int *isAdvectiveFluxBoundary_w, int *isDiffusiveFluxBoundary_u, int *isDiffusiveFluxBoundary_v, int *isDiffusiveFluxBoundary_w, double *ebqe_bc_p_ext, double *ebqe_bc_flux_mass_ext, double *ebqe_bc_flux_mom_u_adv_ext, double *ebqe_bc_flux_mom_v_adv_ext, double *ebqe_bc_flux_mom_w_adv_ext, double *ebqe_bc_u_ext, double *ebqe_bc_flux_u_diff_ext, double *ebqe_penalty_ext, double *ebqe_bc_v_ext, double *ebqe_bc_flux_v_diff_ext, double *ebqe_bc_w_ext, double *ebqe_bc_flux_w_diff_ext, int *csrColumnOffsets_eb_p_p, int *csrColumnOffsets_eb_p_u, int *csrColumnOffsets_eb_p_v, int *csrColumnOffsets_eb_p_w, int *csrColumnOffsets_eb_u_p, int *csrColumnOffsets_eb_u_u, int *csrColumnOffsets_eb_u_v, int *csrColumnOffsets_eb_u_w, int *csrColumnOffsets_eb_v_p, int *csrColumnOffsets_eb_v_u, int *csrColumnOffsets_eb_v_v, int *csrColumnOffsets_eb_v_w, int *csrColumnOffsets_eb_w_p, int *csrColumnOffsets_eb_w_u, int *csrColumnOffsets_eb_w_v, int *csrColumnOffsets_eb_w_w, int *elementFlags, int *boundaryFlags, int use_ball_as_particle, double *ball_center, double *ball_radius, double *ball_velocity, double *ball_angular_velocity, double *ball_center_acceleration, double *ball_angular_acceleration, double *ball_density, double *particle_signed_distances, double *particle_signed_distance_normals, double *particle_velocities, double *particle_centroids, double *ebq_global_phi_s, double *ebq_global_grad_phi_s, double *ebq_particle_velocity_s, double *phi_solid_nodes, double *distance_to_solids, int nParticles, int nElements_owned, double particle_nitsche, double particle_epsFact, double particle_alpha, double particle_beta, double particle_penalty_constant, const int use_pseudo_penalty, bool useExact)=0</div></div>
<div class="ttc" id="aclassproteus_1_1_r_a_n_s2_p_html_a657d5d64a05158d6d19614555ce257e7"><div class="ttname"><a href="classproteus_1_1_r_a_n_s2_p.html#a657d5d64a05158d6d19614555ce257e7">proteus::RANS2P::nDOF_test_X_v_trial_element</a></div><div class="ttdeci">const int nDOF_test_X_v_trial_element</div><div class="ttdef"><b>Definition:</b> <a href="_r_a_n_s2_p_8h_source.html#l00562">RANS2P.h:562</a></div></div>
<div class="ttc" id="aclassproteus_1_1_r_a_n_s2_p_html"><div class="ttname"><a href="classproteus_1_1_r_a_n_s2_p.html">proteus::RANS2P</a></div><div class="ttdef"><b>Definition:</b> <a href="_r_a_n_s2_p_8h_source.html#l00558">RANS2P.h:558</a></div></div>
<div class="ttc" id="aclassequivalent__polynomials_1_1_generalized_functions__mix_html"><div class="ttname"><a href="classequivalent__polynomials_1_1_generalized_functions__mix.html">equivalent_polynomials::GeneralizedFunctions_mix</a></div><div class="ttdef"><b>Definition:</b> <a href="equivalent__polynomials_8h_source.html#l00370">equivalent_polynomials.h:370</a></div></div>
<div class="ttc" id="aclassproteus_1_1_r_a_n_s2_p_html_ab66a1a6d5a9b4641792020f58af14938"><div class="ttname"><a href="classproteus_1_1_r_a_n_s2_p.html#ab66a1a6d5a9b4641792020f58af14938">proteus::RANS2P::evaluateTPAdvectionCoefficients</a></div><div class="ttdeci">void evaluateTPAdvectionCoefficients(const double eps_rho, const double rho_0, const double rho_1, const double useVF, const double &amp;vf, const double &amp;phi, const double &amp;u, const double &amp;v, const double &amp;w, double dmass_adv_p[nSpace], double dmom_u_adv_u[nSpace], double dmom_v_adv_v[nSpace], double dmom_w_adv_w[nSpace])</div><div class="ttdef"><b>Definition:</b> <a href="_r_a_n_s2_p_8h_source.html#l06810">RANS2P.h:6810</a></div></div>
<div class="ttc" id="aclassproteus_1_1_r_a_n_s2_p_html_a7a7848813d299e5d43a0c4872556a476"><div class="ttname"><a href="classproteus_1_1_r_a_n_s2_p.html#a7a7848813d299e5d43a0c4872556a476">proteus::RANS2P::ck_v</a></div><div class="ttdeci">CompKernelType_v ck_v</div><div class="ttdef"><b>Definition:</b> <a href="_r_a_n_s2_p_8h_source.html#l00566">RANS2P.h:566</a></div></div>
<div class="ttc" id="aclassproteus_1_1_r_a_n_s2_p_html_a9a5e8fe094de9df2b69c2c635a7f0d8e"><div class="ttname"><a href="classproteus_1_1_r_a_n_s2_p.html#a9a5e8fe094de9df2b69c2c635a7f0d8e">proteus::RANS2P::get_cross_product</a></div><div class="ttdeci">void get_cross_product(const double *u, const double *v, double res[3])</div><div class="ttdef"><b>Definition:</b> <a href="_r_a_n_s2_p_8h_source.html#l01109">RANS2P.h:1109</a></div></div>
<div class="ttc" id="aclassproteus_1_1_r_a_n_s2_p__base_html_a19ed30cfae419903868c7593804dca97"><div class="ttname"><a href="classproteus_1_1_r_a_n_s2_p__base.html#a19ed30cfae419903868c7593804dca97">proteus::RANS2P_base::calculateVelocityAverage</a></div><div class="ttdeci">virtual void calculateVelocityAverage(int nExteriorElementBoundaries_global, int *exteriorElementBoundariesArray, int nInteriorElementBoundaries_global, int *interiorElementBoundariesArray, int *elementBoundaryElementsArray, int *elementBoundaryLocalElementBoundariesArray, double *mesh_dof, double *mesh_velocity_dof, double MOVING_DOMAIN, int *mesh_l2g, double *mesh_trial_trace_ref, double *mesh_grad_trial_trace_ref, double *normal_ref, double *boundaryJac_ref, int *vel_l2g, double *u_dof, double *v_dof, double *w_dof, double *vel_trial_trace_ref, double *ebqe_velocity, double *velocityAverage)=0</div></div>
<div class="ttc" id="anamespaceproteus_html"><div class="ttname"><a href="namespaceproteus.html">proteus</a></div><div class="ttdef"><b>Definition:</b> <a href="_a_d_r_8h_source.html#l00008">ADR.h:8</a></div></div>
<div class="ttc" id="aclassproteus_1_1_r_a_n_s2_p_html_a348042ad3350e7e70a219182dc12645c"><div class="ttname"><a href="classproteus_1_1_r_a_n_s2_p.html#a348042ad3350e7e70a219182dc12645c">proteus::RANS2P::evaluateTPInvDensityLaplaceCoefficients</a></div><div class="ttdeci">void evaluateTPInvDensityLaplaceCoefficients(const double eps_rho, const double rho_0, const double rho_1, const double useVF, const double &amp;vf, const double &amp;phi, double mom_p_diff_ten[nSpace], double mom_u_diff_ten[nSpace], double mom_v_diff_ten[nSpace], double mom_w_diff_ten[nSpace])</div><div class="ttdef"><b>Definition:</b> <a href="_r_a_n_s2_p_8h_source.html#l06938">RANS2P.h:6938</a></div></div>
<div class="ttc" id="aclassproteus_1_1_r_a_n_s2_p_html_ad7f7189cfca7297be05b3782551714b0"><div class="ttname"><a href="classproteus_1_1_r_a_n_s2_p.html#ad7f7189cfca7297be05b3782551714b0">proteus::RANS2P::ExteriorNumericalDiffusiveFluxJacobian</a></div><div class="ttdeci">double ExteriorNumericalDiffusiveFluxJacobian(const double &amp;eps, const double &amp;phi, int *rowptr, int *colind, const int &amp;isDOFBoundary, const int &amp;isFluxBoundary, const double n[nSpace], double *a, const double &amp;v, const double grad_v[nSpace], const double &amp;penalty)</div><div class="ttdef"><b>Definition:</b> <a href="_r_a_n_s2_p_8h_source.html#l02366">RANS2P.h:2366</a></div></div>
<div class="ttc" id="anamespaceproteus_html_acdff9c5188c64d27db5cdf2669c2a849"><div class="ttname"><a href="namespaceproteus.html#acdff9c5188c64d27db5cdf2669c2a849">proteus::GeneralizedFunctions</a></div><div class="ttdeci">equivalent_polynomials::GeneralizedFunctions_mix&lt; nSpace, nP, nQ &gt; GeneralizedFunctions</div><div class="ttdef"><b>Definition:</b> <a href="_m_corr_8h_source.html#l00015">MCorr.h:15</a></div></div>
<div class="ttc" id="aclassproteus_1_1_r_a_n_s2_p_html_a6c96a8ae5e2aca6096bd12b44658aa84"><div class="ttname"><a href="classproteus_1_1_r_a_n_s2_p.html#a6c96a8ae5e2aca6096bd12b44658aa84">proteus::RANS2P::evaluateTPDensityMassCoefficients</a></div><div class="ttdeci">void evaluateTPDensityMassCoefficients(const double eps_rho, const double rho_0, const double rho_1, const double useVF, const double &amp;vf, const double &amp;phi, const double &amp;p, const double &amp;u, const double &amp;v, const double &amp;w, double &amp;mom_p_acc, double &amp;dmom_p_acc_p, double &amp;mom_u_acc, double &amp;dmom_u_acc_u, double &amp;mom_v_acc, double &amp;dmom_v_acc_v, double &amp;mom_w_acc, double &amp;dmom_w_acc_w)</div><div class="ttdef"><b>Definition:</b> <a href="_r_a_n_s2_p_8h_source.html#l06899">RANS2P.h:6899</a></div></div>
<div class="ttc" id="aclassproteus_1_1_r_a_n_s2_p_html_ae7352b8f6f5d78a97c100c6e6d88f546"><div class="ttname"><a href="classproteus_1_1_r_a_n_s2_p.html#ae7352b8f6f5d78a97c100c6e6d88f546">proteus::RANS2P::getTwoPhaseInvScaledLaplaceOperator</a></div><div class="ttdeci">void getTwoPhaseInvScaledLaplaceOperator(double *mesh_trial_ref, double *mesh_grad_trial_ref, double *mesh_dof, int *mesh_l2g, double *dV_ref, double *p_grad_trial_ref, double *vel_grad_trial_ref, double *elementDiameter, double *nodeDiametersArray, int nElements_global, double useMetrics, double epsFact_rho, double epsFact_mu, double rho_0, double nu_0, double rho_1, double nu_1, int *p_l2g, int *vel_l2g, double *p_dof, double *u_dof, double *v_dof, double *w_dof, const double useVF, double *vf, double *phi, int *sdInfo_p_p_rowptr, int *sdInfo_p_p_colind, int *sdInfo_u_u_rowptr, int *sdInfo_u_u_colind, int *sdInfo_v_v_rowptr, int *sdInfo_v_v_colind, int *sdInfo_w_w_rowptr, int *sdInfo_w_w_colind, int *csrRowIndeces_p_p, int *csrColumnOffsets_p_p, int *csrRowIndeces_u_u, int *csrColumnOffsets_u_u, int *csrRowIndeces_v_v, int *csrColumnOffsets_v_v, int *csrRowIndeces_w_w, int *csrColumnOffsets_w_w, double *laplace_matrix)</div><div class="ttdef"><b>Definition:</b> <a href="_r_a_n_s2_p_8h_source.html#l07128">RANS2P.h:7128</a></div></div>
<div class="ttc" id="aclassproteus_1_1_r_a_n_s2_p_html_a855a5f37352edded7f10b9a548f906f9"><div class="ttname"><a href="classproteus_1_1_r_a_n_s2_p.html#a855a5f37352edded7f10b9a548f906f9">proteus::RANS2P::RANS2P</a></div><div class="ttdeci">RANS2P()</div><div class="ttdef"><b>Definition:</b> <a href="_r_a_n_s2_p_8h_source.html#l00569">RANS2P.h:569</a></div></div>
<div class="ttc" id="aclassproteus_1_1_r_a_n_s2_p_html_a811f562fa019020df780d30394ae4ec0"><div class="ttname"><a href="classproteus_1_1_r_a_n_s2_p.html#a811f562fa019020df780d30394ae4ec0">proteus::RANS2P::calculateVelocityAverage</a></div><div class="ttdeci">void calculateVelocityAverage(int nExteriorElementBoundaries_global, int *exteriorElementBoundariesArray, int nInteriorElementBoundaries_global, int *interiorElementBoundariesArray, int *elementBoundaryElementsArray, int *elementBoundaryLocalElementBoundariesArray, double *mesh_dof, double *mesh_velocity_dof, double MOVING_DOMAIN, int *mesh_l2g, double *mesh_trial_trace_ref, double *mesh_grad_trial_trace_ref, double *normal_ref, double *boundaryJac_ref, int *vel_l2g, double *u_dof, double *v_dof, double *w_dof, double *vel_trial_trace_ref, double *ebqe_velocity, double *velocityAverage)</div><div class="ttdef"><b>Definition:</b> <a href="_r_a_n_s2_p_8h_source.html#l06644">RANS2P.h:6644</a></div></div>
<div class="ttc" id="aclassproteus_1_1_r_a_n_s2_p_html_ae3ee3b038921e561ba98a35bfe00dc0e"><div class="ttname"><a href="classproteus_1_1_r_a_n_s2_p.html#ae3ee3b038921e561ba98a35bfe00dc0e">proteus::RANS2P::calculateSubgridError_tau</a></div><div class="ttdeci">void calculateSubgridError_tau(const double &amp;Ct_sge, const double &amp;Cd_sge, const double G[nSpace *nSpace], const double &amp;G_dd_G, const double &amp;tr_G, const double &amp;A0, const double Ai[nSpace], const double &amp;Kij, const double &amp;pfac, double &amp;tau_v, double &amp;tau_p, double &amp;q_cfl)</div><div class="ttdef"><b>Definition:</b> <a href="_r_a_n_s2_p_8h_source.html#l01681">RANS2P.h:1681</a></div></div>
<div class="ttc" id="aclassproteus_1_1_r_a_n_s2_p_html_a8d4e605e4a83de181253b63041a8feb6"><div class="ttname"><a href="classproteus_1_1_r_a_n_s2_p.html#a8d4e605e4a83de181253b63041a8feb6">proteus::RANS2P::get_acceleration_to_ith_ball</a></div><div class="ttdeci">void get_acceleration_to_ith_ball(int n_balls, const double *ball_center, const double *ball_radius, const double *ball_velocity, const double *ball_angular_velocity, const double *ball_center_acceleration, const double *ball_angular_acceleration, int I, const double x, const double y, const double z, double &amp;ax, double &amp;ay, double &amp;az)</div><div class="ttdef"><b>Definition:</b> <a href="_r_a_n_s2_p_8h_source.html#l01133">RANS2P.h:1133</a></div></div>
<div class="ttc" id="a_error_residual_method_8cpp_html_ae5f5d9edb66645eab31a7c8389493ce7"><div class="ttname"><a href="_error_residual_method_8cpp.html#ae5f5d9edb66645eab31a7c8389493ce7">rho_0</a></div><div class="ttdeci">double rho_0</div><div class="ttdef"><b>Definition:</b> <a href="_error_residual_method_8cpp_source.html#l00022">ErrorResidualMethod.cpp:22</a></div></div>
<div class="ttc" id="a_r_a_n_s2_p_8h_html_a3716a8d2d50d63c6f70019ad4c23c4ac"><div class="ttname"><a href="_r_a_n_s2_p_8h.html#a3716a8d2d50d63c6f70019ad4c23c4ac">USE_CYLINDER_AS_PARTICLE</a></div><div class="ttdeci">#define USE_CYLINDER_AS_PARTICLE</div><div class="ttdef"><b>Definition:</b> <a href="_r_a_n_s2_p_8h_source.html#l00013">RANS2P.h:13</a></div></div>
<div class="ttc" id="aclassproteus_1_1_r_a_n_s2_p_html_aa6183d3c81313639cd5ec6c4697ccdde"><div class="ttname"><a href="classproteus_1_1_r_a_n_s2_p.html#aa6183d3c81313639cd5ec6c4697ccdde">proteus::RANS2P::gf_s</a></div><div class="ttdeci">GeneralizedFunctions&lt; nSpace, 1, nQuadraturePoints_element &gt; gf_s</div><div class="ttdef"><b>Definition:</b> <a href="_r_a_n_s2_p_8h_source.html#l00568">RANS2P.h:568</a></div></div>
<div class="ttc" id="aclassproteus_1_1_r_a_n_s2_p_html_a93a1c0a9daf704bd52b3d1416ffbe58a"><div class="ttname"><a href="classproteus_1_1_r_a_n_s2_p.html#a93a1c0a9daf704bd52b3d1416ffbe58a">proteus::RANS2P::get_velocity_to_ith_ball</a></div><div class="ttdeci">void get_velocity_to_ith_ball(int n_balls, const double *ball_center, const double *ball_radius, const double *ball_velocity, const double *ball_angular_velocity, int I, const double x, const double y, const double z, double &amp;vx, double &amp;vy, double &amp;vz)</div><div class="ttdef"><b>Definition:</b> <a href="_r_a_n_s2_p_8h_source.html#l01115">RANS2P.h:1115</a></div></div>
<div class="ttc" id="aclassproteus_1_1_r_a_n_s2_p__base_html_ac792268b36a32af7e06114b451e97fe5"><div class="ttname"><a href="classproteus_1_1_r_a_n_s2_p__base.html#ac792268b36a32af7e06114b451e97fe5">proteus::RANS2P_base::getTwoPhaseAdvectionOperator</a></div><div class="ttdeci">virtual void getTwoPhaseAdvectionOperator(double *mesh_trial_ref, double *mesh_grad_trial_ref, double *mesh_dof, int *mesh_l2g, double *dV_ref, double *p_trial_ref, double *p_grad_trial_ref, double *vel_trail_ref, double *vel_grad_trial_ref, double *elementDiameter, double *nodeDiametersArray, int nElements_global, double useMetrics, double epsFact_rho, double epsFact_mu, double rho_0, double nu_0, double rho_1, double nu_1, int *vel_l2g, double *u_dof, double *v_dof, double *w_dof, const double useVF, double *vf, double *phi, int *csrRowIndeces_p_p, int *csrColumnOffsets_p_p, int *csrRowIndeces_u_u, int *csrColumnOffsets_u_u, int *csrRowIndeces_v_v, int *csrColumnOffsets_v_v, int *csrRowIndeces_w_w, int *csrColumnOffsets_w_w, double *advection_matrix)=0</div></div>
<div class="ttc" id="aclassproteus_1_1_r_a_n_s2_p_html_a3e0cb3084e0e32cc2355384f2e511801"><div class="ttname"><a href="classproteus_1_1_r_a_n_s2_p.html#a3e0cb3084e0e32cc2355384f2e511801">proteus::RANS2P::get_distance_to_ball</a></div><div class="ttdeci">int get_distance_to_ball(int n_balls, const double *ball_center, const double *ball_radius, const double x, const double y, const double z, double &amp;distance)</div><div class="ttdef"><b>Definition:</b> <a href="_r_a_n_s2_p_8h_source.html#l01057">RANS2P.h:1057</a></div></div>
<div class="ttc" id="aclassproteus_1_1_r_a_n_s2_p_html_a25259ea48a9bc3708796a96164a3b8de"><div class="ttname"><a href="classproteus_1_1_r_a_n_s2_p.html#a25259ea48a9bc3708796a96164a3b8de">proteus::RANS2P::gf</a></div><div class="ttdeci">GeneralizedFunctions&lt; nSpace, 1, nQuadraturePoints_element &gt; gf</div><div class="ttdef"><b>Definition:</b> <a href="_r_a_n_s2_p_8h_source.html#l00567">RANS2P.h:567</a></div></div>
<div class="ttc" id="a_r_a_n_s2_p_8h_html_aaef02b6e1d46c51958a20651954c60b0"><div class="ttname"><a href="_r_a_n_s2_p_8h.html#aaef02b6e1d46c51958a20651954c60b0">DM</a></div><div class="ttdeci">const double DM</div><div class="ttdef"><b>Definition:</b> <a href="_r_a_n_s2_p_8h_source.html#l00010">RANS2P.h:10</a></div></div>
<div class="ttc" id="a_py_embedded_functions_8h_html"><div class="ttname"><a href="_py_embedded_functions_8h.html">PyEmbeddedFunctions.h</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Jan 21 2020 21:07:24 for proteus by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
